"use strict"; var _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e }; (global.webpackJsonp = global.webpackJsonp || []).push([["common/vendor"], [function (e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } function r(e, t, n) { return t in e ? Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e } n(4); var i = t(n(2)), o = t(n(5)); i.default.config.productionTip = !1, o.default.mpType = "app", e(new i.default(function (e) { for (var t = 1; t < arguments.length; t++) { var n = null != arguments[t] ? arguments[t] : {}, i = Object.keys(n); "function" == typeof Object.getOwnPropertySymbols && (i = i.concat(Object.getOwnPropertySymbols(n).filter(function (e) { return Object.getOwnPropertyDescriptor(n, e).enumerable }))), i.forEach(function (t) { r(e, t, n[t]) }) } return e }({}, o.default))).$mount() }).call(this, n(1).createApp) }, function (e, t, n) { function r(e, t) { return function (e) { if (Array.isArray(e)) return e }(e) || function (e, t) { var n = [], r = !0, i = !1, o = void 0; try { for (var s, a = e[Symbol.iterator](); !(r = (s = a.next()).done) && (n.push(s.value), !t || n.length !== t); r = !0); } catch (e) { i = !0, o = e } finally { try { r || null == a.return || a.return() } finally { if (i) throw o } } return n }(e, t) || function () { throw new TypeError("Invalid attempt to destructure non-iterable instance") }() } function i(e) { return function (e) { if (Array.isArray(e)) { for (var t = 0, n = new Array(e.length); t < e.length; t++)n[t] = e[t]; return n } }(e) || function (e) { if (Symbol.iterator in Object(e) || "[object Arguments]" === Object.prototype.toString.call(e)) return Array.from(e) }(e) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance") }() } function o(e) { return "function" == typeof e } function s(e) { return "[object Object]" === Q.call(e) } function a(e, t) { return Y.call(e, t) } function c() { } function u(e) { var t = Object.create(null); return function (n) { return t[n] || (t[n] = e(n)) } } function l(e, t) { Object.keys(t).forEach(function (n) { var r, i, s; -1 !== te.indexOf(n) && o(t[n]) && (e[n] = (r = e[n], i = t[n], (s = i ? r ? r.concat(i) : Array.isArray(i) ? i : [i] : r) ? function (e) { for (var t = [], n = 0; n < e.length; n++)-1 === t.indexOf(e[n]) && t.push(e[n]); return t }(s) : s)) }) } function m(e, t) { e && t && Object.keys(t).forEach(function (n) { -1 !== te.indexOf(n) && o(t[n]) && function (e, t) { var n = e.indexOf(t); -1 !== n && e.splice(n, 1) }(e[n], t[n]) }) } function d(e) { return function (t) { return e(t) || t } } function p(e) { return !!e && ("object" == (void 0 === e ? "undefined" : _typeof(e)) || "function" == typeof e) && "function" == typeof e.then } function f(e, t) { for (var n = !1, r = 0; r < e.length; r++) { var i = e[r]; if (n) n = Promise.then(d(i)); else { var o = i(t); if (p(o) && (n = Promise.resolve(o)), !1 === o) return { then: function () { } } } } return n || { then: function (e) { return e(t) } } } function g(e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return ["success", "fail", "complete"].forEach(function (n) { if (Array.isArray(e[n])) { var r = t[n]; t[n] = function (t) { f(e[n], t).then(function (e) { return o(r) && r(e) || e }) } } }), t } function h(e, t) { var n = []; Array.isArray(ne.returnValue) && n.push.apply(n, i(ne.returnValue)); var r = re[e]; return r && Array.isArray(r.returnValue) && n.push.apply(n, i(r.returnValue)), n.forEach(function (e) { t = e(t) || t }), t } function y(e, t, n) { for (var r = arguments.length, i = new Array(r > 3 ? r - 3 : 0), o = 3; o < r; o++)i[o - 3] = arguments[o]; var s = function (e) { var t = Object.create(null); Object.keys(ne).forEach(function (e) { "returnValue" !== e && (t[e] = ne[e].slice()) }); var n = re[e]; return n && Object.keys(n).forEach(function (e) { "returnValue" !== e && (t[e] = (t[e] || []).concat(n[e])) }), t }(e); return s && Object.keys(s).length ? Array.isArray(s.invoke) ? f(s.invoke, n).then(function (e) { return t.apply(void 0, [g(s, e)].concat(i)) }) : t.apply(void 0, [g(s, n)].concat(i)) : t.apply(void 0, [n].concat(i)) } function v(e) { return oe.test(e) } function b(e) { return ie.test(e) } function T(e) { return !(v(e) || b(e) || function (e) { return se.test(e) }(e)) } function M(e, t) { return T(e) ? function () { for (var n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, r = arguments.length, i = new Array(r > 1 ? r - 1 : 0), s = 1; s < r; s++)i[s - 1] = arguments[s]; return o(n.success) || o(n.fail) || o(n.complete) ? h(e, y.apply(void 0, [e, t, n].concat(i))) : h(e, new Promise(function (r, o) { y.apply(void 0, [e, t, Object.assign({}, n, { success: r, fail: o })].concat(i)), Promise.prototype.finally || (Promise.prototype.finally = function (e) { var t = this.constructor; return this.then(function (n) { return t.resolve(e()).then(function () { return n }) }, function (n) { return t.resolve(e()).then(function () { throw n }) }) }) }).then(function (e) { return [null, e] }).catch(function (e) { return [e] })) } : t } function S(e, t, n) { return function (r) { return t(_(e, r, n)) } } function k(e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {}, i = arguments.length > 4 && void 0 !== arguments[4] && arguments[4]; if (s(t)) { var c = !0 === i ? t : {}; for (var u in o(n) && (n = n(t, c) || {}), t) if (a(n, u)) { var l = n[u]; o(l) && (l = l(t[u], t, c)), l ? "string" == typeof l ? c[l] = t[u] : s(l) && (c[l.name ? l.name : u] = l.value) : console.warn("微信小程序 ".concat(e, "暂不支持").concat(u)) } else -1 !== pe.indexOf(u) ? c[u] = S(e, t[u], r) : i || (c[u] = t[u]); return c } return o(t) && (t = S(e, t, r)), t } function _(e, t, n) { var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3]; return o(de.returnValue) && (t = de.returnValue(e, t)), k(e, t, n, {}, r) } function w(e, t) { if (a(de, e)) { var n = de[e]; return n ? function (t, r) { var i = n; o(n) && (i = n(t)); var s = [t = k(e, t, i.args, i.returnValue)]; void 0 !== r && s.push(r); var a = wx[i.name || e].apply(wx, s); return b(e) ? _(e, a, i.returnValue, v(e)) : a } : function () { console.error("微信小程序 暂不支持".concat(e)) } } return t } function P(e, t, n) { return e[t].apply(e, n) } function C(e) { if (wx.canIUse("nextTick")) { var t = e.triggerEvent; e.triggerEvent = function (n) { for (var r = arguments.length, i = new Array(r > 1 ? r - 1 : 0), o = 1; o < r; o++)i[o - 1] = arguments[o]; return t.apply(e, [_e(n)].concat(i)) } } } function I(e, t) { var n = t[e]; t[e] = n ? function () { C(this); for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; return n.apply(this, t) } : function () { C(this) } } function O(e, t, n) { t.forEach(function (t) { (function e(t, n) { if (!n) return !0; if (K.default.options && Array.isArray(K.default.options[t])) return !0; if (o(n = n.default || n)) return !!o(n.extendOptions[t]) || !!(n.super && n.super.options && Array.isArray(n.super.options[t])); if (o(n[t])) return !0; var r = n.mixins; return Array.isArray(r) ? !!r.find(function (n) { return e(t, n) }) : void 0 })(t, n) && (e[t] = function (e) { return this.$vm && this.$vm.__call_hook(t, e) }) }) } function A(e, t) { var n = e.data || {}, r = e.methods || {}; if ("function" == typeof n) try { n = n.call(t) } catch (e) { Object({ NODE_ENV: "development", VUE_APP_PLATFORM: "mp-weixin", BASE_URL: "/" }).VUE_APP_DEBUG && console.warn("根据 Vue 的 data 函数初始化小程序 data 失败，请尽量确保 data 函数中不访问 vm 对象，否则可能影响首次数据渲染速度。", n) } else try { n = JSON.parse(JSON.stringify(n)) } catch (e) { } return s(n) || (n = {}), Object.keys(r).forEach(function (e) { -1 !== t.__lifecycle_hooks__.indexOf(e) || a(n, e) || (n[e] = r[e]) }), n } function x(e) { return function (t, n) { this.$vm && (this.$vm[e] = t) } } function E(e, t) { var n = e.behaviors, r = e.extends, i = e.mixins, o = e.props; o || (e.props = o = []); var a = []; return Array.isArray(n) && n.forEach(function (e) { a.push(e.replace("uni://", "wx".concat("://"))), "uni://form-field" === e && (Array.isArray(o) ? (o.push("name"), o.push("value")) : (o.name = { type: String, default: "" }, o.value = { type: [String, Number, Boolean, Array, Object, Date], default: "" })) }), s(r) && r.props && a.push(t({ properties: U(r.props, !0) })), Array.isArray(i) && i.forEach(function (e) { s(e) && e.props && a.push(t({ properties: U(e.props, !0) })) }), a } function j(e, t, n, r) { return Array.isArray(t) && 1 === t.length ? t[0] : t } function U(e) { var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1], n = (arguments.length > 2 && void 0 !== arguments[2] && arguments[2], {}); return t || (n.vueId = { type: String, value: "" }, n.vueSlots = { type: null, value: [], observer: function (e, t) { var n = Object.create(null); e.forEach(function (e) { n[e] = !0 }), this.setData({ $slots: n }) } }), Array.isArray(e) ? e.forEach(function (e) { n[e] = { type: null, observer: x(e) } }) : s(e) && Object.keys(e).forEach(function (t) { var r = e[t]; if (s(r)) { var i = r.default; o(i) && (i = i()), r.type = j(0, r.type), n[t] = { type: -1 !== we.indexOf(r.type) ? r.type : null, value: i, observer: x(t) } } else { var a = j(0, r); n[t] = { type: -1 !== we.indexOf(a) ? a : null, observer: x(t) } } }), n } function R(e, t, n) { var r = {}; return Array.isArray(t) && t.length && t.forEach(function (t, i) { "string" == typeof t ? t ? "$event" === t ? r["$" + i] = n : 0 === t.indexOf("$event.") ? r["$" + i] = e.__get_value(t.replace("$event.", ""), n) : r["$" + i] = e.__get_value(t) : r["$" + i] = e : r["$" + i] = function (e, t) { var n = e; return t.forEach(function (t) { var r = t[0], i = t[2]; if (r || void 0 !== i) { var o = t[1], a = t[3], c = r ? e.__get_value(r, n) : n; Number.isInteger(c) ? n = i : o ? Array.isArray(c) ? n = c.find(function (t) { return e.__get_value(o, t) === i }) : s(c) ? n = Object.keys(c).find(function (t) { return e.__get_value(o, c[t]) === i }) : console.error("v-for 暂不支持循环数据：", c) : n = c[i], a && (n = e.__get_value(a, n)) } }), n }(e, t) }), r } function F(e) { var t = this, n = ((e = function (e) { try { e.mp = JSON.parse(JSON.stringify(e)) } catch (e) { } return e.stopPropagation = c, e.preventDefault = c, e.target = e.target || {}, a(e, "detail") || (e.detail = {}), s(e.detail) && (e.target = Object.assign({}, e.target, e.detail)), e }(e)).currentTarget || e.target).dataset; if (!n) return console.warn("事件信息不存在"); var r = n.eventOpts || n["event-opts"]; if (!r) return console.warn("事件信息不存在"); var i = e.type, u = []; return r.forEach(function (n) { var r = n[0], s = n[1], c = r.charAt(0) === Ce, l = (r = c ? r.slice(1) : r).charAt(0) === Pe; r = l ? r.slice(1) : r, s && function (e, t) { return e === t || "regionchange" === t && ("begin" === e || "end" === e) }(i, r) && s.forEach(function (n) { var r = n[0]; if (r) { var i = t.$vm; i.$options.generic && i.$parent && i.$parent.$parent && (i = i.$parent.$parent); var s = i[r]; if (!o(s)) throw new Error(" _vm.".concat(r, " is not a function")); if (l) { if (s.once) return; s.once = !0 } u.push(s.apply(i, function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : [], r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : [], i = arguments.length > 4 ? arguments[4] : void 0, o = arguments.length > 5 ? arguments[5] : void 0, s = !1; if (i && (s = t.currentTarget && t.currentTarget.dataset && "wx" === t.currentTarget.dataset.comType, !n.length)) return s ? [t] : t.detail.__args__ || t.detail; var c = R(e, r, t), u = []; return n.forEach(function (e) { "$event" === e ? "__set_model" !== o || i ? i && !s ? u.push(t.detail.__args__[0]) : u.push(t) : u.push(t.target.value) : Array.isArray(e) && "o" === e[0] ? u.push(function (e) { for (var t = {}, n = 1; n < e.length; n++) { var r = e[n]; t[r[0]] = r[1] } return t }(e)) : "string" == typeof e && a(c, e) ? u.push(c[e]) : u.push(e) }), u }(t.$vm, e, n[1], n[2], c, r))) } }) }), "input" === i && 1 === u.length && void 0 !== u[0] ? u[0] : void 0 } function N(e, t) { var n = t.mocks, r = t.initRefs; K.default.prototype.mpHost = "mp-weixin", K.default.mixin({ beforeCreate: function () { var e, t, i; this.$options.mpType && (this.mpType = this.$options.mpType, this.$mp = (e = { data: {} }, t = this.mpType, i = this.$options.mpInstance, t in e ? Object.defineProperty(e, t, { value: i, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = i, e), this.$scope = this.$options.mpInstance, delete this.$options.mpType, delete this.$options.mpInstance, "app" !== this.mpType && (r(this), function (e, t) { var n = e.$mp[e.mpType]; t.forEach(function (t) { a(n, t) && (e[t] = n[t]) }) }(this, n))) } }); var i = { onLaunch: function (t) { this.$vm || (wx.canIUse("nextTick") || console.error("当前微信基础库版本过低，请将 微信开发者工具-详情-项目设置-调试基础库版本 更换为`2.3.0`以上"), this.$vm = e, this.$vm.$mp = { app: this }, this.$vm.$scope = this, this.$vm._isMounted = !0, this.$vm.__call_hook("mounted", t), this.$vm.__call_hook("onLaunch", t)) } }; return i.globalData = e.$options.globalData || {}, O(i, Ie), i } function D(e) { return Behavior(e) } function B() { return !!this.route } function L(e) { this.triggerEvent("__l", e) } function $(e) { var t = e.$scope; Object.defineProperty(e, "$refs", { get: function () { var e = {}; return t.selectAllComponents(".vue-ref").forEach(function (t) { var n = t.dataset.ref; e[n] = t.$vm || t }), t.selectAllComponents(".vue-ref-in-for").forEach(function (t) { var n = t.dataset.ref; e[n] || (e[n] = []), e[n].push(t.$vm || t) }), e } }) } function q(e) { var t, n = e.detail || e.value, r = n.vuePid, i = n.vueOptions; r && (t = function e(t, n) { var r = t.$children, i = r.find(function (e) { return e.$scope._$vueId === n }); if (i) return i; for (var o = r.length - 1; o >= 0; o--)if (i = e(r[o], n)) return i }(this.$vm, r)), t || (t = this.$vm), i.parent = t } function H(e) { return App(function (e) { return N(e, { mocks: Oe, initRefs: $ }) }(e)), e } function z(e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, n = t.isPage, i = t.initRelation, s = r(function (e, t) { var n; return o(t = t.default || t) ? t = (n = t).extendOptions : n = e.extend(t), [n, t] }(K.default, e), 2), a = s[0], c = s[1], u = { options: { multipleSlots: !0, addGlobalClass: !0 }, data: A(c, K.default.prototype), behaviors: E(c, D), properties: U(c.props, !1, c.__file), lifetimes: { attached: function () { var e, t, r, o = this.properties, s = { mpType: n.call(this) ? "page" : "component", mpInstance: this, propsData: o }; e = o.vueId, t = this, 1 === (r = (e = (e || "").split(",")).length) ? t._$vueId = e[0] : 2 === r && (t._$vueId = e[0], t._$vuePid = e[1]), i.call(this, { vuePid: this._$vuePid, vueOptions: s }), this.$vm = new a(s), function (e, t) { if (Array.isArray(t) && t.length) { var n = Object.create(null); t.forEach(function (e) { n[e] = !0 }), e.$scopedSlots = e.$slots = n } }(this.$vm, o.vueSlots), this.$vm.$mount() }, ready: function () { this.$vm && (this.$vm._isMounted = !0, this.$vm.__call_hook("mounted"), this.$vm.__call_hook("onReady")) }, detached: function () { this.$vm.$destroy() } }, pageLifetimes: { show: function (e) { this.$vm && this.$vm.__call_hook("onPageShow", e) }, hide: function () { this.$vm && this.$vm.__call_hook("onPageHide") }, resize: function (e) { this.$vm && this.$vm.__call_hook("onPageResize", e) } }, methods: { __l: q, __e: F } }; return n ? u : [u, a] } function V(e) { return z(e, { isPage: B, initRelation: L }) } function W(e) { return function (e, t) { var n = V(e); return O(n.methods, Ae, e), n.methods.onLoad = function (e) { this.$vm.$mp.query = e, this.$vm.__call_hook("onLoad", e) }, n }(e) } function J(e) { return Component(W(e)) } function X(e) { return Component(V(e)) } Object.defineProperty(t, "__esModule", { value: !0 }), t.createApp = H, t.createComponent = X, t.createPage = J, t.default = void 0; var G, K = (G = n(2)) && G.__esModule ? G : { default: G }, Q = Object.prototype.toString, Y = Object.prototype.hasOwnProperty, Z = /-(\w)/g, ee = u(function (e) { return e.replace(Z, function (e, t) { return t ? t.toUpperCase() : "" }) }), te = ["invoke", "success", "fail", "complete", "returnValue"], ne = {}, re = {}, ie = /^\$|interceptors|Interceptor$|getSubNVueById|requireNativePlugin|upx2px|hideKeyboard|canIUse|^create|Sync$|Manager$|base64ToArrayBuffer|arrayBufferToBase64/, oe = /^create|Manager$/, se = /^on/, ae = !1, ce = 0, ue = 0, le = { promiseInterceptor: { returnValue: function (e) { return p(e) ? e.then(function (e) { return e[1] }).catch(function (e) { return e[0] }) : e } } }, me = Object.freeze({ upx2px: function (e, t) { var n, r, i, o; if (0 === ce && (n = wx.getSystemInfoSync(), r = n.platform, i = n.pixelRatio, o = n.windowWidth, ce = o, ue = i, ae = "ios" === r), 0 === (e = Number(e))) return 0; var s = e / 750 * (t || ce); return s < 0 && (s = -s), 0 === (s = Math.floor(s + 1e-4)) ? 1 !== ue && ae ? .5 : 1 : e < 0 ? -s : s }, interceptors: le, addInterceptor: function (e, t) { "string" == typeof e && s(t) ? l(re[e] || (re[e] = {}), t) : s(e) && l(ne, e) }, removeInterceptor: function (e, t) { "string" == typeof e ? s(t) ? m(re[e], t) : delete re[e] : s(e) && m(ne, e) } }), de = { previewImage: { args: function (e) { var t = parseInt(e.current); if (!isNaN(t)) { var n = e.urls; if (Array.isArray(n)) { var r = n.length; if (r) return t < 0 ? t = 0 : t >= r && (t = r - 1), t > 0 ? (e.current = n[t], e.urls = n.filter(function (e, r) { return !(r < t) || e !== n[t] })) : e.current = n[0], { indicator: !1, loop: !1 } } } } } }, pe = ["success", "fail", "cancel", "complete"], fe = Object.create(null);["subscribePush", "unsubscribePush", "onPush", "offPush", "share"].forEach(function (e) { fe[e] = function (e) { return function (t) { var n = t.fail, r = t.complete, i = { errMsg: "".concat(e, ":fail:暂不支持 ").concat(e, " 方法") }; o(n) && n(i), o(r) && r(i) } }(e) }); var ge, he = { oauth: ["weixin"], share: ["weixin"], payment: ["wxpay"], push: ["weixin"] }, ye = Object.freeze({ getProvider: function (e) { var t = e.service, n = e.success, r = e.fail, i = e.complete, s = !1; he[t] ? (s = { errMsg: "getProvider:ok", service: t, provider: he[t] }, o(n) && n(s)) : (s = { errMsg: "getProvider:fail:服务[" + t + "]不存在" }, o(r) && r(s)), o(i) && i(s) } }), ve = "function" == typeof getUniEmitter ? getUniEmitter : function () { return ge || (ge = new K.default), ge }, be = Object.freeze({ $on: function () { return P(ve(), "$on", Array.prototype.slice.call(arguments)) }, $off: function () { return P(ve(), "$off", Array.prototype.slice.call(arguments)) }, $once: function () { return P(ve(), "$once", Array.prototype.slice.call(arguments)) }, $emit: function () { return P(ve(), "$emit", Array.prototype.slice.call(arguments)) } }), Te = Object.freeze({}), Me = Page, Se = Component, ke = /:/g, _e = u(function (e) { return ee(e.replace(ke, "-")) }); Page = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return I("onLoad", e), Me(e) }, Component = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return I("created", e), Se(e) }; var we = [String, Number, Boolean, Object, Array, null], Pe = "~", Ce = "^", Ie = ["onShow", "onHide", "onError", "onPageNotFound"], Oe = ["__route__", "__wxExparserNodeId__", "__wxWebviewId__"], Ae = ["onShow", "onHide", "onUnload"]; Ae.push.apply(Ae, ["onPullDownRefresh", "onReachBottom", "onShareAppMessage", "onPageScroll", "onResize", "onTabItemTap"]), [].forEach(function (e) { de[e] = !1 }), [].forEach(function (e) { var t = de[e] && de[e].name ? de[e].name : e; wx.canIUse(t) || (de[e] = !1) }); var xe = {}; "undefined" != typeof Proxy ? xe = new Proxy({}, { get: function (e, t) { return me[t] ? me[t] : Te[t] ? M(t, Te[t]) : ye[t] ? M(t, ye[t]) : fe[t] ? M(t, fe[t]) : be[t] ? be[t] : a(wx, t) || a(de, t) ? M(t, w(t, wx[t])) : void 0 } }) : (Object.keys(me).forEach(function (e) { xe[e] = me[e] }), Object.keys(fe).forEach(function (e) { xe[e] = M(e, fe[e]) }), Object.keys(ye).forEach(function (e) { xe[e] = M(e, fe[e]) }), Object.keys(be).forEach(function (e) { xe[e] = be[e] }), Object.keys(Te).forEach(function (e) { xe[e] = M(e, Te[e]) }), Object.keys(wx).forEach(function (e) { (a(wx, e) || a(de, e)) && (xe[e] = M(e, w(e, wx[e]))) })), wx.createApp = H, wx.createPage = J, wx.createComponent = X; var Ee = xe; t.default = Ee }, function (e, t, n) { n.r(t), function (e) { function n(e) { return null == e } function r(e) { return null != e } function i(e) { return !0 === e } function o(e) { return "string" == typeof e || "number" == typeof e || "symbol" == (void 0 === e ? "undefined" : _typeof(e)) || "boolean" == typeof e } function s(e) { return null !== e && "object" == (void 0 === e ? "undefined" : _typeof(e)) } function a(e) { return pt.call(e).slice(8, -1) } function c(e) { return "[object Object]" === pt.call(e) } function u(e) { var t = parseFloat(String(e)); return t >= 0 && Math.floor(t) === t && isFinite(e) } function l(e) { return r(e) && "function" == typeof e.then && "function" == typeof e.catch } function m(e) { return null == e ? "" : Array.isArray(e) || c(e) && e.toString === pt ? JSON.stringify(e, null, 2) : String(e) } function d(e) { var t = parseFloat(e); return isNaN(t) ? e : t } function p(e, t) { for (var n = Object.create(null), r = e.split(","), i = 0; i < r.length; i++)n[r[i]] = !0; return t ? function (e) { return n[e.toLowerCase()] } : function (e) { return n[e] } } function f(e, t) { if (e.length) { var n = e.indexOf(t); if (n > -1) return e.splice(n, 1) } } function g(e, t) { return ht.call(e, t) } function h(e) { var t = Object.create(null); return function (n) { return t[n] || (t[n] = e(n)) } } function y(e, t) { t = t || 0; for (var n = e.length - t, r = new Array(n); n--;)r[n] = e[n + t]; return r } function v(e, t) { for (var n in t) e[n] = t[n]; return e } function b(e) { for (var t = {}, n = 0; n < e.length; n++)e[n] && v(t, e[n]); return t } function T(e, t, n) { } function M(e, t) { if (e === t) return !0; var n = s(e), r = s(t); if (!n || !r) return !n && !r && String(e) === String(t); try { var i = Array.isArray(e), o = Array.isArray(t); if (i && o) return e.length === t.length && e.every(function (e, n) { return M(e, t[n]) }); if (e instanceof Date && t instanceof Date) return e.getTime() === t.getTime(); if (i || o) return !1; var a = Object.keys(e), c = Object.keys(t); return a.length === c.length && a.every(function (n) { return M(e[n], t[n]) }) } catch (e) { return !1 } } function S(e, t) { for (var n = 0; n < e.length; n++)if (M(e[n], t)) return n; return -1 } function k(e) { var t = !1; return function () { t || (t = !0, e.apply(this, arguments)) } } function _(e) { var t = (e + "").charCodeAt(0); return 36 === t || 95 === t } function w(e, t, n, r) { Object.defineProperty(e, t, { value: n, enumerable: !!r, writable: !0, configurable: !0 }) } function P(e) { return "function" == typeof e && /native code/.test(e.toString()) } function C(e) { Qt.push(e), Kt.target = e } function I() { Qt.pop(), Kt.target = Qt[Qt.length - 1] } function O(e) { return new Yt(void 0, void 0, void 0, String(e)) } function A(e) { on = e } function x(e, t) { var n; if (s(e) && !(e instanceof Yt)) return g(e, "__ob__") && e.__ob__ instanceof sn ? n = e.__ob__ : on && !Lt() && (Array.isArray(e) || c(e)) && Object.isExtensible(e) && !e._isVue && (n = new sn(e)), t && n && n.vmCount++ , n } function E(e, t, n, r, i) { var o = new Kt, s = Object.getOwnPropertyDescriptor(e, t); if (!s || !1 !== s.configurable) { var a = s && s.get, c = s && s.set; a && !c || 2 !== arguments.length || (n = e[t]); var u = !i && x(n); Object.defineProperty(e, t, { enumerable: !0, configurable: !0, get: function () { var t = a ? a.call(e) : n; return Kt.target && (o.depend(), u && (u.dep.depend(), Array.isArray(t) && function e(t) { for (var n = void 0, r = 0, i = t.length; r < i; r++)(n = t[r]) && n.__ob__ && n.__ob__.dep.depend(), Array.isArray(n) && e(n) }(t))), t }, set: function (t) { var s = a ? a.call(e) : n; t === s || t != t && s != s || (r && r(), a && !c || (c ? c.call(e, t) : n = t, u = !i && x(t), o.notify())) } }) } } function j(e, t, r) { if ((n(e) || o(e)) && Ht("Cannot set reactive property on undefined, null, or primitive value: " + e), Array.isArray(e) && u(t)) return e.length = Math.max(e.length, t), e.splice(t, 1, r), r; if (t in e && !(t in Object.prototype)) return e[t] = r, r; var i = e.__ob__; return e._isVue || i && i.vmCount ? (Ht("Avoid adding reactive properties to a Vue instance or its root $data at runtime - declare it upfront in the data option."), r) : i ? (E(i.value, t, r), i.dep.notify(), r) : (e[t] = r, r) } function U(e, t) { if ((n(e) || o(e)) && Ht("Cannot delete reactive property on undefined, null, or primitive value: " + e), Array.isArray(e) && u(t)) e.splice(t, 1); else { var r = e.__ob__; e._isVue || r && r.vmCount ? Ht("Avoid deleting properties on a Vue instance or its root $data - just set it to null.") : g(e, t) && (delete e[t], r && r.dep.notify()) } } function R(e, t) { if (!t) return e; for (var n, r, i, o = qt ? Reflect.ownKeys(t) : Object.keys(t), s = 0; s < o.length; s++)"__ob__" !== (n = o[s]) && (r = e[n], i = t[n], g(e, n) ? r !== i && c(r) && c(i) && R(r, i) : j(e, n, i)); return e } function F(e, t, n) { return n ? function () { var r = "function" == typeof t ? t.call(n, n) : t, i = "function" == typeof e ? e.call(n, n) : e; return r ? R(r, i) : i } : t ? e ? function () { return R("function" == typeof t ? t.call(this, this) : t, "function" == typeof e ? e.call(this, this) : e) } : t : e } function N(e, t) { var n = t ? e ? e.concat(t) : Array.isArray(t) ? t : [t] : e; return n ? function (e) { for (var t = [], n = 0; n < e.length; n++)-1 === t.indexOf(e[n]) && t.push(e[n]); return t }(n) : n } function D(e, t, n, r) { var i = Object.create(e || null); return t ? (L(r, t, n), v(i, t)) : i } function B(e) { new RegExp("^[a-zA-Z][\\-\\.0-9_" + It.source + "]*$").test(e) || Ht('Invalid component name: "' + e + '". Component names should conform to valid custom element name in html5 specification.'), (ft(e) || Ct.isReservedTag(e)) && Ht("Do not use built-in or reserved HTML elements as component id: " + e) } function L(e, t, n) { c(t) || Ht('Invalid value for option "' + e + '": expected an Object, but got ' + a(t) + ".", n) } function $(e, t, n) { function r(r) { var i = an[r] || ln; u[r] = i(e[r], t[r], n, r) } if (function (e) { for (var t in e.components) B(t) }(t), "function" == typeof t && (t = t.options), function (e, t) { var n = e.props; if (n) { var r, i, o = {}; if (Array.isArray(n)) for (r = n.length; r--;)"string" == typeof (i = n[r]) ? o[vt(i)] = { type: null } : Ht("props must be strings when using array syntax."); else if (c(n)) for (var s in n) i = n[s], o[vt(s)] = c(i) ? i : { type: i }; else Ht('Invalid value for option "props": expected an Array or an Object, but got ' + a(n) + ".", t); e.props = o } }(t, n), function (e, t) { var n = e.inject; if (n) { var r = e.inject = {}; if (Array.isArray(n)) for (var i = 0; i < n.length; i++)r[n[i]] = { from: n[i] }; else if (c(n)) for (var o in n) { var s = n[o]; r[o] = c(s) ? v({ from: o }, s) : { from: s } } else Ht('Invalid value for option "inject": expected an Array or an Object, but got ' + a(n) + ".", t) } }(t, n), function (e) { var t = e.directives; if (t) for (var n in t) { var r = t[n]; "function" == typeof r && (t[n] = { bind: r, update: r }) } }(t), !t._base && (t.extends && (e = $(e, t.extends, n)), t.mixins)) for (var i = 0, o = t.mixins.length; i < o; i++)e = $(e, t.mixins[i], n); var s, u = {}; for (s in e) r(s); for (s in t) g(e, s) || r(s); return u } function q(e, t, n, r) { if ("string" == typeof n) { var i = e[t]; if (g(i, n)) return i[n]; var o = vt(n); if (g(i, o)) return i[o]; var s = bt(o); if (g(i, s)) return i[s]; var a = i[n] || i[o] || i[s]; return r && !a && Ht("Failed to resolve " + t.slice(0, -1) + ": " + n, e), a } } function H(e, t, n, r) { var i = t[e], o = !g(n, e), c = n[e], u = J(Boolean, i.type); if (u > -1) if (o && !g(i, "default")) c = !1; else if ("" === c || c === Mt(e)) { var l = J(String, i.type); (l < 0 || u < l) && (c = !0) } if (void 0 === c) { c = function (e, t, n) { if (g(t, "default")) { var r = t.default; return s(r) && Ht('Invalid default value for prop "' + n + '": Props with type Object/Array must use a factory function to return the default value.', e), e && e.$options.propsData && void 0 === e.$options.propsData[n] && void 0 !== e._props[n] ? e._props[n] : "function" == typeof r && "Function" !== V(t.type) ? r.call(e) : r } }(r, i, e); var m = on; A(!0), x(c), A(m) } return function (e, t, n, r, i) { if (e.required && i) return void Ht('Missing required prop: "' + t + '"', r); if (null != n || e.required) { var o = e.type, s = !o || !0 === o, c = []; if (o) { Array.isArray(o) || (o = [o]); for (var u = 0; u < o.length && !s; u++) { var l = z(n, o[u]); c.push(l.expectedType || ""), s = l.valid } } if (!s) return void Ht(function (e, t, n) { var r = 'Invalid prop: type check failed for prop "' + e + '". Expected ' + n.map(bt).join(", "), i = n[0], o = a(t), s = X(t, i), c = X(t, o); return 1 === n.length && G(i) && !function () { for (var e = [], t = arguments.length; t--;)e[t] = arguments[t]; return e.some(function (e) { return "boolean" === e.toLowerCase() }) }(i, o) && (r += " with value " + s), r += ", got " + o + " ", G(o) && (r += "with value " + c + "."), r }(t, n, c), r); var m = e.validator; m && (m(n) || Ht('Invalid prop: custom validator check failed for prop "' + t + '".', r)) } }(i, e, c, r, o), c } function z(e, t) { var n, r = V(t); if (mn.test(r)) { var i = void 0 === e ? "undefined" : _typeof(e); (n = i === r.toLowerCase()) || "object" !== i || (n = e instanceof t) } else n = "Object" === r ? c(e) : "Array" === r ? Array.isArray(e) : e instanceof t; return { valid: n, expectedType: r } } function V(e) { var t = e && e.toString().match(/^\s*function (\w+)/); return t ? t[1] : "" } function W(e, t) { return V(e) === V(t) } function J(e, t) { if (!Array.isArray(t)) return W(t, e) ? 0 : -1; for (var n = 0, r = t.length; n < r; n++)if (W(t[n], e)) return n; return -1 } function X(e, t) { return "String" === t ? '"' + e + '"' : "Number" === t ? "" + Number(e) : "" + e } function G(e) { return ["string", "number", "boolean"].some(function (t) { return e.toLowerCase() === t }) } function K(e, t, n) { C(); try { if (t) for (var r = t; r = r.$parent;) { var i = r.$options.errorCaptured; if (i) for (var o = 0; o < i.length; o++)try { if (!1 === i[o].call(r, e, t, n)) return } catch (e) { Y(e, r, "errorCaptured hook") } } Y(e, t, n) } finally { I() } } function Q(e, t, n, r, i) { var o; try { (o = n ? e.apply(t, n) : e.call(t)) && !o._isVue && l(o) && !o._handled && (o.catch(function (e) { return K(e, r, i + " (Promise/async)") }), o._handled = !0) } catch (e) { K(e, r, i) } return o } function Y(e, t, n) { if (Ct.errorHandler) try { return Ct.errorHandler.call(null, e, t, n) } catch (t) { t !== e && Z(t, null, "config.errorHandler") } Z(e, t, n) } function Z(e, t, n) { if (Ht("Error in " + n + ': "' + e.toString() + '"', t), !xt && !Et || "undefined" == typeof console) throw e; console.error(e) } function ee() { pn = !1; var e = dn.slice(0); dn.length = 0; for (var t = 0; t < e.length; t++)e[t]() } function te(e, t) { var n; if (dn.push(function () { if (e) try { e.call(t) } catch (e) { K(e, t, "nextTick") } else n && n(t) }), pn || (pn = !0, cn()), !e && "undefined" != typeof Promise) return new Promise(function (e) { n = e }) } function ne(e) { !function e(t, n) { var r, i, o = Array.isArray(t); if (!(!o && !s(t) || Object.isFrozen(t) || t instanceof Yt)) { if (t.__ob__) { var a = t.__ob__.dep.id; if (n.has(a)) return; n.add(a) } if (o) for (r = t.length; r--;)e(t[r], n); else for (i = Object.keys(t), r = i.length; r--;)e(t[i[r]], n) } }(e, Cn), Cn.clear() } function re(e, t) { function n() { var e = arguments, r = n.fns; if (!Array.isArray(r)) return Q(r, null, arguments, t, "v-on handler"); for (var i = r.slice(), o = 0; o < i.length; o++)Q(i[o], null, e, t, "v-on handler") } return n.fns = e, n } function ie(e, t, n, i, o) { if (r(t)) { if (g(t, n)) return e[n] = t[n], o || delete t[n], !0; if (g(t, i)) return e[n] = t[i], o || delete t[i], !0 } return !1 } function oe(e) { return o(e) ? [O(e)] : Array.isArray(e) ? function e(t, s) { var a, c, u, l, m = []; for (a = 0; a < t.length; a++)n(c = t[a]) || "boolean" == typeof c || (u = m.length - 1, l = m[u], Array.isArray(c) ? c.length > 0 && (se((c = e(c, (s || "") + "_" + a))[0]) && se(l) && (m[u] = O(l.text + c[0].text), c.shift()), m.push.apply(m, c)) : o(c) ? se(l) ? m[u] = O(l.text + c) : "" !== c && m.push(O(c)) : se(c) && se(l) ? m[u] = O(l.text + c.text) : (i(t._isVList) && r(c.tag) && n(c.key) && r(s) && (c.key = "__vlist" + s + "_" + a + "__"), m.push(c))); return m }(e) : void 0 } function se(e) { return r(e) && r(e.text) && !1 === e.isComment } function ae(e) { var t = e.$options.provide; t && (e._provided = "function" == typeof t ? t.call(e) : t) } function ce(e) { var t = ue(e.$options.inject, e); t && (A(!1), Object.keys(t).forEach(function (n) { E(e, n, t[n], function () { Ht('Avoid mutating an injected value directly since the changes will be overwritten whenever the provided component re-renders. injection being mutated: "' + n + '"', e) }) }), A(!0)) } function ue(e, t) { if (e) { for (var n = Object.create(null), r = qt ? Reflect.ownKeys(e) : Object.keys(e), i = 0; i < r.length; i++) { var o = r[i]; if ("__ob__" !== o) { for (var s = e[o].from, a = t; a;) { if (a._provided && g(a._provided, s)) { n[o] = a._provided[s]; break } a = a.$parent } if (!a) if ("default" in e[o]) { var c = e[o].default; n[o] = "function" == typeof c ? c.call(t) : c } else Ht('Injection "' + o + '" not found', t) } } return n } } function le(e, t) { if (!e || !e.length) return {}; for (var n = {}, r = 0, i = e.length; r < i; r++) { var o = e[r], s = o.data; if (s && s.attrs && s.attrs.slot && delete s.attrs.slot, o.context !== t && o.fnContext !== t || !s || null == s.slot) (n.default || (n.default = [])).push(o); else { var a = s.slot, c = n[a] || (n[a] = []); "template" === o.tag ? c.push.apply(c, o.children || []) : c.push(o) } } for (var u in n) n[u].every(me) && delete n[u]; return n } function me(e) { return e.isComment && !e.asyncFactory || " " === e.text } function de(e, t, n) { var r, i = Object.keys(t).length > 0, o = e ? !!e.$stable : !i, s = e && e.$key; if (e) { if (e._normalized) return e._normalized; if (o && n && n !== dt && s === n.$key && !i && !n.$hasNormal) return n; for (var a in r = {}, e) e[a] && "$" !== a[0] && (r[a] = pe(t, a, e[a])) } else r = {}; for (var c in t) c in r || (r[c] = fe(t, c)); return e && Object.isExtensible(e) && (e._normalized = r), w(r, "$stable", o), w(r, "$key", s), w(r, "$hasNormal", i), r } function pe(e, t, n) { var r = function () { var e = arguments.length ? n.apply(null, arguments) : n({}); return (e = e && "object" == (void 0 === e ? "undefined" : _typeof(e)) && !Array.isArray(e) ? [e] : oe(e)) && (0 === e.length || 1 === e.length && e[0].isComment) ? void 0 : e }; return n.proxy && Object.defineProperty(e, t, { get: r, enumerable: !0, configurable: !0 }), r } function fe(e, t) { return function () { return e[t] } } function ge(e, t) { var n, i, o, a, c; if (Array.isArray(e) || "string" == typeof e) for (n = new Array(e.length), i = 0, o = e.length; i < o; i++)n[i] = t(e[i], i); else if ("number" == typeof e) for (n = new Array(e), i = 0; i < e; i++)n[i] = t(i + 1, i); else if (s(e)) if (qt && e[Symbol.iterator]) { n = []; for (var u = e[Symbol.iterator](), l = u.next(); !l.done;)n.push(t(l.value, n.length)), l = u.next() } else for (a = Object.keys(e), n = new Array(a.length), i = 0, o = a.length; i < o; i++)c = a[i], n[i] = t(e[c], c, i); return r(n) || (n = []), n._isVList = !0, n } function he(e, t, n, r) { var i, o = this.$scopedSlots[e]; o ? (n = n || {}, r && (s(r) || Ht("slot v-bind without argument expects an Object", this), n = v(v({}, r), n)), i = o(n) || t) : i = this.$slots[e] || t; var a = n && n.slot; return a ? this.$createElement("template", { slot: a }, i) : i } function ye(e) { return q(this.$options, "filters", e, !0) || _t } function ve(e, t) { return Array.isArray(e) ? -1 === e.indexOf(t) : e !== t } function be(e, t, n, r, i) { var o = Ct.keyCodes[t] || n; return i && r && !Ct.keyCodes[t] ? ve(i, r) : o ? ve(o, e) : r ? Mt(r) !== t : void 0 } function Te(e, t, n, r, i) { if (n) if (s(n)) { var o; Array.isArray(n) && (n = b(n)); for (var a in n) !function (s) { if ("class" === s || "style" === s || gt(s)) o = e; else { var a = e.attrs && e.attrs.type; o = r || Ct.mustUseProp(t, a, s) ? e.domProps || (e.domProps = {}) : e.attrs || (e.attrs = {}) } var c = vt(s), u = Mt(s); c in o || u in o || (o[s] = n[s], i && ((e.on || (e.on = {}))["update:" + s] = function (e) { n[s] = e })) }(a) } else Ht("v-bind without argument expects an Object or Array value", this); return e } function Me(e, t) { var n = this._staticTrees || (this._staticTrees = []), r = n[e]; return r && !t ? r : (ke(r = n[e] = this.$options.staticRenderFns[e].call(this._renderProxy, null, this), "__static__" + e, !1), r) } function Se(e, t, n) { return ke(e, "__once__" + t + (n ? "_" + n : ""), !0), e } function ke(e, t, n) { if (Array.isArray(e)) for (var r = 0; r < e.length; r++)e[r] && "string" != typeof e[r] && _e(e[r], t + "_" + r, n); else _e(e, t, n) } function _e(e, t, n) { e.isStatic = !0, e.key = t, e.isOnce = n } function we(e, t) { if (t) if (c(t)) { var n = e.on = e.on ? v({}, e.on) : {}; for (var r in t) { var i = n[r], o = t[r]; n[r] = i ? [].concat(i, o) : o } } else Ht("v-on without argument expects an Object value", this); return e } function Pe(e, t, n, r) { t = t || { $stable: !n }; for (var i = 0; i < e.length; i++) { var o = e[i]; Array.isArray(o) ? Pe(o, t, n) : o && (o.proxy && (o.fn.proxy = !0), t[o.key] = o.fn) } return r && (t.$key = r), t } function Ce(e, t) { for (var n = 0; n < t.length; n += 2) { var r = t[n]; "string" == typeof r && r ? e[t[n]] = t[n + 1] : "" !== r && null !== r && Ht("Invalid value for dynamic directive argument (expected string or null): " + r, this) } return e } function Ie(e, t) { return "string" == typeof e ? t + e : e } function Oe(e) { e._o = Se, e._n = d, e._s = m, e._l = ge, e._t = he, e._q = M, e._i = S, e._m = Me, e._f = ye, e._k = be, e._b = Te, e._v = O, e._e = en, e._u = Pe, e._g = we, e._d = Ce, e._p = Ie } function Ae(e, t, n, r, o) { var s, a = this, c = o.options; g(r, "_uid") ? (s = Object.create(r))._original = r : (s = r, r = r._original); var u = i(c._compiled), l = !u; this.data = e, this.props = t, this.children = n, this.parent = r, this.listeners = e.on || dt, this.injections = ue(c.inject, r), this.slots = function () { return a.$slots || de(e.scopedSlots, a.$slots = le(n, r)), a.$slots }, Object.defineProperty(this, "scopedSlots", { enumerable: !0, get: function () { return de(e.scopedSlots, this.slots()) } }), u && (this.$options = c, this.$slots = this.slots(), this.$scopedSlots = de(e.scopedSlots, this.$slots)), c._scopeId ? this._c = function (e, t, n, i) { var o = Re(s, e, t, n, i, l); return o && !Array.isArray(o) && (o.fnScopeId = c._scopeId, o.fnContext = r), o } : this._c = function (e, t, n, r) { return Re(s, e, t, n, r, l) } } function xe(e, t, n, r, i) { var o = function (e) { var t = new Yt(e.tag, e.data, e.children && e.children.slice(), e.text, e.elm, e.context, e.componentOptions, e.asyncFactory); return t.ns = e.ns, t.isStatic = e.isStatic, t.key = e.key, t.isComment = e.isComment, t.fnContext = e.fnContext, t.fnOptions = e.fnOptions, t.fnScopeId = e.fnScopeId, t.asyncMeta = e.asyncMeta, t.isCloned = !0, t }(e); return o.fnContext = n, o.fnOptions = r, (o.devtoolsMeta = o.devtoolsMeta || {}).renderContext = i, t.slot && ((o.data || (o.data = {})).slot = t.slot), o } function Ee(e, t) { for (var n in t) e[vt(n)] = t[n] } function je(e, t, o, a, c) { if (!n(e)) { var u = o.$options._base; if (s(e) && (e = u.extend(e)), "function" == typeof e) { var m; if (n(e.cid) && void 0 === (e = function (e, t) { if (i(e.error) && r(e.errorComp)) return e.errorComp; if (r(e.resolved)) return e.resolved; var o = Rn; if (o && r(e.owners) && -1 === e.owners.indexOf(o) && e.owners.push(o), i(e.loading) && r(e.loadingComp)) return e.loadingComp; if (o && !r(e.owners)) { var a = e.owners = [o], c = !0, u = null, m = null; o.$on("hook:destroyed", function () { return f(a, o) }); var d = function (e) { for (var t = 0, n = a.length; t < n; t++)a[t].$forceUpdate(); e && (a.length = 0, null !== u && (clearTimeout(u), u = null), null !== m && (clearTimeout(m), m = null)) }, p = k(function (n) { e.resolved = Fe(n, t), c ? a.length = 0 : d(!0) }), g = k(function (t) { Ht("Failed to resolve async component: " + String(e) + (t ? "\nReason: " + t : "")), r(e.errorComp) && (e.error = !0, d(!0)) }), h = e(p, g); return s(h) && (l(h) ? n(e.resolved) && h.then(p, g) : l(h.component) && (h.component.then(p, g), r(h.error) && (e.errorComp = Fe(h.error, t)), r(h.loading) && (e.loadingComp = Fe(h.loading, t), 0 === h.delay ? e.loading = !0 : u = setTimeout(function () { u = null, n(e.resolved) && n(e.error) && (e.loading = !0, d(!1)) }, h.delay || 200)), r(h.timeout) && (m = setTimeout(function () { m = null, n(e.resolved) && g("timeout (" + h.timeout + "ms)") }, h.timeout)))), c = !1, e.loading ? e.loadingComp : e.resolved } }(m = e, u))) return function (e, t, n, r, i) { var o = en(); return o.asyncFactory = e, o.asyncMeta = { data: t, context: n, children: r, tag: i }, o }(m, t, o, a, c); t = t || {}, Qe(e), r(t.model) && function (e, t) { var n = e.model && e.model.prop || "value", i = e.model && e.model.event || "input"; (t.attrs || (t.attrs = {}))[n] = t.model.value; var o = t.on || (t.on = {}), s = o[i], a = t.model.callback; r(s) ? (Array.isArray(s) ? -1 === s.indexOf(a) : s !== a) && (o[i] = [a].concat(s)) : o[i] = a }(e.options, t); var d = function (e, t, i) { var o = t.options.props; if (!n(o)) { var s = {}, a = e.attrs, c = e.props; if (r(a) || r(c)) for (var u in o) { var l = Mt(u), m = u.toLowerCase(); u !== m && a && g(a, m) && zt('Prop "' + m + '" is passed to component ' + Wt(i || t) + ', but the declared prop name is "' + u + '". Note that HTML attributes are case-insensitive and camelCased props need to use their kebab-case equivalents when using in-DOM templates. You should probably use "' + l + '" instead of "' + u + '".'), ie(s, c, u, l, !0) || ie(s, a, u, l, !1) } return s } }(t, e, c); if (i(e.options.functional)) return function (e, t, n, i, o) { var s = e.options, a = {}, c = s.props; if (r(c)) for (var u in c) a[u] = H(u, c, t || dt); else r(n.attrs) && Ee(a, n.attrs), r(n.props) && Ee(a, n.props); var l = new Ae(n, a, o, i, e), m = s.render.call(null, l._c, l); if (m instanceof Yt) return xe(m, n, l.parent, s, l); if (Array.isArray(m)) { for (var d = oe(m) || [], p = new Array(d.length), f = 0; f < d.length; f++)p[f] = xe(d[f], n, l.parent, s, l); return p } }(e, d, t, o, a); var p = t.on; if (t.on = t.nativeOn, i(e.options.abstract)) { var h = t.slot; t = {}, h && (t.slot = h) } !function (e) { for (var t = e.hook || (e.hook = {}), n = 0; n < En.length; n++) { var r = En[n], i = t[r], o = xn[r]; i === o || i && i._merged || (t[r] = i ? Ue(o, i) : o) } }(t); var y = e.options.name || c; return new Yt("vue-component-" + e.cid + (y ? "-" + y : ""), t, void 0, void 0, void 0, o, { Ctor: e, propsData: d, listeners: p, tag: c, children: a }, m) } Ht("Invalid Component definition: " + String(e), o) } } function Ue(e, t) { var n = function (n, r) { e(n, r), t(n, r) }; return n._merged = !0, n } function Re(e, t, a, c, u, l) { return (Array.isArray(a) || o(a)) && (u = c, c = a, a = void 0), i(l) && (u = Un), function (e, t, a, c, u) { if (r(a) && r(a.__ob__)) return Ht("Avoid using observed data object as vnode data: " + JSON.stringify(a) + "\nAlways create fresh vnode data objects in each render!", e), en(); if (r(a) && r(a.is) && (t = a.is), !t) return en(); r(a) && r(a.key) && !o(a.key) && Ht("Avoid using non-primitive value as key, use string/number value instead.", e), Array.isArray(c) && "function" == typeof c[0] && ((a = a || {}).scopedSlots = { default: c[0] }, c.length = 0), u === Un ? c = oe(c) : u === jn && (c = function (e) { for (var t = 0; t < e.length; t++)if (Array.isArray(e[t])) return Array.prototype.concat.apply([], e); return e }(c)); var l, m; if ("string" == typeof t) { var d; m = e.$vnode && e.$vnode.ns || Ct.getTagNamespace(t), l = Ct.isReservedTag(t) ? new Yt(Ct.parsePlatformTagName(t), a, c, void 0, void 0, e) : a && a.pre || !r(d = q(e.$options, "components", t)) ? new Yt(t, a, c, void 0, void 0, e) : je(d, a, e, c, t) } else l = je(t, a, e, c); return Array.isArray(l) ? l : r(l) ? (r(m) && function e(t, o, s) { if (t.ns = o, "foreignObject" === t.tag && (o = void 0, s = !0), r(t.children)) for (var a = 0, c = t.children.length; a < c; a++) { var u = t.children[a]; r(u.tag) && (n(u.ns) || i(s) && "svg" !== u.tag) && e(u, o, s) } }(l, m), r(a) && function (e) { s(e.style) && ne(e.style), s(e.class) && ne(e.class) }(a), l) : en() }(e, t, a, c, u) } function Fe(e, t) { return (e.__esModule || qt && "Module" === e[Symbol.toStringTag]) && (e = e.default), s(e) ? t.extend(e) : e } function Ne(e, t) { An.$on(e, t) } function De(e, t) { An.$off(e, t) } function Be(e, t) { var n = An; return function r() { null !== t.apply(null, arguments) && n.$off(e, r) } } function Le(e, t, r) { An = e, function (e, t, r, o, s, a) { var c, u, l, m; for (c in e) u = e[c], l = t[c], m = On(c), n(u) ? Ht('Invalid handler for event "' + m.name + '": got ' + String(u), a) : n(l) ? (n(u.fns) && (u = e[c] = re(u, a)), i(m.once) && (u = e[c] = s(m.name, u, m.capture)), r(m.name, u, m.capture, m.passive, m.params)) : u !== l && (l.fns = u, e[c] = l); for (c in t) n(e[c]) && o((m = On(c)).name, t[c], m.capture) }(t, r || {}, Ne, De, Be, e), An = void 0 } function $e(e) { for (; e && (e = e.$parent);)if (e._inactive) return !0; return !1 } function qe(e, t) { if (t) { if (e._directInactive = !1, $e(e)) return } else if (e._directInactive) return; if (e._inactive || null === e._inactive) { e._inactive = !1; for (var n = 0; n < e.$children.length; n++)qe(e.$children[n]); He(e, "activated") } } function He(e, t) { C(); var n = e.$options[t], r = t + " hook"; if (n) for (var i = 0, o = n.length; i < o; i++)Q(n[i], e, null, e, r); e._hasHookEvent && e.$emit("hook:" + t), I() } function ze() { var e, t; for (Wn(), zn = !0, Bn.sort(function (e, t) { return e.id - t.id }), Vn = 0; Vn < Bn.length; Vn++)if ((e = Bn[Vn]).before && e.before(), t = e.id, $n[t] = null, e.run(), null != $n[t] && (qn[t] = (qn[t] || 0) + 1, qn[t] > Dn)) { Ht("You may have an infinite update loop " + (e.user ? 'in watcher with expression "' + e.expression + '"' : "in a component render function."), e.vm); break } var n = Ln.slice(), r = Bn.slice(); Vn = Bn.length = Ln.length = 0, $n = {}, qn = {}, Hn = zn = !1, function (e) { for (var t = 0; t < e.length; t++)e[t]._inactive = !0, qe(e[t], !0) }(n), function (e) { for (var t = e.length; t--;) { var n = e[t], r = n.vm; r._watcher === n && r._isMounted && !r._isDestroyed && He(r, "updated") } }(r), $t && Ct.devtools && $t.emit("flush") } function Ve(e, t, n) { Kn.get = function () { return this[t][n] }, Kn.set = function (e) { this[t][n] = e }, Object.defineProperty(e, n, Kn) } function We(e) { e._watchers = []; var t = e.$options; t.props && function (e, t) { var n = e.$options.propsData || {}, r = e._props = {}, i = e.$options._propKeys = [], o = !e.$parent; o || A(!1); for (var s in t) !function (s) { i.push(s); var a = H(s, t, n, e), c = Mt(s); (gt(c) || Ct.isReservedAttr(c)) && Ht('"' + c + '" is a reserved attribute and cannot be used as component prop.', e), E(r, s, a, function () { if (!o && !Nn) { if ("mp-baidu" === e.mpHost) return; if ("value" === s && Array.isArray(e.$options.behaviors) && -1 !== e.$options.behaviors.indexOf("uni://form-field")) return; if (e._getFormData) return; for (var t = e.$parent; t;) { if (t.__next_tick_pending) return; t = t.$parent } Ht("Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the prop's value. Prop being mutated: \"" + s + '"', e) } }), s in e || Ve(e, "_props", s) }(s); A(!0) }(e, t.props), t.methods && function (e, t) { var n = e.$options.props; for (var r in t) "function" != typeof t[r] && Ht('Method "' + r + '" has type "' + _typeof(t[r]) + '" in the component definition. Did you reference the function correctly?', e), n && g(n, r) && Ht('Method "' + r + '" has already been defined as a prop.', e), r in e && _(r) && Ht('Method "' + r + '" conflicts with an existing Vue instance method. Avoid defining component methods that start with _ or $.'), e[r] = "function" != typeof t[r] ? T : St(t[r], e) }(e, t.methods), t.data ? function (e) { var t = e.$options.data; c(t = e._data = "function" == typeof t ? function (e, t) { C(); try { return e.call(t, t) } catch (e) { return K(e, t, "data()"), {} } finally { I() } }(t, e) : t || {}) || (t = {}, Ht("data functions should return an object:\nhttps://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function", e)); for (var n = Object.keys(t), r = e.$options.props, i = e.$options.methods, o = n.length; o--;) { var s = n[o]; i && g(i, s) && Ht('Method "' + s + '" has already been defined as a data property.', e), r && g(r, s) ? Ht('The data property "' + s + '" is already declared as a prop. Use prop default value instead.', e) : _(s) || Ve(e, "_data", s) } x(t, !0) }(e) : x(e._data = {}, !0), t.computed && function (e, t) { var n = e._computedWatchers = Object.create(null), r = Lt(); for (var i in t) { var o = t[i], s = "function" == typeof o ? o : o.get; null == s && Ht('Getter is missing for computed property "' + i + '".', e), r || (n[i] = new Gn(e, s || T, T, Qn)), i in e ? i in e.$data ? Ht('The computed property "' + i + '" is already defined in data.', e) : e.$options.props && i in e.$options.props && Ht('The computed property "' + i + '" is already defined as a prop.', e) : Je(e, i, o) } }(e, t.computed), t.watch && t.watch !== Nt && function (e, t) { for (var n in t) { var r = t[n]; if (Array.isArray(r)) for (var i = 0; i < r.length; i++)Ke(e, n, r[i]); else Ke(e, n, r) } }(e, t.watch) } function Je(e, t, n) { var r = !Lt(); "function" == typeof n ? (Kn.get = r ? Xe(t) : Ge(n), Kn.set = T) : (Kn.get = n.get ? r && !1 !== n.cache ? Xe(t) : Ge(n.get) : T, Kn.set = n.set || T), Kn.set === T && (Kn.set = function () { Ht('Computed property "' + t + '" was assigned to but it has no setter.', this) }), Object.defineProperty(e, t, Kn) } function Xe(e) { return function () { var t = this._computedWatchers && this._computedWatchers[e]; if (t) return t.dirty && t.evaluate(), Kt.target && t.depend(), t.value } } function Ge(e) { return function () { return e.call(this, this) } } function Ke(e, t, n, r) { return c(n) && (r = n, n = n.handler), "string" == typeof n && (n = e[n]), e.$watch(t, n, r) } function Qe(e) { var t = e.options; if (e.super) { var n = Qe(e.super); if (n !== e.superOptions) { e.superOptions = n; var r = function (e) { var t, n = e.options, r = e.sealedOptions; for (var i in n) n[i] !== r[i] && (t || (t = {}), t[i] = n[i]); return t }(e); r && v(e.extendOptions, r), (t = e.options = $(n, e.extendOptions)).name && (t.components[t.name] = e) } } return t } function Ye(e) { this instanceof Ye || Ht("Vue is a constructor and should be called with the `new` keyword"), this._init(e) } function Ze(e) { e.cid = 0; var t = 1; e.extend = function (e) { e = e || {}; var n = this, r = n.cid, i = e._Ctor || (e._Ctor = {}); if (i[r]) return i[r]; var o = e.name || n.options.name; o && B(o); var s = function (e) { this._init(e) }; return (s.prototype = Object.create(n.prototype)).constructor = s, s.cid = t++ , s.options = $(n.options, e), s.super = n, s.options.props && function (e) { var t = e.options.props; for (var n in t) Ve(e.prototype, "_props", n) }(s), s.options.computed && function (e) { var t = e.options.computed; for (var n in t) Je(e.prototype, n, t[n]) }(s), s.extend = n.extend, s.mixin = n.mixin, s.use = n.use, wt.forEach(function (e) { s[e] = n[e] }), o && (s.options.components[o] = s), s.superOptions = n.options, s.extendOptions = e, s.sealedOptions = v({}, s.options), i[r] = s, s } } function et(e) { return e && (e.Ctor.options.name || e.tag) } function tt(e, t) { return Array.isArray(e) ? e.indexOf(t) > -1 : "string" == typeof e ? e.split(",").indexOf(t) > -1 : (n = e, "[object RegExp]" === pt.call(n) && e.test(t)); var n } function nt(e, t) { var n = e.cache, r = e.keys, i = e._vnode; for (var o in n) { var s = n[o]; if (s) { var a = et(s.componentOptions); a && !t(a) && rt(n, o, r, i) } } } function rt(e, t, n, r) { var i = e[t]; !i || r && i.tag === r.tag || i.componentInstance.$destroy(), e[t] = null, f(n, t) } function it(e, t) { var n = {}; return function e(t, n) { if (t !== n) { var r = st(t), i = st(n); if (r == nr && i == nr) { if (Object.keys(t).length >= Object.keys(n).length) for (var o in n) { var s = t[o]; void 0 === s ? t[o] = null : e(s, n[o]) } } else r == tr && i == tr && t.length >= n.length && n.forEach(function (n, r) { e(t[r], n) }) } }(e, t), function e(t, n, r, i) { if (t !== n) { var o = st(t), s = st(n); if (o == nr) if (s != nr || Object.keys(t).length < Object.keys(n).length) ot(i, r, t); else { for (var a in t) !function (o) { var s = t[o], a = n[o], c = st(s), u = st(a); if (c != tr && c != nr) s != n[o] && ot(i, ("" == r ? "" : r + ".") + o, s); else if (c == tr) u != tr ? ot(i, ("" == r ? "" : r + ".") + o, s) : s.length < a.length ? ot(i, ("" == r ? "" : r + ".") + o, s) : s.forEach(function (t, n) { e(t, a[n], ("" == r ? "" : r + ".") + o + "[" + n + "]", i) }); else if (c == nr) if (u != nr || Object.keys(s).length < Object.keys(a).length) ot(i, ("" == r ? "" : r + ".") + o, s); else for (var l in s) e(s[l], a[l], ("" == r ? "" : r + ".") + o + "." + l, i) }(a) } else o == tr ? s != tr ? ot(i, r, t) : t.length < n.length ? ot(i, r, t) : t.forEach(function (t, o) { e(t, n[o], r + "[" + o + "]", i) }) : ot(i, r, t) } }(e, t, "", n), n } function ot(e, t, n) { e[t] = n } function st(e) { return Object.prototype.toString.call(e) } function at(e) { if (e.__next_tick_callbacks && e.__next_tick_callbacks.length) { if (Object({ NODE_ENV: "development", VUE_APP_PLATFORM: "mp-weixin", BASE_URL: "/" }).VUE_APP_DEBUG) { var t = e.$scope; console.log("[" + +new Date + "][" + (t.is || t.route) + "][" + e._uid + "]:flushCallbacks[" + e.__next_tick_callbacks.length + "]") } var n = e.__next_tick_callbacks.slice(0); e.__next_tick_callbacks.length = 0; for (var r = 0; r < n.length; r++)n[r]() } } function ct(e, t) { if (!e.__next_tick_pending && !function (e) { return Bn.find(function (t) { return e._watcher === t }) }(e)) { if (Object({ NODE_ENV: "development", VUE_APP_PLATFORM: "mp-weixin", BASE_URL: "/" }).VUE_APP_DEBUG) { var n = e.$scope; console.log("[" + +new Date + "][" + (n.is || n.route) + "][" + e._uid + "]:nextVueTick") } return te(t, e) } if (Object({ NODE_ENV: "development", VUE_APP_PLATFORM: "mp-weixin", BASE_URL: "/" }).VUE_APP_DEBUG) { var r = e.$scope; console.log("[" + +new Date + "][" + (r.is || r.route) + "][" + e._uid + "]:nextMPTick") } var i; if (e.__next_tick_callbacks || (e.__next_tick_callbacks = []), e.__next_tick_callbacks.push(function () { if (t) try { t.call(e) } catch (t) { K(t, e, "nextTick") } else i && i(e) }), !t && "undefined" != typeof Promise) return new Promise(function (e) { i = e }) } function ut() { } function lt(e) { return Array.isArray(e) ? function (e) { for (var t, n = "", i = 0, o = e.length; i < o; i++)r(t = lt(e[i])) && "" !== t && (n && (n += " "), n += t); return n }(e) : s(e) ? function (e) { var t = ""; for (var n in e) e[n] && (t && (t += " "), t += n); return t }(e) : "string" == typeof e ? e : "" } var mt, dt = Object.freeze({}), pt = Object.prototype.toString, ft = p("slot,component", !0), gt = p("key,ref,slot,slot-scope,is"), ht = Object.prototype.hasOwnProperty, yt = /-(\w)/g, vt = h(function (e) { return e.replace(yt, function (e, t) { return t ? t.toUpperCase() : "" }) }), bt = h(function (e) { return e.charAt(0).toUpperCase() + e.slice(1) }), Tt = /\B([A-Z])/g, Mt = h(function (e) { return e.replace(Tt, "-$1").toLowerCase() }), St = Function.prototype.bind ? function (e, t) { return e.bind(t) } : function (e, t) { function n(n) { var r = arguments.length; return r ? r > 1 ? e.apply(t, arguments) : e.call(t, n) : e.call(t) } return n._length = e.length, n }, kt = function (e, t, n) { return !1 }, _t = function (e) { return e }, wt = ["component", "directive", "filter"], Pt = ["beforeCreate", "created", "beforeMount", "mounted", "beforeUpdate", "updated", "beforeDestroy", "destroyed", "activated", "deactivated", "errorCaptured", "serverPrefetch"], Ct = { optionMergeStrategies: Object.create(null), silent: !1, productionTip: !0, devtools: !0, performance: !1, errorHandler: null, warnHandler: null, ignoredElements: [], keyCodes: Object.create(null), isReservedTag: kt, isReservedAttr: kt, isUnknownElement: kt, getTagNamespace: T, parsePlatformTagName: _t, mustUseProp: kt, async: !0, _lifecycleHooks: Pt }, It = /a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/, Ot = new RegExp("[^" + It.source + ".$_\\d]"), At = "__proto__" in {}, xt = "undefined" != typeof window, Et = "undefined" != typeof WXEnvironment && !!WXEnvironment.platform, jt = Et && WXEnvironment.platform.toLowerCase(), Ut = xt && window.navigator.userAgent.toLowerCase(), Rt = Ut && /msie|trident/.test(Ut), Ft = (Ut && Ut.indexOf("msie 9.0"), Ut && Ut.indexOf("edge/"), Ut && Ut.indexOf("android"), Ut && /iphone|ipad|ipod|ios/.test(Ut) || "ios" === jt), Nt = (Ut && /chrome\/\d+/.test(Ut), Ut && /phantomjs/.test(Ut), Ut && Ut.match(/firefox\/(\d+)/), {}.watch); if (xt) try { var Dt = {}; Object.defineProperty(Dt, "passive", { get: function () { } }), window.addEventListener("test-passive", null, Dt) } catch (e) { } var Bt, Lt = function () { return void 0 === mt && (mt = !xt && !Et && void 0 !== e && e.process && "server" === e.process.env.VUE_ENV), mt }, $t = xt && window.__VUE_DEVTOOLS_GLOBAL_HOOK__, qt = "undefined" != typeof Symbol && P(Symbol) && "undefined" != typeof Reflect && P(Reflect.ownKeys); Bt = "undefined" != typeof Set && P(Set) ? Set : function () { function e() { this.set = Object.create(null) } return e.prototype.has = function (e) { return !0 === this.set[e] }, e.prototype.add = function (e) { this.set[e] = !0 }, e.prototype.clear = function () { this.set = Object.create(null) }, e }(); var Ht = T, zt = T, Vt = T, Wt = T, Jt = "undefined" != typeof console, Xt = /(?:^|[-_])(\w)/g; Ht = function (e, t) { var n = t ? Vt(t) : ""; Ct.warnHandler ? Ct.warnHandler.call(null, e, t, n) : Jt && !Ct.silent && console.error("[Vue warn]: " + e + n) }, zt = function (e, t) { Jt && !Ct.silent && console.warn("[Vue tip]: " + e + (t ? Vt(t) : "")) }, Wt = function (e, t) { if (e.$scope && e.$scope.is) return e.$scope.is; if (e.$root === e) return "<Root>"; var n = "function" == typeof e && null != e.cid ? e.options : e._isVue ? e.$options || e.constructor.options : e, r = n.name || n._componentTag, i = n.__file; if (!r && i) { var o = i.match(/([^\/\\]+)\.vue$/); r = o && o[1] } return (r ? "<" + r.replace(Xt, function (e) { return e.toUpperCase() }).replace(/[-_]/g, "") + ">" : "<Anonymous>") + (i && !1 !== t ? " at " + i : "") }, Vt = function (e) { if (e._isVue && e.$parent) { for (var t = [], n = 0; e;) { if (t.length > 0) { var r = t[t.length - 1]; if (r.constructor === e.constructor) { n++ , e = e.$parent; continue } n > 0 && (t[t.length - 1] = [r, n], n = 0) } t.push(e), e = e.$parent } return "\n\nfound in\n\n" + t.map(function (e, t) { return "" + (0 === t ? "---\x3e " : function (e, t) { for (var n = ""; t;)t % 2 == 1 && (n += e), t > 1 && (e += e), t >>= 1; return n }(" ", 5 + 2 * t)) + (Array.isArray(e) ? Wt(e[0]) + "... (" + e[1] + " recursive calls)" : Wt(e)) }).join("\n") } return "\n\n(found in " + Wt(e) + ")" }; var Gt = 0, Kt = function () { this.id = Gt++ , this.subs = [] }; Kt.prototype.addSub = function (e) { this.subs.push(e) }, Kt.prototype.removeSub = function (e) { f(this.subs, e) }, Kt.prototype.depend = function () { Kt.target && Kt.target.addDep(this) }, Kt.prototype.notify = function () { var e = this.subs.slice(); Ct.async || e.sort(function (e, t) { return e.id - t.id }); for (var t = 0, n = e.length; t < n; t++)e[t].update() }, Kt.target = null; var Qt = [], Yt = function (e, t, n, r, i, o, s, a) { this.tag = e, this.data = t, this.children = n, this.text = r, this.elm = i, this.ns = void 0, this.context = o, this.fnContext = void 0, this.fnOptions = void 0, this.fnScopeId = void 0, this.key = t && t.key, this.componentOptions = s, this.componentInstance = void 0, this.parent = void 0, this.raw = !1, this.isStatic = !1, this.isRootInsert = !0, this.isComment = !1, this.isCloned = !1, this.isOnce = !1, this.asyncFactory = a, this.asyncMeta = void 0, this.isAsyncPlaceholder = !1 }, Zt = { child: { configurable: !0 } }; Zt.child.get = function () { return this.componentInstance }, Object.defineProperties(Yt.prototype, Zt); var en = function (e) { void 0 === e && (e = ""); var t = new Yt; return t.text = e, t.isComment = !0, t }, tn = Array.prototype, nn = Object.create(tn);["push", "pop", "shift", "unshift", "splice", "sort", "reverse"].forEach(function (e) { var t = tn[e]; w(nn, e, function () { for (var n = [], r = arguments.length; r--;)n[r] = arguments[r]; var i, o = t.apply(this, n), s = this.__ob__; switch (e) { case "push": case "unshift": i = n; break; case "splice": i = n.slice(2) }return i && s.observeArray(i), s.dep.notify(), o }) }); var rn = Object.getOwnPropertyNames(nn), on = !0, sn = function (e) { var t; this.value = e, this.dep = new Kt, this.vmCount = 0, w(e, "__ob__", this), Array.isArray(e) ? (At ? (t = nn, e.__proto__ = t): function(e, t, n){ for (var r = 0, i = n.length; r < i; r++) { var o = n[r]; w(e, o, t[o]) } }(e, nn, rn), this.observeArray(e)): this.walk(e)}; sn.prototype.walk = function (e) { for (var t = Object.keys(e), n = 0; n < t.length; n++)E(e, t[n]) }, sn.prototype.observeArray = function (e) { for (var t = 0, n = e.length; t < n; t++)x(e[t]) }; var an = Ct.optionMergeStrategies; an.el = an.propsData = function (e, t, n, r) { return n || Ht('option "' + r + '" can only be used during instance creation with the `new` keyword.'), ln(e, t) }, an.data = function (e, t, n) { return n ? F(e, t, n) : t && "function" != typeof t ? (Ht('The "data" option should be a function that returns a per-instance value in component definitions.', n), e) : F(e, t) }, Pt.forEach(function (e) { an[e] = N }), wt.forEach(function (e) { an[e + "s"] = D }), an.watch = function (e, t, n, r) { if (e === Nt && (e = void 0), t === Nt && (t = void 0), !t) return Object.create(e || null); if (L(r, t, n), !e) return t; var i = {}; for (var o in v(i, e), t) { var s = i[o], a = t[o]; s && !Array.isArray(s) && (s = [s]), i[o] = s ? s.concat(a) : Array.isArray(a) ? a : [a] } return i }, an.props = an.methods = an.inject = an.computed = function (e, t, n, r) { if (t && L(r, t, n), !e) return t; var i = Object.create(null); return v(i, e), t && v(i, t), i }, an.provide = F; var cn, un, ln = function (e, t) { return void 0 === t ? e : t }, mn = /^(String|Number|Boolean|Function|Symbol)$/, dn = [], pn = !1; if ("undefined" != typeof Promise && P(Promise)) { var fn = Promise.resolve(); cn = function () { fn.then(ee), Ft && setTimeout(T) } } else if (Rt || "undefined" == typeof MutationObserver || !P(MutationObserver) && "[object MutationObserverConstructor]" !== MutationObserver.toString()) cn = "undefined" != typeof setImmediate && P(setImmediate) ? function () { setImmediate(ee) } : function () { setTimeout(ee, 0) }; else { var gn = 1, hn = new MutationObserver(ee), yn = document.createTextNode(String(gn)); hn.observe(yn, { characterData: !0 }), cn = function () { gn = (gn + 1) % 2, yn.data = String(gn) } } var vn = p("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,require"), bn = function (e, t) { Ht('Property or method "' + t + '" is not defined on the instance but referenced during render. Make sure that this property is reactive, either in the data option, or for class-based components, by initializing the property. See: https://vuejs.org/v2/guide/reactivity.html#Declaring-Reactive-Properties.', e) }, Tn = function (e, t) { Ht('Property "' + t + '" must be accessed with "$data.' + t + '" because properties starting with "$" or "_" are not proxied in the Vue instance to prevent conflicts with Vue internalsSee: https://vuejs.org/v2/api/#data', e) }, Mn = "undefined" != typeof Proxy && P(Proxy); if (Mn) { var Sn = p("stop,prevent,self,ctrl,shift,alt,meta,exact"); Ct.keyCodes = new Proxy(Ct.keyCodes, { set: function (e, t, n) { return Sn(t) ? (Ht("Avoid overwriting built-in modifier in config.keyCodes: ." + t), !1) : (e[t] = n, !0) } }) } var kn = { has: function (e, t) { var n = t in e, r = vn(t) || "string" == typeof t && "_" === t.charAt(0) && !(t in e.$data); return n || r || (t in e.$data ? Tn(e, t) : bn(e, t)), n || !r } }, _n = { get: function (e, t) { return "string" != typeof t || t in e || (t in e.$data ? Tn(e, t) : bn(e, t)), e[t] } }; un = function (e) { if (Mn) { var t = e.$options, n = t.render && t.render._withStripped ? _n : kn; e._renderProxy = new Proxy(e, n) } else e._renderProxy = e }; var wn, Pn, Cn = new Bt, In = xt && window.performance; In && In.mark && In.measure && In.clearMarks && In.clearMeasures && (wn = function (e) { return In.mark(e) }, Pn = function (e, t, n) { In.measure(e, t, n), In.clearMarks(t), In.clearMarks(n) }); var On = h(function (e) { var t = "&" === e.charAt(0), n = "~" === (e = t ? e.slice(1) : e).charAt(0), r = "!" === (e = n ? e.slice(1) : e).charAt(0); return { name: e = r ? e.slice(1) : e, once: n, capture: r, passive: t } }); Oe(Ae.prototype); var An, xn = { init: function (e, t) { if (e.componentInstance && !e.componentInstance._isDestroyed && e.data.keepAlive) { var n = e; xn.prepatch(n, n) } else (e.componentInstance = function (e, t) { var n = { _isComponent: !0, _parentVnode: e, parent: t }, i = e.data.inlineTemplate; return r(i) && (n.render = i.render, n.staticRenderFns = i.staticRenderFns), new e.componentOptions.Ctor(n) }(e, Fn)).$mount(t ? e.elm : void 0, t) }, prepatch: function (e, t) { var n = t.componentOptions; !function (e, t, n, r, i) { Nn = !0; var o = r.data.scopedSlots, s = e.$scopedSlots, a = !!(o && !o.$stable || s !== dt && !s.$stable || o && e.$scopedSlots.$key !== o.$key), c = !!(i || e.$options._renderChildren || a); if (e.$options._parentVnode = r, e.$vnode = r, e._vnode && (e._vnode.parent = r), e.$options._renderChildren = i, e.$attrs = r.data.attrs || dt, e.$listeners = n || dt, t && e.$options.props) { A(!1); for (var u = e._props, l = e.$options._propKeys || [], m = 0; m < l.length; m++) { var d = l[m], p = e.$options.props; u[d] = H(d, p, t, e) } A(!0), e.$options.propsData = t } n = n || dt; var f = e.$options._parentListeners; e.$options._parentListeners = n, Le(e, n, f), c && (e.$slots = le(i, r.context), e.$forceUpdate()), Nn = !1 }(t.componentInstance = e.componentInstance, n.propsData, n.listeners, t, n.children) }, insert: function (e) { var t, n = e.context, r = e.componentInstance; r._isMounted || (r._isMounted = !0, He(r, "mounted")), e.data.keepAlive && (n._isMounted ? ((t = r)._inactive = !1, Ln.push(t)) : qe(r, !0)) }, destroy: function (e) { var t = e.componentInstance; t._isDestroyed || (e.data.keepAlive ? function e(t, n) { if (!(n && (t._directInactive = !0, $e(t)) || t._inactive)) { t._inactive = !0; for (var r = 0; r < t.$children.length; r++)e(t.$children[r]); He(t, "deactivated") } }(t, !0) : t.$destroy()) } }, En = Object.keys(xn), jn = 1, Un = 2, Rn = null, Fn = null, Nn = !1, Dn = 100, Bn = [], Ln = [], $n = {}, qn = {}, Hn = !1, zn = !1, Vn = 0, Wn = Date.now; if (xt && !Rt) { var Jn = window.performance; Jn && "function" == typeof Jn.now && Wn() > document.createEvent("Event").timeStamp && (Wn = function () { return Jn.now() }) } var Xn = 0, Gn = function (e, t, n, r, i) { this.vm = e, i && (e._watcher = this), e._watchers.push(this), r ? (this.deep = !!r.deep, this.user = !!r.user, this.lazy = !!r.lazy, this.sync = !!r.sync, this.before = r.before) : this.deep = this.user = this.lazy = this.sync = !1, this.cb = n, this.id = ++Xn, this.active = !0, this.dirty = this.lazy, this.deps = [], this.newDeps = [], this.depIds = new Bt, this.newDepIds = new Bt, this.expression = t.toString(), "function" == typeof t ? this.getter = t : (this.getter = function (e) { if (!Ot.test(e)) { var t = e.split("."); return function (e) { for (var n = 0; n < t.length; n++) { if (!e) return; e = e[t[n]] } return e } } }(t), this.getter || (this.getter = T, Ht('Failed watching path: "' + t + '" Watcher only accepts simple dot-delimited paths. For full control, use a function instead.', e))), this.value = this.lazy ? void 0 : this.get() }; Gn.prototype.get = function () { var e; C(this); var t = this.vm; try { e = this.getter.call(t, t) } catch (e) { if (!this.user) throw e; K(e, t, 'getter for watcher "' + this.expression + '"') } finally { this.deep && ne(e), I(), this.cleanupDeps() } return e }, Gn.prototype.addDep = function (e) { var t = e.id; this.newDepIds.has(t) || (this.newDepIds.add(t), this.newDeps.push(e), this.depIds.has(t) || e.addSub(this)) }, Gn.prototype.cleanupDeps = function () { for (var e = this.deps.length; e--;) { var t = this.deps[e]; this.newDepIds.has(t.id) || t.removeSub(this) } var n = this.depIds; this.depIds = this.newDepIds, this.newDepIds = n, this.newDepIds.clear(), n = this.deps, this.deps = this.newDeps, this.newDeps = n, this.newDeps.length = 0 }, Gn.prototype.update = function () { this.lazy ? this.dirty = !0 : this.sync ? this.run() : function (e) { var t = e.id; if (null == $n[t]) { if ($n[t] = !0, zn) { for (var n = Bn.length - 1; n > Vn && Bn[n].id > e.id;)n--; Bn.splice(n + 1, 0, e) } else Bn.push(e); if (!Hn) { if (Hn = !0, !Ct.async) return void ze(); te(ze) } } }(this) }, Gn.prototype.run = function () { if (this.active) { var e = this.get(); if (e !== this.value || s(e) || this.deep) { var t = this.value; if (this.value = e, this.user) try { this.cb.call(this.vm, e, t) } catch (e) { K(e, this.vm, 'callback for watcher "' + this.expression + '"') } else this.cb.call(this.vm, e, t) } } }, Gn.prototype.evaluate = function () { this.value = this.get(), this.dirty = !1 }, Gn.prototype.depend = function () { for (var e = this.deps.length; e--;)this.deps[e].depend() }, Gn.prototype.teardown = function () { if (this.active) { this.vm._isBeingDestroyed || f(this.vm._watchers, this); for (var e = this.deps.length; e--;)this.deps[e].removeSub(this); this.active = !1 } }; var Kn = { enumerable: !0, configurable: !0, get: T, set: T }, Qn = { lazy: !0 }, Yn = 0; !function (e) { e.prototype._init = function (e) { var t, n, r = this; r._uid = Yn++ , Ct.performance && wn && (t = "vue-perf-start:" + r._uid, n = "vue-perf-end:" + r._uid, wn(t)), r._isVue = !0, e && e._isComponent ? function (e, t) { var n = e.$options = Object.create(e.constructor.options), r = t._parentVnode; n.parent = t.parent, n._parentVnode = r; var i = r.componentOptions; n.propsData = i.propsData, n._parentListeners = i.listeners, n._renderChildren = i.children, n._componentTag = i.tag, t.render && (n.render = t.render, n.staticRenderFns = t.staticRenderFns) }(r, e) : r.$options = $(Qe(r.constructor), e || {}, r), un(r), r._self = r, function (e) { var t = e.$options, n = t.parent; if (n && !t.abstract) { for (; n.$options.abstract && n.$parent;)n = n.$parent; n.$children.push(e) } e.$parent = n, e.$root = n ? n.$root : e, e.$children = [], e.$refs = {}, e._watcher = null, e._inactive = null, e._directInactive = !1, e._isMounted = !1, e._isDestroyed = !1, e._isBeingDestroyed = !1 }(r), function (e) { e._events = Object.create(null), e._hasHookEvent = !1; var t = e.$options._parentListeners; t && Le(e, t) }(r), function (e) { e._vnode = null, e._staticTrees = null; var t = e.$options, n = e.$vnode = t._parentVnode, r = n && n.context; e.$slots = le(t._renderChildren, r), e.$scopedSlots = dt, e._c = function (t, n, r, i) { return Re(e, t, n, r, i, !1) }, e.$createElement = function (t, n, r, i) { return Re(e, t, n, r, i, !0) }; var i = n && n.data; E(e, "$attrs", i && i.attrs || dt, function () { !Nn && Ht("$attrs is readonly.", e) }, !0), E(e, "$listeners", t._parentListeners || dt, function () { !Nn && Ht("$listeners is readonly.", e) }, !0) }(r), He(r, "beforeCreate"), "mp-toutiao" !== r.mpHost && ce(r), We(r), "mp-toutiao" !== r.mpHost && ae(r), "mp-toutiao" !== r.mpHost && He(r, "created"), Ct.performance && wn && (r._name = Wt(r, !1), wn(n), Pn("vue " + r._name + " init", t, n)), r.$options.el && r.$mount(r.$options.el) } }(Ye), function (e) { var t = { get: function () { return this._data } }, n = { get: function () { return this._props } }; t.set = function () { Ht("Avoid replacing instance root $data. Use nested data properties instead.", this) }, n.set = function () { Ht("$props is readonly.", this) }, Object.defineProperty(e.prototype, "$data", t), Object.defineProperty(e.prototype, "$props", n), e.prototype.$set = j, e.prototype.$delete = U, e.prototype.$watch = function (e, t, n) { if (c(t)) return Ke(this, e, t, n); (n = n || {}).user = !0; var r = new Gn(this, e, t, n); if (n.immediate) try { t.call(this, r.value) } catch (e) { K(e, this, 'callback for immediate watcher "' + r.expression + '"') } return function () { r.teardown() } } }(Ye), function (e) { var t = /^hook:/; e.prototype.$on = function (e, n) { var r = this; if (Array.isArray(e)) for (var i = 0, o = e.length; i < o; i++)r.$on(e[i], n); else (r._events[e] || (r._events[e] = [])).push(n), t.test(e) && (r._hasHookEvent = !0); return r }, e.prototype.$once = function (e, t) { function n() { r.$off(e, n), t.apply(r, arguments) } var r = this; return n.fn = t, r.$on(e, n), r }, e.prototype.$off = function (e, t) { var n = this; if (!arguments.length) return n._events = Object.create(null), n; if (Array.isArray(e)) { for (var r = 0, i = e.length; r < i; r++)n.$off(e[r], t); return n } var o, s = n._events[e]; if (!s) return n; if (!t) return n._events[e] = null, n; for (var a = s.length; a--;)if ((o = s[a]) === t || o.fn === t) { s.splice(a, 1); break } return n }, e.prototype.$emit = function (e) { var t = this, n = e.toLowerCase(); n !== e && t._events[n] && zt('Event "' + n + '" is emitted in component ' + Wt(t) + ' but the handler is registered for "' + e + '". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "' + Mt(e) + '" instead of "' + e + '".'); var r = t._events[e]; if (r) { r = r.length > 1 ? y(r) : r; for (var i = y(arguments, 1), o = 'event handler for "' + e + '"', s = 0, a = r.length; s < a; s++)Q(r[s], t, i, t, o) } return t } }(Ye), function (e) { e.prototype._update = function (e, t) { var n = this, r = n.$el, i = n._vnode, o = function (e) { var t = Fn; return Fn = e, function () { Fn = t } }(n); n._vnode = e, n.$el = i ? n.__patch__(i, e) : n.__patch__(n.$el, e, t, !1), o(), r && (r.__vue__ = null), n.$el && (n.$el.__vue__ = n), n.$vnode && n.$parent && n.$vnode === n.$parent._vnode && (n.$parent.$el = n.$el) }, e.prototype.$forceUpdate = function () { this._watcher && this._watcher.update() }, e.prototype.$destroy = function () { var e = this; if (!e._isBeingDestroyed) { He(e, "beforeDestroy"), e._isBeingDestroyed = !0; var t = e.$parent; !t || t._isBeingDestroyed || e.$options.abstract || f(t.$children, e), e._watcher && e._watcher.teardown(); for (var n = e._watchers.length; n--;)e._watchers[n].teardown(); e._data.__ob__ && e._data.__ob__.vmCount-- , e._isDestroyed = !0, e.__patch__(e._vnode, null), He(e, "destroyed"), e.$off(), e.$el && (e.$el.__vue__ = null), e.$vnode && (e.$vnode.parent = null) } } }(Ye), function (e) { Oe(e.prototype), e.prototype.$nextTick = function (e) { return te(e, this) }, e.prototype._render = function () { var e, t = this, n = t.$options, r = n.render, i = n._parentVnode; i && (t.$scopedSlots = de(i.data.scopedSlots, t.$slots, t.$scopedSlots)), t.$vnode = i; try { Rn = t, e = r.call(t._renderProxy, t.$createElement) } catch (n) { if (K(n, t, "render"), t.$options.renderError) try { e = t.$options.renderError.call(t._renderProxy, t.$createElement, n) } catch (n) { K(n, t, "renderError"), e = t._vnode } else e = t._vnode } finally { Rn = null } return Array.isArray(e) && 1 === e.length && (e = e[0]), e instanceof Yt || (Array.isArray(e) && Ht("Multiple root nodes returned from render function. Render function should return a single root node.", t), e = en()), e.parent = i, e } }(Ye); var Zn = [String, RegExp, Array], er = { KeepAlive: { name: "keep-alive", abstract: !0, props: { include: Zn, exclude: Zn, max: [String, Number] }, created: function () { this.cache = Object.create(null), this.keys = [] }, destroyed: function () { for (var e in this.cache) rt(this.cache, e, this.keys) }, mounted: function () { var e = this; this.$watch("include", function (t) { nt(e, function (e) { return tt(t, e) }) }), this.$watch("exclude", function (t) { nt(e, function (e) { return !tt(t, e) }) }) }, render: function () { var e = this.$slots.default, t = function (e) { if (Array.isArray(e)) for (var t = 0; t < e.length; t++) { var n = e[t]; if (r(n) && (r(n.componentOptions) || (i = n).isComment && i.asyncFactory)) return n } var i }(e), n = t && t.componentOptions; if (n) { var i = et(n), o = this.include, s = this.exclude; if (o && (!i || !tt(o, i)) || s && i && tt(s, i)) return t; var a = this.cache, c = this.keys, u = null == t.key ? n.Ctor.cid + (n.tag ? "::" + n.tag : "") : t.key; a[u] ? (t.componentInstance = a[u].componentInstance, f(c, u), c.push(u)) : (a[u] = t, c.push(u), this.max && c.length > parseInt(this.max) && rt(a, c[0], c, this._vnode)), t.data.keepAlive = !0 } return t || e && e[0] } } }; !function (e) { var t = { get: function () { return Ct }, set: function () { Ht("Do not replace the Vue.config object, set individual fields instead.") } }; Object.defineProperty(e, "config", t), e.util = { warn: Ht, extend: v, mergeOptions: $, defineReactive: E }, e.set = j, e.delete = U, e.nextTick = te, e.observable = function (e) { return x(e), e }, e.options = Object.create(null), wt.forEach(function (t) { e.options[t + "s"] = Object.create(null) }), e.options._base = e, v(e.options.components, er), function (e) { e.use = function (e) { var t = this._installedPlugins || (this._installedPlugins = []); if (t.indexOf(e) > -1) return this; var n = y(arguments, 1); return n.unshift(this), "function" == typeof e.install ? e.install.apply(e, n) : "function" == typeof e && e.apply(null, n), t.push(e), this } }(e), function (e) { e.mixin = function (e) { return this.options = $(this.options, e), this } }(e), Ze(e), function (e) { wt.forEach(function (t) { e[t] = function (e, n) { return n ? ("component" === t && B(e), "component" === t && c(n) && (n.name = n.name || e, n = this.options._base.extend(n)), "directive" === t && "function" == typeof n && (n = { bind: n, update: n }), this.options[t + "s"][e] = n, n) : this.options[t + "s"][e] } }) }(e) }(Ye), Object.defineProperty(Ye.prototype, "$isServer", { get: Lt }), Object.defineProperty(Ye.prototype, "$ssrContext", { get: function () { return this.$vnode && this.$vnode.ssrContext } }), Object.defineProperty(Ye, "FunctionalRenderContext", { value: Ae }), Ye.version = "2.6.10"; var tr = "[object Array]", nr = "[object Object]", rr = h(function (e) { var t = {}, n = /:(.+)/; return e.split(/;(?![^(]*\))/g).forEach(function (e) { if (e) { var r = e.split(n); r.length > 1 && (t[r[0].trim()] = r[1].trim()) } }), t }), ir = ["createSelectorQuery", "createIntersectionObserver", "selectAllComponents", "selectComponent"], or = ["onLaunch", "onShow", "onHide", "onUniNViewMessage", "onError", "onLoad", "onReady", "onUnload", "onPullDownRefresh", "onReachBottom", "onTabItemTap", "onShareAppMessage", "onResize", "onPageScroll", "onNavigationBarButtonTap", "onBackPress", "onNavigationBarSearchInputChanged", "onNavigationBarSearchInputConfirmed", "onNavigationBarSearchInputClicked", "onPageShow", "onPageHide", "onPageResize"]; Ye.prototype.__patch__ = function (e, t) { var n, r, i = this; if (null !== t && ("page" === this.mpType || "component" === this.mpType)) { var o = this.$scope, s = Object.create(null); try { n = this, r = Object.create(null), [].concat(Object.keys(n._data || {}), Object.keys(n._computedWatchers || {})).reduce(function (e, t) { return e[t] = n[t], e }, r), Object.assign(r, n.$mp.data || {}), Array.isArray(n.$options.behaviors) && -1 !== n.$options.behaviors.indexOf("uni://form-field") && (r.name = n.name, r.value = n.value), s = JSON.parse(JSON.stringify(r)) } catch (e) { console.error(e) } s.__webviewId__ = o.data.__webviewId__; var a = Object.create(null); Object.keys(s).forEach(function (e) { a[e] = o.data[e] }); var c = it(s, a); Object.keys(c).length ? (Object({ NODE_ENV: "development", VUE_APP_PLATFORM: "mp-weixin", BASE_URL: "/" }).VUE_APP_DEBUG && console.log("[" + +new Date + "][" + (o.is || o.route) + "][" + this._uid + "]差量更新", JSON.stringify(c)), this.__next_tick_pending = !0, o.setData(c, function () { i.__next_tick_pending = !1, at(i) })) : at(this) } }, Ye.prototype.$mount = function (e, t) { return function (e, t, n) { return e.mpType ? ("app" === e.mpType && (e.$options.render = ut), e.$options.render || (e.$options.render = ut, e.$options.template && "#" !== e.$options.template.charAt(0) || e.$options.el || t ? Ht("You are using the runtime-only build of Vue where the template compiler is not available. Either pre-compile the templates into render functions, or use the compiler-included build.", e) : Ht("Failed to mount component: template or render function not defined.", e)), "mp-toutiao" !== e.mpHost && He(e, "beforeMount"), new Gn(e, function () { e._update(e._render(), n) }, T, { before: function () { e._isMounted && !e._isDestroyed && He(e, "beforeUpdate") } }, !0), n = !1, e) : e }(this, e, t) }, function (e) { var t = e.extend; e.extend = function (e) { var n = (e = e || {}).methods; return n && Object.keys(n).forEach(function (t) { -1 !== or.indexOf(t) && (e[t] = n[t], delete n[t]) }), t.call(this, e) }; var n = e.config.optionMergeStrategies, r = n.created; or.forEach(function (e) { n[e] = r }), e.prototype.__lifecycle_hooks__ = or }(Ye), function (e) { e.config.errorHandler = function (e) { console.error(e) }; var t = e.prototype.$emit; e.prototype.$emit = function (e) { return this.$scope && e && this.$scope.triggerEvent(e, { __args__: y(arguments, 1) }), t.apply(this, arguments) }, e.prototype.$nextTick = function (e) { return ct(this, e) }, ir.forEach(function (t) { e.prototype[t] = function (e) { if (this.$scope) return this.$scope[t](e) } }), e.prototype.__init_provide = ae, e.prototype.__init_injections = ce, e.prototype.__call_hook = function (e, t) { var n = this; C(); var r, i = n.$options[e], o = e + " hook"; if (i) for (var s = 0, a = i.length; s < a; s++)r = Q(i[s], n, t ? [t] : null, n, o); return n._hasHookEvent && n.$emit("hook:" + e), I(), r }, e.prototype.__set_model = function (e, t, n, r) { Array.isArray(r) && (-1 !== r.indexOf("trim") && (n = n.trim()), -1 !== r.indexOf("number") && (n = this._n(n))), e || (e = this), e[t] = n }, e.prototype.__set_sync = function (e, t, n) { e || (e = this), e[t] = n }, e.prototype.__get_orig = function (e) { return c(e) && e.$orig || e }, e.prototype.__get_value = function (e, t) { return function e(t, n) { var r = n.split("."), i = r[0]; return 0 === i.indexOf("__$n") && (i = parseInt(i.replace("__$n", ""))), 1 === r.length ? t[i] : e(t[i], r.slice(1).join(".")) }(t || this, e) }, e.prototype.__get_class = function (e, t) { return function (e, t) { return r(e) || r(t) ? (n = e, i = lt(t), n ? i ? n + " " + i : n : i || "") : ""; var n, i }(t, e) }, e.prototype.__get_style = function (e, t) { if (!e && !t) return ""; var n, r = (n = e, Array.isArray(n) ? b(n) : "string" == typeof n ? rr(n) : n), i = t ? v(t, r) : r; return Object.keys(i).map(function (e) { return Mt(e) + ":" + i[e] }).join(";") }, e.prototype.__map = function (e, t) { var n, r, i, o, a; if (Array.isArray(e)) { for (n = new Array(e.length), r = 0, i = e.length; r < i; r++)n[r] = t(e[r], r); return n } if (s(e)) { for (o = Object.keys(e), n = Object.create(null), r = 0, i = o.length; r < i; r++)n[a = o[r]] = t(e[a], a, r); return n } return [] } }(Ye), t.default = Ye}.call(this, n(3))}, function(e, t) { var n; n = function () { return this }(); try { n = n || new Function("return this")() } catch (e) { "object" == ("undefined" == typeof window ? "undefined" : _typeof(window)) && (n = window) } e.exports = n }, function(e, t, n) { },,,,,, function(e, t, n) { function r(e, t, n, r, i, o, s, a) { var c, u = "function" == typeof e ? e.options : e; if (t && (u.render = t, u.staticRenderFns = n, u._compiled = !0), r && (u.functional = !0), o && (u._scopeId = "data-v-" + o), s ? (c = function (e) { (e = e || this.$vnode && this.$vnode.ssrContext || this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext) || "undefined" == typeof __VUE_SSR_CONTEXT__ || (e = __VUE_SSR_CONTEXT__), i && i.call(this, e), e && e._registeredComponents && e._registeredComponents.add(s) }, u._ssrRegister = c) : i && (c = a ? function () { i.call(this, this.$root.$options.shadowRoot) } : i), c) if (u.functional) { u._injectStyles = c; var l = u.render; u.render = function (e, t) { return c.call(t), l(e, t) } } else { var m = u.beforeCreate; u.beforeCreate = m ? [].concat(m, c) : [c] } return { exports: e, options: u } } n.r(t), n.d(t, "default", function () { return r }) }, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(12)).default) }).call(this, n(1).createPage) },,,,,, function(e, t, n) { (function (e) { function r(e) { for (var t = 1; t < arguments.length; t++) { var n = null != arguments[t] ? arguments[t] : {}, r = Object.keys(n); "function" == typeof Object.getOwnPropertySymbols && (r = r.concat(Object.getOwnPropertySymbols(n).filter(function (e) { return Object.getOwnPropertyDescriptor(n, e).enumerable }))), r.forEach(function (t) { s(e, t, n[t]) }) } return e } function i(e, t, n, r, i, o, s) { try { var a = e[o](s), c = a.value } catch (e) { return void n(e) } a.done ? t(c) : Promise.resolve(c).then(r, i) } function o(e, t) { for (var n = 0; n < t.length; n++) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r) } } function s(e, t, n) { return t in e ? Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var a, c = (a = n(18)) && a.__esModule ? a : { default: a }, u = new Array; u[0] = "http://192.168.1.5:9066", u[1] = "http://192.168.1.29:9066", u[2] = "https://api.hoda.dating"; var l = function () { function t() { var e = this; !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, t), s(this, "config", { baseUrl: u[1], header: { "Content-Type": "application/json;charset=UTF-8" }, method: "GET", dataType: "json", responseType: "text" }), s(this, "interceptor", { request: function (t) { t && (e.requestBeforeFun = t) }, response: function (t, n) { t && n && (e.requestComFun = t, e.requestComFail = n) } }) } var n, a, l; return n = t, a = [{ key: "requestBeforeFun", value: function (e) { return e } }, { key: "requestComFun", value: function (e) { return e } }, { key: "requestComFail", value: function (e) { return e } }, { key: "setConfig", value: function (e) { this.config = e(this.config) } }, { key: "request", value: function () { var n, o = (n = c.default.mark(function n() { var i, o = this, s = arguments; return c.default.wrap(function (n) { for (; ;)switch (n.prev = n.next) { case 0: return (i = s.length > 0 && void 0 !== s[0] ? s[0] : {}).baseUrl = this.config.baseUrl, i.dataType = i.dataType || this.config.dataType, i.responseType = i.responseType || this.config.responseType, i.url = i.url || "", i.data = i.data || {}, i.params = i.params || {}, i.header = i.header || this.config.header, i.method = i.method || this.config.method, n.abrupt("return", new Promise(function (n, s) { var a = !0, c = {}; i.complete = function (e) { e.config = c, 200 === e.statusCode ? (e = o.requestComFun(e), n(e)) : (e = o.requestComFail(e), s(e)) }, c = r({}, o.requestBeforeFun(i, function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "handle cancel", t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : i; s({ errMsg: e, config: t }), a = !1 })); var u = r({}, c); if (a) { var l = t.posUrl(i.url) ? i.url : i.baseUrl + i.url; if ("{}" !== JSON.stringify(i.params)) { var m = t.addQueryString(i.params); l += -1 === l.indexOf("?") ? "?".concat(m) : "&".concat(m) } u.url = l, e.request(u) } })); case 10: case "end": return n.stop() } }, n, this) }), function () { var e = this, t = arguments; return new Promise(function (r, o) { function s(e) { i(c, r, o, s, a, "next", e) } function a(e) { i(c, r, o, s, a, "throw", e) } var c = n.apply(e, t); s(void 0) }) }); return function () { return o.apply(this, arguments) } }() }, { key: "get", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return this.request(r({ url: e, method: "GET" }, t)) } }, { key: "post", value: function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; return this.request(r({ url: e, data: t, method: "POST" }, n)) } }, { key: "put", value: function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; return this.request(r({ url: e, data: t, method: "PUT" }, n)) } }, { key: "delete", value: function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; return this.request(r({ url: e, data: t, method: "DELETE" }, n)) } }, { key: "connect", value: function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; return this.request(r({ url: e, data: t, method: "CONNECT" }, n)) } }, { key: "head", value: function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; return this.request(r({ url: e, data: t, method: "HEAD" }, n)) } }, { key: "options", value: function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; return this.request(r({ url: e, data: t, method: "OPTIONS" }, n)) } }, { key: "trace", value: function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; return this.request(r({ url: e, data: t, method: "TRACE" }, n)) } }, { key: "upload", value: function (n, i) { var o = this, s = i.filePath, a = i.name, c = i.header, u = i.formData; return new Promise(function (i, l) { var m = !0, d = {}, p = { baseUrl: o.config.baseUrl, url: n, filePath: s, method: "UPLOAD", name: a, header: c || o.config.header, formData: u, complete: function (e) { e.config = d, 200 === e.statusCode ? (e = o.requestComFun(e), i(e)) : (e = o.requestComFail(e), l(e)) } }; d = r({}, o.requestBeforeFun(p, function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "handle cancel", t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : p; l({ errMsg: e, config: t }), m = !1 })); var f = r({}, d); m && (f.url = t.posUrl(n) ? n : o.config.baseUrl + n, e.uploadFile(f)) }) } }], l = [{ key: "posUrl", value: function (e) { return /(http|https):\/\/([\w.]+\/?)\S*/.test(e) } }, { key: "addQueryString", value: function (e) { var t = ""; return Object.keys(e).forEach(function (n) { t += n + "=" + e[n] + "&" }), t.substring(0, t.length - 1) } }], a && o(n.prototype, a), l && o(n, l), t }(); t.default = l }).call(this, n(1).default) }, function(e, t, n) { e.exports = n(19) }, function(e, t, n) { var r = function () { return this || "object" == ("undefined" == typeof self ? "undefined" : _typeof(self)) && self }() || Function("return this")(), i = r.regeneratorRuntime && Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime") >= 0, o = i && r.regeneratorRuntime; if (r.regeneratorRuntime = void 0, e.exports = n(20), i) r.regeneratorRuntime = o; else try { delete r.regeneratorRuntime } catch (e) { r.regeneratorRuntime = void 0 } }, function(e, t) { !function (t) { function n(e, t, n, o) { var s = t && t.prototype instanceof i ? t : i, a = Object.create(s.prototype), c = new d(o || []); return a._invoke = function (e, t, n) { var i = _; return function (o, s) { if (i === P) throw new Error("Generator is already running"); if (i === C) { if ("throw" === o) throw s; return f() } for (n.method = o, n.arg = s; ;) { var a = n.delegate; if (a) { var c = u(a, n); if (c) { if (c === I) continue; return c } } if ("next" === n.method) n.sent = n._sent = n.arg; else if ("throw" === n.method) { if (i === _) throw i = C, n.arg; n.dispatchException(n.arg) } else "return" === n.method && n.abrupt("return", n.arg); i = P; var l = r(e, t, n); if ("normal" === l.type) { if (i = n.done ? C : w, l.arg === I) continue; return { value: l.arg, done: n.done } } "throw" === l.type && (i = C, n.method = "throw", n.arg = l.arg) } } }(e, n, c), a } function r(e, t, n) { try { return { type: "normal", arg: e.call(t, n) } } catch (e) { return { type: "throw", arg: e } } } function i() { } function o() { } function s() { } function a(e) { ["next", "throw", "return"].forEach(function (t) { e[t] = function (e) { return this._invoke(t, e) } }) } function c(e) { var t; this._invoke = function (n, i) { function o() { return new Promise(function (t, o) { !function t(n, i, o, s) { var a = r(e[n], e, i); if ("throw" !== a.type) { var c = a.arg, u = c.value; return u && "object" == (void 0 === u ? "undefined" : _typeof(u)) && y.call(u, "__await") ? Promise.resolve(u.__await).then(function (e) { t("next", e, o, s) }, function (e) { t("throw", e, o, s) }) : Promise.resolve(u).then(function (e) { c.value = e, o(c) }, function (e) { return t("throw", e, o, s) }) } s(a.arg) }(n, i, t, o) }) } return t = t ? t.then(o, o) : o() } } function u(e, t) { var n = e.iterator[t.method]; if (n === g) { if (t.delegate = null, "throw" === t.method) { if (e.iterator.return && (t.method = "return", t.arg = g, u(e, t), "throw" === t.method)) return I; t.method = "throw", t.arg = new TypeError("The iterator does not provide a 'throw' method") } return I } var i = r(n, e.iterator, t.arg); if ("throw" === i.type) return t.method = "throw", t.arg = i.arg, t.delegate = null, I; var o = i.arg; return o ? o.done ? (t[e.resultName] = o.value, t.next = e.nextLoc, "return" !== t.method && (t.method = "next", t.arg = g), t.delegate = null, I) : o : (t.method = "throw", t.arg = new TypeError("iterator result is not an object"), t.delegate = null, I) } function l(e) { var t = { tryLoc: e[0] }; 1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t) } function m(e) { var t = e.completion || {}; t.type = "normal", delete t.arg, e.completion = t } function d(e) { this.tryEntries = [{ tryLoc: "root" }], e.forEach(l, this), this.reset(!0) } function p(e) { if (e) { var t = e[b]; if (t) return t.call(e); if ("function" == typeof e.next) return e; if (!isNaN(e.length)) { var n = -1, r = function t() { for (; ++n < e.length;)if (y.call(e, n)) return t.value = e[n], t.done = !1, t; return t.value = g, t.done = !0, t }; return r.next = r } } return { next: f } } function f() { return { value: g, done: !0 } } var g, h = Object.prototype, y = h.hasOwnProperty, v = "function" == typeof Symbol ? Symbol : {}, b = v.iterator || "@@iterator", T = v.asyncIterator || "@@asyncIterator", M = v.toStringTag || "@@toStringTag", S = "object" == (void 0 === e ? "undefined" : _typeof(e)), k = t.regeneratorRuntime; if (k) S && (e.exports = k); else { (k = t.regeneratorRuntime = S ? e.exports : {}).wrap = n; var _ = "suspendedStart", w = "suspendedYield", P = "executing", C = "completed", I = {}, O = {}; O[b] = function () { return this }; var A = Object.getPrototypeOf, x = A && A(A(p([]))); x && x !== h && y.call(x, b) && (O = x); var E = s.prototype = i.prototype = Object.create(O); o.prototype = E.constructor = s, s.constructor = o, s[M] = o.displayName = "GeneratorFunction", k.isGeneratorFunction = function (e) { var t = "function" == typeof e && e.constructor; return !!t && (t === o || "GeneratorFunction" === (t.displayName || t.name)) }, k.mark = function (e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, s) : (e.__proto__ = s, M in e || (e[M] = "GeneratorFunction")), e.prototype = Object.create(E), e }, k.awrap = function (e) { return { __await: e } }, a(c.prototype), c.prototype[T] = function () { return this }, k.AsyncIterator = c, k.async = function (e, t, r, i) { var o = new c(n(e, t, r, i)); return k.isGeneratorFunction(t) ? o : o.next().then(function (e) { return e.done ? e.value : o.next() }) }, a(E), E[M] = "Generator", E[b] = function () { return this }, E.toString = function () { return "[object Generator]" }, k.keys = function (e) { var t = []; for (var n in e) t.push(n); return t.reverse(), function n() { for (; t.length;) { var r = t.pop(); if (r in e) return n.value = r, n.done = !1, n } return n.done = !0, n } }, k.values = p, d.prototype = { constructor: d, reset: function (e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = g, this.done = !1, this.delegate = null, this.method = "next", this.arg = g, this.tryEntries.forEach(m), !e) for (var t in this) "t" === t.charAt(0) && y.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = g) }, stop: function () { this.done = !0; var e = this.tryEntries[0].completion; if ("throw" === e.type) throw e.arg; return this.rval }, dispatchException: function (e) { function t(t, r) { return o.type = "throw", o.arg = e, n.next = t, r && (n.method = "next", n.arg = g), !!r } if (this.done) throw e; for (var n = this, r = this.tryEntries.length - 1; r >= 0; --r) { var i = this.tryEntries[r], o = i.completion; if ("root" === i.tryLoc) return t("end"); if (i.tryLoc <= this.prev) { var s = y.call(i, "catchLoc"), a = y.call(i, "finallyLoc"); if (s && a) { if (this.prev < i.catchLoc) return t(i.catchLoc, !0); if (this.prev < i.finallyLoc) return t(i.finallyLoc) } else if (s) { if (this.prev < i.catchLoc) return t(i.catchLoc, !0) } else { if (!a) throw new Error("try statement without catch or finally"); if (this.prev < i.finallyLoc) return t(i.finallyLoc) } } } }, abrupt: function (e, t) { for (var n = this.tryEntries.length - 1; n >= 0; --n) { var r = this.tryEntries[n]; if (r.tryLoc <= this.prev && y.call(r, "finallyLoc") && this.prev < r.finallyLoc) { var i = r; break } } i && ("break" === e || "continue" === e) && i.tryLoc <= t && t <= i.finallyLoc && (i = null); var o = i ? i.completion : {}; return o.type = e, o.arg = t, i ? (this.method = "next", this.next = i.finallyLoc, I) : this.complete(o) }, complete: function (e, t) { if ("throw" === e.type) throw e.arg; return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), I }, finish: function (e) { for (var t = this.tryEntries.length - 1; t >= 0; --t) { var n = this.tryEntries[t]; if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), m(n), I } }, catch: function (e) { for (var t = this.tryEntries.length - 1; t >= 0; --t) { var n = this.tryEntries[t]; if (n.tryLoc === e) { var r = n.completion; if ("throw" === r.type) { var i = r.arg; m(n) } return i } } throw new Error("illegal catch attempt") }, delegateYield: function (e, t, n) { return this.delegate = { iterator: p(e), resultName: t, nextLoc: n }, "next" === this.method && (this.arg = g), I } } } }(function () { return this || "object" == ("undefined" == typeof self ? "undefined" : _typeof(self)) && self }() || Function("return this")()) }, function(e, t, n) { Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var r = { gender: "", uploadAvatar: "", uploadCertification: "https://static.mianyangjuan.com//Upload_Avatar@3x.png", chatList: [], msgs: [], nowMsg: [], nim: {}, appKey: "447c6d115707b7837feb32738915b9f4", token: "ef9535158b9678b58528972d2aba2b04", account: "587", calcTimeHeader: function (e) { var t = new Date(parseInt(e)), n = t.getUTCFullYear(), r = t.getUTCMonth(), i = t.getDate(), o = t.getHours(), s = t.getUTCMinutes(), a = new Date, c = t.getUTCFullYear(), u = t.getUTCMonth(), l = a.getDate(); if (c == n && u == r && l == i) return o > 12 ? "下午 ".concat(o, ":").concat(s < 10 ? "0" + s : s) : "上午 ".concat(o, ":").concat(s < 10 ? "0" + s : s); var m = new Date(a - 864e5); return n == m.getUTCFullYear() && r == m.getUTCMonth && i == m.getDate() ? "昨天 ".concat(o, ":").concat(s < 10 ? "0" + s : s) : "".concat(n, "-").concat(r + 1, "-").concat(i, " ").concat(o, ":").concat(s < 10 ? "0" + s : s) }, isChatRoom: "", userId: "", myInfo: "", sex: "", isMember: "" }; t.default = r }, function(e, t, n) { (function (e) { function r(e) { return e && e.__esModule ? e : { default: e } } function i(e) { return function (e) { if (Array.isArray(e)) { for (var t = 0, n = new Array(e.length); t < e.length; t++)n[t] = e[t]; return n } }(e) || function (e) { if (Symbol.iterator in Object(e) || "[object Arguments]" === Object.prototype.toString.call(e)) return Array.from(e) }(e) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance") }() } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var o = r(n(23)), s = r(n(21)); r(n(17)), t.default = function t(n) { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, t), s.default.nim = o.default.getInstance({ debug: !1, appKey: "447c6d115707b7837feb32738915b9f4", account: n.account, token: n.token, db: !0, onconnect: function () { console.log("连接成功") }, onwillreconnect: function (e) { console.log("即将重连"), console.log(e.retryCount), console.log(e.duration) }, ondisconnect: function (t) { if (console.log("丢失连接"), console.log(t), t) switch (t.code) { case 302: case 417: break; case "kicked": e.reLaunch({ url: "pages/login/login.vue", success: function (t) { e.showModal({ title: "提示", content: "此账号已在别处登陆" }), console.log(t) }, fail: function (e) { console.log(e) } }) } }, onerror: function (e) { console.log(e) }, onsessions: function (e) { console.log("收到会话列表", e), s.default.chatList = JSON.parse(JSON.stringify(e)), s.default.chatList.map(function (e, t) { e.updateTime = s.default.calcTimeHeader(e.updateTime) }), console.log("common.chatList", s.default.chatList) }, onupdatesession: function (e) { var t, n = !1; console.log("会话更新了", e), s.default.chatList.map(function (t, r) { t.to == e.to && (n = !0, s.default.chatList[r] = e, s.default.chatList[r].updateTime = s.default.calcTimeHeader(s.default.chatList[r].updateTime), s.default.isChatRoom == e.to && (s.default.chatList[r].unread = 0), console.log("cur", r)) }), 0 == n && s.default.chatList.push(e), s.default.chatList.sort((t = "updateTime", function (e, n) { var r = e[t], i = n[t]; return r > i ? -1 : r < i ? 1 : 0 })), console.log("common.chatList", s.default.chatList) }, onroamingmsgs: function (e) { console.log("收到漫游消息", e), s.default.msgs.push(e), s.default.msgs.map(function (e, t) { e.time = s.default.calcTimeHeader(e.time) }), console.log("common.msgs", s.default.msgs) }, onofflinemsgs: function (e) { console.log("收到离线消息", e); var t = !1; console.log("common.msgs", s.default.msgs), s.default.msgs.map(function (n, r) { var o; n.to == e.to && (t = !0, (o = s.default.msgs[r].msgs).push.apply(o, i(e.msgs))) }), 0 == t && s.default.msgs.push(e), console.log("common.msgs", s.default.msgs) }, onmsg: function (e) { var t = !1; console.log("收到消息", e.scene, e.type, e), s.default.msgs.map(function (n, r) { n.time = s.default.calcTimeHeader(n.time), n.to == e.from && (t = !0, s.default.msgs[r].msgs.push(e)) }), 0 == t && s.default.msgs.push(e) }, onmyinfo: function (e) { console.log("收到我的名片", e), s.default.myInfo = e }, onupdatemyinfo: function (e) { console.log("我的名片更新了", e) }, onusers: function (e) { console.log("收到用户资料列表", e) }, onupdateuser: function (e) { console.log("用户资料更新了", e) } }) } }).call(this, n(1).default) }, function(module, exports, __webpack_require__) { module.exports = function (e) { function t(r) { if (n[r]) return n[r].exports; var i = n[r] = { i: r, l: !1, exports: {} }; return e[r].call(i.exports, i, i.exports, t), i.l = !0, i.exports } var n = {}; return t.m = e, t.c = n, t.d = function (e, n, r) { t.o(e, n) || Object.defineProperty(e, n, { configurable: !1, enumerable: !0, get: r }) }, t.r = function (e) { Object.defineProperty(e, "__esModule", { value: !0 }) }, t.n = function (e) { var n = e && e.__esModule ? function () { return e.default } : function () { return e }; return t.d(n, "a", n), n }, t.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, t.p = "", t(t.s = 277) }([function (e, t, n) { var r, i = (r = n(2)) && r.__esModule ? r : { default: r }, o = n(87), s = n(86); n(178); var a, c, u = n(15), l = u.getGlobal(), m = /\s+/; u.deduplicate = function (e) { var t = []; return e.forEach(function (e) { -1 === t.indexOf(e) && t.push(e) }), t }, u.capFirstLetter = function (e) { return e ? (e = "" + e).slice(0, 1).toUpperCase() + e.slice(1) : "" }, u.guid = (a = function () { return (65536 * (1 + Math.random()) | 0).toString(16).substring(1) }, function () { return a() + a() + a() + a() + a() + a() + a() + a() }), u.extend = function (e, t, n) { for (var r in t) void 0 !== e[r] && !0 !== n || (e[r] = t[r]) }, u.filterObj = function (e, t) { var n = {}; return u.isString(t) && (t = t.split(m)), t.forEach(function (t) { e.hasOwnProperty(t) && (n[t] = e[t]) }), n }, u.copy = function (e, t) { return t = t || {}, e ? (Object.keys(e).forEach(function (n) { u.exist(e[n]) && (t[n] = e[n]) }), t) : t }, u.copyWithNull = function (e, t) { return t = t || {}, e ? (Object.keys(e).forEach(function (n) { (u.exist(e[n]) || u.isnull(e[n])) && (t[n] = e[n]) }), t) : t }, u.findObjIndexInArray = function (e, t) { e = e || []; var n = t.keyPath || "id", r = -1; return e.some(function (e, i) { if (s(e, n) === t.value) return r = i, !0 }), r }, u.findObjInArray = function (e, t) { var n = u.findObjIndexInArray(e, t); return -1 === n ? null : e[n] }, u.mergeObjArray = function () { var e = [], t = [].slice.call(arguments, 0, -1), n = arguments[arguments.length - 1]; u.isArray(n) && (t.push(n), n = {}); var r, i = n.keyPath = n.keyPath || "id"; for (n.sortPath = n.sortPath || i; !e.length && t.length;)e = (e = t.shift() || []).slice(0); return t.forEach(function (t) { t && t.forEach(function (t) { -1 !== (r = u.findObjIndexInArray(e, { keyPath: i, value: s(t, i) })) ? e[r] = u.merge({}, e[r], t) : e.push(t) }) }), n.notSort || (e = u.sortObjArray(e, n)), e }, u.cutObjArray = function (e) { var t = e.slice(0), n = arguments.length, r = [].slice.call(arguments, 1, n - 1), i = arguments[n - 1]; u.isObject(i) || (r.push(i), i = {}); var o, a = i.keyPath = i.keyPath || "id"; return r.forEach(function (e) { u.isArray(e) || (e = [e]), e.forEach(function (e) { e && (i.value = s(e, a), -1 !== (o = u.findObjIndexInArray(t, i)) && t.splice(o, 1)) }) }), t }, u.sortObjArray = function (e, t) { var n = (t = t || {}).sortPath || "id"; o.insensitive = !!t.insensitive; var r, i, a, c = !!t.desc; return a = u.isFunction(t.compare) ? t.compare : function (e, t) { return r = s(e, n), i = s(t, n), c ? o(i, r) : o(r, i) }, e.sort(a) }, u.emptyFunc = function () { }, u.isEmptyFunc = function (e) { return e === u.emptyFunc }, u.notEmptyFunc = function (e) { return e !== u.emptyFunc }, u.splice = function (e, t, n) { return [].splice.call(e, t, n) }, u.reshape2d = function (e, t) { if (Array.isArray(e)) { u.verifyParamType("type", t, "number", "util::reshape2d"); var n = e.length; if (n <= t) return [e]; for (var r = Math.ceil(n / t), i = [], o = 0; o < r; o++)i.push(e.slice(o * t, (o + 1) * t)); return i } return e }, u.flatten2d = function (e) { if (Array.isArray(e)) { var t = []; return e.forEach(function (e) { t = t.concat(e) }), t } return e }, u.dropArrayDuplicates = function (e) { if (Array.isArray(e)) { for (var t = {}, n = []; e.length > 0;)t[e.shift()] = !0; for (var r in t) !0 === t[r] && n.push(r); return n } return e }, u.onError = function (e) { throw new function (e) { "object" === (void 0 === e ? "undefined" : (0, i.default)(e)) ? (this.callFunc = e.callFunc || null, this.message = e.message || "UNKNOW ERROR") : this.message = e, this.time = new Date, this.timetag = +this.time }(e) }, u.verifyParamPresent = function (e, t, n, r) { n = n || ""; var i = !1; switch (u.typeOf(t)) { case "undefined": case "null": i = !0; break; case "string": "" === t && (i = !0); break; case "StrStrMap": case "object": Object.keys(t).length || (i = !0); break; case "array": t.length ? t.some(function (e) { if (u.notexist(e)) return i = !0, !0 }) : i = !0 }i && u.onParamAbsent(n + e, r) }, u.onParamAbsent = function (e, t) { u.onParamError("缺少参数 " + e + ", 请确保参数不是 空字符串、空对象、空数组、null或undefined, 或数组的内容不是 null/undefined", t) }, u.verifyParamAbsent = function (e, t, n, r) { n = n || "", void 0 !== t && u.onParamPresent(n + e, r) }, u.onParamPresent = function (e, t) { u.onParamError("多余的参数 " + e, t) }, u.verifyParamType = function (e, t, n, r) { var i = u.typeOf(t).toLowerCase(); u.isArray(n) || (n = [n]); var o = !0; switch (-1 === (n = n.map(function (e) { return e.toLowerCase() })).indexOf(i) && (o = !1), i) { case "number": isNaN(t) && (o = !1); break; case "string": "numeric or numeric string" === n.join("") && (o = !!/^[0-9]+$/.test(t)) }o || u.onParamInvalidType(e, n, "", r) }, u.onParamInvalidType = function (e, t, n, r) { n = n || "", t = u.isArray(t) ? (t = t.map(function (e) { return '"' + e + '"' })).join(", ") : '"' + t + '"', u.onParamError('参数"' + n + e + '"类型错误, 合法的类型包括: [' + t + "]", r) }, u.verifyParamValid = function (e, t, n, r) { u.isArray(n) || (n = [n]), -1 === n.indexOf(t) && u.onParamInvalidValue(e, n, r) }, u.onParamInvalidValue = function (e, t, n) { u.isArray(t) || (t = [t]), t = t.map(function (e) { return '"' + e + '"' }), u.isArray(t) && (t = t.join(", ")), u.onParamError("参数 " + e + "值错误, 合法的值包括: [" + JSON.stringify(t) + "]", n) }, u.verifyParamMin = function (e, t, n, r) { t < n && u.onParamError("参数" + e + "的值不能小于" + n, r) }, u.verifyParamMax = function (e, t, n, r) { t > n && u.onParamError("参数" + e + "的值不能大于" + n, r) }, u.verifyArrayMax = function (e, t, n, r) { t.length > n && u.onParamError("参数" + e + "的长度不能大于" + n, r) }, u.verifyEmail = (c = /^\S+@\S+$/, function (e, t, n) { c.test(t) || u.onParamError("参数" + e + "邮箱格式错误, 合法格式必须包含@符号, @符号前后至少要各有一个字符", n) }), u.verifyTel = function () { var e = /^[+\-()\d]+$/; return function (t, n, r) { e.test(n) || u.onParamError("参数" + t + "电话号码格式错误, 合法字符包括+、-、英文括号和数字", r) } }(), u.verifyBirth = function () { var e = /^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/; return function (t, n, r) { e.test(n) || u.onParamError("参数" + t + '生日格式错误, 合法为"yyyy-MM-dd"', r) } }(), u.onParamError = function (e, t) { u.onError({ message: e, callFunc: t }) }, u.verifyOptions = function (e, t, n, r, i) { if (e = e || {}, t && (u.isString(t) && (t = t.split(m)), u.isArray(t))) { "boolean" != typeof n && (i = n || null, n = !0, r = ""); var o = n ? u.verifyParamPresent : u.verifyParamAbsent; t.forEach(function (t) { o.call(u, t, e[t], r, i) }) } return e }, u.verifyParamAtLeastPresentOne = function (e, t, n) { t && (u.isString(t) && (t = t.split(m)), u.isArray(t) && (t.some(function (t) { return u.exist(e[t]) }) || u.onParamError("以下参数[" + t.join(", ") + "]至少需要传入一个", n))) }, u.verifyParamPresentJustOne = function (e, t, n) { t && (u.isString(t) && (t = t.split(m)), u.isArray(t) && 1 !== t.reduce(function (t, n) { return u.exist(e[n]) && t++ , t }, 0) && u.onParamError("以下参数[" + t.join(", ") + "]必须且只能传入一个", n)) }, u.verifyBooleanWithDefault = function (e, t, n, r, i) { u.undef(n) && (n = !0), m.test(t) && (t = t.split(m)), u.isArray(t) ? t.forEach(function (t) { u.verifyBooleanWithDefault(e, t, n, r, i) }) : void 0 === e[t] ? e[t] = n : u.isBoolean(e[t]) || u.onParamInvalidType(t, "boolean", r, i) }, u.verifyFileInput = function (e, t) { return u.verifyParamPresent("fileInput", e, "", t), u.isString(e) && ((e = "undefined" == typeof document ? void 0 : document.getElementById(e)) || u.onParamError("找不到要上传的文件对应的input, 请检查fileInput id " + e, t)), e.tagName && "input" === e.tagName.toLowerCase() && "file" === e.type.toLowerCase() || u.onParamError("请提供正确的 fileInput, 必须为 file 类型的 input 节点 tagname:" + e.tagName + ", filetype:" + e.type, t), e }, u.verifyFileType = function (e, t) { u.verifyParamValid("type", e, u.validFileTypes, t) }, u.verifyCallback = function (e, t, n) { m.test(t) && (t = t.split(m)), u.isArray(t) ? t.forEach(function (t) { u.verifyCallback(e, t, n) }) : e[t] ? u.isFunction(e[t]) || u.onParamInvalidType(t, "function", "", n) : e[t] = u.emptyFunc }, u.verifyFileUploadCallback = function (e, t) { u.verifyCallback(e, "uploadprogress uploaddone uploaderror uploadcancel", t) }, u.validFileTypes = ["image", "audio", "video", "file"], u.validFileExts = { image: ["bmp", "gif", "jpg", "jpeg", "jng", "png", "webp"], audio: ["mp3", "wav", "aac", "wma", "wmv", "amr", "mp2", "flac", "vorbis", "ac3"], video: ["mp4", "rm", "rmvb", "wmv", "avi", "mpg", "mpeg"] }, u.filterFiles = function (e, t) { var n, r, i = "file" === (t = t.toLowerCase()), o = []; return [].forEach.call(e, function (e) { i ? o.push(e) : (n = e.name.slice(e.name.lastIndexOf(".") + 1), (r = e.type.split("/"))[0] && r[1] && (r[0].toLowerCase() === t || -1 !== u.validFileExts[t].indexOf(n)) && o.push(e)) }), o }; var d, p, f = u.supportFormData = u.notundef(l.FormData); u.getFileName = function (e) { return e = u.verifyFileInput(e), f ? e.files[0].name : e.value.slice(e.value.lastIndexOf("\\") + 1) }, u.getFileInfo = (d = { ppt: 1, pptx: 2, pdf: 3 }, function (e) { var t = {}; if (!(e = u.verifyFileInput(e)).files) return t; var n = e.files[0]; return f && (t.name = n.name, t.size = n.size, t.type = n.name.match(/\.(\w+)$/), t.type = t.type && t.type[1].toLowerCase(), t.transcodeType = d[t.type] || 0), t }), u.sizeText = (p = ["B", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "BB"], function (e) { var t, n = 0; do { t = (e = Math.floor(100 * e) / 100) + p[n], e /= 1024, n++ } while (e > 1); return t }), u.promises2cmds = function (e) { return e.map(function (e) { return e.cmd }) }, u.objs2accounts = function (e) { return e.map(function (e) { return e.account }) }, u.teams2ids = function (e) { return e.map(function (e) { return e.teamId }) }, u.objs2ids = function (e) { return e.map(function (e) { return e.id }) }, u.getMaxUpdateTime = function (e) { var t = e.map(function (e) { return +e.updateTime }); return Math.max.apply(Math, t) }, u.genCheckUniqueFunc = function (e, t) { return e = e || "id", t = t || 1e3, function (t) { this.uniqueSet = this.uniqueSet || {}, this.uniqueSet[e] = this.uniqueSet[e] || {}; var n = this.uniqueSet[e], r = t[e]; return !n[r] && (n[r] = !0, !0) } }, u.fillPropertyWithDefault = function (e, t, n) { return !!u.undef(e[t]) && (e[t] = n, !0) }, e.exports = u }, function (e, t, n) { var r = { info: { hash: "e7b4b6715f0b7c292ab44d9e86d4f7c447e20434", shortHash: "e7b4b671", version: "6.8.0", sdkVersion: "70", nrtcVersion: "4.8.0", nrtcSdkVersion: "1", protocolVersion: 1 }, agentVersion: "2.8.0.906", lbsUrl: "https://lbs.netease.im/lbs/webconf.jsp", roomserver: "roomserver.netease.im", connectTimeout: 8e3, xhrTimeout: 8e3, socketTimeout: 8e3, reconnectionDelay: 1600, reconnectionDelayMax: 8e3, reconnectionJitter: .01, reconnectiontimer: null, heartbeatInterval: 8e3, cmdTimeout: 8e3, defaultReportUrl: "https://dr.netease.im/1.gif", isWeixinApp: !1, isNodejs: !1, isRN: !1, PUSHTOKEN: "", PUSHCONFIG: {}, CLIENTTYPE: 16, PushPermissionAsked: !1, iosPushConfig: null, androidPushConfig: null, netDetectAddr: "https://roomserver-dev.netease.im/v1/sdk/detect/local", optionDefaultLinkUrl: "", defaultLinkUrl: "weblink.netease.im", wxDefaultLinkUrl: "wlnimsc0.netease.im", getDefaultLinkUrl: function (e) { var t = r.optionDefaultLinkUrl || (r.isWeixinApp ? r.wxDefaultLinkUrl : r.defaultLinkUrl); if (!t) return !1; var n = e ? "https" : "http", i = e ? "443" : "80", o = t; return -1 === t.indexOf("http") && (o = n + "://" + o), -1 === t.indexOf(":") && (o = o + ":" + i), o } }; r.weixinNetcall = r.nrtcNetcall = { checkSumUrl: "https://nrtc.netease.im/demo/getChecksum.action", getChannelInfoUrl: "https://nrtc.netease.im/nrtc/getChannelInfos.action" }, r.formatSocketUrl = function (e) { var t = e.url, n = e.secure ? "https" : "http"; return -1 === t.indexOf("http") ? n + "://" + t : t }, r.uploadUrl = "https://nos.netease.com", r.chunkUploadUrl = null, r.commonMaxSize = 104857600, r.chunkSize = 4194304, r.chunkMaxSize = 4194304e4, r.replaceUrl = "https://{bucket}-nosdn.netease.im/{object}", r.downloadHost = "nos.netease.com", r.downloadUrl = "https://{bucket}-nosdn.netease.im/{object}", r.httpsEnabled = !1, r.threshold = 0, r.genUploadUrl = function (e) { return r.uploadUrl + "/" + e }, r.genChunkUploadUrl = function (e) { return r.chunkUploadUrl ? r.chunkUploadUrl + "/" + e.bucket + "/" + e.objectName : "" }, r.genDownloadUrl = function (e, t) { var n = e.bucket, i = (e.tag, e.expireSec), o = +new Date, s = i ? "&survivalTime=" + i : "", a = r.replaceUrl + "?createTime=" + o + s; return (a = r.genNosProtocolUrl(a)).replace("{bucket}", n).replace("{object}", t) }, r.genFileUrl = function (e) { var t = e.bucket, n = e.objectName; return r.genNosProtocolUrl(r.replaceUrl).replace("{bucket}", t).replace("{object}", n) }, r.genNosProtocolUrl = function (e) { return /^http/.test(e) ? r.httpsEnabled && 0 !== e.indexOf("https://") && (e = e.replace("http", "https")) : e = r.httpsEnabled ? "https://" + e : "http://" + e, e }, e.exports = r }, function (e, t, n) { function r(e) { return e && e.__esModule ? e : { default: e } } t.__esModule = !0; var i = r(n(124)), o = r(n(111)), s = "function" == typeof o.default && "symbol" == _typeof(i.default) ? function (e) { return void 0 === e ? "undefined" : _typeof(e) } : function (e) { return e && "function" == typeof o.default && e.constructor === o.default && e !== o.default.prototype ? "symbol" : void 0 === e ? "undefined" : _typeof(e) }; t.default = "function" == typeof o.default && "symbol" === s(i.default) ? function (e) { return void 0 === e ? "undefined" : s(e) } : function (e) { return e && "function" == typeof o.default && e.constructor === o.default && e !== o.default.prototype ? "symbol" : void 0 === e ? "undefined" : s(e) } }, function (e, t, n) { function r(e) { a.verifyOptions(e, "appKey account token", "protocol::IMProtocol"), a.verifyCallback(e, ["onconnect", "onerror", "onwillreconnect", "ondisconnect", "onloginportschange", "onmyinfo", "onblacklist", "onmutelist", "onfriends", "onusers", "onrobots", "onteams", "onSuperTeams", "onsessions", "onroamingmsgs", "onofflinemsgs", "onofflinefiltermsgs", "onroamingsysmsgs", "onofflinesysmsgs", "onofflinefiltersysmsgs", "onofflinecustomsysmsgs", "onofflinefiltercustomsysmsgs", "onbroadcastmsg", "onbroadcastmsgs", "onsysmsgunread", "onsyncdone", "onteammembers", "onsyncteammembersdone", "onmsg", "onsysmsg", "oncustomsysmsg", "onupdatemyinfo", "onupdateuser", "onUpdateSuperTeamMember", "onCreateSuperTeam", "onUpdateSuperTeam", "onAddSuperTeamMembers", "onRemoveSuperTeamMembers", "onUpdateSuperTeamManagers", "onDismissSuperTeam", "onTransferSuperTeam", "onUpdateSuperTeamManagers", "onUpdateSuperTeamMembersMute", "onupdateteammember", "onCreateTeam", "onUpdateTeam", "onAddTeamMembers", "onRemoveTeamMembers", "onUpdateTeamManagers", "onDismissTeam", "onTransferTeam", "onUpdateTeamMembersMute", "onTeamMsgReceipt", "onupdatesession", "onupdatesysmsgunread", "onupdatesysmsg", "onsynccreateteam", "onsyncsupercreateteam", "onsyncmarkinblacklist", "onsyncmarkinmutelist", "onsyncfriendaction", "shouldIgnoreNotification", "shouldCountNotifyUnread", "onPushNotificationMultiportConfig", "onPushNotificationMultiportConfigUpdate", "onpushevents"], "protocol::IMProtocol"), this.db = e.api.db = new i({ logger: e.logger }), o.call(this, e) } var i = n(16), o = n(25), s = (n(4), n(1)), a = n(0), c = a.undef, u = n(98), l = n(44), m = n(56), d = o.fn, p = r.fn = r.prototype = Object.create(d); p.init = function () { d.init.call(this), l.IM.setProtocol(this), this.parser = l.IM, this.sendCmd.bind(this), this.socketUrls = [], this.syncing = !0, this.hasSynced = !1, this.hasSyncedTeamMembers = !1, this.syncPromiseArray = [], this.syncResult = {}, this.syncTeamMembersPromiseArray = [], this.syncSuperTeamMembersPromiseArray = [], this.syncTeamMembersResult = {}, this.timetags = {}, this.superTeamMembersData = {}, this.sysMsgUnread = m.completeUnread({}), this.resetUnsettledMsgs(), this.resetUnsettledSysMsgs(), this.msgPromise = Promise.resolve(), this.sysMsgPromise = Promise.resolve(), this.sessionSet = {}, this.msgReceiptTasks = {}, this.userSet = {}, this.pushNotificationMultiportConfig = u.getDefaultConfig() }, p.reset = function () { d.reset.call(this); var e = this.options; this.db.reset(e.db), c(e.lbsUrl) && (e.lbsUrl = s.lbsUrl), this.resetAutoMarkRead() }, p.resetAutoMarkRead = function () { var e = this.options; a.verifyBooleanWithDefault(e, "autoMarkRead", !0, "", "protocol::resetAutoMarkRead") }, p.resetUnsettledMsgs = function () { this.unhandledMsgs = [], this.unupdatedMsgs = [] }, p.resetUnsettledSysMsgs = function () { this.unhandledSysMsgs = [], this.unupdatedSysMsgs = [] }, p.packetFromSync = function (e) { return !e.obj || !!e.obj.sync }, e.exports = r, n(264), n(263), n(262), n(253), n(251), n(250), n(249), n(248), n(247), n(246), n(245), n(244), n(243), n(242), n(235), n(234), n(233), n(232) }, function (e, t, n) { function r(e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; this.message = e || n.message || "", "object" === (void 0 === t ? "undefined" : (0, o.default)(t)) ? (this.event = t, this.code = "Other_Error") : void 0 !== t && (this.code = t), this.timetag = +new Date, void 0 !== n && (this.event = n), this.event && (this.callFunc = this.event.callFunc || null, delete this.event.callFunc) } var i, o = (i = n(2)) && i.__esModule ? i : { default: i }; r.prototype = Object.create(Error.prototype), r.prototype.name = "NIMError"; var s = { 201: "客户端版本不对, 需升级sdk", 302: "用户名或密码错误, 请检查appKey和token是否有效, account和token是否匹配", 403: "非法操作或没有权限", 404: "对象(用户/群/聊天室)不存在", 405: "参数长度过长", 408: "客户端请求超时", 414: "参数错误", 415: "服务不可用/没有聊天室服务器可分配", 416: "频率控制", 417: "重复操作", 422: "帐号被禁用", 500: "服务器内部错误", 501: "数据库操作失败", 503: "服务器繁忙", 508: "删除有效期过了", 509: "已失效", 7101: "被拉黑", 801: "群人数达到上限", 802: "没有权限", 803: "群不存在或未发生变化", 804: "用户不在群里面", 805: "群类型不匹配", 806: "创建群数量达到限制", 807: "群成员状态不对", 809: "已经在群里", 811: "强推列表中帐号数量超限", 812: "群被禁言", 813: "因群数量限制，部分拉人成功", 814: "禁止使用群组消息已读服务", 815: "群管理员人数上限", 997: "协议已失效", 998: "解包错误", 999: "打包错误", 9102: "通道失效", 9103: "已经在其他端接听/拒绝过这通电话", 11001: "对方离线, 通话不可送达", 13002: "聊天室状态异常", 13003: "在黑名单中", 13004: "在禁言名单中", 13006: "聊天室处于整体禁言状态,只有管理员能发言", Connect_Failed: "无法建立连接, 请确保能 ping/telnet 到云信服务器; 如果是IE8/9, 请确保项目部署在 HTTPS 环境下", Error_Internet_Disconnected: "网断了", Error_Connection_is_not_Established: "连接未建立", Error_Connection_Socket_State_not_Match: "socket状态不对", Error_Timeout: "超时", Param_Error: "参数错误", No_File_Selected: "请选择文件", Wrong_File_Type: "文件类型错误", File_Too_Large: "文件过大", Cross_Origin_Iframe: "不能获取跨域Iframe的内容", Not_Support: "不支持", NO_DB: "无数据库", DB: "数据库错误", Still_In_Team: "还在群里", Session_Exist: "会话已存在", Session_Not_Exist: "会话不存在", Error_Unknown: "未知错误", Operation_Canceled: "操作取消" };[200, 406, 808, 810].forEach(function (e) { s[e] = null }), r.genError = function (e) { var t = s[e]; return void 0 === t && (t = "操作失败"), null === t ? null : new r(t, e) }, r.multiInstance = function (e) { return new r("不允许初始化多个实例", "Not_Allow_Multi_Instance", e) }, r.newNetworkError = function (e) { var t = "Error_Internet_Disconnected"; return new r(s[t], t, e) }, r.newConnectError = function (e) { var t = "Connect_Failed"; return new r(s[t] || null, t, e) }, r.newConnectionError = function (e) { var t = "Error_Connection_is_not_Established"; return new r(s[t], t, e) }, r.newSocketStateError = function (e) { var t = "Error_Connection_Socket_State_not_Match"; return new r(s[t], t, e) }, r.newTimeoutError = function (e) { var t = "Error_Timeout"; return new r(s[t], t, e) }, r.newFrequencyControlError = function (e) { var t = new r(s[416], 416, e); return t.from = "local", t }, r.newParamError = function (e, t) { return new r(e || s.Param_Error, "Param_Error", t) }, r.newNoFileError = function (e, t) { var n = "No_File_Selected"; return new r(e || s[n], n, t) }, r.newWrongFileTypeError = function (e, t) { var n = "Wrong_File_Type"; return new r(e || s[n], n, t) }, r.newFileTooLargeError = function (e, t) { var n = "File_Too_Large"; return new r(e || s[n], n, t) }, r.newCORSIframeError = function (e) { var t = "Cross_Origin_Iframe"; return new r(s[t], t, e) }, r.newSupportError = function (e, t, n) { return new r("不支持" + e, "Not_Support_" + t, n) }, r.newSupportDBError = function (e) { return r.newSupportError("数据库", "DB", e) }, r.noDBError = function (e) { return new r(s.NO_DB, "NO_DB", e) }, r.newDBError = function (e) { return new r(s.DB, "DB", e) }, r.newUnknownError = function (e) { var t = "Error_Unknown"; return new r(s[t], t, e) }, r.stillInTeamError = function (e) { var t = "Still_In_Team"; return new r(s[t], t, e) }, r.sessionExist = function (e) { var t = "Session_Exist"; return new r(s[t], t, e) }, r.sessionNotExist = function (e) { var t = "Session_Not_Exist"; return new r(s[t], t, e) }, r.cancel = function (e) { var t = "Operation_Canceled"; return new r(s[t], t, e) }, r.customError = function (e, t) { e = e || "Other_Error"; var n = ""; return (t = t || {}).message || (n = s[e] || e), "object" !== (void 0 === e ? "undefined" : (0, o.default)(e)) ? new r(n, e, t) : new r(n, "Other_Error", void 0 === t ? e : t) }, e.exports = r }, function (e, t, n) { var r = n(38)("wks"), i = n(28), o = n(7).Symbol, s = "function" == typeof o; (e.exports = function (e) { return r[e] || (r[e] = s && o[e] || (s ? o : i)("Symbol." + e)) }).store = r }, function (e, t, n) { function r(e) { return this.subType = "im", this.nosScene = e.nosScene || "im", this.nosSurvivalTime = e.nosSurvivalTime, e.Protocol = o, e.Message = a, e.constructor = r, this.init(e) } var i = n(12), o = n(3), s = n(1), a = n(231), c = n(44).IM; r.Protocol = o, r.parser = c, r.use = i.use, r.getInstance = i.getInstance, r.rmAllInstances = i.rmAllInstances, r.genInstanceName = function (e) { return "NIM-account-" + e.account }; var u = r.fn = r.prototype = Object.create(i.prototype); r.info = u.info = s.info, e.exports = r, n(221), n(220), n(219), n(218), n(217), n(216), n(215), n(214), n(213), n(212), n(211), n(210), n(209), n(208), n(207), n(206), n(205), n(204) }, function (e, t) { var n = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); "number" == typeof __g && (__g = n) }, function (e, t, n) { var r = n(19), i = n(67), o = n(40), s = Object.defineProperty; t.f = n(11) ? Object.defineProperty : function (e, t, n) { if (r(e), t = o(t, !0), r(n), i) try { return s(e, t, n) } catch (e) { } if ("get" in n || "set" in n) throw TypeError("Accessors not supported!"); return "value" in n && (e[t] = n.value), e } }, function (e, t) { var n = e.exports = { version: "2.5.5" }; "number" == typeof __e && (__e = n) }, function (e, t) { var n = {}.hasOwnProperty; e.exports = function (e, t) { return n.call(e, t) } }, function (e, t, n) { e.exports = !n(23)(function () { return 7 != Object.defineProperty({}, "a", { get: function () { return 7 } }).a }) }, function (e, t, n) { function r() { } var i, o = (i = n(2)) && i.__esModule ? i : { default: i }, s = n(179), a = n(0), c = a.notundef, u = n(177), l = n(1), m = {}; r.getInstance = function (e) { e = p(e), a.verifyOptions(e, "account", "api::Base.getInstance"); var t = this.genInstanceName(e), n = m[t]; return n ? r.updateInstance(n, e) : n = m[t] = new this(e), n }, r.updateInstance = function (e, t) { e.setOptions(t), e.connect() }; var d = r.fn = r.prototype = Object.create(new s), p = function (e) { return e.nosSurvivalTime ? (a.verifyParamType("nosSurvivalTime", e.nosSurvivalTime, "number", "api::Base.getInstance"), a.verifyParamMin("nosSurvivalTime", e.nosSurvivalTime, 86400, "api::Base.getInstance")) : e.nosSurvivalTime = 1 / 0, e }; d.updatePrivateConf = function (e) { if (e && "object" === (0, o.default)(e.privateConf)) { var t = e.privateConf; "string" == typeof t.lbs_web && (e.lbsUrl = t.lbs_web), "boolean" == typeof t.link_ssl_web && (e.secure = t.link_ssl_web), "boolean" == typeof t.https_enabled && (e.httpsEnabled = t.https_enabled), e.uploadUrl = t.nos_uploader_web ? t.nos_uploader_web : null, e.chunkUploadUrl = t.nos_uploader_web ? t.nos_uploader_web : null, e.replaceUrl = t.nos_downloader ? t.nos_downloader : null, e.downloadUrl = t.nos_accelerate ? t.nos_accelerate : null, e.downloadHost = t.nos_accelerate_host ? t.nos_accelerate_host : null, e.ntServerAddress = t.nt_server || null, e.kibanaServer = t.kibana_server, e.statisticServer = t.statistic_server, e.reportGlobalServer = t.report_global_server } return null === e.ntServerAddress || "" === e.ntServerAddress ? l.ntServerAddress = null : l.ntServerAddress = e.ntServerAddress || l.defaultReportUrl, l.uploadUrl = e.uploadUrl || l.uploadUrl, l.chunkUploadUrl = e.chunkUploadUrl || l.chunkUploadUrl, l.downloadUrl = e.downloadUrl || l.downloadUrl, l.downloadHost = e.downloadHost || l.downloadHost, l.replaceUrl = e.replaceUrl || l.replaceUrl, l.httpsEnabled = e.httpsEnabled || l.httpsEnabled, e }, d.init = function (e) { a.verifyOptions(e, "account", "api::Base.init"), e = this.updatePrivateConf(e); var t = this.account = e.account = e.account + "", n = e.constructor.genInstanceName(e), i = m[n]; if (e._disableSingleton && (i = null), i) return r.updateInstance(i, e), i; this.name = n, m[n] = this, this.logger = e.logger = new u({ debug: e.debug, logFunc: e.logFunc, prefix: this.subType }), e.api = this; var o = this.protocol = new e.Protocol(e); return o.name = "Protocol-" + n, o.account = t, o.api = this, o.message = this.message = new e.Message({ account: t }), this.options = a.copy(e), this.reset(), this }, d.destroy = function (e) { var t = this, n = this.protocol.reconnectTimer; e = e || {}; var r = this.name; r && (this.protocol && this.protocol.resetPush && this.protocol.resetPush(), this.disconnect({ done: function (i) { t.logger.warn("ApiBase::destroy: instance destroyed ..."), Object.getOwnPropertyNames(t).forEach(function (e) { delete t[e] }), m && (delete m[r], m[r] = null, clearTimeout(n)), e.done instanceof Function && e.done(i) } })) }, d.reset = function () { var e = this.updatePrivateConf(this.options); a.verifyBooleanWithDefault(e, "exifOrientation", !0, "", "api::Base.reset") }, d.setOptions = function (e) { this.reset(), this.protocol.setOptions(e) }, d.processCallback = function (e, t) { f(e, t) }, d.processCallbackPromise = function (e, t) { return new Promise(function (n, r) { f(e, t, !0, n, r) }) }; var f = function (e, t, n, r, i) { var o = "api::processCallback"; n && (o = "api::processCallbackPromise"), a.verifyCallback(e, "done", o), e.callback = function (s, u, l) { var m = e.callback.options; if (u = u || m, t && (u = m), a.isFunction(e.cbaop)) { var d = e.cbaop(s, u); c(d) && (u = d) } var p = e.done; a.isObject(u) && (delete u.done, delete u.cb, delete u.callback), n ? s ? i({ message: "生成接口回调错误", callFunc: o, event: s }) : r(u) : p(s, u, l) }, e.callback.options = a.copy(e) }; d.processPs = function (e) { a.notexist(e.ps) && (e.ps = "") }, d.processCustom = function (e) { a.notexist(e.custom) && (e.custom = "") }, d.sendCmd = function () { this.protocol.sendCmd.apply(this.protocol, arguments) }, d.sendCmdWithResp = function (e, t, n) { this.sendCmd(e, t, function (e, t, r) { a.isFunction(n) && (e ? n(e, t) : n(null, r)) }) }, d.cbAndSendCmd = function (e, t) { var n = this.processCallbackPromise(t); return this.sendCmd(e, t), n }, d.sendCmdUsePromise = function (e, t) { var n = this; return new Promise(function (r, i) { n.sendCmd(e, t, function (e, t, n) { if (e) i(e); else { var o = a.merge({}, t, n); r(o) } }) }) }, r.use = function (e, t) { e && e.install && a.isFunction(e.install) && e.install(this, t) }, r.rmAllInstances = function () { for (var e in m) m[e].destroy(); m = {} }, d.logout = function (e) { this.protocol.shouldReconnect = !1, this.protocol.doLogout = !0, this.processCallback(e), this.sendCmd("logout", e, e.callback) }, e.exports = r, n(169), n(168), n(165), n(164), n(163), n(162), n(161) }, function (e, t, n) { var r = n(70), i = n(42); e.exports = function (e) { return r(i(e)) } }, function (e, t, n) { var r = n(8), i = n(27); e.exports = n(11) ? function (e, t, n) { return r.f(e, t, i(1, n)) } : function (e, t, n) { return e[t] = n, e } }, function (e, t, n) { (function (e) { function r() { return "undefined" != typeof window ? window : void 0 !== e ? e : {} } function i(e, t) { t = t || 2; for (var n = "" + e; n.length < t;)n = "0" + n; return n } function o(e) { return "" + e.getFullYear() } function s(e) { return i(e.getMonth() + 1) } function a(e) { return i(e.getDate()) } function c(e) { return i(e.getHours()) } function u(e) { return i(e.getMinutes()) } function l(e) { return i(e.getSeconds()) } function m(e) { return i(e.getMilliseconds(), 3) } function d(e) { return Object.prototype.toString.call(e).slice(8, -1) } function p(e) { return d(e).toLowerCase() } function f(e) { return "string" === p(e) } function g(e) { return "array" === p(e) } function h(e) { return "function" === p(e) } function y(e) { return "date" === p(e) } function v(e) { return null === e } function b(e) { return null !== e } function T(e) { return void 0 === e } function M(e) { return void 0 !== e } function S(e) { return M(e) && b(e) } function k(e) { return T(e) || v(e) } function _(e) { return S(e) && "object" === p(e) } function w() { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : function () { }, n = arguments[2]; for (var r in e) e.hasOwnProperty(r) && t.call(n, r, e[r]) } function P(e, t) { w(t, function (t, n) { e[t] = n }) } function C(e) { return f(e) && 0 === e.indexOf("{") && e.lastIndexOf("}") === e.length - 1 } function I(e, t, n) { if (!e) return ""; var r = []; return w(e, function (e, t) { h(t) || (y(t) ? t = t.getTime() : g(t) ? t = t.join(",") : _(t) && (t = JSON.stringify(t)), n && (t = encodeURIComponent(t)), r.push(encodeURIComponent(e) + "=" + t)) }), r.join(t || ",") } function O(e) { var t = r(); return e.tagName && "INPUT" === e.tagName.toUpperCase() || t.Blob && e instanceof t.Blob } Object.defineProperty(t, "__esModule", { value: !0 }), t.url2origin = t.uniqueID = t.off = t.removeEventListener = t.on = t.addEventListener = t.format = t.regWhiteSpace = t.regBlank = t.emptyFunc = t.f = t.emptyObj = t.o = void 0; var A, x, E, j = (A = n(2)) && A.__esModule ? A : { default: A }; t.getGlobal = r, t.detectCSSFeature = function (e) { var t = !1, n = "Webkit Moz ms O".split(" "); if ("undefined" != typeof document) { var r = document.createElement("div"), i = null; if (e = e.toLowerCase(), void 0 !== r.style[e] && (t = !0), !1 === t) { i = e.charAt(0).toUpperCase() + e.substr(1); for (var o = 0; o < n.length; o++)if (void 0 !== r.style[n[o] + i]) { t = !0; break } } return t } console.log("error:fn:detectCSSFeature document is undefined") }, t.fix = i, t.getYearStr = o, t.getMonthStr = s, t.getDayStr = a, t.getHourStr = c, t.getMinuteStr = u, t.getSecondStr = l, t.getMillisecondStr = m, t.dateFromDateTimeLocal = function (e) { return e = "" + e, new Date(e.replace(/-/g, "/").replace("T", " ")) }, t.getClass = d, t.typeOf = p, t.isString = f, t.isNumber = function (e) { return "number" === p(e) }, t.isBoolean = function (e) { return "boolean" === p(e) }, t.isArray = g, t.isFunction = h, t.isDate = y, t.isRegExp = function (e) { return "regexp" === p(e) }, t.isError = function (e) { return "error" === p(e) }, t.isnull = v, t.notnull = b, t.undef = T, t.notundef = M, t.exist = S, t.notexist = k, t.isObject = _, t.isEmpty = function (e) { return k(e) || (f(e) || g(e)) && 0 === e.length }, t.containsNode = function (e, t) { if (e === t) return !0; for (; t.parentNode;) { if (t.parentNode === e) return !0; t = t.parentNode } return !1 }, t.calcHeight = function (e) { var t = e.parentNode || ("undefined" == typeof document ? null : document.body); if (!t) return 0; (e = e.cloneNode(!0)).style.display = "block", e.style.opacity = 0, e.style.height = "auto", t.appendChild(e); var n = e.offsetHeight; return t.removeChild(e), n }, t.remove = function (e) { e.parentNode && e.parentNode.removeChild(e) }, t.dataset = function (e, t, n) { if (!S(n)) return e.getAttribute("data-" + t); e.setAttribute("data-" + t, n) }, t.target = function (e) { return e.target || e.srcElement }, t.createIframe = function (e) { if ("undefined" != typeof document) { var t; if ((e = e || {}).name) try { (t = document.createElement('<iframe name="' + e.name + '"></iframe>')).frameBorder = 0 } catch (n) { (t = document.createElement("iframe")).name = e.name } else t = document.createElement("iframe"); e.visible || (t.style.display = "none"), h(e.onload) && F(t, "load", function n(r) { t.src && (e.multi || D(t, "load", n), e.onload(r)) }), (e.parent || document.body).appendChild(t); var n = e.src || "about:blank"; return setTimeout(function () { t.src = n }, 0), t } }, t.html2node = function (e) { if ("undefined" != typeof document) { var t = document.createElement("div"); t.innerHTML = e; var n = [], r = void 0, i = void 0; if (t.children) for (r = 0, i = t.children.length; r < i; r++)n.push(t.children[r]); else for (r = 0, i = t.childNodes.length; r < i; r++) { var o = t.childNodes[r]; 1 === o.nodeType && n.push(o) } return n.length > 1 ? t : n[0] } }, t.scrollTop = function (e) { return "undefined" != typeof document && S(e) && (document.documentElement.scrollTop = document.body.scrollTop = e), window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0 }, t.forOwn = w, t.mixin = P, t.isJSON = C, t.parseJSON = function e(t) { try { C(t) && (t = JSON.parse(t)), _(t) && w(t, function (n, r) { switch (p(r)) { case "string": case "object": t[n] = e(r) } }) } catch (e) { console.log("error:", e) } return t }, t.simpleClone = function (e) { var t = [], n = JSON.stringify(e, function (e, n) { if ("object" === (void 0 === n ? "undefined" : (0, j.default)(n)) && null !== n) { if (-1 !== t.indexOf(n)) return; t.push(n) } return n }); return JSON.parse(n) }, t.merge = function () { for (var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = arguments.length, n = Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++)n[r - 1] = arguments[r]; return n.forEach(function (t) { P(e, t) }), e }, t.fillUndef = function (e, t) { return w(t, function (t, n) { T(e[t]) && (e[t] = n) }), e }, t.checkWithDefault = function (e, t, n) { var r = e[t] || e[t.toLowerCase()]; return k(r) && (r = n, e[t] = r), r }, t.fetch = function (e, t) { return w(e, function (n, r) { S(t[n]) && (e[n] = t[n]) }), e }, t.string2object = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "", t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : ",", n = {}; return e.split(t).forEach(function (e) { var t = e.split("="), r = t.shift(); r && (n[decodeURIComponent(r)] = decodeURIComponent(t.join("="))) }), n }, t.object2string = I, t.genUrlSep = function (e) { return e.indexOf("?") < 0 ? "?" : "&" }, t.object2query = function (e) { return I(e, "&", !0) }, t.isFileInput = O, t.getKeys = function (e, t) { var n = Object.keys(e); return t && n.sort(function (t, n) { var r = O(e[t]); return r === O(e[n]) ? 0 : r ? 1 : -1 }), n }, t.o = {}, t.emptyObj = {}, t.f = function () { }, t.emptyFunc = function () { }, t.regBlank = /\s+/gi, t.regWhiteSpace = /\s+/gi, t.format = (x = /yyyy|MM|dd|hh|mm|ss|SSS/g, E = { yyyy: o, MM: s, dd: a, hh: c, mm: u, ss: l, SSS: m }, function (e, t) { return e = new Date(e), isNaN(+e) ? "invalid date" : (t = t || "yyyy-MM-dd").replace(x, function (t) { return E[t](e) }) }); var U, R = t.addEventListener = function (e, t, n) { e.addEventListener ? e.addEventListener(t, n, !1) : e.attachEvent && e.attachEvent("on" + t, n) }, F = t.on = R, N = t.removeEventListener = function (e, t, n) { e.removeEventListener ? e.removeEventListener(t, n, !1) : e.detachEvent && e.detachEvent("on" + t, n) }, D = t.off = N; t.uniqueID = (U = 0, function () { return "" + U++ }), t.url2origin = function () { var e = /^([\w]+?:\/\/.*?(?=\/|$))/i; return function (t) { return e.test(t || "") ? RegExp.$1.toLowerCase() : "" } }() }).call(this, n(48)) }, function (e, t, n) { var r = n(276); r.fn = r.prototype, e.exports = r, n(275), n(274), n(273), n(272), n(271), n(270), n(269), n(268), n(267), n(266), n(265) }, function (e, t, n) { var r = n(45), i = n(172), o = n(171), s = n(170); r.json = i, r.upload = o, r.chunkUpload = s, e.exports = r }, function (e, t) { e.exports = function (e) { return "object" == (void 0 === e ? "undefined" : _typeof(e)) ? null !== e : "function" == typeof e } }, function (e, t, n) { var r = n(18); e.exports = function (e) { if (!r(e)) throw TypeError(e + " is not an object!"); return e } }, function (e, t, n) { t.__esModule = !0; var r, i = (r = n(69)) && r.__esModule ? r : { default: r }; t.default = function () { function e(e, t) { for (var n = 0; n < t.length; n++) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), (0, i.default)(e, r.key, r) } } return function (t, n, r) { return n && e(t.prototype, n), r && e(t, r), t } }() }, function (e, t, n) { t.__esModule = !0, t.default = function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } }, function (e, t, n) { var r = n(0), i = { init: function () { i.deviceId = r.guid() } }; i.init(), i.clientTypeMap = { 1: "Android", 2: "iOS", 4: "PC", 8: "WindowsPhone", 16: "Web", 32: "Server", 64: "Mac" }, i.db = { open: function () { } }, e.exports = i }, function (e, t) { e.exports = function (e) { try { return !!e() } catch (e) { return !0 } } }, function (e, t, n) { var r = n(7), i = n(9), o = n(71), s = n(14), a = n(10), c = function e(t, n, c) { var u, l, m, d = t & e.F, p = t & e.G, f = t & e.S, g = t & e.P, h = t & e.B, y = t & e.W, v = p ? i : i[n] || (i[n] = {}), b = v.prototype, T = p ? r : f ? r[n] : (r[n] || {}).prototype; for (u in p && (c = n), c) (l = !d && T && void 0 !== T[u]) && a(v, u) || (m = l ? T[u] : c[u], v[u] = p && "function" != typeof T[u] ? c[u] : h && l ? o(m, r) : y && T[u] == m ? function (e) { var t = function (t, n, r) { if (this instanceof e) { switch (arguments.length) { case 0: return new e; case 1: return new e(t); case 2: return new e(t, n) }return new e(t, n, r) } return e.apply(this, arguments) }; return t.prototype = e.prototype, t }(m) : g && "function" == typeof m ? o(Function.call, m) : m, g && ((v.virtual || (v.virtual = {}))[u] = m, t & e.R && b && !b[u] && s(b, u, m))) }; c.F = 1, c.G = 2, c.S = 4, c.P = 8, c.B = 16, c.W = 32, c.U = 64, c.R = 128, e.exports = c }, function (e, t, n) { function r(e) { i.undef(e.secure) && (e.secure = !0), this.options = i.copy(e), this.keepNosSafeUrl = this.options.keepNosSafeUrl || !1, i.notundef(e.defaultLinkUrl) && i.isString(e.defaultLinkUrl) ? o.optionDefaultLinkUrl = this.options.defaultLinkUrl.trim() : o.optionDefaultLinkUrl = "", this.init(), this.connect(), this.initConnecting = !0 } var i = n(0), o = n(1), s = n(4), a = r.fn = r.prototype; a.init = function () { this.logger = this.options.logger, this.getNosOriginUrlReqNum = 0, this.checkNosReqNum = 0, this.cmdTaskArray = [], this.timerMap = {}, this.cmdCallbackMap = {}, this.cmdContentMap = {}, this.initConnect(), this.reset() }, a.reset = function () { this.resetConnect() }, a.setOptions = function (e) { var t = this.options, n = Object.keys(t), r = n.indexOf("account"); -1 !== r && n.splice(r, 1), e = i.filterObj(e, n), this.options = i.merge(t, e), this.reset() }, a.sendCmd = function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "", n = arguments[2]; this.heartbeat(), "heartbeat" !== e && this.logger.warn("protocol::sendCmd: " + e, t); var r, i = e, o = (e = this.parser.createCmd(e, t)).SER; t = t || {}, this.cmdContentMap[o] = t, t.single && (delete t.single, 1 === (r = Object.keys(t)).length && (this.cmdContentMap[o] = t[r[0]])), t.NOTSTORE && ((r = t.NOTSTORE.split(" ")).forEach(function (e) { delete t[e] }), delete t.NOTSTORE), (n = n || t.callback) && (this.cmdCallbackMap[o] = n), this.cmdTaskArray.push({ cmdName: i, cmd: JSON.stringify(e) }), this.startCmdTaskTimer() }, a.startCmdTaskTimer = function () { var e = this; e.cmdTaskTimer || (e.cmdTaskTimer = setTimeout(function () { var t = e.cmdTaskArray.shift(); e.cmdTaskTimer = null, t && e.executeCmdTask(t), e.cmdTaskArray.length && e.startCmdTaskTimer() }, 0)) }, a.executeCmdTask = function (e) { var t = e.cmdName, n = e.cmd, r = (n = JSON.parse(n)).SER; this.isFrequencyControlled(t) ? (this.logger.warn("protocol::executeCmdTask: " + t + " hit freq control"), this.markCallbackInvalid(r, s.newFrequencyControlError({ callFunc: "protocol::executeCmdTask", message: t + " hit freq control" }))) : this.isConnected() ? ("heartbeat" !== t && this.logger.log("protocol::sendCmd: " + t + " " + JSON.stringify(n)), this.doSendCmd(n)) : (this.logger.warn("protocol::executeCmdTask: " + t + " not connected"), this.markCallbackInvalid(r, s.newSocketStateError({ callFunc: "protocol::executeCmdTask", message: t + " not connected" }))) }, a.isFrequencyControlled = function (e) { var t = this.frequencyControlMap && this.frequencyControlMap[e]; if (t) { if (Date.now() < t.from + t.duration) return !0; delete this.frequencyControlMap[e] } }, a.doSendCmd = function (e) { function t() { n.markCallbackInvalid(r, s.newSocketStateError({ callFunc: "protocol::doSendCmd", message: "ser " + r + " socketSendJson Error" })), n.onDisconnect(!0, "protocol::doSendCmd:socketSendJson") } var n = this, r = e.SER; n.timerMap[r] = setTimeout(function () { n.markCallbackInvalid(r, s.newTimeoutError({ callFunc: "protocol::doSendCmd", message: "ser " + r + " Timeout Error" })) }, o.cmdTimeout); try { n.socket && n.socket.send ? n.socket.send(JSON.stringify(e)) : t() } catch (e) { t() } }, a.getObjWithSer = function (e) { var t = this.cmdContentMap[e]; return t && !t.isImSyncDataObj && delete this.cmdContentMap[e], t && i.copy(t) }, a.getCallbackWithSer = function (e) { var t = this.cmdCallbackMap[e]; return t && !t.isImSyncDataCb && delete this.cmdCallbackMap[e], t }, a.getTimerWithSer = function (e) { var t = this.timerMap[e]; return delete this.timerMap[e], t }, a.clearTimerWithSer = function (e) { var t = this.getTimerWithSer(e); t && clearTimeout(t) }, a.markCallbackInvalid = function (e, t) { this.getObjWithSer(e), this.clearTimerWithSer(e); var n = this.getCallbackWithSer(e); if (n) { var r = n.options; setTimeout(function () { n(t || s.newUnknownError({ ser: e }), r) }, 0) } }, a.markAllCallbackInvalid = function (e) { var t = this; Object.keys(this.cmdCallbackMap).forEach(function (n) { t.markCallbackInvalid(n, e) }) }, a.getPacketObj = function (e) { var t = null; if (e && e.raw) { var n = e.raw.ser; i.notundef(n) && (t = this.getObjWithSer(n)) } return t }, a.callPacketAckCallback = function (e) { var t = this; if (e && e.raw) { var n = e.raw.ser; if (i.notundef(n)) { t.clearTimerWithSer(n); var r = t.getCallbackWithSer(n); r && (r.originUrl && e.obj && e.obj.file && (e.obj.file._url_safe = e.obj.file.url, e.obj.file.url = r.originUrl, "audio" === e.obj.type && (e.obj.file.mp3Url = r.originUrl + (~r.originUrl.indexOf("?") ? "&" : "?") + "audioTrans&type=mp3")), e.promise ? e.promise.then(function () { r(e.error, e.obj) }, function (i) { i.callFunc = "protocol::callPacketAckCallback", i.message = "Resp Promoise Error: cmd: " + e.cmd + ", ser: " + n; var o = s.customError("CALLBACK_ACK_ERR", i); t.logger.error("protocol::callPacketAckCallback: promise error " + JSON.stringify(i)), r(o, e.obj, e.content) }) : r(e.error, e.obj, e.content)) } } }, a.onMessage = function (e) { var t = this; t.heartbeat(), t.parser.parseResponse(e).then(function (e) { e.notFound && t.logger.warn("protocol::onMessage: packet not found " + JSON.stringify(e)), e.error ? (e.error.message = e.cmd + " error: " + e.error.message, t.logger.error("protocol::onMessage: packet error " + JSON.stringify(e.error))) : e.content || "heartbeat" === e.cmd || t.logger.warn("protocol::onMessage: packet.content undefined " + JSON.stringify(e)), e.frequencyControlDuration && (t.logger.error("protocol::onMessage: server freq control " + JSON.stringify(e.cmd)), t.frequencyControlMap = t.frequencyControlMap || {}, t.frequencyControlMap[e.cmd] = { from: +new Date, duration: e.frequencyControlDuration }), e.obj = t.getPacketObj(e), "heartbeat" !== e.cmd && "getClientAntispam" !== e.cmd && t.logger.log("protocol::recvCmd: " + e.cmd + " " + e.rawStr); var n = "process" + i.capFirstLetter(e.service); if (t[n]) if ("heartbeat" !== e.cmd && t.logger.warn("protocol::recvCmd: " + e.cmd + " " + n, e.content), "syncDone" === e.cmd) { if (t.cmdCallbackMap[e.raw.ser] && t.cmdCallbackMap[e.raw.ser].isImSyncDataCb) { t.cmdCallbackMap[e.raw.ser].isImSyncDataCb = !1; var r = function (e, t) { this.checkNosReqNum++ , this.getNosOriginUrlReqNum <= 0 || this.checkNosReqNum >= 10 ? this[e](t) : setTimeout(r, 300) }.bind(t, n, e); r.call(t, n, e) } } else t[n](e); else t.logger.warn("protocol::onMessage: " + n + " not found"); t.callPacketAckCallback(e) }) }, a.onMiscError = function (e, t, n) { t && this.notifyError(e, t, n) }, a.onCustomError = function (e, t) { var n = s.customError(e, t), r = t.message || "未知错误"; this.onMiscError(r, n) }, a.notifyError = function (e, t, n) { this.isConnected() && (this.logger.error((e || "") + " " + this.name, t, n), this.options.onerror(t, n)) }, a.emitAPI = function (e) { var t = e.type, n = e.obj; this.api.emit(t, n) }, e.exports = r, n(160), n(157), n(151), n(150), n(149) }, function (e, t) { e.exports = {} }, function (e, t) { e.exports = function (e, t) { return { enumerable: !(1 & e), configurable: !(2 & e), writable: !(4 & e), value: t } } }, function (e, t) { var n = 0, r = Math.random(); e.exports = function (e) { return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++n + r).toString(36)) } }, function (e, t, n) { var r = n(1), i = { genUrlSep: function (e) { return -1 === (e = "" + e).indexOf("?") ? "?imageView&" : "&" }, urlQuery2Object: function (e) { if ("[object String]" !== Object.prototype.toString.call(e) || "" === e) return {}; var t = e.indexOf("?"); if (-1 !== t) { var n = e.slice(t + 1).split("&"), r = {}; return n.forEach(function (e) { if (~e.indexOf("=")) { var t = e.split("="); r[t[0]] = decodeURIComponent(t[1]) } else r[e] = "" }), r } }, url2object: function (e) { "[object String]" !== Object.prototype.toString.call(e) && (e = ""); var t = (e = e || "").indexOf("https") >= 0 ? "https://" : "http://", n = e.replace(t, ""); n.indexOf("?") >= 0 && (n = n.substring(0, n.indexOf("?"))); var r = n.split("/"); n = r[0]; var i = ""; if (r.length > 0 && (i = r.slice(1).join("/")), -1 === e.indexOf("?")) return { protocol: t, hostname: n, path: i, query: {} }; var o = e.substr(e.indexOf("?") + 1).split("&"), s = {}; return o.forEach(function (e) { if (e.indexOf("=") > 0) { var t = e.split("="); s[t[0]] = decodeURIComponent(t[1]) } else s[e] = "" }), { protocol: t, hostname: n, path: i, query: s } }, object2url: function (e) { var t = e.protocol, n = e.hostname, r = e.path, i = e.query; t = t || "http://", n = n || "", r && (n = n + "/" + r), i = i || {}; var o = []; for (var s in i) "imageView" !== s && o.push(s + "=" + encodeURIComponent(i[s])); return o.length > 0 ? "" + t + n + "?imageView&" + o.join("&") : "" + t + n }, genPrivateUrl: function (e) { var t = i.url2object(e), n = t.hostname, o = t.path, s = r.downloadHost, a = r.downloadUrl; if (n === s) { var c = o.indexOf("/"); if (-1 !== c) { var u = o.substring(0, c), l = o.substring(c + 1); return a.replace("{bucket}", u).replace("{object}", l) } } else if (n && "[object String]" == Object.prototype.toString.call(n) && ~n.indexOf(s)) { var m = t.path, d = m.indexOf("."); if (-1 !== d) { var p = m.substring(0, d), f = m; return a.replace("{bucket}", p).replace("{object}", f) } } return e } }; e.exports = i }, function (e, t) { t.f = {}.propertyIsEnumerable }, function (e, t, n) { var r = n(64), i = n(37); e.exports = Object.keys || function (e) { return r(e, i) } }, , function (e, t, n) { function r(e) { s.verifyOptions(e, "scene to type", "msg::Message"), s.verifyParamValid("scene", e.scene, g, "msg::Message"), this.scene = p[e.scene], this.to = "" + e.to, this.type = h[e.type], this.resend = e.resend ? 1 : 0, e.resend ? (s.verifyOptions(e, "idClient", "msg::Message"), this.idClient = e.idClient) : this.idClient = s.guid(), c(e.text) && (this.body = "" + e.text), c(e.custom) && ("object" === (0, o.default)(e.custom) ? this.custom = JSON.stringify(e.custom) : this.custom = "" + e.custom), c(e.body) && (this.body = "" + e.body), c(e.pushContent) && (this.pushContent = "" + e.pushContent), c(e.pushPayload) && (this.pushPayload = "" + e.pushPayload); var t = e.apns; if (c(t) && "team" === e.scene) { var n = t.accounts; c(n) && s.verifyParamType("apns.accounts", n, "array", "msg::Message"), this.apnsAccounts = n ? JSON.stringify(n) : d, this.apnsContent = t.content || e.pushContent || "", s.verifyBooleanWithDefault(t, "forcePush", !0, "options.apns", "msg::Message"), this.apnsForcePush = t.forcePush ? 1 : 0 } c(e.isHistoryable) && (this.isHistoryable = e.isHistoryable ? 1 : 0), c(e.isRoamingable) && (this.isRoamingable = e.isRoamingable ? 1 : 0), c(e.isSyncable) && (this.isSyncable = e.isSyncable ? 1 : 0), c(e.cc) && (this.cc = e.cc ? 1 : 0), c(e.isPushable) && (this.isPushable = e.isPushable ? 1 : 0), c(e.isOfflinable) && (this.isOfflinable = e.isOfflinable ? 1 : 0), c(e.isUnreadable) && (this.isUnreadable = e.isUnreadable ? 1 : 0), c(e.needPushNick) && (this.needPushNick = e.needPushNick ? 1 : 0), c(e.needMsgReceipt) && (this.needMsgReceipt = e.needMsgReceipt ? 1 : 0), c(e.yidunEnable) && (this.yidunEnable = e.yidunEnable ? 1 : 0), c(e.antiSpamUsingYidun) && (this.antiSpamUsingYidun = e.antiSpamUsingYidun ? 1 : 0), c(e.clientAntiSpam) && (this.clientAntiSpam = e.clientAntiSpam ? 1 : 0), c(e.antiSpamContent) && ("object" === (0, o.default)(e.antiSpamContent) ? this.antiSpamContent = JSON.stringify(e.antiSpamContent) : this.antiSpamContent = "" + e.antiSpamContent), c(e.antiSpamBusinessId) && ("object" === (0, o.default)(e.antiSpamBusinessId) ? this.antiSpamBusinessId = JSON.stringify(e.antiSpamBusinessId) : this.antiSpamBusinessId = "" + e.antiSpamBusinessId) } var i, o = (i = n(2)) && i.__esModule ? i : { default: i }, s = n(0), a = s.undef, c = s.notundef, u = s.exist, l = n(57), m = n(79), d = "#%@all@%#", p = { p2p: 0, team: 1, superTeam: 5 }, f = { 0: "p2p", 1: "team", 5: "superTeam" }, g = Object.keys(p), h = m.typeMap, y = m.validTypes; s.merge(r.prototype, m.prototype), r.prototype.getScene = function () { return f[this.scene] }, r.getType = m.getType, r.reverse = function (e) { var t = { scene: f[e.scene] || e.scene, from: e.from, fromNick: e.fromNick, fromClientType: l.reverseType(e.fromClientType), fromDeviceId: e.fromDeviceId, to: "" + e.to, time: +e.time, type: r.getType(e), text: u(e.body) ? e.body : "", isHistoryable: a(e.isHistoryable) || 1 == +e.isHistoryable, isRoamingable: a(e.isRoamingable) || 1 == +e.isRoamingable, isSyncable: a(e.isSyncable) || 1 == +e.isSyncable, cc: a(e.cc) || 1 == +e.cc, isPushable: a(e.isPushable) || 1 == +e.isPushable, isOfflinable: a(e.isOfflinable) || 1 == +e.isOfflinable, isUnreadable: a(e.isUnreadable) || 1 == +e.isUnreadable, isReplyMsg: a(e.isReplyMsg) || 1 == +e.isReplyMsg, needPushNick: a(e.needPushNick) || 1 == +e.needPushNick, needMsgReceipt: 1 == +e.needMsgReceipt, isLocal: !1 }; if (e.isInBlackList && (t.isInBlackList = 1 == +e.isInBlackList), c(e.isMuted) && (t.isMuted = 1 == +e.isMuted), c(e.resend) && (t.resend = 1 == +e.resend), c(e.idClient) && (t.idClient = e.idClient), c(e.idServer) && (t.idServer = "" + e.idServer), c(e.userUpdateTime) && (t.userUpdateTime = +e.userUpdateTime), c(e.custom) && (t.custom = e.custom), c(e.pushContent) && (t.pushContent = e.pushContent), c(e.pushPayload) && (t.pushPayload = e.pushPayload), c(e.tempTeamMemberCount) && (t.tempTeamMemberCount = +e.tempTeamMemberCount), c(e.apnsAccounts)) { if (t.apns = {}, e.apnsAccounts !== d) { var n = e.apnsAccounts; try { t.apns.accounts = JSON.parse(n) } catch (e) { t.apns.accounts = [] } } t.apns.content = e.apnsContent || "", t.apns.forcePush = 1 == +e.apnsForcePush } return t.status = e.status || "success", c(e.filter) && (t.filter = e.filter), t }, r.setExtra = function (e, t) { e.target = r.getMsgTarget(e, t), e.sessionId = e.scene + "-" + e.target, m.setFlow(e, t) }, r.getMsgTarget = function (e, t) { return "p2p" === e.scene ? e.to === t ? e.from : e.to : "team" === e.scene || "superTeam" === e.scene ? e.to : void 0 }, r.deduplication = function (e) { var t, n = {}, r = []; return e.forEach(function (e) { t = e.idClient, n[t] || (n[t] = !0, r.push(e)) }), r }, r.sortMsgs = function (e) { return e = e.slice(0), s.sortObjArray(e, { sortPath: "time" }), e }, r.getLastMsg = function (e) { return (e = r.sortMsgs(e))[e.length - 1] }, r.getLastNotIgnoredMsg = function (e) { for (var t = null, n = (e = r.sortMsgs(e)).length - 1; n >= 0; n--)if (!(t = e[n]).ignore) return t; return null }, r.getMaxTimetag = function (e) { return r.getLastMsg(e).time }, r.validScenes = g, r.validTypes = y, e.exports = r }, function (e, t, n) { var r = n(7), i = n(9), o = n(41), s = n(35), a = n(8).f; e.exports = function (e) { var t = i.Symbol || (i.Symbol = o ? {} : r.Symbol || {}); "_" == e.charAt(0) || e in t || a(t, e, { value: s.f(e) }) } }, function (e, t, n) { t.f = n(5) }, function (e, t, n) { var r = n(8).f, i = n(10), o = n(5)("toStringTag"); e.exports = function (e, t, n) { e && !i(e = n ? e : e.prototype, o) && r(e, o, { configurable: !0, value: t }) } }, function (e, t) { e.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",") }, function (e, t, n) { var r = n(7), i = r["__core-js_shared__"] || (r["__core-js_shared__"] = {}); e.exports = function (e) { return i[e] || (i[e] = {}) } }, function (e, t, n) { var r = n(38)("keys"), i = n(28); e.exports = function (e) { return r[e] || (r[e] = i(e)) } }, function (e, t, n) { var r = n(18); e.exports = function (e, t) { if (!r(e)) return e; var n, i; if (t && "function" == typeof (n = e.toString) && !r(i = n.call(e))) return i; if ("function" == typeof (n = e.valueOf) && !r(i = n.call(e))) return i; if (!t && "function" == typeof (n = e.toString) && !r(i = n.call(e))) return i; throw TypeError("Can't convert object to primitive value") } }, function (e, t) { e.exports = !0 }, function (e, t) { e.exports = function (e) { if (null == e) throw TypeError("Can't call method on  " + e); return e } }, function (e, t) { var n = Math.ceil, r = Math.floor; e.exports = function (e) { return isNaN(e = +e) ? 0 : (e > 0 ? r : n)(e) } }, function (e, t, n) { function r(e) { this.mixin(e) } var i, o = n(29), s = n(0), a = n(4), c = n(97), u = n(148), l = n(147), m = n(146), d = n(145), p = n(144); r.prototype = Object.create(function () { }.prototype, { protocol: { value: null, writable: !0, enumerable: !0, configurable: !0 } }), r.prototype.setProtocol = function (e) { this.protocol = e }, r.prototype.mixin = function (e) { var t = this; this.configMap = this.configMap || {}, ["idMap", "cmdConfig", "packetConfig"].forEach(function (n) { t.configMap[n] = s.merge({}, t.configMap[n], e.configMap && e.configMap[n]) }), ["serializeMap", "unserializeMap"].forEach(function (n) { t[n] = s.merge({}, t[n], e[n]) }) }, r.prototype.createCmd = (i = 1, function (e, t) { var n = this, r = this.configMap.cmdConfig[e], o = "heartbeat" === e ? 0 : i++; return o > 32767 && (o = 1, i = 2), e = { SID: r.sid, CID: r.cid, SER: o }, r.params && (e.Q = [], r.params.forEach(function (r) { var i = r.type, o = r.name, a = r.entity, c = t[o]; if (!s.undef(c)) { switch (i) { case "PropertyArray": i = "ArrayMable", c = c.map(function (e) { return { t: "Property", v: n.serialize(e, a) } }); break; case "Property": c = n.serialize(c, o); break; case "bool": c = c ? "true" : "false" }e.Q.push({ t: i, v: c }) } })), e }), r.prototype.parseResponse = function (e) { var t = this; return new Promise(function (n, r) { var i = JSON.parse(e), o = { raw: i, rawStr: e, error: a.genError(i.code) }, c = t.configMap.packetConfig[i.sid + "_" + i.cid]; if (!c) return o.notFound = { sid: i.sid, cid: i.cid }, void n(o); var u = i.r, l = "notify" === c.service && !c.cmd; if (o.isNotify = l, l) { var m = i.r[1].headerPacket; if (c = t.configMap.packetConfig[m.sid + "_" + m.cid], u = i.r[1].body, !c) return o.notFound = { sid: m.sid, cid: m.cid }, void n(o) } if (o.service = c.service, o.cmd = c.cmd, o.error) { var d = i.sid + "_" + i.cid; if (l && (d = m.sid + "_" + m.cid), o.error.cmd = o.cmd, o.error.callFunc = "protocol::parseResponse: " + d, 416 === o.error.code) { var p = u[0]; p && (o.frequencyControlDuration = 1e3 * p) } } var f = !1; o.error && c.trivialErrorCodes && (f = -1 !== c.trivialErrorCodes.indexOf(o.error.code)); var g = []; if ((!o.error || f) && c.response) { o.content = {}; var h = function (e, t, n, r) { if (e && "msg" === r || "sysMsg" === r) { var i = n.content[r]; s.isObject(i) && !i.idServer && (i.idServer = "" + t.r[0]) } }; c.response.forEach(function (e, n) { var r = u[n]; if (!s.undef(r)) { var a = e.type, c = e.name, m = e.entity || c; switch (a) { case "Property": g.push(t.unserialize(r, m).then(function (e, t, n, r, i) { n.content[r] = i, h(e, t, n, r) }.bind(this, l, i, o, c))); break; case "PropertyArray": o.content[c] = [], r.forEach(function (e) { g.push(t.unserialize(e, m).then(function (e, t, n) { e.content[t].push(n) }.bind(this, o, c))) }); break; case "KVArray": o.content[c] = r, h(l, i, o, c); break; case "long": case "Long": case "byte": case "Byte": case "Number": o.content[c] = +r; break; default: o.content[c] = r, h(l, i, o, c) } } }) } Promise.all(g).then(function () { n(o) }) }) }, r.prototype.serialize = function (e, t) { var n = this.serializeMap[t], r = {}; for (var i in n) e.hasOwnProperty(i) && (r[n[i]] = e[i]); return r }, r.prototype.matchNosSafeUrl = function (e) { if (!s.isString(e) || !~e.indexOf("_im_url=1")) return !1; var t = (0, o.urlQuery2Object)(e); return !(!t || !t._im_url || 1 != t._im_url) }, r.prototype.getOneNosOriginUrl = function (e, t, n) { var r = this; return new Promise(function (i, o) { r.protocol.getNosOriginUrlReqNum++ , r.protocol.sendCmd("getNosOriginUrl", { nosFileUrlTag: { safeUrl: e } }, function (e, o, s) { r.protocol.getNosOriginUrlReqNum-- , e ? console.warn("error: get nos originUrl failed", e) : (t["_" + n + "_safe"] = t[n], t[n] = s.nosFileUrlTag && s.nosFileUrlTag.originUrl), i() }) }) }, r.prototype.checkObjSafeUrl = function (e, t, n) { var r = this; for (var i in e) if (e.hasOwnProperty(i)) { var o = e[i]; if (s.isString(o)) { if (this.matchNosSafeUrl(o)) { var a = this.getOneNosOriginUrl(o, e, i); t.push(a), n.push(a) } } else s.isObject(o) ? this.checkObjSafeUrl(o, t, n) : s.isArray(o) && o.forEach(function (e) { s.isObject(e) && r.checkObjSafeUrl(e, t, n) }) } }; var f = ["url", "avatar", "fromAvatar", "chatroomAvatar"]; r.prototype.unserialize = function (e, t) { var n = this; return new Promise(function (r, i) { var o = n.unserializeMap[t], s = {}, a = []; if (e) for (var c in o) { var u = []; if (e.hasOwnProperty(c) && (s[o[c]] = e[c], !n.protocol.keepNosSafeUrl)) if ("attach" === o[c] && e[c] && e[c].indexOf && ~e[c].indexOf("_im_url=1")) try { var l = JSON.parse(e[c]); n.checkObjSafeUrl(l, u, a), Promise.all(u).then(function (e, t) { e.attach = JSON.stringify(t) }.bind(n, s, l)) } catch (e) { console.warn(e) } else ~f.indexOf(o[c]) && e[c] && n.matchNosSafeUrl(e[c]) && a.push(n.getOneNosOriginUrl(e[c], s, o[c])) } Promise.all(a).then(function (e) { r(s) }) }) }, r.prototype.syncUnserialize = function (e, t) { var n = this.unserializeMap[t], r = {}; if (e) for (var i in n) e.hasOwnProperty(i) && (r[n[i]] = e[i]); return r }; var g = new r({ configMap: c, serializeMap: u, unserializeMap: l }), h = new r({ configMap: m, serializeMap: d, unserializeMap: p }); e.exports = { IM: g, Chatroom: h } }, function (e, t, n) { function r(e) { var t = e.upload = "multipart/form-data" === (e.headers || a.o)["Content-Type"], n = !1; try { n = (location.protocol + "//" + location.host).toLowerCase() !== a.url2origin(e.url) } catch (e) { } return e.cors = n, t || n || e.mode ? function (e) { var t = e.mode, n = c, r = a.getGlobal(); return !r.FormData && r.document && (t = "iframe"), "iframe" === t && (n = e.upload ? u : l), new n(e) }(e) : new c(e) } function i(e, t, n) { var r = m[e]; if (r) { "onload" === t && r.result && (n = function (e, t) { t = { data: t }; var n = e.result.headers; return n && (t.headers = e.req.header(n)), t }(r, n)), function (e) { var t = m[e]; t && (t.req.destroy(), delete m[e]) }(e); var i = { type: t, result: n }; d(i), i.stopped || r[t](i.result) } } function o(e, t) { var n = a.genUrlSep(e); return t = t || "", a.isObject(t) && (t = a.object2query(t)), t && (e += n + t), e } function s(e, t) { t = t || {}; var n = a.uniqueID(), s = { result: t.result, onload: t.onload || a.f, onerror: t.onerror || a.f }; m[n] = s, t.onload = function (e, t) { i(e, "onload", t) }.bind(null, n), t.onerror = function (e, t) { i(e, "onerror", t) }.bind(null, n), t.query && (e = o(e, t.query)); var c = t.method || ""; return c && !/get/i.test(c) || !t.data || (e = o(e, t.data), t.data = null), t.url = e, s.req = r(t), n } var a = n(15), c = n(176), u = n(174), l = n(173), m = {}, d = a.f; s.filter = function (e) { a.isFunction(e) && (d = e) }, s.abort = function (e) { var t = m[e]; t && t.req && t.req.abort() }, e.exports = s }, function (e, t, n) { e.exports = { description: "weixin micro app", layout: null, manufacturer: null, name: "weixin", prerelease: null, product: null, ua: "Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko) Weixin/1.9.1", version: "1.9.1", os: { architecture: 64, family: "Windows", version: "1.9.1" } } }, function (e, t) { t.f = Object.getOwnPropertySymbols }, function (e, t) { var n; n = function () { return this }(); try { n = n || Function("return this")() || (0, eval)("this") } catch (e) { "object" == ("undefined" == typeof window ? "undefined" : _typeof(window)) && (n = window) } e.exports = n }, function (e, t, n) { function r(e) { i.verifyOptions(e, "teamId", "team::TeamMember"), i.verifyParamAtLeastPresentOne(e, "nickInTeam muteTeam muteNotiType custom", "team::TeamMember"), this.teamId = e.teamId, o(e.account) && (this.account = e.account), o(e.nickInTeam) && (this.nickInTeam = e.nickInTeam), o(e.muteNotiType) ? this.bits = e.muteNotiType : o(e.muteTeam) && (this.bits = 0, e.muteTeam && (this.bits += 1)), o(e.mute) && (this.mute = e.mute ? 1 : 0), o(e.custom) && (this.custom = "" + e.custom) } var i = n(0), o = i.notundef, s = i.fillPropertyWithDefault, a = { 0: "normal", 1: "owner", 2: "manager" }; r.reverse = function (e) { var t = i.copy(e); if (o(t.teamId) && (t.teamId = "" + t.teamId), o(t.type) && (t.type = a[t.type]), o(t.active) && (t.active = 1 == +t.active), o(t.valid) && (t.valid = 1 == +t.valid), o(t.mute) && (t.mute = 1 == +t.mute), o(t.joinTime) && (t.joinTime = +t.joinTime), o(t.updateTime) && (t.updateTime = +t.updateTime), o(t.bits)) { var n = t.bits; delete t.bits, t.muteTeam = !!(1 & n), t.muteNotiType = n } return o(t.teamId) && o(t.account) && (t.id = r.genId(t.teamId, t.account)), t }, r.reverseMembers = function (e) { return e.map(function (e) { return r.reverse(e) }) }, r.fillProperties = function (e) { var t = s(e, "mute", !1), n = s(e, "custom", ""); return t || n }, r.genId = function (e, t) { return e + "-" + t }, r.accounts2ids = function (e, t) { return t.map(function (t) { return r.genId(e, t) }) }, r.assembleMembers = function (e, t) { return i.isArray(t) || (t = [t]), t.map(function (t) { return r.assembleMember(e, t) }) }, r.assembleMember = function (e, t) { return { id: r.genId(e.teamId, t), account: t, teamId: e.teamId, type: "normal", nickInTeam: "", muteTeam: !1, mute: !1, joinTime: e.memberUpdateTime, updateTime: e.memberUpdateTime, active: !0, valid: !0, invitorAccid: "" } }, r.assembleOwner = function (e) { var t = r.assembleMember(e, e.owner); return t.type = "owner", t }, e.exports = r }, function (e, t) { var n = {}.toString; e.exports = function (e) { return n.call(e).slice(8, -1) } }, function (e, t, n) { var r = n(122)(!0); n(68)(String, "String", function (e) { this._t = String(e), this._i = 0 }, function () { var e, t = this._t, n = this._i; return n >= t.length ? { value: void 0, done: !0 } : (e = r(t, n), this._i += e.length, { value: e, done: !1 }) }) }, function (e, t, n) { var r = n(42); e.exports = function (e) { return Object(r(e)) } }, function (e, t, n) { var r = n(19), i = n(119), o = n(37), s = n(39)("IE_PROTO"), a = function () { }, c = function () { var e, t = n(66)("iframe"), r = o.length; for (t.style.display = "none", n(116).appendChild(t), t.src = "javascript:", (e = t.contentWindow.document).open(), e.write("<script>document.F=Object<\/script>"), e.close(), c = e.F; r--;)delete c.prototype[o[r]]; return c() }; e.exports = Object.create || function (e, t) { var n; return null !== e ? (a.prototype = r(e), n = new a, a.prototype = null, n[s] = e) : n = c(), void 0 === t ? n : i(n, t) } }, , function (e, t, n) { function r() { } var i = n(0); r.parse = function (e) { var t = e.split("|"); return { scene: t[0], to: t[1] } }, r.genSessionByMsg = function (e) { return { id: e.sessionId, scene: e.scene, to: e.target, updateTime: e.time, lastMsg: e } }, r.appendLastMsg = function (e) { var t = e.lastMsg; e["last" + i.capFirstLetter(t.type) + "Msg"] = t, e["last" + i.capFirstLetter(t.flow) + "Msg"] = t }, r.genSessionByMsgs = function (e, t) { var n = e.getLastNotIgnoredMsg(t); return n ? r.genSessionByMsg(n) : null }, r.trim = function (e) { delete e.msgReceiptSendTime, delete e.msgReceiptServerTime, delete e.ack, delete e.unreadMsgs }, r.isComplete = function (e) { return e.id && e.scene && e.to }, e.exports = r }, function (e, t, n) { function r(e) { s.verifyOptions(e, "type to", "sysmsg::SystemMessage"), s.verifyParamValid("type", e.type, r.validTypes, "sysmsg::SystemMessage"), -1 !== e.type.indexOf("custom") && (s.verifyOptions(e, "content", "sysmsg::SystemMessage"), this.attach = e.content, c(e.apnsText) && (this.apnsText = "" + e.apnsText), c(e.pushPayload) && ("object" === (0, o.default)(e.pushPayload) ? this.pushPayload = JSON.stringify(e.pushPayload) : this.pushPayload = "" + e.pushPayload), c(e.sendToOnlineUsersOnly) && (this.sendToOnlineUsersOnly = e.sendToOnlineUsersOnly ? 0 : 1), c(e.cc) && (this.cc = e.cc ? 1 : 0), c(e.isPushable) && (this.isPushable = e.isPushable ? 1 : 0), c(e.isUnreadable) && (this.isUnreadable = e.isUnreadable ? 1 : 0), c(e.needPushNick) && (this.needPushNick = e.needPushNick ? 1 : 0)), this.time = e.time || +new Date, this.type = d[e.type], this.to = e.to, c(e.from) && (this.from = e.from), c(e.ps) && (this.ps = e.ps), c(e.deletedIdClient) && (this.deletedIdClient = e.deletedIdClient), c(e.deletedIdServer) && (this.deletedIdServer = e.deletedIdServer), c(e.opeAccount) && (this.opeAccount = e.opeAccount), c(e.yidunEnable) && (this.yidunEnable = e.yidunEnable ? 1 : 0), c(e.antiSpamContent) && ("object" === (0, o.default)(e.antiSpamContent) ? this.antiSpamContent = JSON.stringify(e.antiSpamContent) : this.antiSpamContent = "" + e.antiSpamContent), c(e.antiSpamBusinessId) && ("object" === (0, o.default)(e.antiSpamBusinessId) ? this.antiSpamBusinessId = JSON.stringify(e.antiSpamBusinessId) : this.antiSpamBusinessId = "" + e.antiSpamBusinessId), this.idClient = e.idClient || s.guid() } var i, o = (i = n(2)) && i.__esModule ? i : { default: i }, s = n(0), a = s.undef, c = s.notundef, u = n(44).IM, l = n(58), m = n(49), d = { customP2p: 100, customTeam: 101, deleteMsgP2p: 7, deleteMsgTeam: 8 }, p = { 0: "applyTeam", 1: "rejectTeamApply", 2: "teamInvite", 3: "rejectTeamInvite", 5: "friendRequest", 6: "deleteFriend", 7: "deleteMsgP2p", 8: "deleteMsgTeam", 100: "customP2p", 101: "customTeam", 102: "customP2p" }, f = { 1: "addFriend", 2: "applyFriend", 3: "passFriendApply", 4: "rejectFriendApply" }, g = ["team", "friend", "msg"], h = { applyTeam: "team", rejectTeamApply: "team", teamInvite: "team", rejectTeamInvite: "team", addFriend: "friend", applyFriend: "friend", passFriendApply: "friend", rejectFriendApply: "friend", deleteFriend: "friend", deleteMsg: "msg" }; r.validTypes = Object.keys(d).concat(Object.keys(h)), r.validCategories = ["team", "friend"], r.isCustom = function (e) { return "custom" === e.type }, r.reverse = function (e) { var t = { time: +e.time, to: e.to, type: p[e.type] }; if (c(e.from) && (t.from = e.from), c(e.idServer) && (t.idServer = "" + e.idServer), c(e.deletedIdClient) && (t.deletedIdClient = e.deletedIdClient), c(e.deletedIdServer) && (t.deletedIdServer = "" + e.deletedIdServer), c(e.deletedMsgTime) && (t.deletedMsgTime = +e.deletedMsgTime), c(e.deletedMsgFromNick) && (t.deletedMsgFromNick = "" + e.deletedMsgFromNick), c(e.opeAccount) && (t.opeAccount = e.opeAccount), c(e.ps) && (t.ps = e.ps), e.attach = e.attach ? "" + e.attach : "", "customP2p" === t.type || "customTeam" === t.type) t.content = e.attach, c(e.apnsText) && (t.apnsText = e.apnsText), c(e.pushPayload) && (t.pushPayload = e.pushPayload), s.merge(t, { sendToOnlineUsersOnly: a(e.sendToOnlineUsersOnly) || 0 == +e.sendToOnlineUsersOnly, cc: a(e.cc) || 1 == +e.cc, isPushable: a(e.isPushable) || 1 == +e.isPushable, isUnreadable: a(e.isUnreadable) || 1 == +e.isUnreadable, needPushNick: c(e.needPushNick) && 1 == +e.needPushNick }), t.scene = t.type.slice(6).toLowerCase(), t.type = "custom"; else if ("deleteMsgP2p" === t.type || "deleteMsgTeam" === t.type) t.scene = t.type.slice(9).toLowerCase(), t.type = "deleteMsg"; else { if (e.attach) { t.attach = {}; var n = JSON.parse(e.attach); c(n.vt) ? (t.type = f[n.vt], delete t.attach) : (c(n.tinfo) && (t.attach.team = l.reverse(u.syncUnserialize(n.tinfo, "team"))), c(n.tlist) && (t.attach.member = m.reverse(u.syncUnserialize(n.tlist, "teamMember"))), c(n.attach) && (t.attach.custom = n.attach)) } t.category = h[t.type], t.read = !1, t.state = "init" } return c(e.cc) && (t.cc = 1 == +e.cc), t.status = e.status || "success", c(e.filter) && (t.filter = e.filter), t }, r.reverseSysMsgs = function (e, t) { var n = (t = t || {}).mapper, i = s.isFunction(n); return e.map(function (e) { return e = r.reverse(e), i && (e = n(e)), e }) }, r.completeUnread = function (e) { var t; return e = e || {}, g.forEach(function (t) { delete e[t] }), Object.keys(h).forEach(function (n) { e[n] = e[n] || 0, e[n] < 0 && (e[n] = 0), e[t = h[n]] = e[t] || 0, e[t] = e[t] + e[n] }), e.total = 0, g.forEach(function (t) { e.total += e[t] }), e }, e.exports = r }, function (e, t, n) { function r() { } var i, o = ((i = n(22)) && i.__esModule ? i : { default: i }).default.clientTypeMap; r.reverse = function (e) { var t = e; return t.type = o[t.type], t }, r.reverseType = function (e) { return o[e] || e }, e.exports = r }, function (e, t, n) { function r(e) { switch (i.verifyOptions(e, "action", "team::Team"), e.action) { case "create": i.verifyOptions(e, "teamId", !1, "team::Team"), i.verifyOptions(e, "type name", "team::Team"), i.verifyParamValid("type", e.type, f, "team::Team"), o(e.level) && (i.verifyParamType("level", e.level, "number", "team::Team"), this.level = e.level); break; case "update": i.verifyOptions(e, "teamId", "team::Team"), i.verifyOptions(e, "type", !1, "team::Team") }o(e.teamId) && (this.teamId = e.teamId), o(e.type) && (this.type = d[e.type]), o(e.avatar) && (this.avatar = "" + e.avatar), o(e.name) && (this.name = "" + e.name), o(e.intro) && (this.intro = "" + e.intro), o(e.announcement) && (this.announcement = "" + e.announcement), l.forEach(this.setMode.bind(this, e)), o(e.custom) && (this.custom = "" + e.custom) } var i = n(0), o = i.notundef, s = i.fillPropertyWithDefault, a = Object.keys, c = {}, u = {}, l = [], m = {}, d = { normal: 0, advanced: 1 }, p = { 0: "normal", 1: "advanced" }, f = a(d), g = c.joinMode = { noVerify: 0, needVerify: 1, rejectAll: 2 }; u.joinMode = { 0: "noVerify", 1: "needVerify", 2: "rejectAll" }, l.push("join"), m.joinMode = a(g); var h = c.beInviteMode = { needVerify: 0, noVerify: 1 }; u.beInviteMode = { 0: "needVerify", 1: "noVerify" }, l.push("beInvite"), m.beInviteMode = a(h); var y = c.inviteMode = { manager: 0, all: 1 }; u.inviteMode = { 0: "manager", 1: "all" }, l.push("invite"), m.inviteMode = a(y); var v = c.updateTeamMode = { manager: 0, all: 1 }; u.updateTeamMode = { 0: "manager", 1: "all" }, l.push("updateTeam"), m.updateTeamMode = a(v); var b = c.updateCustomMode = { manager: 0, all: 1 }; u.updateCustomMode = { 0: "manager", 1: "all" }, l.push("updateCustom"), m.updateCustomMode = a(b), r.prototype.setMode = function (e, t) { o(e[t += "Mode"]) && (i.verifyParamValid(t, e[t], m[t], "team::Team"), this[t] = c[t][e[t]]) }, r.reverse = function (e, t) { var n = i.copy(e); if (o(n.teamId) && (n.teamId = "" + n.teamId), o(n.type) && (n.type = p[n.type]), o(n.level) && (n.level = +n.level), o(n.valid) && (n.valid = 1 == +n.valid), o(n.memberNum) && (n.memberNum = +n.memberNum), o(n.memberUpdateTime) && (n.memberUpdateTime = +n.memberUpdateTime), o(n.createTime) && (n.createTime = +n.createTime), o(n.updateTime) && (n.updateTime = +n.updateTime), o(n.validToCurrentUser) && (n.validToCurrentUser = "1" === n.validToCurrentUser), o(n.mute) && (n.mute = "1" === n.mute), o(n.muteType)) switch (n.muteType) { case "0": n.mute = !1, n.muteType = "none"; break; case "1": n.mute = !0, n.muteType = "normal"; break; case "3": n.mute = !0, n.muteType = "all" } else o(n.mute) && (1 === n.mute ? (n.mute = !0, n.muteType = "normal") : (n.mute = !1, n.muteType = "none")); return l.forEach(function (e, t) { o(e[t += "Mode"]) && (e[t] = u[t][e[t]]) }.bind(null, n)), delete n.bits, t || r.fillProperties(n), n }, r.fillProperties = function (e) { var t = s(e, "beInviteMode", "needVerify"), n = s(e, "inviteMode", "manager"), r = s(e, "updateTeamMode", "manager"), i = s(e, "updateCustomMode", "manager"), o = s(e, "avatar", ""); return t || n || r || i || o }, e.exports = r }, function (e, t, n) { var r = { link: { id: 1, heartbeat: 2 }, sync: { id: 5, sync: 1, syncTeamMembers: 2 }, misc: { id: 6, getSimpleNosToken: 1, getNosToken: 2, notifyUploadLog: 3, uploadSdkLogUrl: 4, audioToText: 5, processImage: 6, getNosTokenTrans: 7, notifyTransLog: 8, fetchFile: 9, fetchFileList: 10, removeFile: 11, getClientAntispam: 17, fileQuickTransfer: 18, getNosOriginUrl: 22, getServerTime: 23 }, avSignal: { id: 15, signalingCreate: 1, signalingDelay: 2, signalingClose: 3, signalingJoin: 4, signalingLeave: 5, signalingInvite: 6, signalingCancel: 7, signalingReject: 8, signalingAccept: 9, signalingControl: 10, signalingNotify: 11, signalingMutilClientSyncNotify: 12, signalingUnreadMessageSyncNotify: 13, signalingChannelsSyncNotify: 14, signalingGetChannelInfo: 15 } }, i = { heartbeat: { sid: r.link.id, cid: r.link.heartbeat }, getSimpleNosToken: { sid: r.misc.id, cid: r.misc.getSimpleNosToken, params: [{ type: "int", name: "num" }] }, getNosToken: { sid: r.misc.id, cid: r.misc.getNosToken, params: [{ type: "String", name: "responseBody" }, { type: "Property", name: "nosToken", entity: "nosToken" }] }, uploadSdkLogUrl: { sid: r.misc.id, cid: r.misc.uploadSdkLogUrl, params: [{ type: "string", name: "url" }] }, audioToText: { sid: r.misc.id, cid: r.misc.audioToText, params: [{ type: "Property", name: "audioToText" }] }, processImage: { sid: r.misc.id, cid: r.misc.processImage, params: [{ type: "String", name: "url" }, { type: "PropertyArray", name: "imageOps", entity: "imageOp" }] }, getClientAntispam: { sid: r.misc.id, cid: r.misc.getClientAntispam, params: [{ type: "Property", name: "clientAntispam" }] }, fileQuickTransfer: { sid: r.misc.id, cid: r.misc.fileQuickTransfer, params: [{ type: "Property", name: "fileQuickTransfer" }] }, getNosOriginUrl: { sid: r.misc.id, cid: r.misc.getNosOriginUrl, params: [{ type: "Property", name: "nosFileUrlTag" }] }, getServerTime: { sid: r.misc.id, cid: r.misc.getServerTime, params: [] }, getNosTokenTrans: { sid: r.misc.id, cid: r.misc.getNosTokenTrans, params: [{ type: "Property", name: "transToken" }] }, fetchFile: { sid: r.misc.id, cid: r.misc.fetchFile, params: [{ type: "String", name: "docId" }] }, fetchFileList: { sid: r.misc.id, cid: r.misc.fetchFileList, params: [{ type: "Property", name: "fileListParam" }] }, removeFile: { sid: r.misc.id, cid: r.misc.removeFile, params: [{ type: "String", name: "docId" }] }, signalingCreate: { sid: r.avSignal.id, cid: r.avSignal.signalingCreate, params: [{ type: "Property", name: "avSignalTag" }] }, signalingDelay: { sid: r.avSignal.id, cid: r.avSignal.signalingDelay, params: [{ type: "Property", name: "avSignalTag" }] }, signalingClose: { sid: r.avSignal.id, cid: r.avSignal.signalingClose, params: [{ type: "Property", name: "avSignalTag" }] }, signalingJoin: { sid: r.avSignal.id, cid: r.avSignal.signalingJoin, params: [{ type: "Property", name: "avSignalTag" }] }, signalingLeave: { sid: r.avSignal.id, cid: r.avSignal.signalingLeave, params: [{ type: "Property", name: "avSignalTag" }] }, signalingInvite: { sid: r.avSignal.id, cid: r.avSignal.signalingInvite, params: [{ type: "Property", name: "avSignalTag" }] }, signalingCancel: { sid: r.avSignal.id, cid: r.avSignal.signalingCancel, params: [{ type: "Property", name: "avSignalTag" }] }, signalingReject: { sid: r.avSignal.id, cid: r.avSignal.signalingReject, params: [{ type: "Property", name: "avSignalTag" }] }, signalingAccept: { sid: r.avSignal.id, cid: r.avSignal.signalingAccept, params: [{ type: "Property", name: "avSignalTag" }] }, signalingControl: { sid: r.avSignal.id, cid: r.avSignal.signalingControl, params: [{ type: "Property", name: "avSignalTag" }] }, signalingGetChannelInfo: { sid: r.avSignal.id, cid: r.avSignal.signalingGetChannelInfo, params: [{ type: "Property", name: "avSignalTag" }] } }; e.exports = { idMap: r, cmdConfig: i, packetConfig: { "1_2": { service: "link", cmd: "heartbeat" }, "6_1": { service: "misc", cmd: "getSimpleNosToken", response: [{ type: "PropertyArray", name: "nosTokens", entity: "nosToken" }] }, "6_2": { service: "misc", cmd: "getNosToken", response: [{ type: "Property", name: "nosToken" }] }, "6_3": { service: "misc", cmd: "notifyUploadLog" }, "6_5": { service: "misc", cmd: "audioToText", response: [{ type: "String", name: "text" }] }, "6_6": { service: "misc", cmd: "processImage", response: [{ type: "String", name: "url" }] }, "6_7": { service: "misc", cmd: "getNosTokenTrans", response: [{ type: "Property", name: "nosToken" }, { type: "String", name: "docId" }] }, "6_8": { service: "misc", cmd: "notifyTransLog", response: [{ type: "Property", name: "transInfo" }] }, "6_9": { service: "misc", cmd: "fetchFile", response: [{ type: "Property", name: "info", entity: "transInfo" }] }, "6_10": { service: "misc", cmd: "fetchFileList", response: [{ type: "PropertyArray", name: "list", entity: "transInfo" }, { type: "Number", name: "totalCount" }] }, "6_11": { service: "misc", cmd: "removeFile", response: [{ type: "String", name: "res" }] }, "6_17": { service: "misc", cmd: "getClientAntispam", response: [{ type: "Property", name: "clientAntispam" }] }, "6_18": { service: "misc", cmd: "fileQuickTransfer", response: [{ type: "Property", name: "fileQuickTransfer" }] }, "6_22": { service: "misc", cmd: "getNosOriginUrl", response: [{ type: "Property", name: "nosFileUrlTag" }] }, "6_23": { service: "misc", cmd: "getServerTime", response: [{ type: "Number", name: "time" }] }, "15_1": { service: "avSignal", cmd: "signalingCreate", response: [{ type: "Property", name: "avSignalTag" }] }, "15_2": { service: "avSignal", cmd: "signalingDelay", response: [{ type: "Property", name: "avSignalTag" }] }, "15_3": { service: "avSignal", cmd: "signalingClose", response: [{ type: "Property", name: "avSignalTag" }] }, "15_4": { service: "avSignal", cmd: "signalingJoin", response: [{ type: "Property", name: "avSignalTag" }] }, "15_5": { service: "avSignal", cmd: "signalingLeave", response: [] }, "15_6": { service: "avSignal", cmd: "signalingInvite", response: [] }, "15_7": { service: "avSignal", cmd: "signalingCancel", response: [] }, "15_8": { service: "avSignal", cmd: "signalingReject", response: [] }, "15_9": { service: "avSignal", cmd: "signalingAccept", response: [] }, "15_10": { service: "avSignal", cmd: "signalingControl", response: [] }, "15_11": { service: "avSignal", cmd: "signalingNotify", response: [{ type: "Property", name: "avSignalTag" }] }, "15_12": { service: "avSignal", cmd: "signalingMutilClientSyncNotify", response: [{ type: "Property", name: "avSignalTag" }] }, "15_13": { service: "avSignal", cmd: "signalingUnreadMessageSyncNotify", response: [{ type: "PropertyArray", name: "avSignalTag" }] }, "15_14": { service: "avSignal", cmd: "signalingChannelsSyncNotify", response: [{ type: "PropertyArray", name: "avSignalTag" }] }, "15_15": { service: "avSignal", cmd: "signalingGetChannelInfo", response: [{ type: "Property", name: "avSignalTag" }] } } } }, function (e, t, n) { function r(e) { e.onload && this.once("load", e.onload), e.onerror && this.once("error", e.onerror), e.onbeforesend && this.once("beforesend", e.onbeforesend), e.onaftersend && this.once("aftersend", e.onaftersend); var t = (e = this.options = i.fetch({ method: "GET", url: "", sync: !1, data: null, headers: {}, cookie: !1, timeout: 6e4, type: "text", form: null, input: null, putFileAtEnd: !1, proxyUrl: "" }, e)).headers; i.notexist(t["Content-Type"]) && (t["Content-Type"] = "application/x-www-form-urlencoded"), this.send() } var i = n(15), o = i.f, s = n(175), a = r.prototype = Object.create(s.prototype); a.send = function () { var e = this, t = e.options; setTimeout(function () { try { try { e.emit("beforesend", t) } catch (e) { console.log("error:", "ignore error ajax beforesend,", e) } e.doSend() } catch (t) { console.log("error:", "ignore error server error,", t), e.onError("serverError", "请求失败:" + t.message) } }, 0) }, a.doSend = o, a.afterSend = function () { var e = this; setTimeout(function () { e.emit("aftersend", e.options) }, 0) }, a.onLoad = function (e) { var t = this.options, n = e.status, r = e.result; if (0 === ("" + n).indexOf("2")) { if ("json" === t.type) try { r = JSON.parse(r) } catch (e) { return console.log("error:", "ignore error parse json,", e), void this.onError("parseError", r) } this.emit("load", r) } else this.onError("serverError", "服务器返回异常状态", { status: n, result: r }) }, a.onError = function (e, t, n) { var r = i.isObject(n) ? n : {}; r.code = e || "error", r.message = t || "发生错误", this.emit("error", r) }, a.onTimeout = function () { this.onError("timeout", "请求超时") }, a.abort = function () { this.onError("abort", "客户端中止") }, a.header = function (e) { var t = this; if (!i.isArray(e)) return t.getResponseHeader(e || ""); var n = {}; return e.forEach(function (e) { n[e] = t.header(e) }), n }, a.getResponseHeader = o, a.destroy = o, e.exports = r }, function (e, t, n) { function r(e) { return e && e.__esModule ? e : { default: e } } var i = r(n(2)), o = r(n(21)), s = r(n(20)), a = function () { function e() { (0, o.default)(this, e), this._entries = [] } return (0, s.default)(e, [{ key: "append", value: function (e, t) { if ("string" != typeof e) throw new TypeError("FormData name must be a string"); if ("string" != typeof t && ("object" !== (void 0 === t ? "undefined" : (0, i.default)(t)) || "string" != typeof t.uri)) throw new TypeError("FormData value must be a string or { uri: tempFilePath }"); this._entries.push([e, t]) } }, { key: "set", value: function (e, t) { var n = this.get(e); n ? n[1] = t : this.append(e, t) } }, { key: "delete", value: function (e) { this._entries = this._entries.filter(function (t) { return t[0] !== e }) } }, { key: "entries", value: function () { return this._entries } }, { key: "get", value: function (e) { return this._entries.find(function (t) { return t[0] === e }) } }, { key: "getAll", value: function (e) { return this._entries.filter(function (t) { return t[0] === e }) } }, { key: "has", value: function (e) { return this._entries.some(function (t) { return t[0] === e }) } }, { key: "keys", value: function () { return this._entries.map(function (e) { return e[0] }) } }, { key: "values", value: function () { return this._entries.map(function (e) { return e[1] }) } }]), e }(); e.exports = a }, function (e, t, n) { var r = n(64), i = n(37).concat("length", "prototype"); t.f = Object.getOwnPropertyNames || function (e) { return r(e, i) } }, function (e, t, n) { n(114); for (var r = n(7), i = n(14), o = n(26), s = n(5)("toStringTag"), a = "CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","), c = 0; c < a.length; c++) { var u = a[c], l = r[u], m = l && l.prototype; m && !m[s] && i(m, s, u), o[u] = o.Array } }, function (e, t, n) { var r = n(10), i = n(13), o = n(118)(!1), s = n(39)("IE_PROTO"); e.exports = function (e, t) { var n, a = i(e), c = 0, u = []; for (n in a) n != s && r(a, n) && u.push(n); for (; t.length > c;)r(a, n = t[c++]) && (~o(u, n) || u.push(n)); return u } }, function (e, t, n) { e.exports = n(14) }, function (e, t, n) { var r = n(18), i = n(7).document, o = r(i) && r(i.createElement); e.exports = function (e) { return o ? i.createElement(e) : {} } }, function (e, t, n) { e.exports = !n(11) && !n(23)(function () { return 7 != Object.defineProperty(n(66)("div"), "a", { get: function () { return 7 } }).a }) }, function (e, t, n) { var r = n(41), i = n(24), o = n(65), s = n(14), a = n(26), c = n(120), u = n(36), l = n(115), m = n(5)("iterator"), d = !([].keys && "next" in [].keys()), p = function () { return this }; e.exports = function (e, t, n, f, g, h, y) { c(n, t, f); var v, b, T, M = function (e) { if (!d && e in w) return w[e]; switch (e) { case "keys": case "values": return function () { return new n(this, e) } }return function () { return new n(this, e) } }, S = t + " Iterator", k = "values" == g, _ = !1, w = e.prototype, P = w[m] || w["@@iterator"] || g && w[g], C = P || M(g), I = g ? k ? M("entries") : C : void 0, O = "Array" == t && w.entries || P; if (O && (T = l(O.call(new e))) !== Object.prototype && T.next && (u(T, S, !0), r || "function" == typeof T[m] || s(T, m, p)), k && P && "values" !== P.name && (_ = !0, C = function () { return P.call(this) }), r && !y || !d && !_ && w[m] || s(w, m, C), a[t] = C, a[S] = p, g) if (v = { values: k ? C : M("values"), keys: h ? C : M("keys"), entries: I }, y) for (b in v) b in w || o(w, b, v[b]); else i(i.P + i.F * (d || _), t, v); return v } }, function (e, t, n) { e.exports = { default: n(101), __esModule: !0 } }, function (e, t, n) { var r = n(50); e.exports = Object("z").propertyIsEnumerable(0) ? Object : function (e) { return "String" == r(e) ? e.split("") : Object(e) } }, function (e, t, n) { var r = n(121); e.exports = function (e, t, n) { if (r(e), void 0 === t) return e; switch (n) { case 1: return function (n) { return e.call(t, n) }; case 2: return function (n, r) { return e.call(t, n, r) }; case 3: return function (n, r, i) { return e.call(t, n, r, i) } }return function () { return e.apply(t, arguments) } } }, , , function (e, t, n) { function r(e) { switch (s.notundef(e.type) ? s.verifyFileType(e.type, "msg::FileMessage") : e.type = "file", s.verifyOptions(e, "file", "msg::FileMessage"), s.verifyOptions(e.file, "url ext size", !0, "file.", "msg::FileMessage"), e.type) { case "image": c.verifyFile(e.file, "msg::FileMessage"); break; case "audio": u.verifyFile(e.file, "msg::FileMessage"); break; case "video": l.verifyFile(e.file, "msg::FileMessage") }o.call(this, e), this.attach = JSON.stringify(e.file) } var i = n(29), o = n(33), s = n(0), a = n(1); r.prototype = Object.create(o.prototype), r.reverse = function (e) { var t = o.reverse(e); return e.attach = e.attach ? "" + e.attach : "", t.file = e.attach ? JSON.parse(e.attach) : {}, t.file.url = (0, i.genPrivateUrl)(t.file.url), "audio" !== t.type || t.file.mp3Url || (t.file.mp3Url = t.file.url + (~t.file.url.indexOf("?") ? "&" : "?") + "audioTrans&type=mp3"), a.httpsEnabled && 0 !== t.file.url.indexOf("https://") && (t.file.url = t.file.url.replace("http", "https")), t }, e.exports = r; var c = n(229), u = n(228), l = n(227) }, function (e, t, n) { function r(e) { o.merge(this, e), o.notundef(this.gender) && (o.verifyParamValid("gender", this.gender, r.validGenders, "user::User"), this.gender = s[this.gender]), o.notundef(this.email) && "" !== this.email && o.verifyEmail("email", this.email, "user::User"), o.notundef(this.birth) && "" !== this.birth && o.verifyBirth("birth", this.birth, "user::User"), o.notundef(this.tel) && "" !== this.tel && o.verifyTel("tel", this.tel, "user::User") } var i = n(29), o = n(0), s = { unknown: 0, male: 1, female: 2 }, a = { 0: "unknown", 1: "male", 2: "female" }; r.reverse = function (e) { var t = o.filterObj(e, "account nick avatar _avatar_safe sign gender email birth tel custom createTime updateTime"); return o.notundef(t.avatar) && (t.avatar = (0, i.genPrivateUrl)(t.avatar)), o.notundef(t.gender) && (t.gender = a[t.gender]), o.notundef(t.createTime) && (t.createTime = +t.createTime), o.notundef(t.updateTime) && (t.updateTime = +t.updateTime), t }, r.reverseUsers = function (e) { return e.map(function (e) { return r.reverse(e) }) }, r.validGenders = Object.keys(s), e.exports = r }, function (e, t, n) { function r(e) { i.verifyOptions(e, "teamId", "superTeam::TeamMember"), i.verifyParamAtLeastPresentOne(e, "nickInTeam muteTeam custom", "superTeam::SuperTeamMember"), this.teamId = e.teamId, o(e.account) && (this.account = e.account), o(e.nickInTeam) && (this.nickInTeam = e.nickInTeam), o(e.muteTeam) && (this.bits = 0, e.muteTeam && (this.bits += 1)), o(e.mute) && (this.mute = e.mute ? 1 : 0), o(e.custom) && (this.custom = "" + e.custom) } var i = n(0), o = i.notundef, s = i.fillPropertyWithDefault, a = { 0: "normal", 1: "owner", 2: "manager" }; r.reverse = function (e) { var t = i.copy(e); if (o(t.teamId) && (t.teamId = "" + t.teamId), o(t.type) && (t.type = a[t.type]), o(t.active) && (t.active = 1 == +t.active), o(t.valid) && (t.valid = 1 == +t.valid), o(t.mute) && (t.mute = 1 == +t.mute), o(t.joinTime) && (t.joinTime = +t.joinTime), o(t.updateTime) && (t.updateTime = +t.updateTime), o(t.bits)) { var n = t.bits; delete t.bits, t.muteTeam = !!(1 & n) } return o(t.teamId) && o(t.account) && (t.id = r.genId(t.teamId, t.account)), t }, r.reverseMembers = function (e) { return e.map(function (e) { return r.reverse(e) }) }, r.fillProperties = function (e) { var t = s(e, "mute", !1), n = s(e, "custom", ""); return t || n }, r.genId = function (e, t) { return e + "-" + t }, r.accounts2ids = function (e, t) { return t.map(function (t) { return r.genId(e, t) }) }, r.assembleMembers = function (e, t) { return i.isArray(t) || (t = [t]), t.map(function (t) { return r.assembleMember(e, t) }) }, r.assembleMember = function (e, t) { return { id: r.genId(e.teamId, t), account: t, teamId: e.teamId, type: "normal", nickInTeam: "", muteTeam: !1, mute: !1, joinTime: e.memberUpdateTime, updateTime: e.memberUpdateTime, active: !0, valid: !0 } }, r.assembleOwner = function (e) { var t = r.assembleMember(e, e.owner); return t.type = "owner", t }, e.exports = r }, function (e, t, n) { var r = n(43), i = Math.min; e.exports = function (e) { return e > 0 ? i(r(e), 9007199254740991) : 0 } }, function (e, t) { e.exports = function (e) { var t = n.call(e); return "[object Function]" === t || "function" == typeof e && "[object RegExp]" !== t || "undefined" != typeof window && (e === window.setTimeout || e === window.alert || e === window.confirm || e === window.prompt) }; var n = Object.prototype.toString }, function (e, t, n) { function r() { } var i = n(22); r.typeMap = { text: 0, image: 1, audio: 2, video: 3, geo: 4, notification: 5, file: 6, tip: 10, robot: 11, custom: 100 }; var o = r.typeReverseMap = { 0: "text", 1: "image", 2: "audio", 3: "video", 4: "geo", 5: "notification", 6: "file", 10: "tip", 11: "robot", 100: "custom" }; r.validTypes = Object.keys(r.typeMap), r.setFlow = function (e, t) { var n = t === e.from; n && t === e.to && (n = i.deviceId === e.fromDeviceId), e.flow = n ? "out" : "in", "robot" === e.type && e.content && e.content.msgOut && (e.flow = "in") }, r.getType = function (e) { var t = e.type; return o[t] || t }, e.exports = r }, function (module, exports, __webpack_require__) { (function (global, module) { function getGlobal() { return "undefined" != typeof window ? window : "undefined" != typeof self ? self : void 0 !== global ? global : {} } var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__, root = getGlobal(), io = module.exports; void 0 === root.location && (root.location = null), root.io ? module && (module.exports = io = root.io) : root.io = io, function () { var e, t, n; e = module.exports, t = root, n = e, n.version = "0.9.11", n.protocol = 1, n.transports = [], n.j = [], n.sockets = {}, n.connect = function (e, r) { var i, o, s = n.util.parseUri(e); t && t.location && (s.protocol = s.protocol || t.location.protocol.slice(0, -1), s.host = s.host || (t.document ? t.document.domain : t.location.hostname), s.port = s.port || t.location.port), i = n.util.uniqueUri(s); var a = { host: s.host, secure: "https" === s.protocol, port: s.port || ("https" === s.protocol ? 443 : 80), query: s.query || "" }; return n.util.merge(a, r), !a["force new connection"] && n.sockets[i] || (o = new n.Socket(a)), !a["force new connection"] && o && (n.sockets[i] = o), (o = o || n.sockets[i]).of(s.path.length > 1 ? s.path : "") }, function (e, t) { var n = e.util = {}, r = /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/, i = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"]; n.parseUri = function (e) { for (var t = r.exec(e || ""), n = {}, o = 14; o--;)n[i[o]] = t[o] || ""; return n }, n.uniqueUri = function (e) { var n = e.protocol, r = e.host, i = e.port; return "document" in t && t.document ? (r = r || document.domain, i = i || ("https" == n && "https:" !== document.location.protocol ? 443 : document.location.port)) : (r = r || "localhost", i || "https" != n || (i = 443)), (n || "http") + "://" + r + ":" + (i || 80) }, n.query = function (e, t) { var r = n.chunkQuery(e || ""), i = []; for (var o in n.merge(r, n.chunkQuery(t || "")), r) r.hasOwnProperty(o) && i.push(o + "=" + r[o]); return i.length ? "?" + i.join("&") : "" }, n.chunkQuery = function (e) { for (var t, n = {}, r = e.split("&"), i = 0, o = r.length; i < o; ++i)(t = r[i].split("="))[0] && (n[t[0]] = t[1]); return n }; var o = !1; n.load = function (e) { if ("undefined" != typeof document && document && "complete" === document.readyState || o) return e(); n.on(t, "load", e, !1) }, n.on = function (e, t, n, r) { e.attachEvent ? e.attachEvent("on" + t, n) : e.addEventListener && e.addEventListener(t, n, r) }, n.request = function (e) { if (e && "undefined" != typeof XDomainRequest && !n.ua.hasCORS) return new XDomainRequest; if ("undefined" != typeof XMLHttpRequest && (!e || n.ua.hasCORS)) return new XMLHttpRequest; if (!e) try { return new (root[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP") } catch (e) { } return null }, void 0 !== root && n.load(function () { o = !0 }), n.defer = function (e) { if (!n.ua.webkit || "undefined" != typeof importScripts) return e(); n.load(function () { setTimeout(e, 100) }) }, n.merge = function (e, t, r, i) { var o, s = i || [], a = void 0 === r ? 2 : r; for (o in t) t.hasOwnProperty(o) && n.indexOf(s, o) < 0 && ("object" == _typeof(e[o]) && a ? n.merge(e[o], t[o], a - 1, s) : (e[o] = t[o], s.push(t[o]))); return e }, n.mixin = function (e, t) { n.merge(e.prototype, t.prototype) }, n.inherit = function (e, t) { function n() { } n.prototype = t.prototype, e.prototype = new n }, n.isArray = Array.isArray || function (e) { return "[object Array]" === Object.prototype.toString.call(e) }, n.intersect = function (e, t) { for (var r = [], i = e.length > t.length ? e : t, o = e.length > t.length ? t : e, s = 0, a = o.length; s < a; s++)~n.indexOf(i, o[s]) && r.push(o[s]); return r }, n.indexOf = function (e, t, n) { var r = e.length; for (n = n < 0 ? n + r < 0 ? 0 : n + r : n || 0; n < r && e[n] !== t; n++); return r <= n ? -1 : n }, n.toArray = function (e) { for (var t = [], n = 0, r = e.length; n < r; n++)t.push(e[n]); return t }, n.ua = {}, n.ua.hasCORS = "undefined" != typeof XMLHttpRequest && function () { try { var e = new XMLHttpRequest } catch (e) { return !1 } return null != e.withCredentials }(), n.ua.webkit = "undefined" != typeof navigator && /webkit/i.test(navigator.userAgent), n.ua.iDevice = "undefined" != typeof navigator && /iPad|iPhone|iPod/i.test(navigator.userAgent) }(void 0 !== io ? io : module.exports, root), function (e, t) { function n() { } e.EventEmitter = n, n.prototype.on = function (e, n) { return this.$events || (this.$events = {}), this.$events[e] ? t.util.isArray(this.$events[e]) ? this.$events[e].push(n) : this.$events[e] = [this.$events[e], n] : this.$events[e] = n, this }, n.prototype.addListener = n.prototype.on, n.prototype.once = function (e, t) { function n() { r.removeListener(e, n), t.apply(this, arguments) } var r = this; return n.listener = t, this.on(e, n), this }, n.prototype.removeListener = function (e, n) { if (this.$events && this.$events[e]) { var r = this.$events[e]; if (t.util.isArray(r)) { for (var i = -1, o = 0, s = r.length; o < s; o++)if (r[o] === n || r[o].listener && r[o].listener === n) { i = o; break } if (i < 0) return this; r.splice(i, 1), r.length || delete this.$events[e] } else (r === n || r.listener && r.listener === n) && delete this.$events[e] } return this }, n.prototype.removeAllListeners = function (e) { return void 0 === e ? (this.$events = {}, this) : (this.$events && this.$events[e] && (this.$events[e] = null), this) }, n.prototype.listeners = function (e) { return this.$events || (this.$events = {}), this.$events[e] || (this.$events[e] = []), t.util.isArray(this.$events[e]) || (this.$events[e] = [this.$events[e]]), this.$events[e] }, n.prototype.emit = function (e) { if (!this.$events) return !1; var n = this.$events[e]; if (!n) return !1; var r = Array.prototype.slice.call(arguments, 1); if ("function" == typeof n) n.apply(this, r); else { if (!t.util.isArray(n)) return !1; for (var i = n.slice(), o = 0, s = i.length; o < s; o++)i[o].apply(this, r) } return !0 } }(void 0 !== io ? io : module.exports, void 0 !== io ? io : module.parent.exports), function (exports, nativeJSON) { function f(e) { return e < 10 ? "0" + e : e } function date(e, t) { return isFinite(e.valueOf()) ? e.getUTCFullYear() + "-" + f(e.getUTCMonth() + 1) + "-" + f(e.getUTCDate()) + "T" + f(e.getUTCHours()) + ":" + f(e.getUTCMinutes()) + ":" + f(e.getUTCSeconds()) + "Z" : null } function quote(e) { return escapable.lastIndex = 0, escapable.test(e) ? '"' + e.replace(escapable, function (e) { var t = meta[e]; return "string" == typeof t ? t : "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4) }) + '"' : '"' + e + '"' } function str(e, t) { var n, r, i, o, s, a = gap, c = t[e]; switch (c instanceof Date && (c = date(e)), "function" == typeof rep && (c = rep.call(t, e, c)), void 0 === c ? "undefined" : _typeof(c)) { case "string": return quote(c); case "number": return isFinite(c) ? String(c) : "null"; case "boolean": case "null": return String(c); case "object": if (!c) return "null"; if (gap += indent, s = [], "[object Array]" === Object.prototype.toString.apply(c)) { for (o = c.length, n = 0; n < o; n += 1)s[n] = str(n, c) || "null"; return i = 0 === s.length ? "[]" : gap ? "[\n" + gap + s.join(",\n" + gap) + "\n" + a + "]" : "[" + s.join(",") + "]", gap = a, i } if (rep && "object" == (void 0 === rep ? "undefined" : _typeof(rep))) for (o = rep.length, n = 0; n < o; n += 1)"string" == typeof rep[n] && (i = str(r = rep[n], c)) && s.push(quote(r) + (gap ? ": " : ":") + i); else for (r in c) Object.prototype.hasOwnProperty.call(c, r) && (i = str(r, c)) && s.push(quote(r) + (gap ? ": " : ":") + i); return i = 0 === s.length ? "{}" : gap ? "{\n" + gap + s.join(",\n" + gap) + "\n" + a + "}" : "{" + s.join(",") + "}", gap = a, i } } if (nativeJSON && nativeJSON.parse) return exports.JSON = { parse: nativeJSON.parse, stringify: nativeJSON.stringify }; var JSON = exports.JSON = {}, cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, rep; JSON.stringify = function (e, t, n) { var r; if (gap = "", indent = "", "number" == typeof n) for (r = 0; r < n; r += 1)indent += " "; else "string" == typeof n && (indent = n); if (rep = t, t && "function" != typeof t && ("object" != (void 0 === t ? "undefined" : _typeof(t)) || "number" != typeof t.length)) throw new Error("socket.io:: replacer cannot JSON.stringify"); return str("", { "": e }) }, JSON.parse = function (text, reviver) { function walk(e, t) { var n, r, i = e[t]; if (i && "object" == (void 0 === i ? "undefined" : _typeof(i))) for (n in i) Object.prototype.hasOwnProperty.call(i, n) && (void 0 !== (r = walk(i, n)) ? i[n] = r : delete i[n]); return reviver.call(e, t, i) } var j; if (text = String(text), cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function (e) { return "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4) })), /^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) return j = eval("(" + text + ")"), "function" == typeof reviver ? walk({ "": j }, "") : j; throw new SyntaxError("socket.io:: reviver cannot JSON.parse") } }(void 0 !== io ? io : module.exports, "undefined" != typeof JSON ? JSON : void 0), function (e, t) { var n = e.parser = {}, r = n.packets = ["disconnect", "connect", "heartbeat", "message", "json", "event", "ack", "error", "noop"], i = n.reasons = ["transport not supported", "client not handshaken", "unauthorized"], o = n.advice = ["reconnect"], s = t.JSON, a = t.util.indexOf; n.encodePacket = function (e) { var t = a(r, e.type), n = e.id || "", c = e.endpoint || "", u = e.ack, l = null; switch (e.type) { case "error": var m = e.reason ? a(i, e.reason) : "", d = e.advice ? a(o, e.advice) : ""; "" === m && "" === d || (l = m + ("" !== d ? "+" + d : "")); break; case "message": "" !== e.data && (l = e.data); break; case "event": var p = { name: e.name }; e.args && e.args.length && (p.args = e.args), l = s.stringify(p); break; case "json": l = s.stringify(e.data); break; case "connect": e.qs && (l = e.qs); break; case "ack": l = e.ackId + (e.args && e.args.length ? "+" + s.stringify(e.args) : "") }var f = [t, n + ("data" == u ? "+" : ""), c]; return null != l && f.push(l), f.join(":") }, n.encodePayload = function (e) { var t = ""; if (1 == e.length) return e[0]; for (var n = 0, r = e.length; n < r; n++)t += "�" + e[n].length + "�" + e[n]; return t }; var c = /([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/; n.decodePacket = function (e) { if (!(a = e.match(c))) return {}; var t = a[2] || "", n = (e = a[5] || "", { type: r[a[1]], endpoint: a[4] || "" }); switch (t && (n.id = t, a[3] ? n.ack = "data" : n.ack = !0), n.type) { case "error": var a = e.split("+"); n.reason = i[a[0]] || "", n.advice = o[a[1]] || ""; break; case "message": n.data = e || ""; break; case "event": try { var u = s.parse(e); n.name = u.name, n.args = u.args } catch (e) { } n.args = n.args || []; break; case "json": try { n.data = s.parse(e) } catch (e) { } break; case "connect": n.qs = e || ""; break; case "ack": if ((a = e.match(/^([0-9]+)(\+)?(.*)/)) && (n.ackId = a[1], n.args = [], a[3])) try { n.args = a[3] ? s.parse(a[3]) : [] } catch (e) { } }return n }, n.decodePayload = function (e) { if ("�" == e.charAt(0)) { for (var t = [], r = 1, i = ""; r < e.length; r++)if ("�" == e.charAt(r)) { var o = e.substr(r + 1).substr(0, i); if ("�" != e.charAt(r + 1 + Number(i)) && r + 1 + Number(i) != e.length) { var s = Number(i); l = function (e, t) { for (var n = 0, r = e; r < t.length; r++) { if ("�" == t.charAt(r)) return n; n++ } return n }(r + s + 1, e), o = e.substr(r + 1).substr(0, s + l), r += l } t.push(n.decodePacket(o)), r += Number(i) + 1, i = "" } else i += e.charAt(r); return t } return [n.decodePacket(e)] } }(void 0 !== io ? io : module.exports, void 0 !== io ? io : module.parent.exports), function (e, t) { function n(e, t) { this.socket = e, this.sessid = t } e.Transport = n, t.util.mixin(n, t.EventEmitter), n.prototype.heartbeats = function () { return !0 }, n.prototype.onData = function (e) { if (this !== this.socket.transport) return this; if (this.clearCloseTimeout(), (this.socket.connected || this.socket.connecting || this.socket.reconnecting) && this.setCloseTimeout(), "" !== e) { var n = t.parser.decodePayload(e); if (n && n.length) for (var r = 0, i = n.length; r < i; r++)this.onPacket(n[r]) } return this }, n.prototype.onPacket = function (e) { return this.socket.setHeartbeatTimeout(), "heartbeat" == e.type ? this.onHeartbeat() : ("connect" == e.type && "" == e.endpoint && this.onConnect(), "error" == e.type && "reconnect" == e.advice && (this.isOpen = !1), this.socket.onPacket(e), this) }, n.prototype.setCloseTimeout = function () { if (!this.closeTimeout) { var e = this; this.closeTimeout = setTimeout(function () { e.onDisconnect() }, this.socket.closeTimeout) } }, n.prototype.onDisconnect = function () { return this.isOpen && this.close(), this.clearTimeouts(), this.socket ? (this.socket.transport === this ? this.socket.onDisconnect() : this.socket.setBuffer(!1), this) : this }, n.prototype.onConnect = function () { return this.socket.onConnect(), this }, n.prototype.clearCloseTimeout = function () { this.closeTimeout && (clearTimeout(this.closeTimeout), this.closeTimeout = null) }, n.prototype.clearTimeouts = function () { this.clearCloseTimeout(), this.reopenTimeout && clearTimeout(this.reopenTimeout) }, n.prototype.packet = function (e) { this.send(t.parser.encodePacket(e)) }, n.prototype.onHeartbeat = function (e) { this.packet({ type: "heartbeat" }) }, n.prototype.onOpen = function () { this.isOpen = !0, this.clearCloseTimeout(), this.socket.onOpen() }, n.prototype.onClose = function () { this.isOpen = !1, this.socket.transport === this ? this.socket.onClose() : this.socket.setBuffer(!1), this.onDisconnect(), this.onDisconnectDone instanceof Function && this.onDisconnectDone(null), this.onConnectionOver instanceof Function && this.onConnectionOver(null) }, n.prototype.onDisconnectDone = function () { }, n.prototype.onConnectionOver = function () { }, n.prototype.prepareUrl = function () { var e = this.socket.options; return this.scheme() + "://" + e.host + ":" + e.port + "/" + e.resource + "/" + t.protocol + "/" + this.name + "/" + this.sessid }, n.prototype.ready = function (e, t) { t.call(this) } }(void 0 !== io ? io : module.exports, void 0 !== io ? io : module.parent.exports), function (e, t, n) { function r(e) { if (this.options = { port: 80, secure: !1, document: "document" in n && document, resource: "socket.io", transports: e.transports || t.transports, "connect timeout": 1e4, "try multiple transports": !0, reconnect: !0, "reconnection delay": 500, "reconnection limit": 1 / 0, "reopen delay": 3e3, "max reconnection attempts": 10, "sync disconnect on unload": !1, "auto connect": !0, "flash policy port": 10843, manualFlush: !1 }, t.util.merge(this.options, e), this.connected = !1, this.open = !1, this.connecting = !1, this.reconnecting = !1, this.namespaces = {}, this.buffer = [], this.doBuffer = !1, this.options["sync disconnect on unload"] && (!this.isXDomain() || t.util.ua.hasCORS)) { var r = this; t.util.on(n, "beforeunload", function () { r.disconnectSync() }, !1) } this.options["auto connect"] && this.connect() } function i() { } e.Socket = r, t.util.mixin(r, t.EventEmitter), r.prototype.of = function (e) { return this.namespaces[e] || (this.namespaces[e] = new t.SocketNamespace(this, e), "" !== e && this.namespaces[e].packet({ type: "connect" })), this.namespaces[e] }, r.prototype.publish = function () { var e; for (var t in this.emit.apply(this, arguments), this.namespaces) this.namespaces.hasOwnProperty(t) && (e = this.of(t)).$emit.apply(e, arguments) }, r.prototype.handshake = function (e) { function n(t) { t instanceof Error ? (r.connecting = !1, r.onError(t.message)) : e.apply(null, t.split(":")) } var r = this, o = this.options, s = ["http" + (o.secure ? "s" : "") + ":/", o.host + ":" + o.port, o.resource, t.protocol, t.util.query(this.options.query, "t=" + +new Date)].join("/"); if (this.isXDomain() && !t.util.ua.hasCORS && "undefined" != typeof document && document && document.getElementsByTagName) { var a = document.getElementsByTagName("script")[0], c = document.createElement("script"); c.src = s + "&jsonp=" + t.j.length, c.onreadystatechange = function () { "loaded" == this.readyState && c.parentNode && (c.parentNode.removeChild(c), r.connecting = !1, !r.reconnecting && r.onError("Server down or port not open"), r.publish("handshake_failed")) }, a.parentNode.insertBefore(c, a), t.j.push(function (e) { n(e), c.parentNode.removeChild(c) }) } else { var u = t.util.request(); u.open("GET", s, !0), u.timeout = 1e4, this.isXDomain() && (u.withCredentials = !0), u.onreadystatechange = function () { 4 == u.readyState && (u.onreadystatechange = i, 200 == u.status ? n(u.responseText) : 403 == u.status ? (r.connecting = !1, r.onError(u.responseText), r.publish("handshake_failed")) : (r.connecting = !1, !r.reconnecting && r.onError(u.responseText), r.publish("handshake_failed"))) }, u.ontimeout = function (e) { r.connecting = !1, !r.reconnecting && r.onError(u.responseText), r.publish("handshake_failed") }, u.send(null) } }, r.prototype.connect = function (e) { if (this.connecting) return this; var n = this; return n.connecting = !0, this.handshake(function (r, i, o, s) { n.sessionid = r, n.closeTimeout = 1e3 * o, n.heartbeatTimeout = 1e3 * i, n.transports || (n.transports = n.origTransports = s ? t.util.intersect(s.split(","), n.options.transports) : n.options.transports), n.setHeartbeatTimeout(), n.once("connect", function () { clearTimeout(n.connectTimeoutTimer), n.connectTimeoutTimer = null, e && "function" == typeof e && e() }), n.doConnect() }), this }, r.prototype.doConnect = function () { var e = this; if (e.transport && e.transport.clearTimeouts(), e.transport = e.getTransport(e.transports), !e.transport) return e.publish("connect_failed"); e.transport.ready(e, function () { e.connecting = !0, e.publish("connecting", e.transport.name), e.transport.open(), e.options["connect timeout"] && (e.connectTimeoutTimer && clearTimeout(e.connectTimeoutTimer), e.connectTimeoutTimer = setTimeout(e.tryNextTransport.bind(e), e.options["connect timeout"])) }) }, r.prototype.getTransport = function (e) { for (var n, r = e || this.transports, i = 0; n = r[i]; i++)if (t.Transport[n] && t.Transport[n].check(this) && (!this.isXDomain() || t.Transport[n].xdomainCheck(this))) return new t.Transport[n](this, this.sessionid); return null }, r.prototype.tryNextTransport = function () { if (!this.connected && (this.connecting = !1, this.options["try multiple transports"])) { for (var e = this.transports; e.length > 0 && e.splice(0, 1)[0] != this.transport.name;); e.length ? this.doConnect() : this.publish("connect_failed") } }, r.prototype.setHeartbeatTimeout = function () { if (clearTimeout(this.heartbeatTimeoutTimer), !this.transport || this.transport.heartbeats()) { var e = this; this.heartbeatTimeoutTimer = setTimeout(function () { e.transport && e.transport.onClose() }, this.heartbeatTimeout) } }, r.prototype.packet = function (e) { return this.connected && !this.doBuffer ? this.transport.packet(e) : this.buffer.push(e), this }, r.prototype.setBuffer = function (e) { this.doBuffer = e, !e && this.connected && this.buffer.length && (this.options.manualFlush || this.flushBuffer()) }, r.prototype.flushBuffer = function () { this.transport.payload(this.buffer), this.buffer = [] }, r.prototype.disconnect = function () { return (this.connected || this.connecting) && (this.open && this.of("").packet({ type: "disconnect" }), this.onDisconnect("booted")), this }, r.prototype.disconnectSync = function () { var e = t.util.request(), n = ["http" + (this.options.secure ? "s" : "") + ":/", this.options.host + ":" + this.options.port, this.options.resource, t.protocol, "", this.sessionid].join("/") + "/?disconnect=1"; e.open("GET", n, !1), e.send(null), this.onDisconnect("booted") }, r.prototype.isXDomain = function () { var e = n.location.port || ("https:" == n.location.protocol ? 443 : 80); return this.options.host !== n.location.hostname || this.options.port != e }, r.prototype.onConnect = function () { this.connected || (this.connected = !0, this.connecting = !1, this.doBuffer || this.setBuffer(!1), this.emit("connect")) }, r.prototype.onOpen = function () { this.open = !0 }, r.prototype.onClose = function () { this.open = !1, clearTimeout(this.heartbeatTimeoutTimer) }, r.prototype.onPacket = function (e) { this.of(e.endpoint).onPacket(e) }, r.prototype.onError = function (e) { e && e.advice && "reconnect" === e.advice && (this.connected || this.connecting) && (this.disconnect(), this.options.reconnect && this.reconnect()), this.publish("error", e && e.reason ? e.reason : e) }, r.prototype.onDisconnect = function (e) { var t = this.connected, n = this.connecting; this.connected = !1, this.connecting = !1, this.open = !1, (t || n) && (this.transport.close(), this.transport.clearTimeouts(), t && (this.publish("disconnect", e), "booted" != e && this.options.reconnect && !this.reconnecting && this.reconnect()), n && (this.connectTimeoutTimer && clearTimeout(this.connectTimeoutTimer), this.tryNextTransport())) }, r.prototype.reconnect = function () { function e() { if (n.connected) { for (var e in n.namespaces) n.namespaces.hasOwnProperty(e) && "" !== e && n.namespaces[e].packet({ type: "connect" }); n.publish("reconnect", n.transport.name, n.reconnectionAttempts) } clearTimeout(n.reconnectionTimer), n.removeListener("connect_failed", t), n.removeListener("connect", t), n.reconnecting = !1, delete n.reconnectionAttempts, delete n.reconnectionDelay, delete n.reconnectionTimer, delete n.redoTransports, n.options["try multiple transports"] = i } function t() { if (n.reconnecting) return n.connected ? e() : n.connecting && n.reconnecting ? n.reconnectionTimer = setTimeout(t, 1e3) : void (n.reconnectionAttempts++ >= r ? n.redoTransports ? (n.publish("reconnect_failed"), e()) : (n.on("connect_failed", t), n.options["try multiple transports"] = !0, n.transports = n.origTransports, n.transport = n.getTransport(), n.redoTransports = !0, n.connect()) : (n.reconnectionDelay < o && (n.reconnectionDelay *= 2), n.connect(), n.publish("reconnecting", n.reconnectionDelay, n.reconnectionAttempts), n.reconnectionTimer = setTimeout(t, n.reconnectionDelay))) } this.reconnecting = !0, this.reconnectionAttempts = 0, this.reconnectionDelay = this.options["reconnection delay"]; var n = this, r = this.options["max reconnection attempts"], i = this.options["try multiple transports"], o = this.options["reconnection limit"]; this.options["try multiple transports"] = !1, this.reconnectionTimer = setTimeout(t, this.reconnectionDelay), this.on("connect", t) } }(void 0 !== io ? io : module.exports, void 0 !== io ? io : module.parent.exports, root), function (e, t) { function n(e, t) { this.socket = e, this.name = t || "", this.flags = {}, this.json = new r(this, "json"), this.ackPackets = 0, this.acks = {} } function r(e, t) { this.namespace = e, this.name = t } e.SocketNamespace = n, t.util.mixin(n, t.EventEmitter), n.prototype.$emit = t.EventEmitter.prototype.emit, n.prototype.of = function () { return this.socket.of.apply(this.socket, arguments) }, n.prototype.packet = function (e) { return e.endpoint = this.name, this.socket.packet(e), this.flags = {}, this }, n.prototype.send = function (e, t) { var n = { type: this.flags.json ? "json" : "message", data: e }; return "function" == typeof t && (n.id = ++this.ackPackets, n.ack = !0, this.acks[n.id] = t), this.packet(n) }, n.prototype.emit = function (e) { var t = Array.prototype.slice.call(arguments, 1), n = t[t.length - 1], r = { type: "event", name: e }; return "function" == typeof n && (r.id = ++this.ackPackets, r.ack = "data", this.acks[r.id] = n, t = t.slice(0, t.length - 1)), r.args = t, this.packet(r) }, n.prototype.disconnect = function () { return "" === this.name ? this.socket.disconnect() : (this.packet({ type: "disconnect" }), this.$emit("disconnect")), this }, n.prototype.onPacket = function (e) { function n() { r.packet({ type: "ack", args: t.util.toArray(arguments), ackId: e.id }) } var r = this; switch (e.type) { case "connect": this.$emit("connect"); break; case "disconnect": "" === this.name ? this.socket.onDisconnect(e.reason || "booted") : this.$emit("disconnect", e.reason); break; case "message": case "json": var i = ["message", e.data]; "data" == e.ack ? i.push(n) : e.ack && this.packet({ type: "ack", ackId: e.id }), this.$emit.apply(this, i); break; case "event": i = [e.name].concat(e.args), "data" == e.ack && i.push(n), this.$emit.apply(this, i); break; case "ack": this.acks[e.ackId] && (this.acks[e.ackId].apply(this, e.args), delete this.acks[e.ackId]); break; case "error": console.error("SocketIO on packet error: ", e), e.advice ? this.socket.onError(e) : "unauthorized" === e.reason ? this.$emit("connect_failed", e.reason) : this.$emit("error", e.reason) } }, r.prototype.send = function () { this.namespace.flags[this.name] = !0, this.namespace.send.apply(this.namespace, arguments) }, r.prototype.emit = function () { this.namespace.flags[this.name] = !0, this.namespace.emit.apply(this.namespace, arguments) } }(void 0 !== io ? io : module.exports, void 0 !== io ? io : module.parent.exports), function (e, t, n) { function r(e) { t.Transport.apply(this, arguments) } e.websocket = r, t.util.inherit(r, t.Transport), r.prototype.name = "websocket", r.prototype.open = function () { var e, r = t.util.query(this.socket.options.query), i = this; return e || (e = n.MozWebSocket || n.WebSocket), this.websocket = new e(this.prepareUrl() + r), this.websocket.onopen = function () { i.onOpen(), i.socket.setBuffer(!1) }, this.websocket.onmessage = function (e) { i.onData(e.data) }, this.websocket.onclose = function () { i.socket.setBuffer(!0), i.onClose() }, this.websocket.onerror = function (e) { i.onError(e) }, this }, t.util.ua.iDevice ? r.prototype.send = function (e) { var t = this; return setTimeout(function () { t.websocket.send(e) }, 0), this } : r.prototype.send = function (e) { return this.websocket.send(e), this }, r.prototype.payload = function (e) { for (var t = 0, n = e.length; t < n; t++)this.packet(e[t]); return this }, r.prototype.close = function () { return this.websocket.close(), this }, r.prototype.onError = function (e) { this.socket.onError(e) }, r.prototype.scheme = function () { return this.socket.options.secure ? "wss" : "ws" }, r.check = function () { return "WebSocket" in n && !("__addTask" in WebSocket) || "MozWebSocket" in n }, r.xdomainCheck = function () { return !0 }, t.transports.push("websocket") }(void 0 !== io ? io.Transport : module.exports, void 0 !== io ? io : module.parent.exports, root), function (e, t, n) { function r(e) { e && (t.Transport.apply(this, arguments), this.sendBuffer = []) } function i() { } e.XHR = r, t.util.inherit(r, t.Transport), r.prototype.open = function () { return this.socket.setBuffer(!1), this.onOpen(), this.get(), this.setCloseTimeout(), this }, r.prototype.payload = function (e) { for (var n = [], r = 0, i = e.length; r < i; r++)n.push(t.parser.encodePacket(e[r])); this.send(t.parser.encodePayload(n)) }, r.prototype.send = function (e) { return this.post(e), this }, r.prototype.post = function (e) { var t = this; this.socket.setBuffer(!0), this.sendXHR = this.request("POST"), n.XDomainRequest && this.sendXHR instanceof XDomainRequest ? this.sendXHR.onload = this.sendXHR.onerror = function () { this.onload = i, t.socket.setBuffer(!1) } : this.sendXHR.onreadystatechange = function () { 4 == this.readyState && (this.onreadystatechange = i, t.posting = !1, 200 == this.status ? t.socket.setBuffer(!1) : t.onClose()) }, this.sendXHR.send(e) }, r.prototype.close = function () { return this.onClose(), this }, r.prototype.request = function (e) { var n = t.util.request(this.socket.isXDomain()), r = t.util.query(this.socket.options.query, "t=" + +new Date); if (n.open(e || "GET", this.prepareUrl() + r, !0), "POST" == e) try { n.setRequestHeader ? n.setRequestHeader("Content-type", "text/plain;charset=UTF-8") : n.contentType = "text/plain" } catch (e) { } return n }, r.prototype.scheme = function () { return this.socket.options.secure ? "https" : "http" }, r.check = function (e, r) { try { var i = t.util.request(r), o = n.XDomainRequest && i instanceof XDomainRequest, s = e && e.options && e.options.secure ? "https:" : "http:", a = n.location && s != n.location.protocol; if (i && (!o || !a)) return !0 } catch (e) { } return !1 }, r.xdomainCheck = function (e) { return r.check(e, !0) } }(void 0 !== io ? io.Transport : module.exports, void 0 !== io ? io : module.parent.exports, root), function (e, t, n) { function r() { t.Transport.XHR.apply(this, arguments) } function i() { } e["xhr-polling"] = r, t.util.inherit(r, t.Transport.XHR), t.util.merge(r, t.Transport.XHR), r.prototype.name = "xhr-polling", r.prototype.heartbeats = function () { return !1 }, r.prototype.open = function () { return t.Transport.XHR.prototype.open.call(this), !1 }, r.prototype.get = function () { if (this.isOpen) { var e = this; this.xhr = this.request(), n.XDomainRequest && this.xhr instanceof XDomainRequest ? (this.xhr.onload = function () { this.onload = i, this.onerror = i, e.retryCounter = 1, e.onData(this.responseText), e.get() }, this.xhr.onerror = function () { e.retryCounter++ , !e.retryCounter || e.retryCounter > 3 ? e.onClose() : e.get() }) : this.xhr.onreadystatechange = function () { 4 == this.readyState && (this.onreadystatechange = i, 200 == this.status ? (e.onData(this.responseText), e.get()) : e.onClose()) }, this.xhr.send(null) } }, r.prototype.onClose = function () { if (t.Transport.XHR.prototype.onClose.call(this), this.xhr) { this.xhr.onreadystatechange = this.xhr.onload = this.xhr.onerror = i; try { this.xhr.abort() } catch (e) { } this.xhr = null } }, r.prototype.ready = function (e, n) { var r = this; t.util.defer(function () { n.call(r) }) }, t.transports.push("xhr-polling") }(void 0 !== io ? io.Transport : module.exports, void 0 !== io ? io : module.parent.exports, root), __WEBPACK_AMD_DEFINE_ARRAY__ = [], void 0 === (__WEBPACK_AMD_DEFINE_RESULT__ = function () { return io }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) || (module.exports = __WEBPACK_AMD_DEFINE_RESULT__) }() }).call(this, __webpack_require__(48), __webpack_require__(158)(module)) }, function (e, t, n) { var r = { 1: "ROOM_CLOSE", 2: "ROOM_JOIN", 3: "INVITE", 4: "CANCEL_INVITE", 5: "REJECT", 6: "ACCEPT", 7: "LEAVE", 8: "CONTROL" }, i = { 1: "accid", 2: "uid", 3: "createTime", 4: "expireTime", 5: "web_uid" }, o = { 10404: "ROOM_NOT_EXISTS", 10405: "ROOM_HAS_EXISTS", 10406: "ROOM_MEMBER_NOT_EXISTS", 10407: "ROOM_MEMBER_HAS_EXISTS", 10408: "INVITE_NOT_EXISTS", 10409: "INVITE_HAS_REJECT", 10410: "INVITE_HAS_ACCEPT", 10201: "PEER_NIM_OFFLINE", 10202: "PEER_PUSH_OFFLINE", 10419: "ROOM_MEMBER_EXCEED", 10420: "ROOM_MEMBER_HAS_EXISTS_OTHER_CLIENT", 10417: "UID_CONFLICT" }; e.exports = { parseAvSignalType: function (e) { return r[e] || e }, parseAvSignalMember: function (e) { var t = {}; return Object.keys(e).forEach(function (n) { t[i[n]] = e[n] }), t }, parseAvSignalError: function (e) { return e.message = o[e.code] || e.message || e, e } } }, function (e, t, n) { function r(e) { i.verifyOptions(e, "type", "image::ImageOp"), i.verifyParamValid("type", e.type, r.validTypes, "image::ImageOp"), i.merge(this, e), this.type = o[e.type] } var i = n(0), o = { stripmeta: 0, blur: 2, quality: 3, crop: 4, rotate: 5, thumbnail: 7, interlace: 9 }, s = { 0: "stripmeta", 1: "type", 2: "blur", 3: "quality", 4: "crop", 5: "rotate", 6: "pixel", 7: "thumbnail", 8: "watermark", 9: "interlace", 10: "tmp" }; r.validTypes = Object.keys(o), r.reverse = function (e) { var t = i.copy(e); return t.type = s[t.type], t }, r.reverseImageOps = function (e) { return e.map(function (e) { return r.reverse(e) }) }, e.exports = r }, function (e, t, n) { var r = n(0), i = { fromDataURL: function (e) { var t = r.getGlobal(), n = void 0; n = e.split(",")[0].indexOf("base64") >= 0 ? t.atob(e.split(",")[1]) : t.decodeURIComponent(e.split(",")[1]); for (var i = e.split(",")[0].split(":")[1].split(";")[0], o = new Uint8Array(n.length), s = 0; s < n.length; s++)o[s] = n.charCodeAt(s); return new t.Blob([o], { type: i }) } }; e.exports = i }, function (e, t, n) { var r = n(0), i = { file: { md5: "$(Etag)", size: "$(ObjectSize)" }, image: { md5: "$(Etag)", size: "$(ObjectSize)", w: "$(ImageInfo.Width)", h: "$(ImageInfo.Height)", orientation: "$(ImageInfo.Orientation)" }, audio: { md5: "$(Etag)", size: "$(ObjectSize)", dur: "$(AVinfo.Audio.Duration)" }, video: { md5: "$(Etag)", size: "$(ObjectSize)", dur: "$(AVinfo.Video.Duration)", w: "$(AVinfo.Video.Width)", h: "$(AVinfo.Video.Height)" } }, o = { genResponseBody: function (e) { return i[e = e || "file"] }, parseResponse: function (e, t) { r.notundef(e.size) && (e.size = +e.size), r.notundef(e.w) && (e.w = +e.w), r.notundef(e.h) && (e.h = +e.h), r.notundef(e.dur) && (e.dur = +e.dur); var n = e.orientation; if (r.notundef(n) && (delete e.orientation, t && ("right, top" === n || "left, bottom" === n))) { var i = e.w; e.w = e.h, e.h = i } return e } }; e.exports = o }, function (e, t, n) { var r = n(15), i = r.getGlobal(), o = {}, s = i.name || "_parent", a = [], c = []; o.addMsgListener = function (e) { a.push(e) }; var u, l, m, d, p = (u = /^([\w]+?:\/\/.*?(?=\/|$))/i, function (e) { return e = e || "", u.test(e) ? RegExp.$1 : "*" }), f = function () { var e = unescape(i.name || "").trim(); if (e && 0 === e.indexOf("MSG|")) { i.name = ""; var t = r.string2object(e.replace("MSG|", ""), "|"), n = (t.origin || "").toLowerCase(); n && "*" !== n && 0 !== location.href.toLowerCase().indexOf(n) || function (e) { for (var t = 0, n = a.length; t < n; t++)try { a[t].call(null, e) } catch (e) { } }({ data: JSON.parse(t.data || "null"), source: i.frames[t.self] || t.self, origin: p(t.ref || ("undefined" == typeof document ? "" : document.referrer)) }) } }, g = (m = function (e, t) { for (var n = 0, r = e.length; n < r; n++)if (e[n] === t) return !0; return !1 }, function () { if (c.length) { l = []; for (var e, t = c.length - 1; t >= 0; t--)e = c[t], m(l, e.w) || (l.push(e.w), c.splice(t, 1), e.w.name = e.d); l = null } }), h = o.startTimer = (d = !1, function () { d || (d = !0, i.postMessage || (setInterval(g, 100), setInterval(f, 20))) }); o.postMessage = function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if (r.fillUndef(t, { origin: "*", source: s }), i.postMessage) { var n = t.data; i.FormData || (n = JSON.stringify(n)), e.postMessage(n, t.origin) } else { if (h(), r.isObject(t)) { var o = {}; o.origin = t.origin || "", o.ref = location.href, o.self = t.source, o.data = JSON.stringify(t.data), t = "MSG|" + r.object2string(o, "|", !0) } c.unshift({ w: e, d: escape(t) }) } }, e.exports = o }, function (e, t) { e.exports = function (e, t) { for (var n = t.split("."); n.length;) { var r = n.shift(), i = !1; if ("?" == r[r.length - 1] && (r = r.slice(0, -1), i = !0), !(e = e[r]) && i) return e } return e } }, function (e, t) { e.exports = function e(t, n) { var r, i, o = /(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi, s = /(^[ ]*|[ ]*$)/g, a = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/, c = /^0x[0-9a-f]+$/i, u = /^0/, l = function (t) { return e.insensitive && ("" + t).toLowerCase() || "" + t }, m = l(t).replace(s, "") || "", d = l(n).replace(s, "") || "", p = m.replace(o, "\0$1\0").replace(/\0$/, "").replace(/^\0/, "").split("\0"), f = d.replace(o, "\0$1\0").replace(/\0$/, "").replace(/^\0/, "").split("\0"), g = parseInt(m.match(c), 16) || 1 !== p.length && m.match(a) && Date.parse(m), h = parseInt(d.match(c), 16) || g && d.match(a) && Date.parse(d) || null; if (h) { if (g < h) return -1; if (g > h) return 1 } for (var y = 0, v = Math.max(p.length, f.length); y < v; y++) { if (r = !(p[y] || "").match(u) && parseFloat(p[y]) || p[y] || 0, i = !(f[y] || "").match(u) && parseFloat(f[y]) || f[y] || 0, isNaN(r) !== isNaN(i)) return isNaN(r) ? 1 : -1; if ((void 0 === r ? "undefined" : _typeof(r)) != (void 0 === i ? "undefined" : _typeof(i)) && (r += "", i += ""), r < i) return -1; if (r > i) return 1 } return 0 } }, function (e, t, n) { e.exports = {} }, function (e, t, n) { function r(e) { return e && e.__esModule ? e : { default: e } } var i = r(n(21)), o = r(n(20)), s = n(90), a = 0, c = 1, u = 3, l = function () { function e(t, n) { var r = this; if ((0, i.default)(this, e), !t) throw new TypeError("Failed to construct 'WebSocket': url required"); if (n && (!wx.canIUse || !wx.canIUse("connectSocket.object.protocols"))) throw new Error("subprotocal not supported in weapp"); t = t.replace(/:\d+/, ""), this._url = t, this._protocal = n || "", this._readyState = a, this._socketTask = wx.connectSocket({ url: t, protocals: this._protocal, fail: function (e) { console.info("wx::ws: sockets build failed ..."), r.errorHandler(e) }, success: function (e) { console.log("wx::ws: sockets build succeed ...") } }), this._socketTask.onOpen(function (e) { r._readyState = c, console.log("wx::ws: onopen ", e), r.dispatchEvent({ type: "open" }) }), this._socketTask.onError(function (e) { r.errorHandler(e) }), this._socketTask.onClose(function (e) { r._readyState = u, console.log("wx::ws: onclose ", e); var t = e.code, n = e.reason, i = e.wasClean; r.dispatchEvent({ code: t, reason: n, wasClean: i, type: "close" }), r._socketTask = null }), this._socketTask.onMessage(function (e) { var t = e.data, n = e.origin, i = e.ports, o = e.source; r.dispatchEvent({ data: t, origin: n, ports: i, source: o, type: "message" }) }) } return (0, o.default)(e, [{ key: "dispatchEvent", value: function (e) { var t = "on" + e.type; "function" == typeof this[t] && this[t](e) } }, { key: "close", value: function () { try { console.log("wx::ws:close WebSocket force close: readystate " + this._readyState), this._socketTask.close({ code: 1e3, reason: "wx::ws:user force close websocket", complete: function () { } }) } catch (e) { console.warn("wx::ws:close WebSocket force error", e) } } }, { key: "send", value: function (e) { if (this._readyState !== c) throw new Error("wx:ws: sendMsg when readyState=" + this._readyState); if (!("string" == typeof e || e instanceof ArrayBuffer)) throw new TypeError("wx:ws: sendMsg only String/ArrayBuffer supported"); this._socketTask.send({ data: e }) } }, { key: "errorHandler", value: function (e) { console.error("wx::ws: onerror ", e), this._readyState = u, this.dispatchEvent({ type: "error", message: e.errMsg }), e.errMsg && "[object Array]" === Object.prototype.toString.call(e.errMsg) && (e.errMsg.indexOf("断裂管道") > 0 || e.errMsg.indexOf("broken pipe") > 0) && this.dispatchEvent({ code: 1006, reason: e.errMsg, type: "close" }), this._socketTask = null } }, { key: "url", get: function () { return this._url } }, { key: "protocal", get: function () { return this._protocal } }, { key: "readyState", get: function () { return this._readyState } }]), e }(); s(l, { CONNECTING: a, OPEN: c, CLOSING: 2, CLOSED: u }), e.exports = l }, function (e, t, n) { var r = Object.getOwnPropertySymbols, i = Object.prototype.hasOwnProperty, o = Object.prototype.propertyIsEnumerable; e.exports = function () { try { if (!Object.assign) return !1; var e = new String("abc"); if (e[5] = "de", "5" === Object.getOwnPropertyNames(e)[0]) return !1; for (var t = {}, n = 0; n < 10; n++)t["_" + String.fromCharCode(n)] = n; if ("0123456789" !== Object.getOwnPropertyNames(t).map(function (e) { return t[e] }).join("")) return !1; var r = {}; return "abcdefghijklmnopqrst".split("").forEach(function (e) { r[e] = e }), "abcdefghijklmnopqrst" === Object.keys(Object.assign({}, r)).join("") } catch (e) { return !1 } }() ? Object.assign : function (e, t) { for (var n, s, a = function (e) { if (null == e) throw new TypeError("Object.assign cannot be called with null or undefined"); return Object(e) }(e), c = 1; c < arguments.length; c++) { for (var u in n = Object(arguments[c])) i.call(n, u) && (a[u] = n[u]); if (r) { s = r(n); for (var l = 0; l < s.length; l++)o.call(n, s[l]) && (a[s[l]] = n[s[l]]) } } return a } }, function (e, t, n) { function r(e) { return e && e.__esModule ? e : { default: e } } function i(e) { this.status = e.statusCode, this.statusText = e.statusCode, e.header && (this._responseHeaders = Object.keys(e.header).reduce(function (t, n) { return t[n.toLowerCase()] = e.header[n], t }, {})); var t = e.data; "string" != typeof t && (t = JSON.stringify(t)), this.responseText = this.response = t, this.readyState = m, this.dispatchEvent({ type: "readystatechange" }) } var o = r(n(180)), s = r(n(21)), a = r(n(20)), c = n(90), u = n(61), l = 0, m = 4, d = function () { function e() { (0, s.default)(this, e) } return (0, a.default)(e, [{ key: "dispatchEvent", value: function (e) { var t = "on" + e.type; "function" == typeof this[t] && this[t](e) } }]), e }(), p = function () { function e() { (0, s.default)(this, e), this.readyState = l, this._headers = {}, this.upload = new d } return (0, a.default)(e, [{ key: "dispatchEvent", value: function (e) { var t = "on" + e.type; "function" == typeof this[t] && this[t](e) } }, { key: "abort", value: function () { if (!this._request || this._request.abort) return this.status = 0, this.readyState = m, this._request.abort(); throw new Error("该版本基础库不支持 abort request") } }, { key: "getAllResponseHeaders", value: function () { var e = this; return this._responseHeaders ? Object.keys(this._responseHeaders).map(function (t) { return t + ": " + e._responseHeaders[t] }).join("\r\n") : "" } }, { key: "getResponseHeader", value: function (e) { var t = e.toLowerCase(); return this._responseHeaders && this._responseHeaders[t] ? this._responseHeaders[t] : null } }, { key: "overrideMimeType", value: function () { throw new Error("not supported in weapp") } }, { key: "open", value: function (e, t) { var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2]; if (this.readyState !== l) throw new Error("request is already opened"); if (!n) throw new Error("sync request is not supported"); this._method = e, t = t.replace(/:\d+/, ""), this._url = t, this.readyState = 1, this.dispatchEvent({ type: "readystatechange" }) } }, { key: "setRequestHeader", value: function (e, t) { if (1 !== this.readyState) throw new Error("request is not opened"); this._headers[e.toLowerCase()] = t } }, { key: "send", value: function (e) { var t = this; if (1 !== this.readyState) throw new Error("request is not opened"); if (e instanceof u) { var n = e.entries(), r = n.filter(function (e) { return "string" != typeof e[1] }); if (0 === r.length) throw new Error("Must specify a Blob field in FormData"); r.length > 1 && console.warn("Only the first Blob will be send in Weapp"); var s = n.filter(function (e) { return "string" == typeof e[1] }).reduce(function (e, t) { return c(e, (0, o.default)({}, t[0], t[1])) }, {}); this._request = wx.uploadFile({ url: this._url, name: r[0][0], filePath: r[0][1].uri, formData: s, header: this._headers, success: i.bind(this), fail: function (e) { t.status = 0, t.readyState = m, t.dispatchEvent({ type: "readystatechange" }), t.dispatchEvent({ type: "error" }) } }), this._request && this._request.onProgressUpdate && this._request.onProgressUpdate(function (e) { var n = e.totalBytesSent, r = e.totalBytesExpectedToSend; t.upload.dispatchEvent({ type: "progress", loaded: n, total: r }) }) } else this._request = wx.request({ url: this._url, data: e || "", method: this._method.toUpperCase(), header: this._headers, success: i.bind(this), fail: function (e) { t.status = 0, t.readyState = m, t.dispatchEvent({ type: "readystatechange" }), t.dispatchEvent({ type: "error" }) } }) } }]), e }(); c(p, { UNSENT: l, OPENED: 1, HEADERS_RECEIVED: 2, LOADING: 3, DONE: m }), e.exports = p }, function (e, t, n) { function r(e) { return e && e.__esModule ? e : { default: e } } var i = r(n(21)), o = r(n(20)), s = function () { function e() { (0, i.default)(this, e) } return (0, o.default)(e, [{ key: "getItem", value: function (e) { return wx.getStorageSync(e) } }, { key: "setItem", value: function (e, t) { return wx.setStorageSync(e, t) } }, { key: "removeItem", value: function (e) { return this.setItem(e, "") } }, { key: "clear", value: function () { return wx.clearStorageSync() } }]), e }(); e.exports = new s }, function (e, t, n) { var r = n(30), i = n(27), o = n(13), s = n(40), a = n(10), c = n(67), u = Object.getOwnPropertyDescriptor; t.f = n(11) ? u : function (e, t) { if (e = o(e), t = s(t, !0), c) try { return u(e, t) } catch (e) { } if (a(e, t)) return i(!r.f.call(e, t), e[t]) } }, , , function (e, t, n) { var r = n(46), i = n(139), o = n(80), s = n(87), a = n(86), c = n(0), u = n(133), l = n(83), m = n(17), d = n(132), p = n(131); e.exports = function (e) { c.merge(e, { platform: r, xhr: i, io: o, naturalSort: s, deepAccess: a, util: c, support: u, blob: l, ajax: m, LoggerPlugin: d, usePlugin: p }) } }, function (e, t, n) { var r = n(0), i = n(59), o = r.merge({}, i.idMap, { auth: { id: 2, login: 3, kicked: 5, logout: 6, multiPortLogin: 7, kick: 8 }, user: { id: 3, updatePushToken: 1, appBackground: 2, markInBlacklist: 3, getBlacklist: 4, markInMutelist: 5, getMutelist: 6, getRelations: 8, getUsers: 7, updateMyInfo: 10, updateDonnop: 15, syncMyInfo: 109, syncUpdateMyInfo: 110 }, notify: { id: 4, markRead: 3, syncOfflineMsgs: 4, batchMarkRead: 5, syncOfflineSysMsgs: 6, syncOfflineNetcallMsgs: 8, syncRoamingMsgs: 9, syncMsgReceipts: 12, syncRobots: 15, syncBroadcastMsgs: 16, syncSuperTeamRoamingMsgs: 17 }, sync: { id: 5, sync: 1, syncTeamMembers: 2, syncSuperTeamMembers: 3 }, msg: { id: 7, sendMsg: 1, msg: 2, sysMsg: 3, getHistoryMsgs: 6, sendCustomSysMsg: 7, searchHistoryMsgs: 8, deleteSessions: 9, getSessions: 10, syncSendMsg: 101, sendMsgReceipt: 11, msgReceipt: 12, deleteMsg: 13, msgDeleted: 14, markSessionAck: 16, broadcastMsg: 17, clearServerHistoryMsgs: 18 }, team: { id: 8, createTeam: 1, sendTeamMsg: 2, teamMsg: 3, teamMsgs: 4, addTeamMembers: 5, removeTeamMembers: 6, updateTeam: 7, leaveTeam: 8, getTeam: 9, getTeams: 10, getTeamMembers: 11, dismissTeam: 12, applyTeam: 13, passTeamApply: 14, rejectTeamApply: 15, addTeamManagers: 16, removeTeamManagers: 17, transferTeam: 18, updateInfoInTeam: 19, updateNickInTeam: 20, acceptTeamInvite: 21, rejectTeamInvite: 22, getTeamHistoryMsgs: 23, searchTeamHistoryMsgs: 24, updateMuteStateInTeam: 25, getMyTeamMembers: 26, getMutedTeamMembers: 27, sendTeamMsgReceipt: 28, getTeamMsgReads: 29, getTeamMsgReadAccounts: 30, notifyTeamMsgReads: 31, muteTeamAll: 32, getTeamMemberInvitorAccid: 33, syncMyTeamMembers: 126, syncTeams: 109, syncTeamMembers: 111, syncCreateTeam: 101, syncSendTeamMsg: 102, syncUpdateTeamMember: 119 }, superTeam: { id: 21, sendSuperTeamMsg: 2, superTeamMsg: 3, addSuperTeamMembers: 5, removeSuperTeamMembers: 6, leaveSuperTeam: 7, updateSuperTeam: 8, getSuperTeam: 9, getSuperTeams: 12, updateInfoInSuperTeam: 10, getMySuperTeamMembers: 11, getSuperTeamMembers: 13, getSuperTeamHistoryMsgs: 14, getSuperTeamMembersByJoinTime: 15, syncMySuperTeamMembers: 111, syncSuperTeams: 109, syncSuperTeamMembers: 113, syncCreateSuperTeam: 101, syncSendSuperTeamMsg: 102, syncUpdateSuperTeamMember: 110 }, friend: { id: 12, friendRequest: 1, syncFriendRequest: 101, deleteFriend: 2, syncDeleteFriend: 102, updateFriend: 3, syncUpdateFriend: 103, getFriends: 4 }, chatroom: { id: 13, getChatroomAddress: 1 }, filter: { id: 101, sendFilterMsg: 1, filterMsg: 2, filterSysMsg: 3, sendFilterCustomSysMsg: 7 }, eventService: { id: 14, publishEvent: 1, pushEvent: 2, subscribeEvent: 3, unSubscribeEventsByAccounts: 4, unSubscribeEventsByType: 5, querySubscribeEventsByAccounts: 6, querySubscribeEventsByType: 7, pushEvents: 9 } }), s = r.merge({}, i.cmdConfig, { login: { sid: o.auth.id, cid: o.auth.login, params: [{ type: "Property", name: "login" }] }, logout: { sid: o.auth.id, cid: o.auth.logout }, kick: { sid: o.auth.id, cid: o.auth.kick, params: [{ type: "StrArray", name: "deviceIds" }] }, updatePushToken: { sid: o.user.id, cid: o.user.updatePushToken, params: [{ type: "String", name: "tokenName" }, { type: "String", name: "token" }, { type: "int", name: "pushkit" }] }, appBackground: { sid: o.user.id, cid: o.user.appBackground, params: [{ type: "bool", name: "isBackground" }, { type: "Int", name: "badge" }] }, markInBlacklist: { sid: o.user.id, cid: o.user.markInBlacklist, params: [{ type: "String", name: "account" }, { type: "bool", name: "isAdd" }] }, getBlacklist: { sid: o.user.id, cid: o.user.getBlacklist, params: [{ type: "long", name: "time" }] }, markInMutelist: { sid: o.user.id, cid: o.user.markInMutelist, params: [{ type: "String", name: "account" }, { type: "bool", name: "isAdd" }] }, getMutelist: { sid: o.user.id, cid: o.user.getMutelist, params: [{ type: "long", name: "time" }] }, getRelations: { sid: o.user.id, cid: o.user.getRelations, params: [{ type: "long", name: "timetag" }] }, getUsers: { sid: o.user.id, cid: o.user.getUsers, params: [{ type: "StrArray", name: "accounts" }] }, updateMyInfo: { sid: o.user.id, cid: o.user.updateMyInfo, params: [{ type: "Property", name: "user" }] }, updateDonnop: { sid: o.user.id, cid: o.user.updateDonnop, params: [{ type: "Property", name: "donnop" }] }, markRead: { sid: o.notify.id, cid: o.notify.markRead, params: [{ type: "long", name: "id" }, { type: "ph", name: "ph" }] }, batchMarkRead: { sid: o.notify.id, cid: o.notify.batchMarkRead, params: [{ type: "byte", name: "sid" }, { type: "byte", name: "cid" }, { type: "LongArray", name: "ids" }] }, sync: { sid: o.sync.id, cid: o.sync.sync, params: [{ type: "Property", name: "sync" }] }, syncTeamMembers: { sid: o.sync.id, cid: o.sync.syncTeamMembers, params: [{ type: "LongLongMap", name: "sync" }] }, syncSuperTeamMembers: { sid: o.sync.id, cid: o.sync.syncSuperTeamMembers, params: [{ type: "LongLongMap", name: "sync" }] }, sendMsg: { sid: o.msg.id, cid: o.msg.sendMsg, params: [{ type: "Property", name: "msg" }] }, getHistoryMsgs: { sid: o.msg.id, cid: o.msg.getHistoryMsgs, params: [{ type: "String", name: "to" }, { type: "long", name: "beginTime" }, { type: "long", name: "endTime" }, { type: "long", name: "lastMsgId" }, { type: "int", name: "limit" }, { type: "bool", name: "reverse" }, { type: "LongArray", name: "msgTypes" }] }, sendCustomSysMsg: { sid: o.msg.id, cid: o.msg.sendCustomSysMsg, params: [{ type: "Property", name: "sysMsg" }] }, searchHistoryMsgs: { sid: o.msg.id, cid: o.msg.searchHistoryMsgs, params: [{ type: "String", name: "to" }, { type: "long", name: "beginTime" }, { type: "long", name: "endTime" }, { type: "String", name: "keyword" }, { type: "int", name: "limit" }, { type: "bool", name: "reverse" }] }, getSessions: { sid: o.msg.id, cid: o.msg.getSessions, params: [{ type: "long", name: "time" }] }, deleteSessions: { sid: o.msg.id, cid: o.msg.deleteSessions, params: [{ type: "StrArray", name: "sessions" }] }, sendMsgReceipt: { sid: o.msg.id, cid: o.msg.sendMsgReceipt, params: [{ type: "Property", name: "msgReceipt" }] }, deleteMsg: { sid: o.msg.id, cid: o.msg.deleteMsg, params: [{ type: "Property", name: "sysMsg" }] }, markSessionAck: { sid: o.msg.id, cid: o.msg.markSessionAck, params: [{ type: "byte", name: "scene" }, { type: "String", name: "to" }, { type: "long", name: "timetag" }] }, clearServerHistoryMsgs: { sid: o.msg.id, cid: o.msg.clearServerHistoryMsgs, params: [{ type: "Property", name: "clearMsgsParams" }] }, sendSuperTeamMsg: { sid: o.superTeam.id, cid: o.superTeam.sendSuperTeamMsg, params: [{ type: "Property", name: "msg" }] }, addSuperTeamMembers: { sid: o.superTeam.id, cid: o.superTeam.addSuperTeamMembers, params: [{ type: "long", name: "teamId" }, { type: "StrArray", name: "accounts" }] }, removeSuperTeamMembers: { sid: o.superTeam.id, cid: o.superTeam.removeSuperTeamMembers, params: [{ type: "long", name: "teamId" }, { type: "StrArray", name: "accounts" }] }, leaveSuperTeam: { sid: o.superTeam.id, cid: o.superTeam.leaveSuperTeam, params: [{ type: "long", name: "teamId" }] }, updateSuperTeam: { sid: o.superTeam.id, cid: o.superTeam.updateSuperTeam, params: [{ type: "Property", name: "team" }] }, getSuperTeam: { sid: o.superTeam.id, cid: o.superTeam.getSuperTeam, params: [{ type: "long", name: "teamId" }] }, getSuperTeams: { sid: o.superTeam.id, cid: o.superTeam.getSuperTeams, params: [{ type: "long", name: "timetag" }] }, getSuperTeamMembers: { sid: o.superTeam.id, cid: o.superTeam.getSuperTeamMembers, params: [{ type: "long", name: "teamId" }, { type: "long", name: "timetag" }] }, updateInfoInSuperTeam: { sid: o.superTeam.id, cid: o.superTeam.updateInfoInSuperTeam, params: [{ type: "Property", name: "superTeamMember" }] }, getSuperTeamHistoryMsgs: { sid: o.superTeam.id, cid: o.superTeam.getSuperTeamHistoryMsgs, params: [{ type: "long", name: "to" }, { type: "long", name: "beginTime" }, { type: "long", name: "endTime" }, { type: "long", name: "lastMsgId" }, { type: "int", name: "limit" }, { type: "bool", name: "reverse" }, { type: "LongArray", name: "msgTypes" }] }, getSuperTeamMembersByJoinTime: { sid: o.superTeam.id, cid: o.superTeam.getSuperTeamMembersByJoinTime, params: [{ type: "long", name: "teamId" }, { type: "long", name: "joinTime" }, { type: "int", name: "limit" }, { type: "bool", name: "reverse" }] }, getMySuperTeamMembers: { sid: o.superTeam.id, cid: o.superTeam.getMySuperTeamMembers, params: [{ type: "LongArray", name: "teamIds" }] }, createTeam: { sid: o.team.id, cid: o.team.createTeam, params: [{ type: "Property", name: "team" }, { type: "StrArray", name: "accounts" }, { type: "String", name: "ps" }] }, sendTeamMsg: { sid: o.team.id, cid: o.team.sendTeamMsg, params: [{ type: "Property", name: "msg" }] }, addTeamMembers: { sid: o.team.id, cid: o.team.addTeamMembers, params: [{ type: "long", name: "teamId" }, { type: "StrArray", name: "accounts" }, { type: "String", name: "ps" }, { type: "String", name: "attach" }] }, removeTeamMembers: { sid: o.team.id, cid: o.team.removeTeamMembers, params: [{ type: "long", name: "teamId" }, { type: "StrArray", name: "accounts" }] }, updateTeam: { sid: o.team.id, cid: o.team.updateTeam, params: [{ type: "Property", name: "team" }] }, leaveTeam: { sid: o.team.id, cid: o.team.leaveTeam, params: [{ type: "long", name: "teamId" }] }, getTeam: { sid: o.team.id, cid: o.team.getTeam, params: [{ type: "long", name: "teamId" }] }, getTeams: { sid: o.team.id, cid: o.team.getTeams, params: [{ type: "long", name: "timetag" }] }, getTeamMembers: { sid: o.team.id, cid: o.team.getTeamMembers, params: [{ type: "long", name: "teamId" }, { type: "long", name: "timetag" }] }, dismissTeam: { sid: o.team.id, cid: o.team.dismissTeam, params: [{ type: "long", name: "teamId" }] }, applyTeam: { sid: o.team.id, cid: o.team.applyTeam, params: [{ type: "long", name: "teamId" }, { type: "String", name: "ps" }] }, passTeamApply: { sid: o.team.id, cid: o.team.passTeamApply, params: [{ type: "long", name: "teamId" }, { type: "String", name: "from" }] }, rejectTeamApply: { sid: o.team.id, cid: o.team.rejectTeamApply, params: [{ type: "long", name: "teamId" }, { type: "String", name: "from" }, { type: "String", name: "ps" }] }, addTeamManagers: { sid: o.team.id, cid: o.team.addTeamManagers, params: [{ type: "long", name: "teamId" }, { type: "StrArray", name: "accounts" }] }, removeTeamManagers: { sid: o.team.id, cid: o.team.removeTeamManagers, params: [{ type: "long", name: "teamId" }, { type: "StrArray", name: "accounts" }] }, transferTeam: { sid: o.team.id, cid: o.team.transferTeam, params: [{ type: "long", name: "teamId" }, { type: "String", name: "account" }, { type: "bool", name: "leave" }] }, updateInfoInTeam: { sid: o.team.id, cid: o.team.updateInfoInTeam, params: [{ type: "Property", name: "teamMember" }] }, updateNickInTeam: { sid: o.team.id, cid: o.team.updateNickInTeam, params: [{ type: "Property", name: "teamMember" }] }, acceptTeamInvite: { sid: o.team.id, cid: o.team.acceptTeamInvite, params: [{ type: "long", name: "teamId" }, { type: "String", name: "from" }] }, rejectTeamInvite: { sid: o.team.id, cid: o.team.rejectTeamInvite, params: [{ type: "long", name: "teamId" }, { type: "String", name: "from" }, { type: "String", name: "ps" }] }, getTeamHistoryMsgs: { sid: o.team.id, cid: o.team.getTeamHistoryMsgs, params: [{ type: "long", name: "to" }, { type: "long", name: "beginTime" }, { type: "long", name: "endTime" }, { type: "long", name: "lastMsgId" }, { type: "int", name: "limit" }, { type: "bool", name: "reverse" }, { type: "LongArray", name: "msgTypes" }] }, searchTeamHistoryMsgs: { sid: o.team.id, cid: o.team.searchTeamHistoryMsgs, params: [{ type: "long", name: "to" }, { type: "long", name: "beginTime" }, { type: "long", name: "endTime" }, { type: "String", name: "keyword" }, { type: "int", name: "limit" }, { type: "bool", name: "reverse" }] }, updateMuteStateInTeam: { sid: o.team.id, cid: o.team.updateMuteStateInTeam, params: [{ type: "long", name: "teamId" }, { type: "String", name: "account" }, { type: "int", name: "mute" }] }, getMyTeamMembers: { sid: o.team.id, cid: o.team.getMyTeamMembers, params: [{ type: "LongArray", name: "teamIds" }] }, getMutedTeamMembers: { sid: o.team.id, cid: o.team.getMutedTeamMembers, params: [{ type: "long", name: "teamId" }] }, sendTeamMsgReceipt: { sid: o.team.id, cid: o.team.sendTeamMsgReceipt, params: [{ type: "PropertyArray", name: "teamMsgReceipts", entity: "teamMsgReceipt" }] }, getTeamMsgReads: { sid: o.team.id, cid: o.team.getTeamMsgReads, params: [{ type: "PropertyArray", name: "teamMsgReceipts", entity: "teamMsgReceipt" }] }, getTeamMsgReadAccounts: { sid: o.team.id, cid: o.team.getTeamMsgReadAccounts, params: [{ type: "Property", name: "teamMsgReceipt" }] }, muteTeamAll: { sid: o.team.id, cid: o.team.muteTeamAll, params: [{ type: "long", name: "teamId" }, { type: "int", name: "muteType" }] }, getTeamMemberInvitorAccid: { sid: o.team.id, cid: o.team.getTeamMemberInvitorAccid, params: [{ type: "long", name: "teamId" }, { type: "StrArray", name: "accounts" }] }, friendRequest: { sid: o.friend.id, cid: o.friend.friendRequest, params: [{ type: "String", name: "account" }, { type: "byte", name: "type" }, { type: "String", name: "ps" }] }, deleteFriend: { sid: o.friend.id, cid: o.friend.deleteFriend, params: [{ type: "String", name: "account" }, { type: "Property", name: "delFriendParams" }] }, updateFriend: { sid: o.friend.id, cid: o.friend.updateFriend, params: [{ type: "Property", name: "friend" }] }, getFriends: { sid: o.friend.id, cid: o.friend.getFriends, params: [{ type: "long", name: "timetag" }] }, getChatroomAddress: { sid: o.chatroom.id, cid: o.chatroom.getChatroomAddress, params: [{ type: "long", name: "chatroomId" }, { type: "bool", name: "isWeixinApp" }] }, sendFilterMsg: { sid: o.filter.id, cid: o.filter.sendFilterMsg, params: [{ type: "Property", name: "msg" }] }, sendFilterCustomSysMsg: { sid: o.filter.id, cid: o.filter.sendFilterCustomSysMsg, params: [{ type: "Property", name: "sysMsg" }] }, publishEvent: { sid: o.eventService.id, cid: o.eventService.publishEvent, params: [{ type: "Property", name: "msgEvent" }] }, pushEvent: { sid: o.eventService.id, cid: o.eventService.pushEvent }, subscribeEvent: { sid: o.eventService.id, cid: o.eventService.subscribeEvent, params: [{ type: "Property", name: "msgEventSubscribe" }, { type: "StrArray", name: "accounts" }] }, unSubscribeEventsByAccounts: { sid: o.eventService.id, cid: o.eventService.unSubscribeEventsByAccounts, params: [{ type: "Property", name: "msgEventSubscribe" }, { type: "StrArray", name: "accounts" }] }, unSubscribeEventsByType: { sid: o.eventService.id, cid: o.eventService.unSubscribeEventsByType, params: [{ type: "Property", name: "msgEventSubscribe" }] }, querySubscribeEventsByAccounts: { sid: o.eventService.id, cid: o.eventService.querySubscribeEventsByAccounts, params: [{ type: "Property", name: "msgEventSubscribe" }, { type: "StrArray", name: "accounts" }] }, querySubscribeEventsByType: { sid: o.eventService.id, cid: o.eventService.querySubscribeEventsByType, params: [{ type: "Property", name: "msgEventSubscribe" }] }, pushEvents: { sid: o.eventService.id, cid: o.eventService.pushEvents } }), a = r.merge({}, i.packetConfig, { "2_3": { service: "auth", cmd: "login", response: [{ type: "Property", name: "loginRes" }, { type: "PropertyArray", name: "loginPorts", entity: "loginPort" }, { type: "Property", name: "aosPushInfo" }] }, "2_5": { service: "auth", cmd: "kicked", response: [{ type: "Number", name: "from" }, { type: "Number", name: "reason" }] }, "2_6": { service: "auth", cmd: "logout" }, "2_7": { service: "auth", cmd: "multiPortLogin", response: [{ type: "Number", name: "state" }, { type: "PropertyArray", name: "loginPorts", entity: "loginPort" }] }, "2_8": { service: "auth", cmd: "kick", response: [{ type: "StrArray", name: "deviceIds" }] }, "3_1": { service: "user", cmd: "updatePushToken" }, "3_2": { service: "user", cmd: "appBackground" }, "3_3": { service: "user", cmd: "markInBlacklist" }, "3_103": { service: "user", cmd: "syncMarkInBlacklist", response: [{ type: "String", name: "account" }, { type: "Boolean", name: "isAdd" }] }, "3_4": { service: "user", cmd: "getBlacklist", response: [{ type: "StrArray", name: "blacklist" }] }, "3_5": { service: "user", cmd: "markInMutelist" }, "3_105": { service: "user", cmd: "syncMarkInMutelist", response: [{ type: "String", name: "account" }, { type: "Boolean", name: "isAdd" }] }, "3_6": { service: "user", cmd: "getMutelist", response: [{ type: "StrArray", name: "mutelist" }] }, "3_8": { service: "user", cmd: "getRelations", response: [{ type: "PropertyArray", name: "specialRelations", entity: "specialRelation" }, { type: "Number", name: "timetag" }] }, "3_7": { service: "user", cmd: "getUsers", response: [{ type: "PropertyArray", name: "users", entity: "user" }] }, "3_10": { service: "user", cmd: "updateMyInfo", response: [{ type: "Number", name: "timetag" }] }, "3_15": { service: "user", cmd: "updateDonnop", response: [{ type: "Number", name: "timetag" }] }, "3_115": { service: "user", cmd: "syncUpdateDonnop", response: [{ type: "Property", name: "donnop" }, { type: "Number", name: "timetag" }] }, "3_109": { service: "user", cmd: "syncMyInfo", response: [{ type: "Property", name: "user" }, { type: "Number", name: "timetag" }] }, "3_110": { service: "user", cmd: "syncUpdateMyInfo", response: [{ type: "Property", name: "user" }] }, "4_1": { service: "notify" }, "4_2": { service: "notify" }, "4_3": { service: "notify", cmd: "markRead" }, "4_4": { service: "notify", cmd: "syncOfflineMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "4_5": { service: "notify", cmd: "batchMarkRead" }, "4_6": { service: "notify", cmd: "syncOfflineSysMsgs", response: [{ type: "PropertyArray", name: "sysMsgs", entity: "sysMsg" }] }, "4_8": { service: "notify", cmd: "syncOfflineNetcallMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "4_9": { service: "notify", cmd: "syncRoamingMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "4_17": { service: "notify", cmd: "syncSuperTeamRoamingMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "4_12": { service: "notify", cmd: "syncMsgReceipts", response: [{ type: "PropertyArray", name: "msgReceipts", entity: "msgReceipt" }, { type: "Number", name: "timetag" }] }, "4_13": { service: "notify", cmd: "syncDonnop", response: [{ type: "Property", name: "donnop" }, { type: "Number", name: "timetag" }] }, "4_14": { service: "notify", cmd: "syncSessionAck", response: [{ type: "StrLongMap", name: "p2p" }, { type: "LongLongMap", name: "team" }, { type: "Number", name: "timetag" }] }, "4_15": { service: "notify", cmd: "syncRobots", response: [{ type: "PropertyArray", name: "robots", entity: "robot" }] }, "4_16": { service: "notify", cmd: "syncBroadcastMsgs", response: [{ type: "PropertyArray", name: "broadcastMsgs", entity: "broadcastMsg" }] }, "4_100": { service: "notify", cmd: "syncOfflineFilterMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "4_101": { service: "notify", cmd: "syncOfflineFilterSysMsgs", response: [{ type: "PropertyArray", name: "sysMsgs", entity: "sysMsg" }] }, "5_1": { service: "sync", cmd: "syncDone", response: [{ type: "Number", name: "timetag" }] }, "5_2": { service: "sync", cmd: "syncTeamMembersDone", response: [{ type: "Number", name: "timetag" }] }, "5_3": { service: "sync", cmd: "syncSuperTeamMembersDone", response: [{ type: "Number", name: "timetag" }] }, "7_1": { service: "msg", cmd: "sendMsg", response: [{ type: "Property", name: "msg" }], trivialErrorCodes: [7101] }, "7_2": { service: "msg", cmd: "msg", response: [{ type: "Property", name: "msg" }] }, "7_3": { service: "msg", cmd: "sysMsg", response: [{ type: "Property", name: "sysMsg" }] }, "7_6": { service: "msg", cmd: "getHistoryMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "7_7": { service: "msg", cmd: "sendCustomSysMsg", trivialErrorCodes: [7101] }, "7_8": { service: "msg", cmd: "searchHistoryMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "7_9": { service: "msg", cmd: "deleteSessions" }, "7_10": { service: "msg", cmd: "getSessions", response: [{ type: "StrArray", name: "sessions" }] }, "7_101": { service: "msg", cmd: "syncSendMsg", response: [{ type: "Property", name: "msg" }] }, "7_11": { service: "msg", cmd: "sendMsgReceipt", response: [{ type: "Property", name: "msgReceipt" }] }, "7_12": { service: "msg", cmd: "msgReceipt", response: [{ type: "Property", name: "msgReceipt" }] }, "7_13": { service: "msg", cmd: "onDeleteMsg" }, "7_14": { service: "msg", cmd: "onMsgDeleted", response: [{ type: "Property", name: "sysMsg" }] }, "7_15": { service: "msg", cmd: "onDeleteMsgOfflineRoaming", response: [{ type: "PropertyArray", name: "sysMsgs", entity: "sysMsg" }, { type: "Number", name: "timetag" }, { type: "Number", name: "type" }] }, "7_16": { service: "msg", cmd: "onMarkSessionAck" }, "7_17": { service: "msg", cmd: "broadcastMsg", response: [{ type: "Property", name: "broadcastMsg" }] }, "7_18": { service: "msg", cmd: "clearServerHistoryMsgs" }, "7_116": { service: "msg", cmd: "syncMarkSessionAck", response: [{ type: "Number", name: "scene" }, { type: "String", name: "to" }, { type: "Number", name: "timetag" }] }, "21_2": { service: "superTeam", cmd: "sendSuperTeamMsg", response: [{ type: "Property", name: "msg" }] }, "21_3": { service: "superTeam", cmd: "superTeamMsg", response: [{ type: "Property", name: "msg" }] }, "21_5": { service: "superTeam", cmd: "addSuperTeamMembers", response: [{ type: "StrArray", name: "abortedAccidList" }, { type: "long", name: "timetag" }] }, "21_6": { service: "superTeam", cmd: "removeSuperTeamMembers" }, "21_7": { service: "superTeam", cmd: "leaveSuperTeam" }, "21_8": { service: "superTeam", cmd: "updateSuperTeam", response: [{ type: "long", name: "teamId" }, { type: "long", name: "timetag" }] }, "21_9": { service: "superTeam", cmd: "getSuperTeam", response: [{ type: "Property", name: "team" }] }, "21_12": { service: "superTeam", cmd: "getSuperTeams", response: [{ type: "PropertyArray", name: "teams", entity: "superTeam" }, { type: "bool", name: "isAll" }, { type: "long", name: "timetag" }] }, "21_10": { service: "superTeam", cmd: "updateInfoInSuperTeam" }, "21_13": { service: "superTeam", cmd: "getSuperTeamMembers", response: [{ type: "long", name: "timetag" }] }, "21_11": { service: "superTeam", cmd: "getMySuperTeamMembers", response: [{ type: "PropertyArray", name: "members", entity: "superTeamMember" }] }, "21_14": { service: "superTeam", cmd: "getSuperTeamHistoryMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "21_15": { service: "superTeam", cmd: "getSuperTeamMembersByJoinTime", response: [{ type: "PropertyArray", name: "members", entity: "superTeamMember" }] }, "21_113": { service: "superTeam", cmd: "syncSuperTeamMembers", response: [{ type: "Number", name: "teamId" }, { type: "PropertyArray", name: "members", entity: "superTeamMember" }, { type: "bool", name: "isAll" }, { type: "long", name: "timetag" }] }, "21_111": { service: "superTeam", cmd: "syncMySuperTeamMembers", response: [{ type: "PropertyArray", name: "teamMembers", entity: "superTeamMember" }, { type: "long", name: "timetag" }] }, "21_109": { service: "superTeam", cmd: "syncSuperTeams", response: [{ type: "PropertyArray", name: "teams", entity: "superTeam" }, { type: "bool", name: "isAll" }, { type: "long", name: "timetag" }] }, "21_101": { service: "superTeam", cmd: "syncCreateSuperTeam", response: [{ type: "Property", name: "team" }] }, "21_102": { service: "superTeam", cmd: "syncSendSuperTeamMsg", response: [{ type: "Property", name: "msg" }] }, "21_110": { service: "superTeam", cmd: "syncUpdateSuperTeamMember", response: [{ type: "Property", name: "teamMember", entity: "superTeamMember" }] }, "8_1": { service: "team", cmd: "createTeam", response: [{ type: "Property", name: "team" }, { type: "StrArray", name: "abortedAccidList" }] }, "8_2": { service: "team", cmd: "sendTeamMsg", response: [{ type: "Property", name: "msg" }] }, "8_3": { service: "team", cmd: "teamMsg", response: [{ type: "Property", name: "msg" }] }, "8_4": { service: "team", cmd: "teamMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "8_5": { service: "team", cmd: "addTeamMembers", response: [{ type: "long", name: "time" }, { type: "StrArray", name: "abortedAccidList" }] }, "8_6": { service: "team", cmd: "removeTeamMembers" }, "8_7": { service: "team", cmd: "updateTeam", response: [{ type: "Number", name: "id" }, { type: "Number", name: "time" }] }, "8_8": { service: "team", cmd: "leaveTeam" }, "8_9": { service: "team", cmd: "getTeam", response: [{ type: "Property", name: "team" }] }, "8_10": { service: "team", cmd: "getTeams", response: [{ type: "PropertyArray", name: "teams", entity: "team" }, { type: "Number", name: "timetag" }] }, "8_11": { service: "team", cmd: "getTeamMembers", response: [{ type: "Number", name: "teamId" }, { type: "PropertyArray", name: "members", entity: "teamMember" }, { type: "Number", name: "timetag" }] }, "8_12": { service: "team", cmd: "dismissTeam" }, "8_13": { service: "team", cmd: "applyTeam", response: [{ type: "Property", name: "team" }] }, "8_14": { service: "team", cmd: "passTeamApply" }, "8_15": { service: "team", cmd: "rejectTeamApply" }, "8_16": { service: "team", cmd: "addTeamManagers" }, "8_17": { service: "team", cmd: "removeTeamManagers" }, "8_18": { service: "team", cmd: "transferTeam" }, "8_19": { service: "team", cmd: "updateInfoInTeam" }, "8_20": { service: "team", cmd: "updateNickInTeam" }, "8_21": { service: "team", cmd: "acceptTeamInvite", response: [{ type: "Property", name: "team" }] }, "8_22": { service: "team", cmd: "rejectTeamInvite" }, "8_23": { service: "team", cmd: "getTeamHistoryMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "8_24": { service: "team", cmd: "searchTeamHistoryMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "8_25": { service: "team", cmd: "updateMuteStateInTeam" }, "8_26": { service: "team", cmd: "getMyTeamMembers", response: [{ type: "PropertyArray", name: "teamMembers", entity: "teamMember" }] }, "8_27": { service: "team", cmd: "getMutedTeamMembers", response: [{ type: "Number", name: "teamId" }, { type: "PropertyArray", name: "teamMembers", entity: "teamMember" }] }, "8_28": { service: "team", cmd: "sendTeamMsgReceipt", response: [{ type: "PropertyArray", name: "teamMsgReceipts", entity: "teamMsgReceipt" }] }, "8_29": { service: "team", cmd: "getTeamMsgReads", response: [{ type: "PropertyArray", name: "teamMsgReceipts", entity: "teamMsgReceipt" }] }, "8_30": { service: "team", cmd: "getTeamMsgReadAccounts", response: [{ type: "String", name: "idClient" }, { type: "StrArray", name: "readAccounts" }, { type: "StrArray", name: "unreadAccounts" }] }, "8_31": { service: "team", cmd: "notifyTeamMsgReads", response: [{ type: "PropertyArray", name: "teamMsgReceipts", entity: "teamMsgReceipt" }] }, "8_32": { service: "team", cmd: "muteTeamAll", response: [] }, "8_33": { service: "team", cmd: "getTeamMemberInvitorAccid", response: [{ type: "object", name: "accountsMap" }] }, "8_126": { service: "team", cmd: "syncMyTeamMembers", response: [{ type: "PropertyArray", name: "teamMembers", entity: "teamMember" }, { type: "Number", name: "timetag" }] }, "8_109": { service: "team", cmd: "syncTeams", response: [{ type: "Number", name: "timetag" }, { type: "PropertyArray", name: "teams", entity: "team" }] }, "8_111": { service: "team", cmd: "syncTeamMembers", response: [{ type: "Number", name: "teamId" }, { type: "PropertyArray", name: "members", entity: "teamMember" }, { type: "Number", name: "timetag" }] }, "8_101": { service: "team", cmd: "syncCreateTeam", response: [{ type: "Property", name: "team" }] }, "8_102": { service: "team", cmd: "syncSendTeamMsg", response: [{ type: "Property", name: "msg" }] }, "8_119": { service: "team", cmd: "syncUpdateTeamMember", response: [{ type: "Property", name: "teamMember" }] }, "12_1": { service: "friend", cmd: "friendRequest" }, "12_101": { service: "friend", cmd: "syncFriendRequest", response: [{ type: "String", name: "account" }, { type: "Number", name: "type" }, { type: "String", name: "ps" }] }, "12_2": { service: "friend", cmd: "deleteFriend" }, "12_102": { service: "friend", cmd: "syncDeleteFriend", response: [{ type: "String", name: "account" }] }, "12_3": { service: "friend", cmd: "updateFriend" }, "12_103": { service: "friend", cmd: "syncUpdateFriend", response: [{ type: "Property", name: "friend" }] }, "12_4": { service: "friend", cmd: "getFriends", response: [{ type: "PropertyArray", name: "friends", entity: "friend" }, { type: "Number", name: "timetag" }] }, "12_5": { service: "friend", cmd: "syncFriends", response: [{ type: "PropertyArray", name: "friends", entity: "friend" }, { type: "Number", name: "timetag" }] }, "12_6": { service: "friend", cmd: "syncFriendUsers", response: [{ type: "PropertyArray", name: "users", entity: "user" }, { type: "Number", name: "timetag" }] }, "13_1": { service: "chatroom", cmd: "getChatroomAddress", response: [{ type: "StrArray", name: "address" }] }, "14_1": { service: "eventService", cmd: "publishEvent", response: [{ type: "Property", name: "msgEvent" }] }, "14_2": { service: "eventService", cmd: "pushEvent", response: [{ type: "Property", name: "msgEvent" }] }, "14_3": { service: "eventService", cmd: "subscribeEvent", response: [{ type: "StrArray", name: "accounts" }] }, "14_4": { service: "eventService", cmd: "unSubscribeEventsByAccounts", response: [{ type: "StrArray", name: "accounts" }] }, "14_5": { service: "eventService", cmd: "unSubscribeEventsByType" }, "14_6": { service: "eventService", cmd: "querySubscribeEventsByAccounts", response: [{ type: "PropertyArray", name: "msgEventSubscribes", entity: "msgEventSubscribe" }] }, "14_7": { service: "eventService", cmd: "querySubscribeEventsByType", response: [{ type: "PropertyArray", name: "msgEventSubscribes", entity: "msgEventSubscribe" }] }, "14_9": { service: "eventService", cmd: "pushEvents", response: [{ type: "PropertyArray", name: "msgEvents", entity: "msgEvent" }] }, "101_1": { service: "filter", cmd: "sendFilterMsg", response: [{ type: "Property", name: "msg" }] }, "101_2": { service: "filter", cmd: "filterMsg", response: [{ type: "Property", name: "msg" }] }, "101_3": { service: "filter", cmd: "filterSysMsg", response: [{ type: "Property", name: "sysMsg" }] }, "101_7": { service: "filter", cmd: "sendFilterCustomSysMsg" } }); e.exports = { idMap: o, cmdConfig: s, packetConfig: a } }, function (e, t, n) { function r(e) { i(e.shouldPushNotificationWhenPCOnline) && (this.open = e.shouldPushNotificationWhenPCOnline ? 2 : 1) } var i = n(0).notundef; r.getDefaultConfig = function () { return { shouldPushNotificationWhenPCOnline: !0 } }, r.reverse = function (e) { return { shouldPushNotificationWhenPCOnline: 1 != +e.open } }, e.exports = r }, function (e, t, n) { function r(e) { i.verifyOptions(e, "action", "superTeam::SuperTeam"), i.verifyOptions(e, "teamId", "superTeam::SuperTeam"), o(e.teamId) && (this.teamId = e.teamId), o(e.type) && (this.type = m[e.type]), o(e.avatar) && (this.avatar = "" + e.avatar), o(e.name) && (this.name = "" + e.name), o(e.intro) && (this.intro = "" + e.intro), o(e.announcement) && (this.announcement = "" + e.announcement), o(e.custom) && (this.custom = "" + e.custom), l.forEach(this.setMode.bind(this, e)) } var i = n(0), o = i.notundef, s = i.fillPropertyWithDefault, a = (Object.keys, {}), c = {}, u = {}, l = [], m = { normal: 0, advanced: 1 }, d = { 0: "normal", 1: "advanced" }; r.prototype.setMode = function (e, t) { o(e[t += "Mode"]) && (i.verifyParamValid(t, e[t], u[t], "Superteam::Team"), this[t] = a[t][e[t]]) }, r.reverse = function (e, t) { var n = i.copy(e); if (o(n.teamId) && (n.teamId = "" + n.teamId), o(n.type) && (n.type = d[n.type]), o(n.level) && (n.level = +n.level), o(n.valid) && (n.valid = 1 == +n.valid), o(n.memberNum) && (n.memberNum = +n.memberNum), o(n.memberUpdateTime) && (n.memberUpdateTime = +n.memberUpdateTime), o(n.createTime) && (n.createTime = +n.createTime), o(n.updateTime) && (n.updateTime = +n.updateTime), o(n.validToCurrentUser) && (n.validToCurrentUser = "1" === n.validToCurrentUser), o(n.mute) && (n.mute = "1" === n.mute), o(n.muteType)) switch (n.muteType) { case "0": n.mute = !1, n.muteType = "none"; break; case "1": n.mute = !0, n.muteType = "normal"; break; case "3": n.mute = !0, n.muteType = "all" } else o(n.mute) && (1 === n.mute ? (n.mute = !0, n.muteType = "normal") : (n.mute = !1, n.muteType = "none")); return l.forEach(function (e, t) { o(e[t += "Mode"]) && (e[t] = c[t][e[t]]) }.bind(null, n)), delete n.bits, t || r.fillProperties(n), n }, r.fillProperties = function (e) { return s(e, "avatar", "") }, e.exports = r }, function (e, t, n) { var r = n(24); r(r.S + r.F * !n(11), "Object", { defineProperty: n(8).f }) }, function (e, t, n) { n(100); var r = n(9).Object; e.exports = function (e, t, n) { return r.defineProperty(e, t, n) } }, function (e, t, n) { n(34)("observable") }, function (e, t, n) { n(34)("asyncIterator") }, function (e, t) { }, function (e, t, n) { var r = n(13), i = n(62).f, o = {}.toString, s = "object" == ("undefined" == typeof window ? "undefined" : _typeof(window)) && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) : []; e.exports.f = function (e) { return s && "[object Window]" == o.call(e) ? function (e) { try { return i(e) } catch (e) { return s.slice() } }(e) : i(r(e)) } }, function (e, t, n) { var r = n(50); e.exports = Array.isArray || function (e) { return "Array" == r(e) } }, function (e, t, n) { var r = n(31), i = n(47), o = n(30); e.exports = function (e) { var t = r(e), n = i.f; if (n) for (var s, a = n(e), c = o.f, u = 0; a.length > u;)c.call(e, s = a[u++]) && t.push(s); return t } }, function (e, t, n) { var r = n(28)("meta"), i = n(18), o = n(10), s = n(8).f, a = 0, c = Object.isExtensible || function () { return !0 }, u = !n(23)(function () { return c(Object.preventExtensions({})) }), l = function (e) { s(e, r, { value: { i: "O" + ++a, w: {} } }) }, m = e.exports = { KEY: r, NEED: !1, fastKey: function (e, t) { if (!i(e)) return "symbol" == (void 0 === e ? "undefined" : _typeof(e)) ? e : ("string" == typeof e ? "S" : "P") + e; if (!o(e, r)) { if (!c(e)) return "F"; if (!t) return "E"; l(e) } return e[r].i }, getWeak: function (e, t) { if (!o(e, r)) { if (!c(e)) return !0; if (!t) return !1; l(e) } return e[r].w }, onFreeze: function (e) { return u && m.NEED && c(e) && !o(e, r) && l(e), e } } }, function (e, t, n) { var r = n(7), i = n(10), o = n(11), s = n(24), a = n(65), c = n(108).KEY, u = n(23), l = n(38), m = n(36), d = n(28), p = n(5), f = n(35), g = n(34), h = n(107), y = n(106), v = n(19), b = n(18), T = n(13), M = n(40), S = n(27), k = n(53), _ = n(105), w = n(93), P = n(8), C = n(31), I = w.f, O = P.f, A = _.f, x = r.Symbol, E = r.JSON, j = E && E.stringify, U = p("_hidden"), R = p("toPrimitive"), F = {}.propertyIsEnumerable, N = l("symbol-registry"), D = l("symbols"), B = l("op-symbols"), L = Object.prototype, $ = "function" == typeof x, q = r.QObject, H = !q || !q.prototype || !q.prototype.findChild, z = o && u(function () { return 7 != k(O({}, "a", { get: function () { return O(this, "a", { value: 7 }).a } })).a }) ? function (e, t, n) { var r = I(L, t); r && delete L[t], O(e, t, n), r && e !== L && O(L, t, r) } : O, V = function (e) { var t = D[e] = k(x.prototype); return t._k = e, t }, W = $ && "symbol" == _typeof(x.iterator) ? function (e) { return "symbol" == (void 0 === e ? "undefined" : _typeof(e)) } : function (e) { return e instanceof x }, J = function e(t, n, r) { return t === L && e(B, n, r), v(t), n = M(n, !0), v(r), i(D, n) ? (r.enumerable ? (i(t, U) && t[U][n] && (t[U][n] = !1), r = k(r, { enumerable: S(0, !1) })) : (i(t, U) || O(t, U, S(1, {})), t[U][n] = !0), z(t, n, r)) : O(t, n, r) }, X = function (e, t) { v(e); for (var n, r = h(t = T(t)), i = 0, o = r.length; o > i;)J(e, n = r[i++], t[n]); return e }, G = function (e) { var t = F.call(this, e = M(e, !0)); return !(this === L && i(D, e) && !i(B, e)) && (!(t || !i(this, e) || !i(D, e) || i(this, U) && this[U][e]) || t) }, K = function (e, t) { if (e = T(e), t = M(t, !0), e !== L || !i(D, t) || i(B, t)) { var n = I(e, t); return !n || !i(D, t) || i(e, U) && e[U][t] || (n.enumerable = !0), n } }, Q = function (e) { for (var t, n = A(T(e)), r = [], o = 0; n.length > o;)i(D, t = n[o++]) || t == U || t == c || r.push(t); return r }, Y = function (e) { for (var t, n = e === L, r = A(n ? B : T(e)), o = [], s = 0; r.length > s;)!i(D, t = r[s++]) || n && !i(L, t) || o.push(D[t]); return o }; $ || (a((x = function () { if (this instanceof x) throw TypeError("Symbol is not a constructor!"); var e = d(arguments.length > 0 ? arguments[0] : void 0); return o && H && z(L, e, { configurable: !0, set: function t(n) { this === L && t.call(B, n), i(this, U) && i(this[U], e) && (this[U][e] = !1), z(this, e, S(1, n)) } }), V(e) }).prototype, "toString", function () { return this._k }), w.f = K, P.f = J, n(62).f = _.f = Q, n(30).f = G, n(47).f = Y, o && !n(41) && a(L, "propertyIsEnumerable", G, !0), f.f = function (e) { return V(p(e)) }), s(s.G + s.W + s.F * !$, { Symbol: x }); for (var Z = "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","), ee = 0; Z.length > ee;)p(Z[ee++]); for (var te = C(p.store), ne = 0; te.length > ne;)g(te[ne++]); s(s.S + s.F * !$, "Symbol", { for: function (e) { return i(N, e += "") ? N[e] : N[e] = x(e) }, keyFor: function (e) { if (!W(e)) throw TypeError(e + " is not a symbol!"); for (var t in N) if (N[t] === e) return t }, useSetter: function () { H = !0 }, useSimple: function () { H = !1 } }), s(s.S + s.F * !$, "Object", { create: function (e, t) { return void 0 === t ? k(e) : X(k(e), t) }, defineProperty: J, defineProperties: X, getOwnPropertyDescriptor: K, getOwnPropertyNames: Q, getOwnPropertySymbols: Y }), E && s(s.S + s.F * (!$ || u(function () { var e = x(); return "[null]" != j([e]) || "{}" != j({ a: e }) || "{}" != j(Object(e)) })), "JSON", { stringify: function (e) { for (var t, n, r = [e], i = 1; arguments.length > i;)r.push(arguments[i++]); if (n = t = r[1], (b(t) || void 0 !== e) && !W(e)) return y(t) || (t = function (e, t) { if ("function" == typeof n && (t = n.call(this, e, t)), !W(t)) return t }), r[1] = t, j.apply(E, r) } }), x.prototype[R] || n(14)(x.prototype, R, x.prototype.valueOf), m(x, "Symbol"), m(Math, "Math", !0), m(r.JSON, "JSON", !0) }, function (e, t, n) { n(109), n(104), n(103), n(102), e.exports = n(9).Symbol }, function (e, t, n) { e.exports = { default: n(110), __esModule: !0 } }, function (e, t) { e.exports = function (e, t) { return { value: t, done: !!e } } }, function (e, t) { e.exports = function () { } }, function (e, t, n) { var r = n(113), i = n(112), o = n(26), s = n(13); e.exports = n(68)(Array, "Array", function (e, t) { this._t = s(e), this._i = 0, this._k = t }, function () { var e = this._t, t = this._k, n = this._i++; return !e || n >= e.length ? (this._t = void 0, i(1)) : i(0, "keys" == t ? n : "values" == t ? e[n] : [n, e[n]]) }, "values"), o.Arguments = o.Array, r("keys"), r("values"), r("entries") }, function (e, t, n) { var r = n(10), i = n(52), o = n(39)("IE_PROTO"), s = Object.prototype; e.exports = Object.getPrototypeOf || function (e) { return e = i(e), r(e, o) ? e[o] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? s : null } }, function (e, t, n) { var r = n(7).document; e.exports = r && r.documentElement }, function (e, t, n) { var r = n(43), i = Math.max, o = Math.min; e.exports = function (e, t) { return (e = r(e)) < 0 ? i(e + t, 0) : o(e, t) } }, function (e, t, n) { var r = n(13), i = n(77), o = n(117); e.exports = function (e) { return function (t, n, s) { var a, c = r(t), u = i(c.length), l = o(s, u); if (e && n != n) { for (; u > l;)if ((a = c[l++]) != a) return !0 } else for (; u > l; l++)if ((e || l in c) && c[l] === n) return e || l || 0; return !e && -1 } } }, function (e, t, n) { var r = n(8), i = n(19), o = n(31); e.exports = n(11) ? Object.defineProperties : function (e, t) { i(e); for (var n, s = o(t), a = s.length, c = 0; a > c;)r.f(e, n = s[c++], t[n]); return e } }, function (e, t, n) { var r = n(53), i = n(27), o = n(36), s = {}; n(14)(s, n(5)("iterator"), function () { return this }), e.exports = function (e, t, n) { e.prototype = r(s, { next: i(1, n) }), o(e, t + " Iterator") } }, function (e, t) { e.exports = function (e) { if ("function" != typeof e) throw TypeError(e + " is not a function!"); return e } }, function (e, t, n) { var r = n(43), i = n(42); e.exports = function (e) { return function (t, n) { var o, s, a = String(i(t)), c = r(n), u = a.length; return c < 0 || c >= u ? e ? "" : void 0 : (o = a.charCodeAt(c)) < 55296 || o > 56319 || c + 1 === u || (s = a.charCodeAt(c + 1)) < 56320 || s > 57343 ? e ? a.charAt(c) : o : e ? a.slice(c, c + 2) : s - 56320 + (o - 55296 << 10) + 65536 } } }, function (e, t, n) { n(51), n(63), e.exports = n(35).f("iterator") }, function (e, t, n) { e.exports = { default: n(123), __esModule: !0 } }, function (e, t, n) { n(182); var r = n(1); r.lbsUrl = r.lbsUrl.replace("/webconf.jsp", "/wxwebconf.jsp"), r.defaultReportUrl = null, r.isWeixinApp = !0 }, , , , , , function (e, t, n) { var r = n(22); e.exports = function (e) { e.db && (r.db = e.db) } }, function (e, t, n) { function r(e) { var t = this, n = e.url || null; t.level = { debug: 0, log: 1, info: 2, warn: 3, error: 4 }[e.level] || 0, t.logCache = [], t.logNum = 1, t.timeInterval = 5e3, window.onerror = function (e, n, r, i, o) { t.error(o) }, setInterval(function () { t.logCache.length > 0 && n && t.postLogs(n, t.logCache) }, t.timeInterval) } var i, o = (i = n(2)) && i.__esModule ? i : { default: i }; r.prototype.debug = function () { this.level > 0 || (console.debug.apply(this, arguments), this.cacheLogs.apply(this, ["[degbug]"].concat(arguments))) }, r.prototype.log = function () { this.level > 1 || (console.log.apply(this, arguments), this.cacheLogs.apply(this, ["[log]"].concat(arguments))) }, r.prototype.info = function () { this.level > 2 || (console.info.apply(this, arguments), this.cacheLogs.apply(this, ["[info]"].concat(arguments))) }, r.prototype.warn = function () { this.level > 3 || (console.warn.apply(this, arguments), this.cacheLogs.apply(this, ["[warn]"].concat(arguments))) }, r.prototype.error = function () { this.level > 4 || (console.error.apply(this, arguments), this.cacheLogs.apply(this, ["[error]"].concat(arguments))) }, r.prototype.cacheLogs = function (e, t) { for (var n = [], r = 0; r < t.length; r++) { var i = t[r]; "object" === (void 0 === i ? "undefined" : (0, o.default)(i)) ? n.push(JSON.stringify(i)) : n.push(i) } var s = this.logNum++ + " " + e + " " + n.join("; "); this.logCache.push(s.replace("%c", "")) }, r.prototype.postLogs = function (e, t) { var n = this, r = new XMLHttpRequest; r.onreadystatechange = function () { 4 === r.readyState && (200 === r.status ? (console.info("LoggerPlugin::日志上报完成"), n.logCache = [], n.timeInterval = 5e3) : n.timeInterval += 5e3) }, r.open("POST", e), r.setRequestHeader("Content-Type", "plain/text;charset=utf-8"), r.timeout = 360, r.send(t.join("\n")) }, e.exports = r }, function (e, t, n) { var r = { set: function (e, t, n) { r[e] = t, n && (n.support = t) } }; e.exports = r }, function (e, t) { e.exports = function () { for (var e = {}, t = 0; t < arguments.length; t++) { var r = arguments[t]; for (var i in r) n.call(r, i) && (e[i] = r[i]) } return e }; var n = Object.prototype.hasOwnProperty }, function (e, t, n) { var r = n(78); e.exports = function (e, t, n) { if (!r(t)) throw new TypeError("iterator must be a function"); arguments.length < 3 && (n = this), "[object Array]" === i.call(e) ? function (e, t, n) { for (var r = 0, i = e.length; r < i; r++)o.call(e, r) && t.call(n, e[r], r, e) }(e, t, n) : "string" == typeof e ? function (e, t, n) { for (var r = 0, i = e.length; r < i; r++)t.call(n, e.charAt(r), r, e) }(e, t, n) : function (e, t, n) { for (var r in e) o.call(e, r) && t.call(n, e[r], r, e) }(e, t, n) }; var i = Object.prototype.toString, o = Object.prototype.hasOwnProperty }, function (e, t) { (t = e.exports = function (e) { return e.replace(/^\s*|\s*$/g, "") }).left = function (e) { return e.replace(/^\s*/, "") }, t.right = function (e) { return e.replace(/\s*$/, "") } }, function (e, t, n) { var r = n(136), i = n(135); e.exports = function (e) { if (!e) return {}; var t = {}; return i(r(e).split("\n"), function (e) { var n, i = e.indexOf(":"), o = r(e.slice(0, i)).toLowerCase(), s = r(e.slice(i + 1)); void 0 === t[o] ? t[o] = s : (n = t[o], "[object Array]" === Object.prototype.toString.call(n) ? t[o].push(s) : t[o] = [t[o], s]) }), t } }, function (e, t, n) { (function (t) { var n; n = "undefined" != typeof window ? window : void 0 !== t ? t : "undefined" != typeof self ? self : {}, e.exports = n }).call(this, n(48)) }, function (e, t, n) { function r(e, t, n) { var r = e; return a(t) ? (n = t, "string" == typeof e && (r = { uri: e })) : r = u(t, { uri: e }), r.callback = n, r } function i(e, t, n) { return o(t = r(e, t, n)) } function o(e) { function t(e) { return clearTimeout(l), e instanceof Error || (e = new Error("" + (e || "Unknown XMLHttpRequest Error"))), e.statusCode = 0, a(e, y) } function n() { if (!o) { var t; clearTimeout(l), t = e.useXDR && void 0 === u.status ? 200 : 1223 === u.status ? 204 : u.status; var n = y, r = null; return 0 !== t ? (n = { body: function () { var e = void 0; if (e = u.response ? u.response : u.responseText || function (e) { try { if ("document" === e.responseType) return e.responseXML; var t = e.responseXML && "parsererror" === e.responseXML.documentElement.nodeName; if ("" === e.responseType && !t) return e.responseXML } catch (e) { } return null }(u), h) try { e = JSON.parse(e) } catch (e) { } return e }(), statusCode: t, method: d, headers: {}, url: m, rawRequest: u }, u.getAllResponseHeaders && (n.headers = c(u.getAllResponseHeaders()))) : r = new Error("Internal XMLHttpRequest Error"), a(r, n, n.body) } } if (void 0 === e.callback) throw new Error("callback argument missing"); var r, o, s = !1, a = function (t, n, r) { s || (s = !0, e.callback(t, n, r)) }, u = e.xhr || null; u || (u = e.cors || e.useXDR ? new i.XDomainRequest : new i.XMLHttpRequest); var l, m = u.url = e.uri || e.url, d = u.method = e.method || "GET", p = e.body || e.data, f = u.headers = e.headers || {}, g = !!e.sync, h = !1, y = { body: void 0, headers: {}, statusCode: 0, method: d, url: m, rawRequest: u }; if ("json" in e && !1 !== e.json && (h = !0, f.accept || f.Accept || (f.Accept = "application/json"), "GET" !== d && "HEAD" !== d && (f["content-type"] || f["Content-Type"] || (f["Content-Type"] = "application/json"), p = JSON.stringify(!0 === e.json ? p : e.json))), u.onreadystatechange = function () { 4 === u.readyState && setTimeout(n, 0) }, u.onload = n, u.onerror = t, u.onprogress = function () { }, u.onabort = function () { o = !0 }, u.ontimeout = t, u.open(d, m, !g, e.username, e.password), g || (u.withCredentials = !!e.withCredentials), !g && e.timeout > 0 && (l = setTimeout(function () { if (!o) { o = !0, u.abort("timeout"); var e = new Error("XMLHttpRequest timeout"); e.code = "ETIMEDOUT", t(e) } }, e.timeout)), u.setRequestHeader) for (r in f) f.hasOwnProperty(r) && u.setRequestHeader(r, f[r]); else if (e.headers && !function (e) { for (var t in e) if (e.hasOwnProperty(t)) return !1; return !0 }(e.headers)) throw new Error("Headers cannot be set on an XDomainRequest object"); return "responseType" in e && (u.responseType = e.responseType), "beforeSend" in e && "function" == typeof e.beforeSend && e.beforeSend(u), u.send(p || null), u } var s = n(138), a = n(78), c = n(137), u = n(134); e.exports = i, i.XMLHttpRequest = s.XMLHttpRequest || function () { }, i.XDomainRequest = "withCredentials" in new i.XMLHttpRequest ? i.XMLHttpRequest : s.XDomainRequest, function (e, t) { for (var n = 0; n < e.length; n++)!function (e) { i["delete" === e ? "del" : e] = function (t, n, i) { return (n = r(t, n, i)).method = e.toUpperCase(), o(n) } }(e[n]) }(["get", "put", "post", "patch", "head", "delete"]) }, function (e, t, n) { function r(e) { return e && e.__esModule ? e : { default: e } } t.__esModule = !0; var i = r(n(241)), o = r(n(238)); t.default = function (e, t) { if (Array.isArray(e)) return e; if ((0, i.default)(Object(e))) return function (e, t) { var n = [], r = !0, i = !1, s = void 0; try { for (var a, c = (0, o.default)(e); !(r = (a = c.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0); } catch (e) { i = !0, s = e } finally { try { !r && c.return && c.return() } finally { if (i) throw s } } return n }(e, t); throw new TypeError("Invalid attempt to destructure non-iterable instance") } }, function (e, t, n) { function r(e) { i.verifyOptions(e, "account", "friend::Friend"), i.verifyParamAtLeastPresentOne(e, "alias custom", "friend::Friend"), this.account = e.account, o(e.alias) && (this.alias = e.alias), o(e.custom) && (this.custom = e.custom) } var i = n(0), o = i.notundef, s = { addFriend: 1, applyFriend: 2, passFriendApply: 3, rejectFriendApply: 4 }, a = { 1: "addFriend", 2: "applyFriend", 3: "passFriendApply", 4: "rejectFriendApply" }; r.reverse = function (e) { var t = i.filterObj(e, "account alias custom createTime updateTime serverex"); return o(e.flag) && (t.valid = "1" === e.flag), o(t.createTime) && (t.createTime = +t.createTime), o(t.updateTime) && (t.updateTime = +t.updateTime), t }, r.validTypes = function () { return Object.keys(s) }, r.getByteFromType = function (e) { return s[e] }, r.getTypeFromByte = function (e) { return a[e] }, r.assembleFriend = function (e) { var t = +new Date; return { account: e, alias: "", createTime: t, custom: "", updateTime: t, valid: !0 } }, e.exports = r }, function (e, t, n) { var r = n(50), i = n(5)("toStringTag"), o = "Arguments" == r(function () { return arguments }()); e.exports = function (e) { var t, n, s; return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof (n = function (e, t) { try { return e[t] } catch (e) { } }(t = Object(e), i)) ? n : o ? r(t) : "Object" == (s = r(t)) && "function" == typeof t.callee ? "Arguments" : s } }, function (e, t, n) { var r = n(142), i = n(5)("iterator"), o = n(26); e.exports = n(9).getIteratorMethod = function (e) { if (null != e) return e[i] || e["@@iterator"] || o[r(e)] } }, function (e, t, n) { e.exports = { imLogin: { 3: "clientType", 4: "os", 6: "sdkVersion", 8: "appLogin", 9: "protocolVersion", 10: "pushTokenName", 11: "pushToken", 13: "deviceId", 18: "appKey", 19: "account", 24: "browser", 26: "session", 32: "deviceInfo", 38: "customTag", 112: "isReactNative", 1e3: "token" }, nosToken: { 1: "objectName", 2: "token", 3: "bucket", 4: "expireTime", 7: "expireSec", 8: "tag", 9: "shortUrl" }, audioToText: { 2: "url" }, imageOp: { 0: "type", 1: "stripmeta", 2: "typeType", 3: "blurRadius", 4: "blurSigma", 5: "qualityQuality", 6: "cropX", 7: "cropY", 8: "cropWidth", 9: "cropHeight", 10: "rotateAngle", 11: "pixelPixel", 12: "thumbnailMode", 13: "thumbnailWidth", 14: "thumbnailHeight", 15: "thumbnailAxisX", 16: "thumbnailAxisY", 17: "thumbnailCenterX", 18: "thumbnailCenterY", 19: "thumbnailEnlarge", 20: "thumbnailToStatic", 21: "watermarkType", 22: "watermarkGravity", 23: "watermarkDissolve", 24: "watermarkDx", 25: "watermarkDy", 26: "watermarkImage", 27: "watermarkText", 28: "watermarkFont", 29: "watermarkFontSize", 30: "watermarkFontColor", 31: "interlace" }, robot: { 4: "account", 5: "nick", 6: "avatar", 7: "intro", 8: "config", 9: "valid", 10: "createTime", 11: "updateTime", 12: "custid", 13: "botid", 14: "bindTime", _6_safe: "_avatar_safe" }, clientAntispam: { 1: "version", 2: "md5", 3: "nosurl", 4: "thesaurus" }, fileQuickTransfer: { 1: "md5", 2: "url", 3: "size", 4: "threshold", _2_safe: "_url_safe" }, transToken: { 1: "name", 2: "type", 3: "transType", 4: "size", 5: "extra", 6: "body" }, transInfo: { 1: "docId", 2: "name", 3: "prefix", 4: "size", 5: "type", 6: "state", 7: "transType", 8: "transSize", 9: "pageCount", 10: "picInfo", 11: "extra", 12: "flag" }, nosFileUrlTag: { 0: "safeUrl", 1: "originUrl" }, fileListParam: { 1: "fromDocId", 2: "limit" }, avSignalTag: { 1: "type", 2: "channelName", 3: "channelId", 4: "channelCreateTime", 5: "channelExpireTime", 6: "creator", 7: "ext", 8: "channelInValid", 10: "from", 11: "to", 12: "requestId", 13: "needPush", 14: "pushTitle", 15: "pushContent", 16: "pushPayload", 17: "needBadge", 18: "members", 19: "attach", 20: "attachExt", 21: "isSave", 22: "msgid", 23: "uid", 24: "time" }, login: { 1: "appKey", 2: "account", 3: "deviceId", 5: "chatroomId", 8: "appLogin", 20: "chatroomNick", 21: "chatroomAvatar", 22: "chatroomCustom", 23: "chatroomEnterCustom", 26: "session", 38: "isAnonymous", _21_safe: "_chatroomAvatar_safe" }, chatroom: { 1: "id", 3: "name", 4: "announcement", 5: "broadcastUrl", 12: "custom", 14: "createTime", 15: "updateTime", 16: "queuelevel", 100: "creator", 101: "onlineMemberNum", 102: "mute" }, msg: { 1: "idClient", 2: "type", 3: "attach", 4: "custom", 5: "resend", 6: "userUpdateTime", 7: "fromNick", 8: "fromAvatar", 9: "fromCustom", 10: "yidunEnable", 11: "antiSpamContent", 12: "skipHistory", 13: "body", 14: "antiSpamBusinessId", 15: "clientAntiSpam", 16: "antiSpamUsingYidun", 20: "time", 21: "from", 22: "chatroomId", 23: "fromClientType", 25: "highPriority", _8_safe: "_fromAvatar_safe" }, chatroomMember: { 1: "chatroomId", 2: "account", 3: "type", 4: "level", 5: "nick", 6: "avatar", 7: "custom", 8: "online", 9: "guest", 10: "enterTime", 12: "blacked", 13: "gaged", 14: "valid", 15: "updateTime", 16: "tempMuted", 17: "tempMuteDuration", _6_safe: "_avatar_safe" } } }, function (e, t, n) { e.exports = { imLogin: { clientType: 3, os: 4, sdkVersion: 6, appLogin: 8, protocolVersion: 9, pushTokenName: 10, pushToken: 11, deviceId: 13, appKey: 18, account: 19, browser: 24, session: 26, deviceInfo: 32, isReactNative: 112, token: 1e3, customTag: 38 }, nosToken: { objectName: 1, token: 2, bucket: 3, expireTime: 4, expireSec: 7, tag: 8, shortUrl: 9 }, audioToText: { url: 2 }, imageOp: { type: 0, stripmeta: 1, typeType: 2, blurRadius: 3, blurSigma: 4, qualityQuality: 5, cropX: 6, cropY: 7, cropWidth: 8, cropHeight: 9, rotateAngle: 10, pixelPixel: 11, thumbnailMode: 12, thumbnailWidth: 13, thumbnailHeight: 14, thumbnailAxisX: 15, thumbnailAxisY: 16, thumbnailCenterX: 17, thumbnailCenterY: 18, thumbnailEnlarge: 19, thumbnailToStatic: 20, watermarkType: 21, watermarkGravity: 22, watermarkDissolve: 23, watermarkDx: 24, watermarkDy: 25, watermarkImage: 26, watermarkText: 27, watermarkFont: 28, watermarkFontSize: 29, watermarkFontColor: 30, interlace: 31 }, robot: { account: 4, nick: 5, avatar: 6, intro: 7, config: 8, valid: 9, createTime: 10, updateTime: 11, custid: 12, botid: 13, bindTime: 14 }, clientAntispam: { version: 1, md5: 2, nosurl: 3, thesaurus: 4 }, fileQuickTransfer: { md5: 1, url: 2, size: 3, threshold: 4 }, transToken: { name: 1, type: 2, transType: 3, size: 4, extra: 5, body: 6 }, transInfo: { docId: 1, name: 2, prefix: 3, size: 4, type: 5, state: 6, transType: 7, transSize: 8, pageCount: 9, picInfo: 10, extra: 11, flag: 12 }, nosFileUrlTag: { safeUrl: 0, originUrl: 1 }, fileListParam: { fromDocId: 1, limit: 2 }, avSignalTag: { type: 1, channelName: 2, channelId: 3, channelCreateTime: 4, channelExpireTime: 5, creator: 6, ext: 7, channelInValid: 8, from: 10, to: 11, requestId: 12, needPush: 13, pushTitle: 14, pushContent: 15, pushPayload: 16, needBadge: 17, members: 18, attach: 19, attachExt: 20, isSave: 21, msgid: 22, uid: 23, time: 24 }, login: { appKey: 1, account: 2, deviceId: 3, chatroomId: 5, appLogin: 8, chatroomNick: 20, chatroomAvatar: 21, chatroomCustom: 22, chatroomEnterCustom: 23, session: 26, isAnonymous: 38 }, chatroom: { id: 1, name: 3, announcement: 4, broadcastUrl: 5, custom: 12, createTime: 14, updateTime: 15, queuelevel: 16, creator: 100, onlineMemberNum: 101, mute: 102 }, msg: { idClient: 1, type: 2, attach: 3, custom: 4, resend: 5, userUpdateTime: 6, fromNick: 7, fromAvatar: 8, fromCustom: 9, yidunEnable: 10, antiSpamContent: 11, skipHistory: 12, body: 13, antiSpamBusinessId: 14, clientAntiSpam: 15, antiSpamUsingYidun: 16, time: 20, from: 21, chatroomId: 22, fromClientType: 23, highPriority: 25 }, chatroomMember: { chatroomId: 1, account: 2, type: 3, level: 4, nick: 5, avatar: 6, custom: 7, online: 8, guest: 9, enterTime: 10, blacked: 12, gaged: 13, valid: 14, updateTime: 15, tempMuted: 16, tempMuteDuration: 17 } } }, function (e, t, n) { var r = n(0), i = n(59), o = r.merge({}, i.idMap, { chatroom: { id: 13, login: 2, kicked: 3, logout: 4, sendMsg: 6, msg: 7, getChatroomMembers: 8, getHistoryMsgs: 9, markChatroomMember: 11, closeChatroom: 12, getChatroom: 13, updateChatroom: 14, updateMyChatroomMemberInfo: 15, getChatroomMembersInfo: 16, kickChatroomMember: 17, updateChatroomMemberTempMute: 19, queueOffer: 20, queuePoll: 21, queueList: 22, peak: 23, queueDrop: 24, queueInit: 25, queueChange: 26 }, user: { id: 3, syncRobot: 16 } }), s = r.merge({}, i.cmdConfig, { login: { sid: o.chatroom.id, cid: o.chatroom.login, params: [{ type: "byte", name: "type" }, { type: "Property", name: "login" }, { type: "Property", name: "imLogin" }] }, logout: { sid: o.chatroom.id, cid: o.chatroom.logout }, sendMsg: { sid: o.chatroom.id, cid: o.chatroom.sendMsg, params: [{ type: "Property", name: "msg" }] }, getChatroomMembers: { sid: o.chatroom.id, cid: o.chatroom.getChatroomMembers, params: [{ type: "byte", name: "type" }, { type: "long", name: "time" }, { type: "int", name: "limit" }] }, getHistoryMsgs: { sid: o.chatroom.id, cid: o.chatroom.getHistoryMsgs, params: [{ type: "long", name: "timetag" }, { type: "int", name: "limit" }, { type: "bool", name: "reverse" }, { type: "LongArray", name: "msgTypes" }] }, markChatroomMember: { sid: o.chatroom.id, cid: o.chatroom.markChatroomMember, params: [{ type: "string", name: "account" }, { type: "int", name: "type" }, { type: "bool", name: "isAdd" }, { type: "int", name: "level" }, { type: "string", name: "custom" }] }, closeChatroom: { sid: o.chatroom.id, cid: o.chatroom.closeChatroom, params: [{ type: "string", name: "custom" }] }, getChatroom: { sid: o.chatroom.id, cid: o.chatroom.getChatroom }, updateChatroom: { sid: o.chatroom.id, cid: o.chatroom.updateChatroom, params: [{ type: "Property", name: "chatroom" }, { type: "bool", name: "needNotify" }, { type: "String", name: "custom" }] }, updateMyChatroomMemberInfo: { sid: o.chatroom.id, cid: o.chatroom.updateMyChatroomMemberInfo, params: [{ type: "Property", name: "chatroomMember" }, { type: "bool", name: "needNotify" }, { type: "String", name: "custom" }, { type: "bool", name: "needSave" }] }, getChatroomMembersInfo: { sid: o.chatroom.id, cid: o.chatroom.getChatroomMembersInfo, params: [{ type: "StrArray", name: "accounts" }] }, kickChatroomMember: { sid: o.chatroom.id, cid: o.chatroom.kickChatroomMember, params: [{ type: "string", name: "account" }, { type: "string", name: "custom" }] }, updateChatroomMemberTempMute: { sid: o.chatroom.id, cid: o.chatroom.updateChatroomMemberTempMute, params: [{ type: "String", name: "account" }, { type: "long", name: "duration" }, { type: "bool", name: "needNotify" }, { type: "String", name: "custom" }] }, queueOffer: { sid: o.chatroom.id, cid: o.chatroom.queueOffer, params: [{ type: "string", name: "elementKey" }, { type: "string", name: "elementValue" }, { type: "bool", name: "transient" }] }, queuePoll: { sid: o.chatroom.id, cid: o.chatroom.queuePoll, params: [{ type: "string", name: "elementKey" }] }, queueList: { sid: o.chatroom.id, cid: o.chatroom.queueList }, peak: { sid: o.chatroom.id, cid: o.chatroom.peak }, queueDrop: { sid: o.chatroom.id, cid: o.chatroom.queueDrop }, queueInit: { sid: o.chatroom.id, cid: o.chatroom.queueInit, params: [{ type: "int", name: "limit" }] }, queueChange: { sid: o.chatroom.id, cid: o.chatroom.queueChange, params: [{ type: "StrStrMap", name: "elementMap" }, { type: "bool", name: "needNotify" }, { type: "string", name: "notifyExt" }] }, syncRobot: { sid: o.user.id, cid: o.user.syncRobot, params: [{ type: "long", name: "timetag" }] } }), a = r.merge({}, i.packetConfig, { "4_10": { service: "notify" }, "4_11": { service: "notify" }, "3_16": { service: "chatroom", cmd: "syncRobot", response: [{ type: "PropertyArray", name: "robots", entity: "robot" }] }, "13_2": { service: "chatroom", cmd: "login", response: [{ type: "Property", name: "chatroom" }, { type: "Property", name: "chatroomMember" }] }, "13_3": { service: "chatroom", cmd: "kicked", response: [{ type: "Number", name: "reason" }, { type: "String", name: "custom" }] }, "13_4": { service: "chatroom", cmd: "logout" }, "13_6": { service: "chatroom", cmd: "sendMsg", response: [{ type: "Property", name: "msg" }] }, "13_7": { service: "chatroom", cmd: "msg", response: [{ type: "Property", name: "msg" }] }, "13_8": { service: "chatroom", cmd: "getChatroomMembers", response: [{ type: "PropertyArray", name: "members", entity: "chatroomMember" }] }, "13_9": { service: "chatroom", cmd: "getHistoryMsgs", response: [{ type: "PropertyArray", name: "msgs", entity: "msg" }] }, "13_11": { service: "chatroom", cmd: "markChatroomMember", response: [{ type: "Property", name: "chatroomMember" }] }, "13_12": { service: "chatroom", cmd: "closeChatroom" }, "13_13": { service: "chatroom", cmd: "getChatroom", response: [{ type: "Property", name: "chatroom" }] }, "13_14": { service: "chatroom", cmd: "updateChatroom" }, "13_15": { service: "chatroom", cmd: "updateMyChatroomMemberInfo" }, "13_16": { service: "chatroom", cmd: "getChatroomMembersInfo", response: [{ type: "PropertyArray", name: "members", entity: "chatroomMember" }] }, "13_17": { service: "chatroom", cmd: "kickChatroomMember" }, "13_19": { service: "chatroom", cmd: "updateChatroomMemberTempMute" }, "13_20": { service: "chatroom", cmd: "queueOffer" }, "13_21": { service: "chatroom", cmd: "queuePoll", response: [{ type: "String", name: "elementKey" }, { type: "String", name: "elementValue" }] }, "13_22": { service: "chatroom", cmd: "queueList", response: [{ type: "KVArray", name: "queueList" }] }, "13_23": { service: "chatroom", cmd: "peak", response: [{ type: "String", name: "elementKey" }, { type: "String", name: "elementValue" }] }, "13_24": { service: "chatroom", cmd: "queueDrop" }, "13_25": { service: "chatroom", cmd: "queueInit" }, "13_26": { service: "chatroom", cmd: "queueChange", response: [{ type: "StrArray", name: "elementKeyArray" }] } }); e.exports = { idMap: o, cmdConfig: s, packetConfig: a } }, function (e, t, n) { e.exports = { nosToken: { 1: "objectName", 2: "token", 3: "bucket", 4: "expireTime", 7: "expireSec", 8: "tag", 9: "shortUrl" }, audioToText: { 2: "url" }, imageOp: { 0: "type", 1: "stripmeta", 2: "typeType", 3: "blurRadius", 4: "blurSigma", 5: "qualityQuality", 6: "cropX", 7: "cropY", 8: "cropWidth", 9: "cropHeight", 10: "rotateAngle", 11: "pixelPixel", 12: "thumbnailMode", 13: "thumbnailWidth", 14: "thumbnailHeight", 15: "thumbnailAxisX", 16: "thumbnailAxisY", 17: "thumbnailCenterX", 18: "thumbnailCenterY", 19: "thumbnailEnlarge", 20: "thumbnailToStatic", 21: "watermarkType", 22: "watermarkGravity", 23: "watermarkDissolve", 24: "watermarkDx", 25: "watermarkDy", 26: "watermarkImage", 27: "watermarkText", 28: "watermarkFont", 29: "watermarkFontSize", 30: "watermarkFontColor", 31: "interlace" }, robot: { 4: "account", 5: "nick", 6: "avatar", 7: "intro", 8: "config", 9: "valid", 10: "createTime", 11: "updateTime", 12: "custid", 13: "botid", 14: "bindTime", _6_safe: "_avatar_safe" }, clientAntispam: { 1: "version", 2: "md5", 3: "nosurl", 4: "thesaurus" }, fileQuickTransfer: { 1: "md5", 2: "url", 3: "size", 4: "threshold", _2_safe: "_url_safe" }, transToken: { 1: "name", 2: "type", 3: "transType", 4: "size", 5: "extra", 6: "body" }, transInfo: { 1: "docId", 2: "name", 3: "prefix", 4: "size", 5: "type", 6: "state", 7: "transType", 8: "transSize", 9: "pageCount", 10: "picInfo", 11: "extra", 12: "flag" }, nosFileUrlTag: { 0: "safeUrl", 1: "originUrl" }, fileListParam: { 1: "fromDocId", 2: "limit" }, avSignalTag: { 1: "type", 2: "channelName", 3: "channelId", 4: "channelCreateTime", 5: "channelExpireTime", 6: "creator", 7: "ext", 8: "channelInValid", 10: "from", 11: "to", 12: "requestId", 13: "needPush", 14: "pushTitle", 15: "pushContent", 16: "pushPayload", 17: "needBadge", 18: "members", 19: "attach", 20: "attachExt", 21: "isSave", 22: "msgid", 23: "uid", 24: "time" }, login: { 3: "clientType", 4: "os", 6: "sdkVersion", 8: "appLogin", 9: "protocolVersion", 10: "pushTokenName", 11: "pushToken", 13: "deviceId", 18: "appKey", 19: "account", 24: "browser", 26: "session", 32: "deviceInfo", 38: "customTag", 112: "isReactNative", 1e3: "token" }, loginRes: { 17: "lastLoginDeviceId", 38: "customTag", 102: "connectionId", 103: "ip", 104: "port", 106: "country", 111: "hasXMPush" }, loginPort: { 3: "type", 4: "os", 5: "mac", 13: "deviceId", 19: "account", 32: "deviceInfo", 38: "customTag", 102: "connectionId", 103: "ip", 109: "time" }, aosPushInfo: { 110: "pushType", 111: "hasTokenPreviously" }, sync: { 1: "myInfo", 2: "offlineMsgs", 3: "teams", 6: "netcallMsgs", 7: "roamingMsgs", 9: "relations", 11: "friends", 12: "sessions", 13: "friendUsers", 14: "msgReceipts", 15: "myTeamMembers", 16: "donnop", 17: "deleteMsg", 18: "sessionAck", 19: "robots", 20: "broadcastMsgs", 21: "avSignal", 22: "superTeams", 23: "myInfoInSuperTeams", 24: "superTeamRoamingMsgs", 100: "filterMsgs" }, donnop: { 1: "open" }, superTeam: { 1: "teamId", 3: "name", 4: "type", 5: "owner", 6: "level", 7: "selfCustom", 8: "valid", 9: "memberNum", 10: "memberUpdateTime", 11: "createTime", 12: "updateTime", 13: "validToCurrentUser", 14: "intro", 15: "announcement", 16: "joinMode", 17: "bits", 18: "custom", 19: "serverCustom", 20: "avatar", 21: "beInviteMode", 22: "inviteMode", 23: "updateTeamMode", 24: "updateCustomMode", 100: "mute", 101: "muteType", _20_safe: "_avatar_safe" }, superTeamMember: { 1: "teamId", 3: "account", 4: "type", 5: "nickInTeam", 7: "bits", 8: "active", 9: "valid", 10: "createTime", 11: "updateTime", 12: "custom", 13: "mute", 14: "invitoraccid", 15: "joinTime" }, team: { 1: "teamId", 3: "name", 4: "type", 5: "owner", 6: "level", 7: "selfCustom", 8: "valid", 9: "memberNum", 10: "memberUpdateTime", 11: "createTime", 12: "updateTime", 13: "validToCurrentUser", 14: "intro", 15: "announcement", 16: "joinMode", 17: "bits", 18: "custom", 19: "serverCustom", 20: "avatar", 21: "beInviteMode", 22: "inviteMode", 23: "updateTeamMode", 24: "updateCustomMode", 100: "mute", 101: "muteType", _20_safe: "_avatar_safe" }, teamMember: { 1: "teamId", 3: "account", 4: "type", 5: "nickInTeam", 7: "bits", 8: "active", 9: "valid", 10: "joinTime", 11: "updateTime", 12: "custom", 13: "mute", 14: "invitorAccid" }, msg: { 0: "scene", 1: "to", 2: "from", 4: "fromClientType", 5: "fromDeviceId", 6: "fromNick", 7: "time", 8: "type", 9: "body", 10: "attach", 11: "idClient", 12: "idServer", 13: "resend", 14: "userUpdateTime", 15: "custom", 16: "pushPayload", 17: "pushContent", 18: "apnsAccounts", 19: "apnsContent", 20: "apnsForcePush", 21: "yidunEnable", 22: "antiSpamContent", 23: "antiSpamBusinessId", 24: "clientAntiSpam", 25: "antiSpamUsingYidun", 26: "needMsgReceipt", 100: "isHistoryable", 101: "isRoamingable", 102: "isSyncable", 104: "isMuted", 105: "cc", 106: "isInBlackList", 107: "isPushable", 108: "isOfflinable", 109: "isUnreadable", 110: "needPushNick", 111: "isReplyMsg", 112: "tempTeamMemberCount" }, msgReceipt: { 1: "to", 2: "from", 7: "time", 11: "idClient" }, teamMsgReceipt: { 0: "teamId", 1: "idServer", 100: "read", 101: "unread", 102: "idClient", 103: "account" }, sysMsg: { 0: "time", 1: "type", 2: "to", 3: "from", 4: "ps", 5: "attach", 6: "idServer", 7: "sendToOnlineUsersOnly", 8: "apnsText", 9: "pushPayload", 10: "deletedIdClient", 11: "deletedIdServer", 12: "yidunEnable", 13: "antiSpamContent", 14: "deletedMsgTime", 15: "deletedMsgFromNick", 16: "opeAccount", 105: "cc", 107: "isPushable", 109: "isUnreadable", 110: "needPushNick" }, broadcastMsg: { 1: "broadcastId", 2: "fromAccid", 3: "fromUid", 4: "timestamp", 5: "body" }, friend: { 4: "account", 5: "flag", 6: "beflag", 7: "source", 8: "alias", 9: "bits", 10: "custom", 11: "createTime", 12: "updateTime", 13: "serverex" }, user: { 1: "account", 3: "nick", 4: "avatar", 5: "sign", 6: "gender", 7: "email", 8: "birth", 9: "tel", 10: "custom", 12: "createTime", 13: "updateTime", _4_safe: "_avatar_safe" }, specialRelation: { 0: "account", 1: "isMuted", 2: "isBlacked", 3: "createTime", 4: "updateTime" }, msgType: { 0: "text", 1: "picture", 2: "audio", 3: "video", 4: "location", 5: "notification", 6: "file", 7: "netcall_audio", 8: "netcall_vedio", 9: "datatunnel_new", 10: "tips", 11: "robot", 100: "custom" }, msgEvent: { 1: "type", 2: "value", 3: "idClient", 4: "custom", 5: "validTime", 6: "broadcastType", 7: "sync", 8: "validTimeType", 9: "durable", 10: "time", 11: "idServer", 12: "clientType", 13: "serverConfig", 14: "serverCustom", 101: "appid", 103: "account", 104: "enableMultiClient", 106: "consid" }, msgEventSubscribe: { 1: "type", 2: "subscribeTime", 3: "sync", 102: "to", 104: "from", 105: "time" }, clearMsgsParams: { 1: "account", 2: "delRoam" }, delFriendParams: { 1: "delAlias" } } }, function (e, t, n) { e.exports = { nosToken: { objectName: 1, token: 2, bucket: 3, expireTime: 4, expireSec: 7, tag: 8, shortUrl: 9 }, audioToText: { url: 2 }, imageOp: { type: 0, stripmeta: 1, typeType: 2, blurRadius: 3, blurSigma: 4, qualityQuality: 5, cropX: 6, cropY: 7, cropWidth: 8, cropHeight: 9, rotateAngle: 10, pixelPixel: 11, thumbnailMode: 12, thumbnailWidth: 13, thumbnailHeight: 14, thumbnailAxisX: 15, thumbnailAxisY: 16, thumbnailCenterX: 17, thumbnailCenterY: 18, thumbnailEnlarge: 19, thumbnailToStatic: 20, watermarkType: 21, watermarkGravity: 22, watermarkDissolve: 23, watermarkDx: 24, watermarkDy: 25, watermarkImage: 26, watermarkText: 27, watermarkFont: 28, watermarkFontSize: 29, watermarkFontColor: 30, interlace: 31 }, robot: { account: 4, nick: 5, avatar: 6, intro: 7, config: 8, valid: 9, createTime: 10, updateTime: 11, custid: 12, botid: 13, bindTime: 14 }, clientAntispam: { version: 1, md5: 2, nosurl: 3, thesaurus: 4 }, fileQuickTransfer: { md5: 1, url: 2, size: 3, threshold: 4 }, transToken: { name: 1, type: 2, transType: 3, size: 4, extra: 5, body: 6 }, transInfo: { docId: 1, name: 2, prefix: 3, size: 4, type: 5, state: 6, transType: 7, transSize: 8, pageCount: 9, picInfo: 10, extra: 11, flag: 12 }, nosFileUrlTag: { safeUrl: 0, originUrl: 1 }, fileListParam: { fromDocId: 1, limit: 2 }, avSignalTag: { type: 1, channelName: 2, channelId: 3, channelCreateTime: 4, channelExpireTime: 5, creator: 6, ext: 7, channelInValid: 8, from: 10, to: 11, requestId: 12, needPush: 13, pushTitle: 14, pushContent: 15, pushPayload: 16, needBadge: 17, members: 18, attach: 19, attachExt: 20, isSave: 21, msgid: 22, uid: 23, time: 24 }, login: { clientType: 3, os: 4, sdkVersion: 6, appLogin: 8, protocolVersion: 9, pushTokenName: 10, pushToken: 11, deviceId: 13, appKey: 18, account: 19, browser: 24, session: 26, deviceInfo: 32, isReactNative: 112, token: 1e3, customTag: 38 }, loginRes: { lastLoginDeviceId: 17, customTag: 38, connectionId: 102, ip: 103, port: 104, country: 106, hasXMPush: 111 }, loginPort: { type: 3, os: 4, mac: 5, deviceId: 13, account: 19, deviceInfo: 32, connectionId: 102, ip: 103, time: 109, customTag: 38 }, aosPushInfo: { pushType: 110, hasTokenPreviously: 111 }, sync: { myInfo: 1, offlineMsgs: 2, teams: 3, netcallMsgs: 6, roamingMsgs: 7, relations: 9, friends: 11, sessions: 12, friendUsers: 13, msgReceipts: 14, myTeamMembers: 15, donnop: 16, deleteMsg: 17, sessionAck: 18, robots: 19, broadcastMsgs: 20, avSignal: 21, superTeams: 22, myInfoInSuperTeams: 23, superTeamRoamingMsgs: 24, filterMsgs: 100 }, donnop: { open: 1 }, superTeam: { teamId: 1, name: 3, type: 4, owner: 5, level: 6, selfCustom: 7, valid: 8, memberNum: 9, memberUpdateTime: 10, createTime: 11, updateTime: 12, validToCurrentUser: 13, intro: 14, announcement: 15, joinMode: 16, bits: 17, custom: 18, serverCustom: 19, avatar: 20, beInviteMode: 21, inviteMode: 22, updateTeamMode: 23, updateCustomMode: 24, mute: 100, muteType: 101 }, superTeamMember: { teamId: 1, account: 3, type: 4, nickInTeam: 5, bits: 7, active: 8, valid: 9, createTime: 10, updateTime: 11, custom: 12, mute: 13, invitoraccid: 14, joinTime: 15 }, team: { teamId: 1, name: 3, type: 4, owner: 5, level: 6, selfCustom: 7, valid: 8, memberNum: 9, memberUpdateTime: 10, createTime: 11, updateTime: 12, validToCurrentUser: 13, intro: 14, announcement: 15, joinMode: 16, bits: 17, custom: 18, serverCustom: 19, avatar: 20, beInviteMode: 21, inviteMode: 22, updateTeamMode: 23, updateCustomMode: 24, mute: 100, muteType: 101 }, teamMember: { teamId: 1, account: 3, type: 4, nickInTeam: 5, bits: 7, active: 8, valid: 9, joinTime: 10, updateTime: 11, custom: 12, mute: 13, invitorAccid: 14 }, msg: { scene: 0, to: 1, from: 2, fromClientType: 4, fromDeviceId: 5, fromNick: 6, time: 7, type: 8, body: 9, attach: 10, idClient: 11, idServer: 12, resend: 13, userUpdateTime: 14, custom: 15, pushPayload: 16, pushContent: 17, apnsAccounts: 18, apnsContent: 19, apnsForcePush: 20, yidunEnable: 21, antiSpamContent: 22, antiSpamBusinessId: 23, clientAntiSpam: 24, antiSpamUsingYidun: 25, needMsgReceipt: 26, isHistoryable: 100, isRoamingable: 101, isSyncable: 102, isMuted: 104, cc: 105, isInBlackList: 106, isPushable: 107, isOfflinable: 108, isUnreadable: 109, needPushNick: 110, isReplyMsg: 111, tempTeamMemberCount: 112 }, msgReceipt: { to: 1, from: 2, time: 7, idClient: 11 }, teamMsgReceipt: { teamId: 0, idServer: 1, read: 100, unread: 101, idClient: 102, account: 103 }, sysMsg: { time: 0, type: 1, to: 2, from: 3, ps: 4, attach: 5, idServer: 6, sendToOnlineUsersOnly: 7, apnsText: 8, pushPayload: 9, deletedIdClient: 10, deletedIdServer: 11, yidunEnable: 12, antiSpamContent: 13, deletedMsgTime: 14, deletedMsgFromNick: 15, opeAccount: 16, cc: 105, isPushable: 107, isUnreadable: 109, needPushNick: 110 }, broadcastMsg: { broadcastId: 1, fromAccid: 2, fromUid: 3, timestamp: 4, body: 5 }, friend: { account: 4, flag: 5, beflag: 6, source: 7, alias: 8, bits: 9, custom: 10, createTime: 11, updateTime: 12, serverex: 13 }, user: { account: 1, nick: 3, avatar: 4, sign: 5, gender: 6, email: 7, birth: 8, tel: 9, custom: 10, createTime: 12, updateTime: 13 }, specialRelation: { account: 0, isMuted: 1, isBlacked: 2, createTime: 3, updateTime: 4 }, msgType: { text: 0, picture: 1, audio: 2, video: 3, location: 4, notification: 5, file: 6, netcall_audio: 7, netcall_vedio: 8, datatunnel_new: 9, tips: 10, robot: 11, custom: 100 }, msgEvent: { type: 1, value: 2, idClient: 3, custom: 4, validTime: 5, broadcastType: 6, sync: 7, validTimeType: 8, durable: 9, time: 10, idServer: 11, clientType: 12, serverConfig: 13, serverCustom: 14, appid: 101, account: 103, enableMultiClient: 104, consid: 106 }, msgEventSubscribe: { type: 1, subscribeTime: 2, sync: 3, to: 102, from: 104, time: 105 }, clearMsgsParams: { account: 1, delRoam: 2 }, delFriendParams: { delAlias: 1 } } }, function (e, t, n) { var r = n(25).fn, i = n(0), o = n(81); r.processAvSignal = function (e) { switch (e.cmd) { case "signalingCreate": case "signalingDelay": case "signalingClose": case "signalingJoin": case "signalingLeave": case "signalingInvite": case "signalingCancel": case "signalingReject": case "signalingAccept": case "signalingControl": case "signalingSyncMsgRead": case "signalingGetChannelInfo": break; case "signalingNotify": this.onSignalingNotify(e); break; case "signalingMutilClientSyncNotify": this.onSignalingMutilClientSyncNotify(e); break; case "signalingUnreadMessageSyncNotify": this.onSignalingUnreadMessageSyncNotify(e); break; case "signalingChannelsSyncNotify": this.onSignalingMembersSyncNotify(e); break; default: this.logger.log("avSignal::unhandled cmd:", e.cmd) } }; var s = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; if (e.needPush && (e.needPush = "1" === e.needPush), e.needBadge && (e.needBadge = "1" === e.needBadge), e.channelInValid && (e.channelInValid = "1" === e.channelInValid), e.attach) { var t = JSON.parse(e.attach); e.eventType = o.parseAvSignalType(t.type) } if (e.members) { var n = JSON.parse(e.members); e.members = n.map(function (e) { return o.parseAvSignalMember(e) }) } return e }; r.onSignalingNotify = function (e) { if (e.error) { var t = e.error; this.logger.error("protocal::avSignal:onSignalingNotify error", t), this.emitAPI({ type: "error", error: t }), this.options.onerror(t) } else { e.raw && e.raw.r && e.raw.r.length && e.content && e.content.avSignalTag && (e.content.avSignalTag.msgid = e.raw.r[0]); var n = e.content.avSignalTag; n = Array.isArray(n) ? n.map(function (e) { return s(e) }) : s(n), this.emitAPI({ type: "signalingNotify", obj: n }), i.isFunction(this.options.onSignalingNotify) && this.options.onSignalingNotify(n) } }, r.onSignalingMutilClientSyncNotify = function (e) { if (e.error) { var t = e.error; this.logger.error("protocal::avSignal:onSignalingMutilClientSyncNotify error", t), this.emitAPI({ type: "error", error: t }), this.options.onerror(t) } else this.emitAPI({ type: "signalingMutilClientSyncNotify", obj: e.content }), i.isFunction(this.options.onSignalingMutilClientSyncNotify) && this.options.onSignalingMutilClientSyncNotify(e.content) }, r.onSignalingUnreadMessageSyncNotify = function (e) { if (e.error) { var t = e.error; this.logger.error("protocal::avSignal:onSignalingUnreadMessageSyncNotify error", t), this.emitAPI({ type: "error", error: t }), this.options.onerror(t) } else { var n = e.content.avSignalTag; Array.isArray(n) && (n = n.map(function (e) { return s(e) })), this.emitAPI({ type: "signalingUnreadMessageSyncNotify", obj: n }), i.isFunction(this.options.onSignalingUnreadMessageSyncNotify) && this.options.onSignalingUnreadMessageSyncNotify(n) } }, r.onSignalingMembersSyncNotify = function (e) { if (e.error) { var t = e.error; this.logger.error("protocal::avSignal:onSignalingMembersSyncNotify error", t), this.emitAPI({ type: "error", error: t }), this.options.onerror(t) } else { var n = e.content.avSignalTag; Array.isArray(n) || (n = [n]), n = n.map(function (e) { return s(e) }), this.emitAPI({ type: "signalingChannelsSyncNotify", obj: n }), i.isFunction(this.options.onSignalingMembersSyncNotify) && this.options.onSignalingMembersSyncNotify(n) } } }, function (e, t, n) { var r = n(25).fn, i = n(82); r.processMisc = function (e) { switch (e.cmd) { case "getSimpleNosToken": e.error || (e.obj = e.content.nosTokens[0]); break; case "getNosToken": e.error || (e.obj = e.content.nosToken); break; case "notifyUploadLog": e.error || this.emitAPI({ type: "notifyUploadLog" }); break; case "audioToText": e.error || (e.obj.text = e.content.text); break; case "processImage": e.obj.imageOps = i.reverseImageOps(e.obj.imageOps), e.error || (e.obj = { url: e.content.url }); break; case "getNosTokenTrans": e.error || (e.obj = { nosToken: e.content.nosToken, docId: e.content.docId }); break; case "getNosOriginUrl": e.error || (e.obj = e.content.nosFileUrlTag.originUrl); break; case "notifyTransLog": e.error || this.emitAPI({ type: "notifyTransLog", obj: e.content.transInfo }); break; case "fetchFile": case "fetchFileList": case "removeFile": e.error || (e.obj = e.content); break; case "getServerTime": e.obj = e.content.time } } }, function (e, t, n) { var r = n(25).fn, i = n(1); r.processLink = function (e) { e.cmd }, r.startHeartbeat = function () { var e = this; e.stopHeartbeat(), e.heartbeatTimer = setTimeout(function () { e.sendCmd("heartbeat", null, e.onHeartbeat.bind(e)) }, i.heartbeatInterval) }, r.stopHeartbeat = function () { this.heartbeatTimer && (clearTimeout(this.heartbeatTimer), this.heartbeatTimer = null) }, r.onHeartbeat = function (e, t) { e ? (e.callFunc = "link::onHeartbeat", this.api.reportLogs({ event: "ping_timeout" }), this.onCustomError("heartbeat error", "HEARTBEAT_ERROR", e)) : this.startHeartbeat() }, r.heartbeat = function () { } }, function (e, t, n) { var r = n(31), i = n(47), o = n(30), s = n(52), a = n(70), c = Object.assign; e.exports = !c || n(23)(function () { var e = {}, t = {}, n = Symbol(), r = "abcdefghijklmnopqrst"; return e[n] = 7, r.split("").forEach(function (e) { t[e] = e }), 7 != c({}, e)[n] || Object.keys(c({}, t)).join("") != r }) ? function (e, t) { for (var n = s(e), c = arguments.length, u = 1, l = i.f, m = o.f; c > u;)for (var d, p = a(arguments[u++]), f = l ? r(p).concat(l(p)) : r(p), g = f.length, h = 0; g > h;)m.call(p, d = f[h++]) && (n[d] = p[d]); return n } : c }, function (e, t, n) { var r = n(24); r(r.S + r.F, "Object", { assign: n(152) }) }, function (e, t, n) { n(153), e.exports = n(9).Object.assign }, function (e, t, n) { e.exports = { default: n(154), __esModule: !0 } }, function (e, t, n) { t.__esModule = !0; var r, i = (r = n(155)) && r.__esModule ? r : { default: r }; t.default = i.default || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e } }, function (e, t, n) { var r, i, o = (r = n(156)) && r.__esModule ? r : { default: r }, s = n(25).fn, a = n(4), c = n(46), u = n(57), l = n(22), m = n(1), d = n(0), p = d.notundef; s.login = function () { var e = this; Promise.resolve().then(function () { return e.assembleLogin() }).then(function (t) { e.sendCmd("login", (0, o.default)({}, t), e.onLogin.bind(e)) }), e.autoconnect = !1 }, s.genSessionKey = (i = {}, function () { var e = this.name; return i[e] = i[e] || d.guid() }), s.assembleIMLogin = function () { var e = this.options, t = e.account, n = this.autoconnect ? 0 : 1; return this.sdkSession = this.genSessionKey(), { appLogin: n, appKey: e.appKey, account: t, token: e.token, sdkVersion: m.info.sdkVersion, protocolVersion: m.info.protocolVersion, os: c.os.toString(), browser: c.name + " " + c.version, clientType: m.CLIENTTYPE || 16, session: this.sdkSession, deviceId: l.deviceId, isReactNative: m.isRN ? 1 : 0, customTag: e.customTag || "" } }, s.onLogin = function (e, t) { this.loginResult = t, e ? this.onAuthError(e, "link::onLogin") : (this.startHeartbeat(), this.afterLogin(t)) }, s.afterLogin = d.emptyFunc, s.notifyLogin = function () { var e = this.loginResult; this.logger.info("link::notifyLogin: on connect", e), this.options.onconnect(e) }, s.logout = function () { var e = "done disconnect"; if (this.doLogout) return this.doLogout = !1, e = "done logout", void this.onAuthError(new a(e, "logout"), "link::logout"); if (this.isConnected()) { var t = new a(e, "logout"); this.onAuthError(t, "link::logout") } }, s.onKicked = function (e) { var t = e.content, n = t.from, r = t.reason, i = t.custom, o = { reason: this.kickedReasons[r] || "unknown", message: this.kickedMessages[r] || "未知原因" }; if (p(n) && (o.from = u.reverseType(n)), p(i) && (o.custom = i), this.shouldNotifyKicked(o)) { var s = new a("被踢了", "kicked"); d.merge(s, o), this.onAuthError(s, "link::onKicked") } else this.logger.warn("link::onKicked: silentlyKick"), this.shouldReconnect = !0, this.hasNotifyDisconnected = !0, this.disconnectSocket() }, s.shouldNotifyKicked = function (e) { return "silentlyKick" !== e.reason }, s.onAuthError = function (e, t) { this.shouldReconnect = !1, (e = e || a.newConnectionError({ callFunc: t })).callFunc = e.callFunc || t || null, this.markAllCallbackInvalid(e), this.notifyDisconnect(e) } }, function (e, t) { e.exports = function (e) { return e.webpackPolyfill || (e.deprecate = function () { }, e.paths = [], e.children || (e.children = []), Object.defineProperty(e, "loaded", { enumerable: !0, get: function () { return e.l } }), Object.defineProperty(e, "id", { enumerable: !0, get: function () { return e.i } }), e.webpackPolyfill = 1), e } }, function (e, t) { function n(e) { e = e || {}, this.ms = e.min || 100, this.max = e.max || 1e4, this.factor = e.factor || 2, this.jitter = e.jitter > 0 && e.jitter <= 1 ? e.jitter : 0, this.attempts = 0 } e.exports = n, n.prototype.duration = function () { var e = this.ms * Math.pow(this.factor, this.attempts++); if (this.jitter) { var t = Math.random(), n = Math.floor(t * this.jitter * e); e = 0 == (1 & Math.floor(10 * t)) ? e - n : e + n } return 0 | Math.min(e, this.max) }, n.prototype.reset = function () { this.attempts = 0 }, n.prototype.setMin = function (e) { this.ms = e }, n.prototype.setMax = function (e) { this.max = e }, n.prototype.setJitter = function (e) { this.jitter = e } }, function (e, t, n) { var r = n(25).fn, i = n(4), o = n(159), s = n(80), a = n(1), c = n(0); r.initConnect = function () { this.socket = null, this.retryCount = 0, this.connecting = !1, this.initConnecting = !1, this.shouldReconnect = !0, this.hasNotifyDisconnected = !1, this.doLogout = !1 }, r.resetConnect = function () { var e = this.options; c.notundef(e.needReconnect) ? (c.verifyParamType("needReconnect", e.needReconnect, "boolean", "link::resetConnect"), this.needReconnect = e.needReconnect) : this.needReconnect = !0, this.logger.log("link::resetConnect: needReconnect " + this.needReconnect), c.notundef(e.reconnectionAttempts) && c.verifyParamType("reconnectionAttempts", e.reconnectionAttempts, "number", "link::resetConnect"), c.notundef(e.noCacheLinkUrl) && c.verifyParamType("noCacheLinkUrl", e.noCacheLinkUrl, "boolean", "link::resetConnect"), this.reconnectionAttempts = "number" == typeof e.reconnectionAttempts ? e.reconnectionAttempts : 1 / 0, this.backoff = new o({ min: a.reconnectionDelay, max: a.reconnectionDelayMax, jitter: a.reconnectionJitter }) }, r.connect = function (e) { if (e) { if (this.initConnecting) return void this.logger.warn("link::connect: already init connecting"); clearTimeout(this.reconnectTimer) } if (this.isConnected()) this.logger.warn("link::connect: already connected"); else if (this.connecting) this.logger.warn("link::connect: already connecting"); else if (this.connecting = !0, this.hasNotifyDisconnected = !1, this.socket && this.socket && this.socket.socket) this.logger.info("link::connect: try connecting..."), this.socket.socket.connect(); else if (this.options.socketUrl && "string" == typeof this.options.socketUrl) this.connectToUrl(this.options.socketUrl); else { var t = this.getNextSocketUrl(); t && !this.options.noCacheLinkUrl ? this.connectToUrl(t) : this.refreshSocketUrl() } }, r.getNextSocketUrl = function () { return this.socketUrls.shift() }, r.isConnected = function () { return !!this.socket && !!this.socket.socket && this.socket.socket.connected }, r.connectToUrl = function (e) { var t = this; if (e = e || "", t.logger.log("link::connectToUrl: " + e), "undefined" == typeof window) { var n = c.getGlobal(), r = e.split(":"); n && !n.location && r.length > 1 && (n.location = { protocol: r[0], hostname: r[1].slice(2), port: r[2] }), this.options.transports = ["websocket"] } var i = this.options.transports || ["websocket", "xhr-polling"]; t.socket = s.connect(e, { transports: i, reconnect: !1, "force new connection": !0, "connect timeout": a.connectTimeout }), t.logger.info("link::connectToUrl: socket url: " + e + ", transports: " + JSON.stringify(i)), t.socket.on("connect", t.onConnect.bind(t)), t.socket.on("handshake_failed", t.onHandshakeFailed.bind(t)), t.socket.on("connect_failed", t.onConnectFailed.bind(t)), t.socket.on("error", t.onError.bind(t)), t.socket.on("message", t.onMessage.bind(t)), t.socket.on("disconnect", function (n) { t.logger.warn("link::connectToUrl: socket url: " + e + ", disconnected"), t.doLogout ? t.logout() : t.onDisconnect(!0, "link::socketDisconnect") }) }, r.disconnect = function (e) { function t(t) { n.logger.info("link::disconnect: socket finally closed, ", t), clearTimeout(n.disconnectCallbackTimer), e(t) } var n = this; e instanceof Function || (e = function () { }), clearTimeout(n.connectTimer), n.disconnectCallbackTimer = setTimeout(function () { e.call(n, "mark disconnected due to timeout") }, 1e4), n.socket && n.socket.socket && n.socket.socket.transport ? n.socket.socket.transport.onDisconnectDone = function (e) { t(e) } : t(null), n.isConnected() ? (n.logger.log("link::disconnect: start disconnecting"), n.logout()) : n.connecting ? (n.logger.log("link::disconnect: abort connecting"), n.disconnectSocket()) : (n.logger.log("link::disconnect: start otherwise"), n.connecting = !1, n.shouldReconnect = !1, n.needReconnect = !1, n.options.ondisconnect({ callFunc: "link::disconnect", message: "manually disconnect status" })) }, r.onConnect = function () { this.backoff && this.backoff.reset(), this.reconnectStatus = this.retryCount > 0 ? 1 : 0, this.retryCount = 0, this.connecting = !1, this.initConnecting = !1, this.shouldReconnect = !0, this.hasNotifyDisconnected = !1, this.logger.log("link::onConnect: socket onconnected, start login"), this.login(), this.api.reportLogs({ event: "ws_connected" }) }, r.onHandshakeFailed = function () { this.api.reportLogs({ event: "ws_handshake_failed" }), this.onDisconnect(!1, "link::onHandshakeFailed") }, r.onConnectFailed = function () { this.api.reportLogs({ event: "ws_connect_failed" }), this.onDisconnect(!1, "link::onConnectFailed") }, r.onError = function () { var e = arguments[0]; if (e) { if (this.api.reportLogs({ event: "connect_timeout" }), void 0 !== e.x5ImgDecodeStatus) return; if ("[object Object]" === Object.prototype.toString.call(e) && Object.keys(e).length <= 0) return; this.onMiscError("连接错误", new i(e, "LINK_ERROR", { callFunc: "link::onError" })) } this.connecting = !1 }, r.onDisconnect = function () { var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0], t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null; this.connected = e, this.connecting = !1, this.markAllCallbackInvalid(i.newNetworkError({ callFunc: t })), this.stopHeartbeat(), this.reconnect() }, r.willReconnect = function () { return this.shouldReconnect && this.needReconnect && this.retryCount < this.reconnectionAttempts }, r.reconnect = function () { var e = this; if (e.willReconnect()) if (e.socket && e.socket.socket && e.socket.socket.transport && e.socket.socket.transport.websocket) { e.logger.info("link::reconnect: on socket closed"), e.socket.socket.transport.onConnectionOver = function () { e.logger.log("link::reconnect: on connectionOver"), clearTimeout(e.reconnectTimer), e.doReconnect() }; try { e.socket.socket.transport.websocket.close() } catch (t) { e.logger.warn("link::reconnect: force disconnect error:", t) } } else clearTimeout(e.reconnectTimer), e.reconnectTimer = setTimeout(function () { e.logger.info("link::reconnect: on socket timeout"), e.doReconnect() }, 3e4); else e.notifyDisconnect() }, r.doReconnect = function () { var e = this; e.socket = null, e.connected && (e.autoconnect = !0), e.retryCount++ , e.appLogin = 1; var t = e.backoff.duration(); e.logger.info("link::reconnect: will retry after " + t + "ms, retryCount " + e.retryCount), e.options.onwillreconnect({ retryCount: e.retryCount, duration: t }), clearTimeout(e.connectTimer), e.connectTimer = setTimeout(function () { e.connect() }, t) }, r.notifyConnectError = function (e) { var t = i.newConnectError({ message: e, callFunc: "link::notifyConnectError" }); this.logger.error("link::notifyConnectError:", t), this.options.onerror(t) }, r.notifyDisconnect = function (e) { var t = this; t.hasNotifyDisconnected || (t.hasNotifyDisconnected = !0, t.disconnectSocket(), (e = e || new i).retryCount = t.retryCount, e.willReconnect = t.willReconnect(), t.backoff && t.backoff.reset(), t.retryCount = 0, t.socket && t.socket.socket && t.socket.socket.transport && t.socket.socket.transport.websocket ? (t.logger.info("link::notifyDisconnect: ondisconnected", e), t.socket.socket.transport.onConnectionOver = function () { t.socket = null, t.options.ondisconnect(e) }) : (t.logger.info("link::notifyDisconnect: ondisconnected/no transport ws", e), t.options.ondisconnect(e)), t.onWbNotifyHangup instanceof Function && t.onWbNotifyHangup({ content: { account: t.account, channelId: null, timetag: +Date() } })) }, r.disconnectSocket = function () { if (this.isConnected() || this.connecting) try { this.connecting = !1, this.shouldReconnect = !1, this.needReconnect = !1, this.socket.disconnect() } catch (e) { this.logger.info("link::disconnectSocket: disconnect failed, error ", e) } } }, function (e, t, n) { var r, i = (r = n(2)) && r.__esModule ? r : { default: r }, o = n(12).fn, s = n(0), a = n(59), c = n(81); o.signalingCreate = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.type, n = e.channelName, r = e.ext; return s.verifyOptions(e, "type", "api::signalling"), this.sendCmdUsePromise("signalingCreate", { avSignalTag: { type: t, channelName: n, ext: r } }).then(function (e) { var t = e.avSignalTag; return Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingDelay = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return s.verifyOptions(e, "channelId", "api::signalling"), this.sendCmdUsePromise("signalingDelay", { avSignalTag: e }).then(function (e) { var t = e.avSignalTag; return Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingClose = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.offlineEnabled; return s.verifyOptions(e, "channelId", "api::signalling"), this.sendCmdUsePromise("signalingClose", { avSignalTag: s.merge(e, { isSave: !0 === t ? 1 : 0 }) }).then(function (e) { var t = e.avSignalTag; return t.offlineEnabled = 1 === t.isSave, delete t.isSave, Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingJoin = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.offlineEnabled; return s.verifyOptions(e, "channelId", "api::signalling"), this.sendCmdUsePromise("signalingJoin", { avSignalTag: s.merge(e, { isSave: !0 === t ? 1 : 0 }) }).then(function (e) { var t = e.avSignalTag, n = t.members; return "string" == typeof t.members && (n = JSON.parse(t.members).map(function (e) { return c.parseAvSignalMember(e) })), t.members = n, Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingLeave = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.offlineEnabled; return s.verifyOptions(e, "channelId", "api::signalling"), this.sendCmdUsePromise("signalingLeave", { avSignalTag: s.merge(e, { isSave: !0 === t ? 1 : 0 }) }).then(function (e) { var t = e.avSignalTag; return t.offlineEnabled = 1 === t.isSave, delete t.isSave, Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingGetChannelInfo = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.channelName; return s.verifyOptions(e, "channelName", "api::signalling"), this.sendCmdUsePromise("signalingGetChannelInfo", { avSignalTag: { channelName: t } }).then(function (e) { var t = e.avSignalTag, n = t.members; return "string" == typeof t.members && (n = JSON.parse(t.members).map(function (e) { return c.parseAvSignalMember(e) })), t.members = n, Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingInvite = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.account, n = e.offlineEnabled, r = e.pushInfo, o = void 0 === r ? {} : r; s.verifyOptions(e, "channelId requestId account", "api::signalling"), "object" === (0, i.default)(o.pushPayload) && (o.pushPayload = JSON.stringify(o.pushPayload)); var a = s.merge(e, o, { to: t, isSave: !0 === n ? 1 : 0, needPush: !0 === o.needPush ? 1 : 0, needBadge: !1 === o.needBadge ? 0 : 1 }); return this.sendCmdUsePromise("signalingInvite", { avSignalTag: a }).then(function (e) { var t = e.avSignalTag; return t.offlineEnabled = 1 === t.isSave, t.needBadge = 1 === t.needBadge, t.needPush = 1 === t.needPush, delete t.isSave, Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingCancel = function (e) { var t = e.account, n = e.offlineEnabled; return s.verifyOptions(e, "channelId requestId account", "api::signalling"), this.sendCmdUsePromise("signalingCancel", { avSignalTag: s.merge(e, { to: t, isSave: !0 === n ? 1 : 0 }) }).then(function (e) { var t = e.avSignalTag; return t.offlineEnabled = 1 === t.isSave, delete t.isSave, Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingCreateAndJoin = function (e) { var t = this, n = e.channelName, r = e.uid, i = void 0 === r ? 0 : r, o = e.offlineEnabled, a = void 0 === o || o, c = e.attachExt, u = void 0 === c ? "" : c; return this.signalingCreate(e).catch(function (e) { return 10405 === e.code ? (t.logger.warn("api::avSignal:signalingCall room already exists:", e), t.signalingGetChannelInfo({ channelName: n })) : Promise.reject(e) }).then(function (e) { var n = { channelId: e.channelId, offlineEnabled: a, attachExt: u }; return i && s.merge(n, { uid: i }), t.signalingJoin(n) }) }, o.signalingCall = function (e) { var t = this, n = e.account, r = e.offlineEnabled, i = e.requestId; s.verifyOptions(e, "type requestId account", "api::signalling"); var o = ""; return this.signalingCreateAndJoin(e).then(function (s) { t.logger.log("api::avSignal:signalingCall join:", s); var a = { channelId: o = s.channelId || o, account: n, requestId: i, offlineEnabled: r, attachExt: e.attachExt || "", pushInfo: e.pushInfo || {} }; return t.signalingInvite(a) }) }, o.signalingReject = function (e) { var t = e.account, n = e.offlineEnabled; return s.verifyOptions(e, "channelId requestId account", "api::signalling"), this.sendCmdUsePromise("signalingReject", { avSignalTag: s.merge(e, { to: t, isSave: !0 === n ? 1 : 0 }) }).then(function (e) { var t = e.avSignalTag; return t.offlineEnabled = 1 === t.isSave, delete t.isSave, Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingAccept = function (e) { var t = this, n = e.account, r = e.offlineEnabled; return s.verifyOptions(e, "channelId requestId account", "api::signalling"), this.sendCmdUsePromise("signalingAccept", { avSignalTag: s.merge(e, { to: n, isSave: !0 === r ? 1 : 0 }) }).then(function (e) { var t = e.avSignalTag; return t.offlineEnabled = 1 === t.isSave, delete t.isSave, Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }).then(function (n) { if (e.autoJoin) { var r = { channelId: e.channelId, offlineEnabled: e.offlineEnabled, attachExt: e.joinAttachExt, uid: e.uid }; return t.signalingJoin(r) } return n }) }, o.signalingControl = function (e) { var t = e.account; return s.verifyOptions(e, "channelId", "api::signalling"), this.sendCmdUsePromise("signalingControl", { avSignalTag: s.merge(e, t ? { to: t } : {}) }).then(function (e) { var t = e.avSignalTag; return Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingSync = function () { return this.sendCmdUsePromise("sync", { sync: { avSignal: 0 } }).then(function (e) { var t = e.avSignalTag; return Promise.resolve(t) }).catch(function (e) { return Promise.reject(c.parseAvSignalError(e)) }) }, o.signalingMarkMsgRead = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; s.verifyOptions(e, "msgid", "api::signalling"); var t, n = a.idMap.avSignal; return t = "string" == typeof e.msgid ? [e.msgid] : e.msgid, this.sendCmd("batchMarkRead", { sid: n.id, cid: n.signalingNotify, ids: t }) } }, function (e, t, n) { var r = n(12).fn, i = n(0), o = n(17), s = n(1), a = n(46); (a = a || {}).name = a.name || "", a.version = a.version || "", r.reportLogs = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = this, n = t.options, r = s.ntServerAddress; if (r) { var c = s.info; e = i.merge(e, { appkey: n.appKey, uid: n.account, os: "web", session: t.protocol.sdkSession || "", ver: c.sdkVersion, type: t.subType, platform: "" + a.name.toLowerCase() + a.version.replace(/(\.\d+)+$/, "") }); var u = r + i.genUrlSep(r), l = []; for (var m in e) l.push(m + "=" + e[m]); u += l.join("&"), o(u, { proxyUrl: i.url2origin(u) + "/lbs/res/cors/nej_proxy_frame.html", timeout: s.xhrTimeout, onload: function () { }, onerror: function (e) { t.logger.info("report::ajax report error", e) } }) } } }, function (e, t, n) { function r(e, t, n, r) { var i = !1, o = ""; if (1 === n ? e.indexOf(t) >= 0 && (i = !0, o = t) : 2 === n && (o = new RegExp(t, "g")).test(e) && (i = !0), i && "" !== o) switch (r) { case 1: return e.replace(o, "**"); case 2: return { code: 2 }; case 3: return { code: 3 } }return e } function i(e, t) { for (var n = t.match, i = t.operate, o = e, a = 0; a < t.keys.length; a++) { var c = t.keys[a], u = c.match || n, l = c.operate || i; try { if ("object" === (void 0 === (o = r(o, c.key, u, l)) ? "undefined" : (0, s.default)(o))) return o } catch (e) { this.logger.warn("misc::filterContent: js cannot parse this regexp ", e) } } return o } var o, s = (o = n(2)) && o.__esModule ? o : { default: o }, a = n(0), c = n(12).fn; c.uploadSdkLogUrl = function (e) { return a.verifyOptions(e, "url", "misc::uploadSdkLogUrl"), this.cbAndSendCmd("uploadSdkLogUrl", e) }, c.getClientAntispamLexicon = function (e) { var t = this, n = (e = e || {}).done; n instanceof Function || (n = function () { }), e = { clientAntispam: { version: 0 } }; var r = this; return this.protocol.sendCmd("getClientAntispam", e, function (e, i, o) { e ? (r.protocol.logger.error("misc::getClientAntispamLexicon:", e), n.call(t, e, {})) : (n.call(t, null, o), r.antispamLexicon = o.clientAntispam || {}) }) }, c.filterClientAntispam = function (e) { var t = e.content, n = e.antispamLexicon; if (!t) return { code: 404, errmsg: "待反垃圾文本content不存在" }; n = n || this.antispamLexicon || {}; var r = this.antispamLexicon && this.antispamLexicon.thesaurus; if (!r) return { code: 404, errmsg: "没有反垃圾词库或者词库格式不合法" }; try { r = JSON.parse(r).thesaurus } catch (e) { return this.protocol.logger.error("misc::filterClientAntispam: parse thesaurus error"), { code: 500, errmsg: "反垃圾词库格式不合法" } } for (var o = t, a = 0; a < r.length; a++)if ("object" === (void 0 === (o = i.call(this, o, r[a])) ? "undefined" : (0, s.default)(o))) { if (2 === o.code) return { code: 200, type: 2, errmsg: "建议拒绝发送", content: t, result: "" }; if (3 === o.code) return { code: 200, type: 3, errmsg: "建议服务器处理反垃圾，发消息带上字段clientAntiSpam", content: t, result: t } } return o === t ? { code: 200, type: 0, errmsg: "", content: t, result: o } : { code: 200, type: 1, errmsg: "已对特殊字符做了过滤", content: t, result: o } }, c.getServerTime = function (e) { this.processCallback(e), this.sendCmd("getServerTime", {}, e.callback) } }, function (e, t, n) { var r, i, o = (r = n(2)) && r.__esModule ? r : { default: r }, s = n(29), a = n(0), c = n(12).fn; c.viewImageSync = function (e) { var t = this.options; a.verifyOptions(e, "url", "nos::viewImageSync"); var n = e.url, r = (0, s.url2object)(n), i = r.protocol, c = r.hostname, u = r.path, l = r.query; if ("boolean" == typeof e.strip && (l.stripmeta = e.strip ? 1 : 0), "number" == typeof e.quality && (a.verifyParamMin("quality", e.quality, 0, "nos::viewImageSync"), a.verifyParamMax("quality", e.quality, 100, "nos::viewImageSync"), l.quality = Math.round(e.quality)), "boolean" == typeof e.interlace && (l.interlace = e.interlace ? 1 : 0), "number" == typeof e.rotate && (l.rotate = Math.round(e.rotate)), "object" === (0, o.default)(e.thumbnail)) { var m = e.thumbnail.mode || "crop", d = e.thumbnail.width, p = e.thumbnail.height; if (d >= 0 && p >= 0 && d < 4096 && p < 4096 && (d > 0 || p > 0)) { switch (m) { case "crop": m = "y"; break; case "contain": m = "x"; break; case "cover": m = "z"; break; default: m = "x" }l.thumbnail = "" + d + m + p } } if (t.downloadUrl) { var f = (0, s.url2object)(e.url), g = t.downloadUrl, h = f.path, y = h.indexOf("/"); if (-1 !== y) { var v = h.substring(0, y), b = h.substring(y + 1); g = g.replace("{bucket}", v).replace("{object}", b) } var T = (0, s.url2object)(g); return (0, s.object2url)({ protocol: T.protocol, hostname: T.hostname, path: T.path, query: a.merge(T.query, l) }) } return (0, s.object2url)({ protocol: i, hostname: c, path: u, query: l }) }, c.viewImageStripMeta = function (e) { a.verifyOptions(e, "url strip", "nos::viewImageStripMeta"), a.verifyParamType("strip", e.strip, "boolean", "nos::viewImageStripMeta"); var t = "stripmeta=" + (e.strip ? 1 : 0), n = (0, s.genUrlSep)(e.url); return e.url + n + t }, c.viewImageQuality = function (e) { a.verifyOptions(e, "url quality", "nos::viewImageQuality"), a.verifyParamType("quality", e.quality, "number", "nos::viewImageQuality"), a.verifyParamMin("quality", e.quality, 0, "nos::viewImageQuality"), a.verifyParamMax("quality", e.quality, 100, "nos::viewImageQuality"); var t = "quality=" + Math.round(e.quality), n = (0, s.genUrlSep)(e.url); return e.url + n + t }, c.viewImageInterlace = function (e) { a.verifyOptions(e, "url", "nos::viewImageInterlace"); var t = (0, s.genUrlSep)(e.url); return e.url + t + "interlace=1" }, c.viewImageRotate = function (e) { for (a.verifyOptions(e, "url angle", "nos::viewImageRotate"), a.verifyParamType("angle", e.angle, "number", "nos::viewImageRotate"); e.angle < 0;)e.angle = e.angle + 360; e.angle = e.angle % 360; var t = "rotate=" + Math.round(e.angle), n = (0, s.genUrlSep)(e.url); return e.url + n + t }, c.viewImageBlur = function (e) { a.verifyOptions(e, "url radius sigma", "nos::viewImageBlur"), a.verifyParamType("radius", e.radius, "number", "nos::viewImageBlur"), a.verifyParamMin("radius", e.radius, 1, "nos::viewImageBlur"), a.verifyParamMax("radius", e.radius, 50, "nos::viewImageBlur"), a.verifyParamType("sigma", e.sigma, "number", "nos::viewImageBlur"), a.verifyParamMin("sigma", e.sigma, 0, "nos::viewImageBlur"); var t = "blur=" + Math.round(e.radius) + "x" + Math.round(e.sigma), n = (0, s.genUrlSep)(e.url); return e.url + n + t }, c.viewImageCrop = function (e) { a.verifyOptions(e, "url x y width height", "nos::viewImageCrop"), a.verifyParamType("x", e.x, "number", "nos::viewImageCrop"), a.verifyParamMin("x", e.x, 0, "nos::viewImageCrop"), a.verifyParamType("y", e.y, "number", "nos::viewImageCrop"), a.verifyParamMin("y", e.y, 0, "nos::viewImageCrop"), a.verifyParamType("width", e.width, "number", "nos::viewImageCrop"), a.verifyParamMin("width", e.width, 0, "nos::viewImageCrop"), a.verifyParamType("height", e.height, "number", "nos::viewImageCrop"), a.verifyParamMin("height", e.height, 0, "nos::viewImageCrop"); var t = "crop=" + Math.round(e.x) + "_" + Math.round(e.y) + "_" + Math.round(e.width) + "_" + Math.round(e.height), n = (0, s.genUrlSep)(e.url); return e.url + n + t }, c.viewImageThumbnail = (i = { cover: "z", contain: "x", crop: "y" }, function (e) { a.verifyOptions(e, "url mode", "nos::viewImageThumbnail"), a.verifyParamValid("mode", e.mode, Object.keys(i), "nos::viewImageThumbnail"), "contain" === e.mode ? a.verifyParamAtLeastPresentOne(e, "width height", "nos::viewImageThumbnail") : a.verifyOptions(e, "width height", "nos::viewImageThumbnail"), a.undef(e.width) && (e.width = 0), a.undef(e.height) && (e.height = 0), a.verifyParamType("width", e.width, "number", "nos::viewImageThumbnail"), a.verifyParamMin("width", e.width, 0, "nos::viewImageThumbnail"), a.verifyParamType("height", e.height, "number", "nos::viewImageThumbnail"), a.verifyParamMin("height", e.height, 0, "nos::viewImageThumbnail"); var t = Math.round(e.width), n = Math.round(e.height), r = "thumbnail=" + t + i[e.mode] + n; "crop" === e.mode && a.notundef(e.axis) && (a.undef(e.axis.x) && (e.axis.x = 5), a.undef(e.axis.y) && (e.axis.y = 5), a.verifyParamMin("axis.x", e.axis.x, 0, "nos::viewImageThumbnail"), a.verifyParamMax("axis.x", e.axis.x, 10, "nos::viewImageThumbnail"), a.verifyParamMin("axis.y", e.axis.y, 0, "nos::viewImageThumbnail"), a.verifyParamMax("axis.y", e.axis.y, 10, "nos::viewImageThumbnail"), r = r + "&axis=" + Math.round(e.axis.x) + "_" + Math.round(e.axis.y)), a.notundef(e.enlarge) && (a.verifyParamType("enlarge", e.enlarge, "boolean", "nos::viewImageThumbnail"), e.enlarge && (r += "&enlarge=1")); var o = (0, s.genUrlSep)(e.url); return e.url + o + r }) }, function (e, t, n) { var r, i = n(0), o = n(12).fn, s = n(82), a = n(84), c = n(4); o.transDoc = function (e) { i.verifyOptions(e, "fileInput done", "nos::transDoc"); try { var t = e.fileInput.files[0], n = e.fileInputName = t.name, r = { ppt: 1, pptx: 2, pdf: 3 }, o = n.substring(n.lastIndexOf(".") + 1); if (["ppt", "pdf", "pptx"].indexOf(o) < 0) return void e.done(c.newNoFileError("请上传正确格式的文件【ppt, pptx, pdf】", { callFunc: "nos: transDoc", fileInput: e.fileInput }), e) } catch (t) { return void e.done(c.newNoFileError("请上传正确的文件节点", { callFunc: "msg::previewFile", fileInput: e.fileInput }), e) } var s = JSON.stringify(a.genResponseBody("file") || {}).replace(/"/gi, '\\"'), u = { transToken: { name: n, type: r[o], transType: "png" === e.transcode ? 11 : 10, size: t.size, body: s } }; this.getNosTokenTrans({ responseBody: u, nosToken: { nosScene: e.nosScene || this.nosScene, nosSurvivalTime: e.nosSurvivalTime }, callback: function (t, n) { t ? e.done(t) : (e.nosToken = n.nosToken, e.docId = n.docId, this._doPreviewFile(e)) }.bind(this) }) }, o.getSimpleNosToken = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return e.num = 1, i.verifyOptions(e), this.cbAndSendCmd("getSimpleNosToken", e) }, o.getNosToken = function (e) { var t = e.callback, n = e.nosToken, r = e.responseBody, i = { tag: n.nosScene }; n.nosSurvivalTime && n.nosSurvivalTime !== 1 / 0 && (i.expireSec = n.nosSurvivalTime), this.sendCmd("getNosToken", { responseBody: r, nosToken: i }, t) }, o.getNosTokenTrans = function (e) { this.sendCmd("getNosTokenTrans", e.responseBody, e.callback) }, o.packFileDownloadName = function (e) { i.verifyOptions(e, "url name", !0, "", "nos::packFileDownloadName"); var t = e.url; return t + i.genUrlSep(t) + "download=" + encodeURIComponent(e.name) }, o.audioToMp3 = function (e) { i.verifyOptions(e, "url", "nos::audioToMp3"); var t = e.url; return t + i.genUrlSep(t) + "audioTrans&type=mp3" }, o.removeFile = function (e) { this.sendCmd("removeFile", e, e.callback) }, o.fetchFile = function (e) { this.sendCmd("fetchFile", e, e.callback) }, o.fetchFileList = function (e) { this.sendCmd("fetchFileList", e, e.callback) }, o.stripImageMeta = function (e) { return this.beforeProcessImage(e, "stripmeta") }, o.qualityImage = function (e) { return this.beforeProcessImage(e, "quality") }, o.interlaceImage = function (e) { return this.beforeProcessImage(e, "interlace") }, o.rotateImage = function (e) { return this.beforeProcessImage(e, "rotate") }, o.blurImage = function (e) { return this.beforeProcessImage(e, "blur") }, o.cropImage = function (e) { return this.beforeProcessImage(e, "crop") }, o.thumbnailImage = function (e) { return this.beforeProcessImage(e, "thumbnail") }, o.beforeProcessImage = function (e, t) { var n = i.copy(e); return n.type = t, e.ops = [n], this.processImage(e) }, o.processImage = function (e) { var t = this; i.verifyOptions(e, "url ops", !0, "", "nos::processImage"), i.verifyParamType("ops", e.ops, "array", "nos::processImage"); var n = e.ops.map(function (e) { return i.verifyOptions(e, "type", !0, "", "nos::processImage"), i.verifyParamValid("type", e.type, s.validTypes, "nos::processImage"), t["gen" + e.type.slice(0, 1).toUpperCase() + e.type.slice(1) + "Op"](e) }); t.processCallback(e), t.sendCmd("processImage", { url: e.url, imageOps: n }, e.callback) }, o.genStripmetaOp = function (e) { return new s({ type: e.type, stripmeta: e.strip ? 1 : 0 }) }, o.genQualityOp = function (e) { i.verifyOptions(e, "quality", !0, "", "nos::genQualityOp"), i.verifyParamType("quality", e.quality, "number", "nos::genQualityOp"), i.verifyParamMin("quality", e.quality, 0, "nos::genQualityOp"), i.verifyParamMax("quality", e.quality, 100, "nos::genQualityOp"); var t = Math.round(e.quality); return new s({ type: e.type, qualityQuality: t }) }, o.genInterlaceOp = function (e) { return new s({ type: e.type }) }, o.genRotateOp = function (e) { for (i.verifyOptions(e, "angle", !0, "", "nos::genRotateOp"), i.verifyParamType("angle", e.angle, "number", "nos::genRotateOp"); e.angle < 0;)e.angle = e.angle + 360; e.angle = e.angle % 360; var t = Math.round(e.angle); return new s({ type: e.type, rotateAngle: t }) }, o.genBlurOp = function (e) { i.verifyOptions(e, "radius sigma", "nos::genBlurOp"), i.verifyParamType("radius", e.radius, "number", "nos::genBlurOp"), i.verifyParamMin("radius", e.radius, 1, "nos::genBlurOp"), i.verifyParamMax("radius", e.radius, 50, "nos::genBlurOp"), i.verifyParamType("sigma", e.sigma, "number", "nos::genBlurOp"), i.verifyParamMin("sigma", e.sigma, 0, "nos::genBlurOp"); var t = Math.round(e.radius), n = Math.round(e.sigma); return new s({ type: e.type, blurRadius: t, blurSigma: n }) }, o.genCropOp = function (e) { i.verifyOptions(e, "x y width height", "nos::genCropOp"), i.verifyParamType("x", e.x, "number", "nos::genCropOp"), i.verifyParamMin("x", e.x, 0, "nos::genCropOp"), i.verifyParamType("y", e.y, "number", "nos::genCropOp"), i.verifyParamMin("y", e.y, 0, "nos::genCropOp"), i.verifyParamType("width", e.width, "number", "nos::genCropOp"), i.verifyParamMin("width", e.width, 0, "nos::genCropOp"), i.verifyParamType("height", e.height, "number", "nos::genCropOp"), i.verifyParamMin("height", e.height, 0, "nos::genCropOp"); var t = Math.round(e.x), n = Math.round(e.y), r = Math.round(e.width), o = Math.round(e.height); return new s({ type: e.type, cropX: t, cropY: n, cropWidth: r, cropHeight: o }) }, o.genThumbnailOp = (r = { cover: "z", contain: "x", crop: "y" }, function (e) { i.verifyOptions(e, "mode", "nos::genThumbnailOp"), i.verifyParamValid("mode", e.mode, Object.keys(r), "nos::genThumbnailOp"), "contain" === e.mode ? i.verifyParamAtLeastPresentOne(e, "width height", "nos::genThumbnailOp") : i.verifyOptions(e, "width height", "nos::genThumbnailOp"), i.undef(e.width) && (e.width = 0), i.undef(e.height) && (e.height = 0), i.verifyParamType("width", e.width, "number", "nos::genThumbnailOp"), i.verifyParamMin("width", e.width, 0, "nos::genThumbnailOp"), i.verifyParamType("height", e.height, "number", "nos::genThumbnailOp"), i.verifyParamMin("height", e.height, 0, "nos::genThumbnailOp"); var t = Math.round(e.width), n = Math.round(e.height), o = new s({ type: e.type, thumbnailMode: r[e.mode], thumbnailWidth: t, thumbnailHeight: n }); if ("crop" === e.mode && i.notundef(e.axis)) { i.undef(e.axis.x) && (e.axis.x = 5), i.undef(e.axis.y) && (e.axis.y = 5), i.verifyParamMin("axis.x", e.axis.x, 0, "nos::genThumbnailOp"), i.verifyParamMax("axis.x", e.axis.x, 10, "nos::genThumbnailOp"), i.verifyParamMin("axis.y", e.axis.y, 0, "nos::genThumbnailOp"), i.verifyParamMax("axis.y", e.axis.y, 10, "nos::genThumbnailOp"); var a = Math.round(e.axis.x), c = Math.round(e.axis.y); o.thumbnailAxisX = a, o.thumbnailAxisY = c } return i.notundef(e.enlarge) && (i.verifyParamType("enlarge", e.enlarge, "boolean", "nos::genThumbnailOp"), e.enlarge && (o.thumbnailEnlarge = 1)), o }), o.getNosOriginUrl = function (e) { i.verifyOptions(e, "safeShortUrl", !0, "", "nos::getNosOriginUrl"), i.verifyParamType("safeShortUrl", e.safeShortUrl, "string", "nos::getNosOriginUrl"), /^http(s)?:/.test(e.safeShortUrl) && ~e.safeShortUrl.indexOf("im_url=1") ? (this.processCallback(e), this.sendCmd("getNosOriginUrl", { nosFileUrlTag: { safeUrl: e.safeShortUrl } }, e.callback)) : e.done(new c("参数 “safeShortUrl” 内容非文件安全短链", { callFunc: "nos: getNosOriginUrl" }), e) } }, function (e, t, n) { function r(e) { var t = this; t.options = o.copy(e), o.verifyOptions(e, "url fileName"), o.verifyParamPresentJustOne(e, "blob fileInput"), o.verifyCallback(e, "beginupload uploadprogress uploaddone"), e.fileInput && (e.fileInput = o.verifyFileInput(e.fileInput)), e.type && o.verifyFileType(e.type), e.timeout ? o.verifyParamType("timeout", e.timeout, "number") : e.timeout = 6e5, o.verifyFileUploadCallback(e), e.data = {}, e.params && o.merge(e.data, e.params); var n = e.fileName, r = e.fileInput; if (l) { if (r) { var u = e.type ? o.filterFiles(r.files, e.type) : [].slice.call(r.files, 0); if (!u || !u.length) return void e.uploaddone(s.newWrongFileTypeError("未读取到" + e.type + "类型的文件, 请确保文件选择节点的文件不为空, 并且请确保选择了" + e.type + "类型的文件")); e.data[n] = u[0]; var m = r.files[0].size } else if (e.blob) { if (e.data[n] = e.blob, "file" !== e.type && e.blob.type && -1 === e.blob.type.indexOf(e.type)) return void e.uploaddone(s.newWrongFileTypeError("未读取到" + e.type + "类型的文件, 请确保选择了" + e.type + "类型的文件")); m = e.blob.size } if (e.maxSize && m > e.maxSize) return void e.uploaddone(s.newFileTooLargeError("上传文件大小超过" + e.maxSize + "限制")); if (!e.commonUpload) return m > i.chunkMaxSize ? void e.uploaddone(s.newFileTooLargeError("直传文件大小超过" + i.chunkMaxSize + "限制")) : void (t.sn = c(e, n, t)); if (m > i.commonMaxSize) return void e.uploaddone(s.newFileTooLargeError("普通上传文件大小超过" + i.commonMaxSize + "限制")) } else o.dataset(r, "name", n), e.data.input = r; var d = { data: e.data, onaftersend: function () { e.beginupload(t) }, onuploading: function (t) { var n = Math.floor(1e4 * t.loaded / t.total) / 100, r = { docId: e.docId, total: t.total, loaded: t.loaded, percentage: n, percentageText: n + "%" }; e.fileInput && (r.fileInput = e.fileInput), e.blob && (r.blob = e.blob), e.uploadprogress(r) }, onload: function (n) { n.docId = e.docId, n.Error ? t.onError(n) : e.uploaddone(null, n) }, onerror: function (n) { try { if (n.result) var r = JSON.parse(n.result); else r = n; t.onError(r) } catch (r) { console.log("error: ignore error if could not parse obj.result", r), e.uploaddone(new s(n.message, n.code), t.options) } } }; l || (d.mode = "iframe"), d.putFileAtEnd = !0, t.sn = a(e.url, d) } var i = n(1), o = n(0), s = n(4), a = n(17).upload, c = n(17).chunkUpload, u = n(17).abort, l = o.supportFormData; r.prototype.onError = function (e) { var t, n, r, i = this.options; n = (t = (e = e || {}).Error || e || {}).Code || t.code || "unknown", r = t.Message || t.message || "未知错误", i.uploaddone(new s(n + "(" + r + ")", n)) }, r.prototype.abort = function () { u(this.sn) }, e.exports = r }, function (e, t, n) { var r, i; void 0 === (i = "function" == typeof (r = function (e) { return function (t) { function n(e) { var t = e.localName; return null == t && (t = e.baseName), null != t && "" !== t || (t = e.nodeName), t } function r(e) { return "string" == typeof e ? e.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;") : e } function i(e, n, r) { switch (t.arrayAccessForm) { case "property": e[n] instanceof Array ? e[n + "_asArray"] = e[n] : e[n + "_asArray"] = [e[n]] }if (!(e[n] instanceof Array) && t.arrayAccessFormPaths.length > 0) { for (var i = !1, o = 0; o < t.arrayAccessFormPaths.length; o++) { var s = t.arrayAccessFormPaths[o]; if ("string" == typeof s) { if (s === r) { i = !0; break } } else if (s instanceof RegExp) { if (s.test(r)) { i = !0; break } } else if ("function" == typeof s && s(n, r)) { i = !0; break } } i && (e[n] = [e[n]]) } } function o(e) { var t = e.split(/[-T:+Z]/g), n = new Date(t[0], t[1] - 1, t[2]), r = t[5].split("."); if (n.setHours(t[3], t[4], r[0]), r.length > 1 && n.setMilliseconds(r[1]), t[6] && t[7]) { var i = 60 * t[6] + Number(t[7]); i = 0 + ("-" == (/\d\d-\d\d:\d\d$/.test(e) ? "-" : "+") ? -1 * i : i), n.setMinutes(n.getMinutes() - i - n.getTimezoneOffset()) } else -1 !== e.indexOf("Z", e.length - 1) && (n = new Date(Date.UTC(n.getFullYear(), n.getMonth(), n.getDate(), n.getHours(), n.getMinutes(), n.getSeconds(), n.getMilliseconds()))); return n } function s(e, r) { return e.nodeType === h.DOCUMENT_NODE ? function (e) { for (var r = {}, i = e.childNodes, o = 0; o < i.length; o++) { var a = i.item(o); if (a.nodeType === h.ELEMENT_NODE) { var c = n(a); t.ignoreRoot ? r = s(a, c) : r[c] = s(a, c) } } return r }(e) : e.nodeType === h.ELEMENT_NODE ? function (e, r) { for (var a = { __cnt: 0 }, c = e.childNodes, u = 0; u < c.length; u++) { var l = c.item(u), m = n(l); l.nodeType !== h.COMMENT_NODE && (a.__cnt++ , null == a[m] ? (a[m] = s(l, r + "." + m), i(a, m, r + "." + m)) : (a[m] instanceof Array || (a[m] = [a[m]], i(a, m, r + "." + m)), a[m][a[m].length] = s(l, r + "." + m))) } for (var d = 0; d < e.attributes.length; d++) { var p = e.attributes.item(d); a.__cnt++; for (var f = p.value, g = 0; g < t.attributeConverters.length; g++) { var y = t.attributeConverters[g]; y.test.call(null, p.name, p.value) && (f = y.convert.call(null, p.name, p.value)) } a[t.attributePrefix + p.name] = f } var v = e.prefix; return v && (a.__cnt++ , a.__prefix = v), a["#text"] && (a.__text = a["#text"], a.__text instanceof Array && (a.__text = a.__text.join("\n")), t.escapeMode && (a.__text = a.__text.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&quot;/g, '"').replace(/&#x27;/g, "'").replace(/&amp;/g, "&")), t.stripWhitespaces && (a.__text = a.__text.trim()), delete a["#text"], "property" === t.arrayAccessForm && delete a["#text_asArray"], a.__text = function (e, n, r) { if (t.datetimeAccessFormPaths.length > 0) for (var i = r.split(".#")[0], s = 0; s < t.datetimeAccessFormPaths.length; s++) { var a = t.datetimeAccessFormPaths[s]; if ("string" == typeof a) { if (a === i) return o(e) } else if (a instanceof RegExp) { if (a.test(i)) return o(e) } else if ("function" == typeof a && a(i)) return o(e) } return e }(a.__text, 0, r + ".#text")), a.hasOwnProperty("#cdata-section") && (a.__cdata = a["#cdata-section"], delete a["#cdata-section"], "property" === t.arrayAccessForm && delete a["#cdata-section_asArray"]), 1 === a.__cnt && a.__text ? a = a.__text : 0 === a.__cnt && "text" === t.emptyNodeForm ? a = "" : a.__cnt > 1 && void 0 !== a.__text && t.skipEmptyTextNodesForObj && (t.stripWhitespaces && "" === a.__text || "" === a.__text.trim()) && delete a.__text, delete a.__cnt, t.keepCData || a.hasOwnProperty("__text") || !a.hasOwnProperty("__cdata") ? (t.enableToStringFunc && (a.__text || a.__cdata) && (a.toString = function () { return (this.__text ? this.__text : "") + (this.__cdata ? this.__cdata : "") }), a) : a.__cdata ? a.__cdata : "" }(e, r) : e.nodeType === h.TEXT_NODE || e.nodeType === h.CDATA_SECTION_NODE ? e.nodeValue : null } function a(e, n, i, o) { var s = "<" + (e && e.__prefix ? e.__prefix + ":" : "") + n; if (i) for (var a = 0; a < i.length; a++) { var c = i[a], u = e[c]; t.escapeMode && (u = r(u)), s += " " + c.substr(t.attributePrefix.length) + "=", t.useDoubleQuotes ? s += '"' + u + '"' : s += "'" + u + "'" } return s + (o ? " />" : ">") } function c(e, t) { return "</" + (e && e.__prefix ? e.__prefix + ":" : "") + t + ">" } function u(e, n) { return "property" === t.arrayAccessForm && (i = "_asArray", -1 !== (r = n.toString()).indexOf(i, r.length - i.length)) || 0 === n.toString().indexOf(t.attributePrefix) || 0 === n.toString().indexOf("__") || e[n] instanceof Function; var r, i } function l(e) { var t = 0; if (e instanceof Object) for (var n in e) u(e, n) || t++; return t } function m(e) { var n = []; if (e instanceof Object) for (var r in e) -1 === r.toString().indexOf("__") && 0 === r.toString().indexOf(t.attributePrefix) && n.push(r); return n } function d(e) { var n = ""; return e instanceof Object ? n += function (e) { var n = ""; return e.__cdata && (n += "<![CDATA[" + e.__cdata + "]]>"), e.__text && (t.escapeMode ? n += r(e.__text) : n += e.__text), n }(e) : null !== e && (t.escapeMode ? n += r(e) : n += e), n } function p(e, n, r) { var i = ""; return t.jsAttributeFilter && t.jsAttributeFilter.call(null, n, e) ? i : (t.jsAttributeConverter && (e = t.jsAttributeConverter.call(null, n, e)), null != e && "" !== e || !t.selfClosingElements ? "object" == (void 0 === e ? "undefined" : _typeof(e)) ? "[object Array]" === Object.prototype.toString.call(e) ? i += function (e, t, n) { var r = ""; if (0 === e.length) r += a(e, t, n, !0); else for (var i = 0; i < e.length; i++)r += p(e[i], t, m(e[i])); return r }(e, n, r) : e instanceof Date ? (i += a(e, n, r, !1), i += t.jsDateUTC ? e.toUTCString() : e.toISOString(), i += c(e, n)) : l(e) > 0 || e.__text || e.__cdata ? (i += a(e, n, r, !1), i += f(e), i += c(e, n)) : t.selfClosingElements ? i += a(e, n, r, !0) : (i += a(e, n, r, !1), i += c(e, n)) : (i += a(e, n, r, !1), i += d(e), i += c(e, n)) : i += a(e, n, r, !0), i) } function f(e) { var t = ""; if (l(e) > 0) for (var n in e) if (!u(e, n)) { var r = e[n]; t += p(r, n, m(r)) } return t + d(e) } function g(t) { if (void 0 === t) return null; if ("string" != typeof t) return null; var n = null, r = null; if (e) r = (n = new e).parseFromString(t, "text/xml"); else if (window && window.DOMParser) { n = new window.DOMParser; var i = null; if (!(window.ActiveXObject || "ActiveXObject" in window)) try { i = n.parseFromString("INVALID", "text/xml").childNodes[0].namespaceURI } catch (e) { i = null } try { r = n.parseFromString(t, "text/xml"), null !== i && r.getElementsByTagNameNS(i, "parsererror").length > 0 && (r = null) } catch (e) { r = null } } else 0 === t.indexOf("<?") && (t = t.substr(t.indexOf("?>") + 2)), (r = new ActiveXObject("Microsoft.XMLDOM")).async = "false", r.loadXML(t); return r } (t = t || {}).arrayAccessForm = t.arrayAccessForm || "none", t.emptyNodeForm = t.emptyNodeForm || "text", t.jsAttributeFilter = t.jsAttributeFilter, t.jsAttributeConverter = t.jsAttributeConverter, t.attributeConverters = t.attributeConverters || [], t.datetimeAccessFormPaths = t.datetimeAccessFormPaths || [], t.arrayAccessFormPaths = t.arrayAccessFormPaths || [], void 0 === t.enableToStringFunc && (t.enableToStringFunc = !0), void 0 === t.skipEmptyTextNodesForObj && (t.skipEmptyTextNodesForObj = !0), void 0 === t.stripWhitespaces && (t.stripWhitespaces = !0), void 0 === t.useDoubleQuotes && (t.useDoubleQuotes = !0), void 0 === t.ignoreRoot && (t.ignoreRoot = !1), void 0 === t.escapeMode && (t.escapeMode = !0), void 0 === t.attributePrefix && (t.attributePrefix = "_"), void 0 === t.selfClosingElements && (t.selfClosingElements = !0), void 0 === t.keepCData && (t.keepCData = !1), void 0 === t.jsDateUTC && (t.jsDateUTC = !1), function () { function e(e) { var t = String(e); return 1 === t.length && (t = "0" + t), t } "function" != typeof String.prototype.trim && (String.prototype.trim = function () { return this.replace(/^\s+|^\n+|(\s|\n)+$/g, "") }), "function" != typeof Date.prototype.toISOString && (Date.prototype.toISOString = function () { return this.getUTCFullYear() + "-" + e(this.getUTCMonth() + 1) + "-" + e(this.getUTCDate()) + "T" + e(this.getUTCHours()) + ":" + e(this.getUTCMinutes()) + ":" + e(this.getUTCSeconds()) + "." + String((this.getUTCMilliseconds() / 1e3).toFixed(3)).slice(2, 5) + "Z" }) }(); var h = { ELEMENT_NODE: 1, TEXT_NODE: 3, CDATA_SECTION_NODE: 4, COMMENT_NODE: 8, DOCUMENT_NODE: 9 }; this.asArray = function (e) { return null == e ? [] : e instanceof Array ? e : [e] }, this.toXmlDateTime = function (e) { return e instanceof Date ? e.toISOString() : "number" == typeof e ? new Date(e).toISOString() : null }, this.asDateTime = function (e) { return "string" == typeof e ? o(e) : e }, this.xml2dom = function (e) { return g(e) }, this.dom2js = function (e) { return s(e, null) }, this.js2dom = function (e) { return g(this.js2xml(e)) }, this.xml2js = function (e) { var t = g(e); return null != t ? this.dom2js(t) : null }, this.js2xml = function (e) { return f(e) }, this.getVersion = function () { return "3.1.1" } } }) ? r.apply(t, []) : r) || (e.exports = i) }, function (e, t, n) { var r, i = (r = n(2)) && r.__esModule ? r : { default: r }, o = n(12).fn, s = n(0), a = n(167), c = n(4), u = n(1), l = n(84), m = n(166), d = n(83); o.sendText = function (e) { return this.processCallback(e), e.msg = new this.message.TextMessage(e), this.sendMsg(e) }, o.previewFile = function (e) { if (s.verifyOptions(e, "done", "msg::previewFile"), e.type || (e.type = "file"), s.verifyParamPresentJustOne(e, "dataURL blob fileInput filePath wxFilePath fileObject", "msg::previewFile"), s.exist(e.maxSize) && s.verifyParamType("maxSize", e.maxSize, "number", "api::previewFile"), s.exist(e.commonUpload) && s.verifyParamType("commonUpload", e.commonUpload, "boolean", "api::previewFile"), e.nosSurvivalTime ? (s.verifyParamType("nosSurvivalTime", e.nosSurvivalTime, "number", "api::Base.getInstance"), s.verifyParamMin("nosSurvivalTime", e.nosSurvivalTime, 86400, "api::Base.getInstance")) : e.nosSurvivalTime = this.nosSurvivalTime, e.filePath = e.filePath || e.wxFilePath, delete e.wxFilePath, e.dataURL) e.blob = d.fromDataURL(e.dataURL); else if (e.blob); else if (e.fileInput) { if (e.fileInput = s.verifyFileInput(e.fileInput, "msg::previewFile"), e.fileInput.files) { if (!e.fileInput.files.length) return void e.done(c.newNoFileError("请选择" + e.type + "文件", { callFunc: "msg::previewFile", fileInput: e.fileInput }), e); e.fileSize = e.fileInput.files[0].size } e.fileInputName = s.getFileName(e.fileInput) } this.processCallback(e); var t = JSON.stringify(l.genResponseBody(e.type) || {}).replace(/"/gi, '\\"'), n = null, r = e.transcode ? "getNosTokenTrans" : "getNosToken"; if (e.transcode) { s.verifyOptions(e, "fileInput", "msg::previewFile"); var i = s.getFileInfo(e.fileInput); n = { transToken: { name: i.name, type: i.transcodeType, transType: "png" === e.transcode ? 11 : 10, size: i.size, body: t } } } else n = t; this[r]({ responseBody: n, nosToken: { nosScene: e.nosScene || this.nosScene, nosSurvivalTime: e.nosSurvivalTime }, callback: function (t, n) { t ? e.done(t) : (e.transcode ? (e.nosToken = n.nosToken, e.docId = n.docId) : e.nosToken = n, this._doPreviewFile(e)) }.bind(this) }) }, o._doPreviewFile = function (e) { function t(t, n, i) { if (e.uploaddone = o, t) e.done(t, e.callback.options); else { if (n = l.parseResponse(n, r.options.exifOrientation), i || (n.url = u.genDownloadUrl(e.nosToken, p.Object), e.nosToken.shortUrl && (n._url_safe = e.nosToken.shortUrl)), s.exist(e.fileInputName)) n.name = e.fileInputName; else if (e.blob) { var a = e.blob.name; if (n.name = a || "blob-" + n.md5, !a) { var c = e.blob.type; n.ext = c.slice(c.lastIndexOf("/") + 1) } } else e.filePath ? n.name = e.filePath : e.fileObject && (n.name = e.fileObject.fileName); if (!n.ext) { var m = n.name.lastIndexOf("."); n.ext = -1 === m ? "unknown" : n.name.slice(m + 1) } n.size = n.size || 0, e.done(null, s.copy(n)) } } var n, r = this, o = e.uploaddone, a = u.genUploadUrl(e.nosToken.bucket), d = u.genChunkUploadUrl(e.nosToken); e.commonUpload || !d || u.isWeixinApp || u.isNodejs || u.isRN ? (e.commonUpload = !0, n = a) : n = d; var p = this.assembleUploadParams(e.nosToken); if (u.isWeixinApp) s.verifyOptions(e, "filePath", "msg::_doPreviewFile"), r.fileQuickTransfer(e, t, function () { wx.uploadFile({ url: n, filePath: e.filePath, name: "file", formData: p, fail: function (e) { r.protocol.logger.log("error:", "api::msg:upload file failed", e) }, success: function (e) { if (200 === e.statusCode) try { t(null, JSON.parse(e.data)) } catch (n) { r.protocol.logger.log("error:", "parse wx upload file res error", n), t({ code: "PARSE_WX_UPLOAD_FILE_RES_ERROR", str: e.data, msg: e.errMsg }) } else t({ code: e.statusCode, msg: e.errMsg }) } }) }); else if (u.isNodejs) { var f = { url: n, name: "file", formData: p, success: function (e) { if (200 === e.statusCode) try { t(null, JSON.parse(e.data)) } catch (n) { r.protocol.logger.log("error:", "parse nodejs upload file res error", n), t({ code: "PARSE_NODEJS_UPLOAD_FILE_RES_ERROR", str: e.data, msg: e.errMsg }) } else t({ code: e.statusCode, msg: e.errMsg }) }, fail: function (e) { r.protocol.logger.log("error:", "api::msg:upload file failed", e) } }; if (e.filePath) f.filePath = e.filePath; else { if ("object" !== (0, i.default)(e.fileObject)) throw new c("Nodejs上传fileObject参数类型应如 {fileName:..,fileData:..} "); f.fileData = e.fileObject.fileData } r.fileQuickTransfer(e, t, function () { m.uploadFile(f) }) } else if (u.isRN) { var g = { url: n, name: "file", formData: p, filePath: e.filePath, success: function (e) { if (e.ok && 200 === e.status) try { e.md5 = e.headers.map && e.headers.map.etag && e.headers.map.etag[0] || "UNKNOWN", t(null, e) } catch (n) { r.protocol.logger.log("error:", "parse React Native upload file res error", n), t({ code: "PARSE_React_Native_UPLOAD_FILE_RES_ERROR", res: e }) } else t({ code: e.status, msg: e.statusText }) }, fail: function (e) { r.protocol.logger.log("error:", "api::msg:upload file failed", e) } }; r.fileQuickTransfer(e, t, function () { m.uploadFile(g) }) } else e.uploaddone = t, e.url = n, e.params = p, e.fileName = "file", r.fileQuickTransfer(e, t, function () { return new m(e) }) }, o.fileQuickTransfer = function (e, t, n) { var r = this; e = e || {}, t instanceof Function || (t = function () { }), n instanceof Function || (n = function () { }); var i = e.fastPass; if (i) try { i = JSON.parse(i), e.fastPass = i } catch (e) { r.protocol.logger.error("快传参数解析失败") } var o = e.fileInputName || e.name || e.blob && e.blob.name || "", s = e.fileSize || e.size || e.blob && e.blob.size || 0, a = i ? ((i.md5 || e.digest || "") + "").trim() : "", c = e.type || e.blob && e.blob.type; if (a && s >= u.threshold) { var l = !0, m = { name: o, md5: a, ext: o.slice(o.lastIndexOf(".") + 1), type: c }; switch (c) { case "image": i && i.w && i.h ? (m.w = i.w, m.h = i.h) : (l = !1, r.protocol.logger.error("快传 image 文件缺少参数 w 或 h")); break; case "video": i && i.w && i.h && i.dur ? (m.w = i.w, m.h = i.h, m.dur = i.dur) : (l = !1, r.protocol.logger.error("快传 video 文件缺少参数 w 或 h 或 dur")); break; case "audio": i && i.dur ? m.dur = i.dur : (l = !1, r.protocol.logger.error("快传 audio 文件缺少参数 dur")) }if (!l) return void n(); var d = { fileQuickTransfer: { md5: a } }; return s && (d.fileQuickTransfer.size = s), this.protocol.sendCmd("fileQuickTransfer", d, function (e, i, o) { !e && o && o.fileQuickTransfer && o.fileQuickTransfer.url || (r.protocol.logger.error("misc::fileQuickTransfer: not found", e, i, o), n()), o && o.fileQuickTransfer && o.fileQuickTransfer.threshold && (u.threshold = o.fileQuickTransfer.threshold || 0), o && o.fileQuickTransfer && o.fileQuickTransfer.url && (m.size = s || o.fileQuickTransfer.size, m.url = o.fileQuickTransfer.url, o.fileQuickTransfer._url_safe && (m._url_safe = o.fileQuickTransfer._url_safe), t(e, m, !0)) }) } n() }, o.sendFile = function (e) { if (e.type || (e.type = "file"), s.verifyParamPresentJustOne(e, "dataURL blob fileInput file filePath wxFilePath fileObject", "msg::sendFile"), s.exist(e.maxSize) && s.verifyParamType("maxSize", e.maxSize, "number", "api::previewFile"), s.exist(e.commonUpload) && s.verifyParamType("commonUpload", e.commonUpload, "boolean", "api::previewFile"), this.processCallback(e), e.filePath = e.filePath || e.wxFilePath, delete e.wxFilePath, e.dataURL) this._previewAndSendFile(e); else if (e.blob) this._previewAndSendFile(e); else if (e.fileInput) { if (e.fileInput = s.verifyFileInput(e.fileInput, "msg::sendFile"), e.fileInput.files && !e.fileInput.files.length) return void e.done(c.newNoFileError("请选择" + e.type + "文件", { callFunc: "msg::sendFile", fileInput: e.fileInput }), e.callback.options); this._previewAndSendFile(e) } else if (e.filePath || e.fileObject) this._previewAndSendFile(e); else if (e.file) { var t, n = e.file._url_safe; return n && (t = e.file.url, e.file.url = n, delete e.file._url_safe), e.msg = new this.message.FileMessage(e), this.sendMsg(e, t) } }, o._previewAndSendFile = function (e) { var t = this; s.verifyCallback(e, "uploaddone beforesend", "msg::_previewAndSendFile"); var n = e.done; e.done = function (r, i) { if (e.done = n, r) e.uploaddone(r, e.callback.options), e.done(r, e.callback.options); else { if (/chatroom/.test(e.scene)) return; var o; e.uploaddone(null, s.copy(i)); var a = i._url_safe; a && (o = i.url, i.url = a, delete i._url_safe), e.file = i, e.msg = new t.message.FileMessage(e), e.beforesend(t.sendMsg(e, o)) } }, t.previewFile(e) }, o.assembleUploadParams = function (e) { return e ? { Object: decodeURIComponent(e.objectName), "x-nos-token": e.token, "x-nos-entity-type": "json" } : null }, o.deleteFile = function (e) { s.verifyParamPresentJustOne(e, "docId", "msg::deleteFile"), this.removeFile({ docId: e.docId, callback: function (t, n) { t ? e.error && e.error(t, n) : e.success && e.success(n) } }) }, o.getFile = function (e) { s.verifyParamPresentJustOne(e, "docId", "msg::getFile"), this.fetchFile({ docId: e.docId, callback: function (t, n) { t ? e.error && e.error(t, n) : e.success && e.success(n.info) } }) }, o.getFileList = function (e) { var t = e.fromDocId, n = void 0 === t ? "" : t, r = e.limit, i = void 0 === r ? 10 : r, o = { limit: i }; n && (o.fromDocId = n), this.fetchFileList({ fileListParam: o, callback: function (t, n) { t ? (i > 30 && (t.message = t.message + "::文档条数超过限制:30"), e.error && e.error(t, n)) : e.success && e.success(n) } }) }, o.sendGeo = function (e) { return this.processCallback(e), e.msg = new this.message.GeoMessage(e), this.sendMsg(e) }, o.sendTipMsg = function (e) { return this.processCallback(e), e.msg = new this.message.TipMessage(e), this.sendMsg(e) }, o.sendCustomMsg = function (e) { return this.processCallback(e), e.msg = new this.message.CustomMessage(e), this.sendMsg(e) }, o.sendRobotMsg = function (e) { return this.processCallback(e), e.msg = new this.message.RobotMessage(e), this.sendMsg(e) }, o.sendMsg = function (e, t) { var n = this.protocol, r = e.msg, i = {}, o = !!e.isLocal; if (o && (e.time && (r.time = e.time), e.idClient && (r.idClient = e.idClient)), e.resend && ("out" !== e.flow || "fail" !== e.status)) return s.onError("只能重发发送失败的消息"); e.callback.options.idClient = r.idClient, this.beforeSendMsg(e, i); var a = e.rtnMsg = this.formatReturnMsg(r); return t && !this.options.keepNosSafeUrl && a.file && (a.file._url_safe = a.file.url, a.file.url = t, "audio" === a.type && (a.file.mp3Url = t + (~t.indexOf("?") ? "&" : "?") + "audioTrans&type=mp3")), a.hasOwnProperty("chatroomId") && !a.chatroomId ? s.onError("聊天室未连接") : (o && (a.status = "success", a.isLocal = !0), n.storeSendMsg && (i.promise = n.storeSendMsg(a)), e.cbaop = function (e) { if (e && "server" !== e.from) return a.status = "fail", n.updateSendMsgError && n.updateSendMsgError(a), a }, o || (t && !this.options.keepNosSafeUrl && e.callback && (e.callback.originUrl = t), i.msg = r, this.sendCmd(e.cmd, i, e.callback)), this.afterSendMsg(e), o && setTimeout(function () { a = s.simpleClone(a), e.done(null, a) }, 0), s.copy(a)) }, o.beforeSendMsg = function () { }, o.afterSendMsg = function () { }, o.formatReturnMsg = function (e) { return e = s.copy(e), this.protocol.completeMsg(e), e.status = "sending", this.message.reverse(e) }, o.resendMsg = function (e) { return s.verifyOptions(e, "msg", "msg::resendMsg"), this.trimMsgFlag(e), e.resend = !0, this._sendMsgByType(e) }, o.forwardMsg = function (e) { return s.verifyOptions(e, "msg", "msg::forwardMsg"), this.trimMsgFlag(e), this.beforeForwardMsg(e), e.forward = !0, e.msg.idClient = s.guid(), this._sendMsgByType(e) }, o.trimMsgFlag = function (e) { e && e.msg && (e.msg = s.copy(e.msg), delete e.msg.resend, delete e.msg.forward) }, o.beforeForwardMsg = function () { }, o._sendMsgByType = function (e) { switch (s.verifyOptions(e, "msg", "msg::_sendMsgByType"), s.verifyParamValid("msg.type", e.msg.type, this.message.validTypes, "msg::_sendMsgByType"), s.merge(e, e.msg), e.type) { case "text": return this.sendText(e); case "image": case "audio": case "video": case "file": return this.sendFile(e); case "geo": return this.sendGeo(e); case "custom": return this.sendCustomMsg(e); case "tip": return this.sendTipMsg(e); default: throw new c("不能发送类型为 " + e.type + " 的消息") } }, o.parseRobotTemplate = function (e) { function t(e) { return Array.isArray(e.text) || (e.text = [e.text]), e.text = e.text.map(function (e) { return { type: "text", name: e._name, text: e.__text } }), e.text } function n(e) { return Array.isArray(e.image) || (e.image = [e.image]), e.image = e.image.map(function (e) { return { type: "image", name: e._name, url: e._url } }), e.image } if (/<template[^>\/]+\/>/.test(e)) return { raw: e, json: [{ type: "text", name: "", text: "" }] }; if (!/<template[^>\/]+>/.test(e)) return { raw: e, json: [{ type: "text", name: "", text: e }] }; var r = new a({ escapeMode: !1 }); e = e.replace(/<template [^>]+>/, "<template>"); var i = r.xml2js(e); i = i.template.LinearLayout, Array.isArray(i) || (i = [i]); var o = []; return i = i.forEach(function (e) { e.image && (o = o.concat(n(e))), e.text && (o = o.concat(t(e))), e.link && (o = o.concat(function (e) { if (e.link) { var r = e.link; Array.isArray(r) || (r = [r]), r = r.map(function (e) { return e.image && (e.image = n(e)), e.text && (e.text = t(e)), "url" === e._type ? (e.type = "url", e.style = e._style || "", e.target = e._target, delete e._target, delete e._style) : "block" === e._type && (e.type = "block", e.style = e._style || "", e.params = e._params || "", e.target = e._target, delete e._params, delete e._target, delete e._style), delete e._type, e }), e.link = r } return e.link }(e))) }), { raw: e, json: o } } }, function (e, t, n) { var r = n(12).fn; r.isConnected = function () { return !!this.protocol && this.protocol.isConnected() }, r.connect = function () { this.protocol.appLogin = 0, this.protocol.connect(!0) }, r.disconnect = function (e) { e = e || {}, this.protocol.disconnect(e.done) } }, function (e, t, n) { var r = n(1), i = r.chunkSize, o = (n(0), n(45)); e.exports = function (e, t, n) { function s(t) { var n = c.fileUoloadedSize + t.loaded, r = Math.floor(1e4 * n / c.fileSize) / 100; if (parseInt(r) >= 100 && (r = 100, s = function () { }), c.percentage !== r) { c.percentage = r; var i = { docId: e.docId, total: c.fileSize, loaded: n, percentage: r, percentageText: r + "%" }; e.fileInput && (i.fileInput = e.fileInput), e.blob && (i.blob = e.blob), e.uploadprogress(i) } } function a(e) { try { if (e.result) var t = JSON.parse(e.result); else t = e; n.onError(t) } catch (e) { n.onError(e) } } var c = { file: e.data[t], fileSize: e.data[t].size, fileUoloadedSize: 0, percentage: 0 }, u = { query: { offset: 0, complete: i >= c.fileSize, version: "1.0" }, headers: { "Content-Type": "application/x-www-form-urlencoded", "x-nos-token": e.nosToken.token }, method: "POST", timeout: 0, onaftersend: function () { e.beginupload(n) }, onuploading: s, onload: function t(l) { try { l = JSON.parse(l) } catch (e) { return void n.onError(e) } if (l.errMsg || l.errCode) n.onError(l); else if (l.offset < c.fileSize) delete u.onaftersend, c.fileUoloadedSize = l.offset, n.sn = function (e, n, r, c, u) { var l = n.offset, m = n.offset + i; return r.data = u.file.slice(l, m), r.query.offset = n.offset, r.query.complete = m >= u.fileSize, r.query.context = n.context, r.onuploading = s, r.onload = t, r.onerror = a, o(e, r) }(e.url, l, u, 0, c); else { var m = function (e) { n.onError(e) }, d = r.genFileUrl(e.nosToken); "image" === e.type ? o(d + "?imageInfo", { onload: function (t) { try { t = JSON.parse(t), e.uploaddone(null, { docId: l.docId, w: t.Width, h: t.Height, orientation: t.Orientation || "", type: t.Type, size: t.Size || c.fileSize }) } catch (e) { m(e) } }, onerror: m }) : "video" === e.type || "audio" === e.type ? o(d + "?vinfo", { onload: function (t) { try { (t = JSON.parse(t)).GetVideoInfo && t.GetVideoInfo.VideoInfo && (t = t.GetVideoInfo.VideoInfo), e.uploaddone(null, { docId: l.docId, w: t.Width, h: t.Height, dur: t.Duration, orientation: t.Rotate, audioCodec: t.AudioCodec, videoCodec: t.VideoCodec, container: t.Container, size: t.Size || c.fileSize }) } catch (e) { m(e) } }, onerror: m }) : e.uploaddone(null, { docId: l.docId, size: c.fileSize }) } }, onerror: a }; return u.data = c.file.slice(0, i), o(e.url, u) } }, function (e, t, n) { var r = n(45); e.exports = function (e, t) { return t.method = "POST", t.headers = t.headers || {}, t.headers["Content-Type"] = "multipart/form-data", t.timeout = 0, t.type = t.type || "json", r(e, t) } }, function (e, t, n) { var r, i, o = n(15), s = n(45), a = (r = /json/i, i = /post/i, function (e, t) { var n = (t = t || {}).data = t.data || {}, a = t.headers = t.headers || {}, c = o.checkWithDefault(a, "Accept", "application/json"), u = o.checkWithDefault(a, "Content-Type", "application/json"); return r.test(c) && (t.type = "json"), i.test(t.method) && r.test(u) && (t.data = JSON.stringify(n)), s(e, t) }); e.exports = a }, function (e, t, n) { function r(e) { this.init(), s.call(this, e) } var i = n(15), o = n(85), s = n(60), a = {}, c = s.prototype, u = r.prototype = Object.create(c); u.init = function () { function e(e) { var n = e.data; if (0 === n.indexOf(t)) { var r = (n = JSON.parse(n.replace(t, ""))).key, i = a[r]; i && (delete a[r], n.result = decodeURIComponent(n.result || ""), i.onLoad(n)) } } var t = "NEJ-AJAX-DATA:", n = !1; return function () { !function () { if (!n) { n = !0; var t = i.getGlobal(); t.postMessage ? i.on(t, "message", e) : o.addMsgListener(e) } }() } }(), u.doSend = function () { var e = this.options, t = i.url2origin(e.url), n = e.proxyUrl || t + "/res/nej_proxy_frame.html", r = a[n]; if (i.isArray(r)) r.push(this.doSend.bind(this, e)); else { if (!r) return a[n] = [this.doSend.bind(this, e)], void i.createIframe({ src: n, onload: function (e) { var t = a[n]; a[n] = i.target(e).contentWindow, t.forEach(function (e) { try { e() } catch (e) { console.log("error:", e) } }) } }); if (!this.aborted) { var s = this.key = i.uniqueID(); a[s] = this; var c = i.fetch({ method: "GET", url: "", data: null, headers: {}, timeout: 0 }, e); c.key = s, o.postMessage(r, { data: c }), this.afterSend() } } }, u.abort = function () { this.aborted = !0, delete a[this.key], c.abort.call(this) }, e.exports = r }, function (e, t, n) { function r(e) { this.init(), o.call(this, e) } var i = n(15), o = n(60), s = n(85), a = "NEJ-UPLOAD-RESULT:", c = {}, u = o.prototype, l = r.prototype = Object.create(u); l.init = function () { function e(e) { var t = e.data; if (0 === t.indexOf(a)) { var n = (t = JSON.parse(t.replace(a, ""))).key, r = c[n]; r && (delete c[n], t.result = decodeURIComponent(t.result || ""), r.onLoad(t.result)) } } var t = !1; return function () { !function () { if (!t) { t = !0; var n = i.getGlobal(); n.postMessage ? i.on(n, "message", e) : (s.addMsgListener(e), s.startTimer()) } }() } }(), l.doSend = function () { function e() { l.forEach(function (e, t) { var n = m[t]; n.parentNode && (e.name = n.name, i.isFunction(e.setAttribute) && e.setAttribute("form", n.getAttribute("form")), n.parentNode.replaceChild(e, n)) }) } var t = this, n = t.options, r = t.key = "zoro-ajax-upload-iframe-" + i.uniqueID(); c[r] = t; var o = t.form = i.html2node('<form style="display:none;"></form>'); "undefined" == typeof document ? console.log("error: document is undefined") : document.body.appendChild(o), o.target = r, o.method = "POST", o.enctype = "multipart/form-data", o.encoding = "multipart/form-data"; var s = n.url, a = i.genUrlSep(s); o.action = s + a + "_proxy_=form"; var u = n.data, l = [], m = []; u && i.getKeys(u, n.putFileAtEnd).forEach(function (e) { var t = u[e]; if (t.tagName && "INPUT" === t.tagName.toUpperCase()) { if ("file" === t.type) { var n = t, r = n.cloneNode(!0); n.parentNode.insertBefore(r, n); var s = i.dataset(n, "name"); s && (n.name = s), o.appendChild(n), i.isFunction(n.setAttribute) && (n.setAttribute("form", ""), n.removeAttribute("form")), l.push(t), m.push(r) } } else { var a = i.html2node('<input type="hidden"/>'); a.name = e, a.value = t, o.appendChild(a) } }); var d = t.iframe = i.createIframe({ name: r, onload: function () { t.aborted ? e() : (i.on(d, "load", t.checkResult.bind(t)), o.submit(), e(), t.afterSend()) } }) }, l.checkResult = function () { var e, t; try { if ((t = ((e = this.iframe.contentWindow.document.body).innerText || e.textContent || "").trim()).indexOf(a) >= 0 || e.innerHTML.indexOf(a) >= 0) return } catch (e) { return void console.log("error:", "ignore error if not same domain,", e) } this.onLoad(t) }, l.onLoad = function (e) { u.onLoad.call(this, { status: 200, result: e }), i.remove(this.form), i.remove(this.iframe), u.destroy.call(this) }, l.destroy = function () { i.remove(this.iframe), i.remove(this.form) }, l.abort = function () { this.aborted = !0, delete c[this.key], u.abort.call(this) }, e.exports = r }, function (e, t, n) { var r; !function (t) { function i() { } function o(e, t) { for (var n = e.length; n--;)if (e[n].listener === t) return n; return -1 } function s(e) { return function () { return this[e].apply(this, arguments) } } var a = i.prototype, c = t.EventEmitter; a.getListeners = function (e) { var t, n, r = this._getEvents(); if (e instanceof RegExp) for (n in t = {}, r) r.hasOwnProperty(n) && e.test(n) && (t[n] = r[n]); else t = r[e] || (r[e] = []); return t }, a.flattenListeners = function (e) { var t, n = []; for (t = 0; t < e.length; t += 1)n.push(e[t].listener); return n }, a.getListenersAsObject = function (e) { var t, n = this.getListeners(e); return n instanceof Array && ((t = {})[e] = n), t || n }, a.addListener = function (e, t) { if (!function e(t) { return "function" == typeof t || t instanceof RegExp || !(!t || "object" != (void 0 === t ? "undefined" : _typeof(t))) && e(t.listener) }(t)) throw new TypeError("listener must be a function"); var n, r = this.getListenersAsObject(e), i = "object" == (void 0 === t ? "undefined" : _typeof(t)); for (n in r) r.hasOwnProperty(n) && -1 === o(r[n], t) && r[n].push(i ? t : { listener: t, once: !1 }); return this }, a.on = s("addListener"), a.addOnceListener = function (e, t) { return this.addListener(e, { listener: t, once: !0 }) }, a.once = s("addOnceListener"), a.defineEvent = function (e) { return this.getListeners(e), this }, a.defineEvents = function (e) { for (var t = 0; t < e.length; t += 1)this.defineEvent(e[t]); return this }, a.removeListener = function (e, t) { var n, r, i = this.getListenersAsObject(e); for (r in i) i.hasOwnProperty(r) && -1 !== (n = o(i[r], t)) && i[r].splice(n, 1); return this }, a.off = s("removeListener"), a.addListeners = function (e, t) { return this.manipulateListeners(!1, e, t) }, a.removeListeners = function (e, t) { return this.manipulateListeners(!0, e, t) }, a.manipulateListeners = function (e, t, n) { var r, i, o = e ? this.removeListener : this.addListener, s = e ? this.removeListeners : this.addListeners; if ("object" != (void 0 === t ? "undefined" : _typeof(t)) || t instanceof RegExp) for (r = n.length; r--;)o.call(this, t, n[r]); else for (r in t) t.hasOwnProperty(r) && (i = t[r]) && ("function" == typeof i ? o.call(this, r, i) : s.call(this, r, i)); return this }, a.removeEvent = function (e) { var t, n = void 0 === e ? "undefined" : _typeof(e), r = this._getEvents(); if ("string" === n) delete r[e]; else if (e instanceof RegExp) for (t in r) r.hasOwnProperty(t) && e.test(t) && delete r[t]; else delete this._events; return this }, a.removeAllListeners = s("removeEvent"), a.emitEvent = function (e, t) { var n, r, i, o, s = this.getListenersAsObject(e); for (o in s) if (s.hasOwnProperty(o)) for (n = s[o].slice(0), i = 0; i < n.length; i++)!0 === (r = n[i]).once && this.removeListener(e, r.listener), r.listener.apply(this, t || []) === this._getOnceReturnValue() && this.removeListener(e, r.listener); return this }, a.trigger = s("emitEvent"), a.emit = function (e) { var t = Array.prototype.slice.call(arguments, 1); return this.emitEvent(e, t) }, a.setOnceReturnValue = function (e) { return this._onceReturnValue = e, this }, a._getOnceReturnValue = function () { return !this.hasOwnProperty("_onceReturnValue") || this._onceReturnValue }, a._getEvents = function () { return this._events || (this._events = {}) }, i.noConflict = function () { return t.EventEmitter = c, i }, void 0 === (r = function () { return i }.call(t, n, t, e)) || (e.exports = r) }(this || {}) }, function (e, t, n) { function r(e) { e.onuploading && this.on("uploading", e.onuploading), o.call(this, e) } var i = n(15), o = n(60), s = o.prototype, a = r.prototype = Object.create(s); a.doSend = function () { var e = this.options, t = e.headers, n = this.xhr = new XMLHttpRequest; if ("multipart/form-data" === t["Content-Type"]) { delete t["Content-Type"], n.upload.onprogress = this.onProgress.bind(this), n.upload.onload = this.onProgress.bind(this); var r = e.data; e.data = new window.FormData, r && i.getKeys(r, e.putFileAtEnd).forEach(function (t) { var n = r[t]; n.tagName && "INPUT" === n.tagName.toUpperCase() ? "file" === n.type && [].forEach.call(n.files, function (t) { e.data.append(i.dataset(n, "name") || n.name || t.name || "file-" + i.uniqueID(), t) }) : e.data.append(t, n) }) } else t["x-nos-token"] && (n.upload.onprogress = this.onProgress.bind(this), n.upload.onload = this.onProgress.bind(this)); n.onreadystatechange = this.onStateChange.bind(this), 0 !== e.timeout && (this.timer = setTimeout(this.onTimeout.bind(this), e.timeout)), n.open(e.method, e.url, !e.sync), Object.keys(t).forEach(function (e) { n.setRequestHeader(e, t[e]) }), e.cookie && "withCredentials" in n && (n.withCredentials = !0), n.send(e.data), this.afterSend() }, a.onProgress = function (e) { e.lengthComputable && e.loaded <= e.total && this.emit("uploading", e) }, a.onStateChange = function () { var e = this.xhr; 4 === e.readyState && this.onLoad({ status: e.status, result: e.responseText || "" }) }, a.getResponseHeader = function (e) { var t = this.xhr; return t ? t.getResponseHeader(e) : "" }, a.destroy = function () { clearTimeout(this.timer); try { this.xhr.onreadystatechange = i.f, this.xhr.abort() } catch (e) { console.log("error:", "ignore error ajax destroy,", e) } s.destroy.call(this) }, e.exports = r }, function (e, t, n) { function r() { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; o.merge(this, { options: e, debug: !1, api: "log", style: "color:blue;", log: o.emptyFunc, info: o.emptyFunc, warn: o.emptyFunc, error: o.emptyFunc }), this.prefix = e.prefix || "", this.setDebug(e.debug) } var i = n(46), o = n(0); n(17); var s = r.prototype, a = ["Chrome", "Safari", "Firefox"]; s.setDebug = function () { var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0], t = this; if (t.debug = e, e.style && (t.style = e.style), t.debug && o.exist(console)) { var n = console; t.debug = function () { var e = t.formatArgs(arguments); -1 !== a.indexOf(i.name) && o.isString(e[0]) && (e[0] = "%c" + e[0], e.splice(1, 0, t.style)), t._log("debug", e) }, t.log = function () { var e = t.formatArgs(arguments); -1 !== a.indexOf(i.name) && o.isString(e[0]) && (e[0] = "%c" + e[0], e.splice(1, 0, t.style)), t._log("log", e) }, t.info = function () { var e = t.formatArgs(arguments); -1 !== a.indexOf(i.name) && o.isString(e[0]) && (e[0] = "%c" + e[0], e.splice(1, 0, t.style)), t._log("info", e) }, t.warn = function () { var e = t.formatArgs(arguments); -1 !== a.indexOf(i.name) && o.isString(e[0]) && (e[0] = "%c" + e[0], e.splice(1, 0, t.style)), t._log("warn", e) }, t.error = function () { var e = t.formatArgs(arguments); -1 !== a.indexOf(i.name) && o.isString(e[0]) && (e[0] = "%c" + e[0], e.splice(1, 0, t.style)), t._log("error", e) }, t._log = function (e, r) { var i = t.options.logFunc, s = null; if (i && (i[e] && (s = i[e]), o.isFunction(s))) s.apply(i, r); else if (n[e]) try { n[e].apply ? t.chrome(e, r) : t.ie(e, r) } catch (e) { } }, t.chrome = function (e, r) { -1 !== a.indexOf(i.name) ? n[e].apply(n, r) : t.ie(e, r) }, t.ie = function (e, t) { t.forEach(function (t) { n[e](JSON.stringify(t, null, 4)) }) } } }, s.formatArgs = function (e) { e = [].slice.call(e, 0); var t = new Date, n = "[NIM LOG " + c(t.getMonth() + 1) + "-" + c(t.getDate()) + " " + c(t.getHours()) + ":" + c(t.getMinutes()) + ":" + c(t.getSeconds()) + ":" + c(t.getMilliseconds(), 3) + " " + this.prefix.toUpperCase() + "]  "; return o.isString(e[0]) ? e[0] = n + e[0] : e.splice(0, 0, n), e.forEach(function (t, n) { (o.isArray(t) || o.isObject(t)) && (e[n] = o.simpleClone(t)) }), e }; var c = function (e, t) { t = t || 2; for (var n = "" + e; n.length < t;)n = "0" + n; return n }; e.exports = r }, function (e, t, n) { var r = n(1); "undefined" != typeof window && (window.console || r.isWeixinApp || (window.console = { log: function () { }, info: function () { }, warn: function () { }, error: function () { } })) }, function (e, t, n) { function r() { } function i(e, t, n) { this.fn = e, this.context = t, this.once = n || !1 } function o() { this._events = new r, this._eventsCount = 0 } var s = Object.prototype.hasOwnProperty, a = "~"; Object.create && (r.prototype = Object.create(null), (new r).__proto__ || (a = !1)), o.prototype.eventNames = function () { var e, t, n = []; if (0 === this._eventsCount) return n; for (t in e = this._events) s.call(e, t) && n.push(a ? t.slice(1) : t); return Object.getOwnPropertySymbols ? n.concat(Object.getOwnPropertySymbols(e)) : n }, o.prototype.listeners = function (e, t) { var n = a ? a + e : e, r = this._events[n]; if (t) return !!r; if (!r) return []; if (r.fn) return [r.fn]; for (var i = 0, o = r.length, s = new Array(o); i < o; i++)s[i] = r[i].fn; return s }, o.prototype.emit = function (e, t, n, r, i, o) { var s = a ? a + e : e; if (!this._events[s]) return !1; var c, u, l = this._events[s], m = arguments.length; if (l.fn) { switch (l.once && this.removeListener(e, l.fn, void 0, !0), m) { case 1: return l.fn.call(l.context), !0; case 2: return l.fn.call(l.context, t), !0; case 3: return l.fn.call(l.context, t, n), !0; case 4: return l.fn.call(l.context, t, n, r), !0; case 5: return l.fn.call(l.context, t, n, r, i), !0; case 6: return l.fn.call(l.context, t, n, r, i, o), !0 }for (u = 1, c = new Array(m - 1); u < m; u++)c[u - 1] = arguments[u]; l.fn.apply(l.context, c) } else { var d, p = l.length; for (u = 0; u < p; u++)switch (l[u].once && this.removeListener(e, l[u].fn, void 0, !0), m) { case 1: l[u].fn.call(l[u].context); break; case 2: l[u].fn.call(l[u].context, t); break; case 3: l[u].fn.call(l[u].context, t, n); break; case 4: l[u].fn.call(l[u].context, t, n, r); break; default: if (!c) for (d = 1, c = new Array(m - 1); d < m; d++)c[d - 1] = arguments[d]; l[u].fn.apply(l[u].context, c) } } return !0 }, o.prototype.on = function (e, t, n) { var r = new i(t, n || this), o = a ? a + e : e; return this._events[o] ? this._events[o].fn ? this._events[o] = [this._events[o], r] : this._events[o].push(r) : (this._events[o] = r, this._eventsCount++), this }, o.prototype.once = function (e, t, n) { var r = new i(t, n || this, !0), o = a ? a + e : e; return this._events[o] ? this._events[o].fn ? this._events[o] = [this._events[o], r] : this._events[o].push(r) : (this._events[o] = r, this._eventsCount++), this }, o.prototype.removeListener = function (e, t, n, i) { var o = a ? a + e : e; if (!this._events[o]) return this; if (!t) return 0 == --this._eventsCount ? this._events = new r : delete this._events[o], this; var s = this._events[o]; if (s.fn) s.fn !== t || i && !s.once || n && s.context !== n || (0 == --this._eventsCount ? this._events = new r : delete this._events[o]); else { for (var c = 0, u = [], l = s.length; c < l; c++)(s[c].fn !== t || i && !s[c].once || n && s[c].context !== n) && u.push(s[c]); u.length ? this._events[o] = 1 === u.length ? u[0] : u : 0 == --this._eventsCount ? this._events = new r : delete this._events[o] } return this }, o.prototype.removeAllListeners = function (e) { var t; return e ? (t = a ? a + e : e, this._events[t] && (0 == --this._eventsCount ? this._events = new r : delete this._events[t])) : (this._events = new r, this._eventsCount = 0), this }, o.prototype.off = o.prototype.removeListener, o.prototype.addListener = o.prototype.on, o.prototype.setMaxListeners = function () { return this }, o.prefixed = a, o.EventEmitter = o, e.exports = o }, function (e, t, n) { t.__esModule = !0; var r, i = (r = n(69)) && r.__esModule ? r : { default: r }; t.default = function (e, t, n) { return t in e ? (0, i.default)(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e } }, function (e, t, n) { (function (t) { var r, i = (r = n(2)) && r.__esModule ? r : { default: r }, o = n(92), s = n(91), a = n(61), c = n(89), u = n(88); e.exports = { polyfill: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : t || window; if ("object" !== (void 0 === e ? "undefined" : (0, i.default)(e))) throw new Error("polyfill target is not an Object"); var n = { localStorage: o, XMLHttpRequest: s, FormData: a, WebSocket: c, Object: Object, navigator: u, location: Object.create(null) }; for (var r in n) e[r] || (e[r] = n[r]); e.navigator.product = "WeixinApp" }, localStorage: o, XMLHttpRequest: s, FormData: a, WebSocket: c } }).call(this, n(48)) }, function (e, t, n) { var r = n(181).polyfill; try { r() } catch (e) { } try { r(GameGlobal) } catch (e) { } try { window = window || {}, r(window) } catch (e) { } try { localStorage = localStorage || n(92) } catch (e) { } try { XMLHttpRequest = XMLHttpRequest || n(91) } catch (e) { } try { FormData = FormData || n(61) } catch (e) { } try { WebSocket = WebSocket || n(89) } catch (e) { } try { navigator = navigator || n(88) } catch (e) { } }, , , , , , , , , , , , , , , , , , , , function (e, t, n) { function r(e) { i.verifyOptions(e, "type", "event::MsgEventSubscribe"), i.verifyParamType("type", e.type, "number", "event::MsgEventSubscribe"), i.findObjIndexInArray([1, 2, 3], e.type) < 0 && i.verifyParamMin("type", e.type, 1e5, "event::MsgEventSubscribe"), this.type = e.type, o(e.subscribeTime) ? (i.verifyParamType("subscribeTime", e.subscribeTime, "number", "event::MsgEventSubscribe"), i.verifyParamMin("subscribeTime", e.subscribeTime, 60, "event::MsgEventSubscribe"), i.verifyParamMax("subscribeTime", e.subscribeTime, 2592e3, "event::MsgEventSubscribe"), this.subscribeTime = e.subscribeTime) : this.subscribeTime = 2592e3, o(e.sync) ? (i.verifyParamType("sync", e.sync, "boolean", "event::MsgEventSubscribe"), this.sync = e.sync) : this.sync = !0 } var i = n(0), o = i.notundef; r.prototype.assembleEvent = function (e) { return { type: this.type, subscribeTime: this.subscribeTime, sync: !0 === this.sync ? 1 : 0 } }, e.exports = r }, function (e, t, n) { function r(e) { if (i.verifyOptions(e, "type value", "event::MsgEvent"), i.verifyParamType("type", e.type, "number", "event::MsgEvent"), i.verifyParamType("value", e.value, "number", "event::MsgEvent"), this.type = e.type, this.value = e.value, this.idClient = i.guid(), o(e.custom) && (this.custom = "" + e.custom), this.validTime = e.validTime || 604800, i.verifyParamType("validTime", this.validTime, "number", "event::MsgEvent"), i.verifyParamMin("validTime", this.validTime, 60, "event::MsgEvent"), i.verifyParamMax("validTime", this.validTime, 604800, "event::MsgEvent"), o(e.broadcastType)) { if (i.verifyParamType("broadcastType", e.broadcastType, "number", "event::MsgEvent"), [1, 2].indexOf(e.broadcastType) < 0) throw new s('参数错误"broadcastType":只能为1或2'); this.broadcastType = e.broadcastType } else this.broadcastType = 2; o(e.sync) ? (i.verifyParamType("sync", e.sync, "boolean", "event::MsgEvent"), this.sync = e.sync) : this.sync = !1 } var i = n(0), o = i.notundef, s = n(4); r.prototype.assembleEvent = function () { return { type: this.type, value: this.value, idClient: this.idClient, custom: this.custom || "", validTime: this.validTime, broadcastType: this.broadcastType, sync: !0 === this.sync ? 1 : 0 } }, e.exports = r }, function (e, t, n) { function r(e) { return "object" === (void 0 === e ? "undefined" : (0, o.default)(e)) && (e.msgEventSubscribes ? e = e.msgEventSubscribes : e.msgEventSubscribe ? e = e.msgEventSubscribe : e.accounts ? e = e.accounts : e.msgEvent && (e = e.msgEvent).time && (e.time = +e.time), 1 === e.sync ? e.sync = !0 : 0 === e.sync && (e.sync = !1)), e } var i, o = (i = n(2)) && i.__esModule ? i : { default: i }, s = n(6).fn, a = n(0), c = n(203), u = n(202); s.batchSendEventsCmds = function (e, t, n) { var i = this, o = a.dropArrayDuplicates(t.accounts); o = a.reshape2d(o, 100); var s = []; o.forEach(function (n) { s.push(new Promise(function (o, s) { var c = a.simpleClone(t); c.accounts = n, i.sendCmdWithResp(e, c, function (e, t) { e ? s(e) : o(r(t)) }) })) }), Promise.all(s).then(function (e) { var t = null; if (e.length > 0) if (e[0].msgEventSubscribe) { var i = e[0].msgEventSubscribe; i = r(i); var o = []; e.forEach(function (e) { o = o.concat(e.accounts) }), t = { accounts: o, msgEventSubscribe: i } } else t = [], e.forEach(function (e) { t = t.concat(e) }); n(null, t) }, function (e) { n(e, null) }) }, s.publishEvent = function (e) { var t = new c(e); t = t.assembleEvent(), this.processCallback(e), this.sendCmdWithResp("publishEvent", { msgEvent: t }, function (t, n) { t || (n = r(n)), e.callback(t, n) }) }, s.subscribeEvent = function (e) { a.verifyOptions(e, "accounts", "event::subscribeEvent"); var t = new u(e); a.verifyParamType("accounts", e.accounts, "array", "event::subscribeEvent"), this.processCallback(e), t = t.assembleEvent(), this.batchSendEventsCmds("subscribeEvent", { msgEventSubscribe: t, accounts: e.accounts }, function (t, n) { !t && n && (n = { failedAccounts: n }), e.callback(t, n) }) }, s.unSubscribeEventsByAccounts = function (e) { a.verifyOptions(e, "accounts", "event::unSubscribeEventsByAccounts"), a.verifyParamType("accounts", e.accounts, "array", "event::unSubscribeEventsByAccounts"); var t = new u(e); t = t.assembleEvent(), this.processCallback(e), this.batchSendEventsCmds("unSubscribeEventsByAccounts", { msgEventSubscribe: t, accounts: e.accounts }, function (t, n) { !t && n && (n = { failedAccounts: n }), e.callback(t, n) }) }, s.unSubscribeEventsByType = function (e) { var t = new u(e); t = t.assembleEvent(), this.processCallback(e), this.sendCmdWithResp("unSubscribeEventsByType", { msgEventSubscribe: t }, function (t, n) { e.callback(t) }) }, s.querySubscribeEventsByAccounts = function (e) { a.verifyOptions(e, "accounts", "event::querySubscribeEventsByAccounts"), a.verifyParamType("accounts", e.accounts, "array", "event::querySubscribeEventsByAccounts"); var t = new u(e); t = t.assembleEvent(), this.processCallback(e), this.batchSendEventsCmds("querySubscribeEventsByAccounts", { msgEventSubscribe: t, accounts: e.accounts }, function (t, n) { !t && n && (n = { msgEventSubscribes: n }), e.callback(t, n) }) }, s.querySubscribeEventsByType = function (e) { var t = new u(e); t = t.assembleEvent(), this.processCallback(e), this.sendCmdWithResp("querySubscribeEventsByType", { msgEventSubscribe: t }, function (t, n) { t || (n = { msgEventSubscribes: r(n) }), e.callback(t, n) }) } }, function (e, t, n) { var r = n(6).fn, i = n(98), o = n(0), s = o.undef; r.getPushNotificationMultiportConfig = function () { return this.protocol.getPushNotificationMultiportConfig() }, r.updatePushNotificationMultiportConfig = function (e) { o.verifyOptions(e), s(e.shouldPushNotificationWhenPCOnline) && (e.shouldPushNotificationWhenPCOnline = !0), e.donnop = new i(e), this.processCallback(e), this.sendCmd("updateDonnop", e) } }, function (e, t, n) { var r = n(6).fn; r.clearDB = function (e) { var t = this.db; this.processCallback(e); var n = e.done; t.enable ? t.clear().then(n, n) : n() }, r.removeDB = function (e) { var t = this.db; this.processCallback(e); var n = e.done; t.enable ? t.destroy().then(n, n) : n() }, r.closeDB = function (e) { var t = this.db; this.processCallback(e); var n = e.done; t.enable ? t.close().then(n, n) : n() } }, function (e, t, n) { var r = n(6).fn, i = n(0); r.audioToText = function (e) { i.verifyOptions(e, "url", "audio::audioToText"), e.audioToText = i.filterObj(e, "url"), this.processCallback(e), this.sendCmd("audioToText", e) } }, function (e, t, n) { }, function (e, t, n) { }, function (e, t, n) { var r = n(6).fn, i = n(0), o = n(1); r.getChatroomAddress = function (e) { i.verifyOptions(e, "chatroomId", "chatroom::getChatroomAddress"), e.isWeixinApp = o.isWeixinApp, this.processCallback(e), this.sendCmd("getChatroomAddress", e) } }, function (e, t, n) { var r = n(6).fn, i = n(0), o = i.undef, s = i.notundef, a = n(56); r.markSysMsgRead = function (e) { function t() { e.done(n, e) } var n, r = this.db, o = Promise.resolve(), s = this.protocol; i.verifyOptions(e, "sysMsgs", "sysmsg::markSysMsgRead"); var a = e.sysMsgs; i.isArray(a) || (a = [a]), r.enable ? o = r.markSysMsgRead(a).then(function (e) { a = e, s.onUpdateSysMsg(e) }) : (a = a.filter(function (e) { return !e.read })).length && (s.options.autoMarkRead || s.markSysMsgRead(a, !0), a.forEach(function (e) { e.read = !0 }), s.onUpdateSysMsg(a)), o.then(function () { return s.reduceSysMsgUnread(a) }).then(t, function (e) { n = e, t() }) }, r.sendCustomSysMsg = function (e) { i.verifyOptions(e, "scene to content", "sysmsg::sendCustomSysMsg"), i.verifyParamValid("scene", e.scene, this.message.validScenes, "sysmsg::sendCustomSysMsg"), this.processCallback(e), "p2p" === e.scene ? e.type = "customP2p" : e.type = "customTeam", e.sysMsg = new a(e); var t = "sendCustomSysMsg"; return e.filter && (t = "sendFilterCustomSysMsg"), this.sendCmd(t, { sysMsg: e.sysMsg, single: !0 }, e.callback), this.formatReturnSysMsg(e.sysMsg) }, r.formatReturnSysMsg = function (e) { return e = i.copy(e), this.protocol.completeSysMsg(e), e.status = "sending", a.reverse(e) }, r.getLocalSysMsgs = function (e) { function t() { e.sysMsgs = c, e.done(n, e) } var n, r = this.db, c = []; i.verifyOptions(e), e.category && i.verifyParamValid("category", e.category, a.validCategories, "sysmsg::getLocalSysMsgs"), e.type && i.verifyParamValid("type", e.type, a.validTypes, "sysmsg::getLocalSysMsgs"), o(e.limit) && (e.limit = 100), i.verifyParamType("limit", e.limit, "number", "sysmsg::getLocalSysMsgs"), i.verifyParamMax("limit", e.limit, 100, "sysmsg::getLocalSysMsgs"), s(e.reverse) ? i.verifyParamType("reverse", e.reverse, "boolean", "sysmsg::getLocalSysMsgs") : e.reverse = !1, this.processCallback(e), r.enable ? r.getSysMsgs(e).then(function (e) { c = e, t() }, function (e) { n = e, t() }) : t() }, r.updateLocalSysMsg = function (e) { function t() { e.sysMsg = o, e.done(n, e) } var n, r = this.db, o = null; if (i.verifyOptions(e, "idServer", "sysmsg::updateLocalSysMsg"), this.processCallback(e), r.enable) { var s = i.filterObj(e, "idServer state localCustom"); r.updateSysMsg(s).then(function (e) { o = e, t() }, function (e) { n = e, t() }) } else t() }, r.deleteLocalSysMsg = function (e) { function t() { e.done(n, e) } var n, r = this.db; i.verifyOptions(e, "idServer", "sysmsg::deleteLocalSysMsg"), this.processCallback(e), r.enable ? r.deleteSysMsg(e.idServer).then(function () { t() }, function (e) { n = e, t() }) : t() }, r.deleteAllLocalSysMsgs = function (e) { function t() { r.protocol.onUpdateSysMsgUnread({}), e.done(n, e) } var n, r = this, i = r.db; r.processCallback(e), i.enable && i.deleteAllSysMsgs().then(function () { t() }, function (e) { n = e, t() }) } }, function (e, t, n) { var r = n(6).fn, i = n(0), o = i.undef, s = i.notundef, a = n(22), c = n(55), u = n(56), l = n(4); r.beforeSendMsg = function (e) { var t, n = this.protocol, r = e.msg; switch (r.to === this.account && (r.fromDeviceId = a.deviceId), r.userUpdateTime = n.myInfo && n.myInfo.updateTime, r.getScene()) { case "p2p": t = "sendMsg"; break; case "team": t = "sendTeamMsg"; break; case "superTeam": t = "sendSuperTeamMsg" }e.filter && (t = "sendFilterMsg", r.filter = !0), e.cmd = t }, r.afterSendMsg = function (e) { var t = e.rtnMsg, n = c.genSessionByMsg(t); this.protocol.onUpdateSession(n) }, r.beforeForwardMsg = function (e) { i.verifyOptions(e, "msg scene to", "msg::beforeForwardMsg"), e.msg.scene = e.scene, e.msg.to = e.to }, r.markMsgRead = function (e) { var t = this.protocol; !e || this.db.enable || t.options.autoMarkRead ? this.logger.warn("api::markMsgRead: 不需要标记消息为已收到 (没有消息, 或者启用了数据库, 或者启用了自动标记已收到)") : t.markMsgRead(e, !0) }, r.sendMsgReceipt = function (e) { if (i.verifyOptions(e), this.processCallback(e), e.msg) { i.verifyOptions(e, "msg", "msg::sendMsgReceipt"); var t = e.msg; i.verifyOptions(t, "target idClient time", !0, "msg.", "msg::sendMsgReceipt"), this.protocol.shouldSendMsgReceipt(t) ? this.sendCmd("sendMsgReceipt", { msgReceipt: { to: t.target, idClient: t.idClient, time: t.time } }, e.callback) : e.done() } else e.done() }, r.isMsgRemoteRead = function (e) { return this.protocol.isMsgRemoteRead(e) }, r.deleteMsg = function (e) { i.verifyOptions(e, "msg", "msg::deleteMsg"); var t = e.msg; if ("team" !== t.scene && "out" !== t.flow || "success" !== t.status || t.from === t.to || t.isLocal) return e.done(l.newParamError("只能删除自己发送给别人的, 并且发送成功的非本地消息", { callFunc: "msg::deleteMsg" }), e); i.verifyOptions(t, ["scene", "to", "from", "time", "idClient", "idServer"], !0, "msg.", "msg::deleteMsg"), i.verifyParamValid("msg.scene", t.scene, this.message.validScenes, "msg::deleteMsg"); var n = i.simpleClone(t); this.processPs(n), this.processCallback(e), s(e.opeAccount) ? n.opeAccount = e.opeAccount : o(n.opeAccount) && (n.opeAccount = n.from), "p2p" === n.scene ? n.type = "deleteMsgP2p" : n.type = "deleteMsgTeam", n.deletedIdClient = n.idClient, n.deletedIdServer = n.idServer, n = new u(n), this.sendCmd("deleteMsg", { sysMsg: n, msg: t }, e.callback) }; var m = { text: 0, image: 1, audio: 2, video: 3, geo: 4, notification: 5, file: 6, tip: 10, robot: 11, custom: 100 }; r.getHistoryMsgs = function (e) { var t; switch (i.verifyOptions(e, "scene to", "msg::getHistoryMsgs"), i.verifyParamValid("scene", e.scene, this.message.validScenes, "msg::getHistoryMsgs"), void 0 === e.beginTime && (e.beginTime = 0), i.verifyParamType("beginTime", e.beginTime, "number", "msg::getHistoryMsgs"), void 0 === e.endTime && (e.endTime = 0), i.verifyParamType("endTime", e.endTime, "number", "msg::getHistoryMsgs"), void 0 !== e.lastMsgId && null !== e.lastMsgId || (e.lastMsgId = "0"), void 0 === e.limit && (e.limit = 100), i.verifyParamType("limit", e.limit, "number", "msg::getHistoryMsgs"), i.verifyParamMax("limit", e.limit, 100, "msg::getHistoryMsgs"), s(e.reverse) ? i.verifyParamType("reverse", e.reverse, "boolean", "msg::getHistoryMsgs") : e.reverse = !1, s(e.asc) ? i.verifyParamType("asc", e.asc, "boolean", "msg::getHistoryMsgs") : e.asc = !1, o(e.msgTypes) ? e.msgTypes = [] : Array.isArray(e.msgTypes) ? (e.msgTypes = e.msgTypes.map(function (e) { return m[e] }), e.msgTypes = e.msgTypes.filter(function (e) { return "number" == typeof e })) : "number" == typeof m[e.msgTypes] ? e.msgTypes = [m[e.msgTypes]] : e.msgTypes = [], this.processCallback(e), e.asc && (e.cbaop = function (e, t) { e || (t.msgs = t.msgs.reverse()) }), e.scene) { case "p2p": t = "getHistoryMsgs"; break; case "team": t = "getTeamHistoryMsgs"; break; case "superTeam": t = "getSuperTeamHistoryMsgs" }var n = { scene: e.scene, to: e.to, beginTime: e.beginTime, endTime: e.endTime, lastMsgId: e.lastMsgId, limit: e.limit, reverse: e.reverse, msgTypes: e.msgTypes }; this.sendCmd(t, n, e.callback) }, r.searchHistoryMsgs = function (e) { var t; switch (i.verifyOptions(e, "scene to keyword", "msg::searchHistoryMsgs"), i.verifyParamValid("scene", e.scene, this.message.validScenes, "msg::searchHistoryMsgs"), void 0 === e.beginTime && (e.beginTime = 0), i.verifyParamType("beginTime", e.beginTime, "number", "msg::searchHistoryMsgs"), void 0 === e.endTime && (e.endTime = 0), i.verifyParamType("endTime", e.endTime, "number", "msg::searchHistoryMsgs"), void 0 === e.limit && (e.limit = 100), i.verifyParamType("limit", e.limit, "number", "msg::searchHistoryMsgs"), i.verifyParamMax("limit", e.limit, 100, "msg::searchHistoryMsgs"), s(e.reverse) ? i.verifyParamType("reverse", e.reverse, "boolean", "msg::searchHistoryMsgs") : e.reverse = !1, s(e.asc) ? i.verifyParamType("asc", e.asc, "boolean", "msg::searchHistoryMsgs") : e.asc = !1, this.processCallback(e), e.asc && (e.cbaop = function (e, t) { e || (t.msgs = t.msgs.reverse()) }), e.scene) { case "p2p": t = "searchHistoryMsgs"; break; case "team": t = "searchTeamHistoryMsgs" }var n = i.filterObj(e, "scene to beginTime endTime keyword limit reverse"); this.sendCmd(t, n, e.callback) }, r.getLocalMsgs = function (e) { function t() { var t = i.simpleClone(e); t.msgs = a, delete t.callback, delete t.done, e.done(r, t) } var n = this.db, r = null, a = []; i.verifyOptions(e); var c = !1; s(e.start) && (c = !0, i.verifyParamType("start", e.start, "number", "msg::getLocalMsgs")); var u = !1; s(e.end) && (u = !0, i.verifyParamType("end", e.end, "number", "msg::getLocalMsgs")), c && u && e.end <= e.start && i.onParamError("参数 end 必须晚于 start"), o(e.limit) && (e.limit = 100), i.verifyParamType("limit", e.limit, "number", "msg::getLocalMsgs"), i.verifyParamMin("limit", e.limit, 1, "msg::getLocalMsgs"), this.processCallback(e), n.enable ? n.getMsgs(e).then(function (e) { a = e, t() }, function (e) { (e = e || {}).message = e.message || "msg::getLocalMsgs:db error", t() }) : t() }, r.getLocalMsgByIdClient = function (e) { function t() { e.msg = o, e.done(n, e) } var n, r = this.db, o = null; i.verifyOptions(e, "idClient", "msg::getLocalMsgByIdClient"), this.processCallback(e), r.enable ? r.getMsgByIdClient(e.idClient).then(function (e) { e && (o = e), t() }, function (e) { n = e, t() }) : t() }, r.getLocalMsgsByIdClients = function (e) { function t() { e.msgs = o, e.done(n, e) } var n, r = this.db, o = []; i.verifyOptions(e, "idClients", "msg::getLocalMsgByIdClient"), i.verifyParamType("idClients", e.idClients, "array", "msg::getLocalMsgByIdClient"), this.processCallback(e), r.enable ? r.getMsgsByIdClients(e.idClients).then(function (e) { o = e.filter(function (e) { return !!e }), t() }, function (e) { n = e, t() }) : t() }, r.updateLocalMsg = function (e) { function t() { e.msg = o, e.done(n, e) } var n, r = this.db, o = null; if (i.verifyOptions(e, "idClient", "msg::updateLocalMsg"), this.processCallback(e), r.enable) { var s = i.filterObj(e, "idClient localCustom"); r.updateMsg(s).then(function (e) { o = e, t() }, function (e) { n = e, t() }) } else t() }, r.deleteLocalMsg = function (e) { function t() { e.done(n, e) } var n; i.verifyOptions(e, "msg", "msg::deleteLocalMsg"); var r = e.msg; i.verifyOptions(r, "idClient sessionId", !0, "msg.", "msg::deleteLocalMsg"), this.processCallback(e), this.protocol.deleteLocalMsg(r).then(t, function (e) { n = e, t() }) }, r.deleteLocalMsgsBySession = function (e) { function t(e) { r = e, n() } function n() { e.done(r, e) } var r, o = this, s = o.db; i.verifyOptions(e, "scene to", "msg::deleteLocalMsgsBySession"), i.verifyParamValid("scene", e.scene, o.message.validScenes, "msg::deleteLocalMsgsBySession"), e.sessionId = e.scene + "-" + e.to, e.delLastMsg = !0 === e.delLastMsg, o.processCallback(e), s.enable ? s.deleteMsgsBySessionId(e).then(function () { e.delLastMsg ? s.updateSession({ id: e.sessionId, lastMsg: null }).then(function (t) { o.protocol.onUpdateSession(t), e.session = t, n() }, t) : n() }, t) : (e.delLastMsg && o.protocol.onUpdateSession({ id: e.sessionId, lastMsg: null }), n()) }, r.deleteLocalMsgs = function (e) { function t() { e.done(n, e) } var n, r = this, o = r.db, a = !1 !== e.updateSession; i.verifyOptions(e, "sessionId", "msg::deleteLocalMsgsBySession"), s(e.start) && i.verifyParamType("start", e.start, "number", "msg::deleteLocalMsgs"), s(e.end) && i.verifyParamType("end", e.end, "number", "msg::deleteLocalMsgs"), s(e.end) && s(e.start) && e.end <= e.start && i.onParamError("参数 end 必须大于 start"), r.processCallback(e), o.enable ? o.deleteMsgsBySessionId(e).then(function () { t(), a && r.protocol.checkAndUpdateLocalSessionByMsg(e.sessionId) }, function (e) { n = e, t() }) : t() }, r.deleteAllLocalMsgs = function (e) { function t() { e.done(n, e) } var n, r = this.db; this.processCallback(e), r.enable && r.deleteAllMsgs().then(function () { t() }, function (e) { n = e, t() }) }, r.clearServerHistoryMsgs = function (e) { i.verifyOptions(e, "account", "msg::clearServerHistoryMsgs"); var t = !(!1 === e.delRoam); this.processCallback(e), this.sendCmd("clearServerHistoryMsgs", { clearMsgsParams: { account: e.account, delRoam: t ? 1 : 0 } }, e.callback) } }, function (e, t, n) { var r = n(6).fn, i = n(0), o = i.undef, s = i.notundef, a = n(79); r.setCurrSession = function (e) { this.resetSessionUnread(e), this.protocol.setCurrSession(e) }, r.resetAllSessionUnread = function () { for (var e in this.protocol.sessionSet) this.protocol.sessionSet[e].unread > 0 && this.resetSessionUnread(e) }, r.resetSessionUnread = function (e) { if (this.protocol.resetSessionUnread(e), this.options.syncSessionUnread) { var t = this.protocol.findSession(e); if (t) if (t.lastMsg) if (t.scene && t.to) { var n = t.lastMsg.time; if (t && t.ack && t.ack >= n) this.logger.warn("api::resetSessionUnread: session ack not needs " + e); else { var r = { scene: "p2p" === t.scene ? 0 : 1, to: t.to, timetag: n }; this.sendCmd("markSessionAck", r) } } else this.logger.warn("api::resetSessionUnread: session.scene|to undefined " + e); else this.logger.warn("api::resetSessionUnread: session.lastMsg undefined " + e); else this.logger.warn("api::resetSessionUnread: session undefined " + e) } }, r.resetCurrSession = function () { this.protocol.setCurrSession("") }, r.insertLocalSession = function (e) { function t() { e.session = r, e.done(n, e) } var n, r; i.verifyOptions(e, "scene to", "scene::insertLocalSession"), i.verifyParamValid("scene", e.scene, this.message.validScenes, "scene::insertLocalSession"), this.processCallback(e), this.protocol.insertLocalSession(e).then(function (e) { r = e, t() }, function (e) { n = e, t() }) }, r.getLocalSessions = function (e) { function t() { e.sessions = c, e.done(n, e) } var n, r = this, a = r.db, c = []; i.verifyOptions(e), o(e.limit) && (e.limit = 100), i.verifyParamType("limit", e.limit, "number", "scene::getLocalSessions"), i.verifyParamMax("limit", e.limit, 100, "scene::getLocalSessions"), s(e.reverse) ? i.verifyParamType("reverse", e.reverse, "boolean", "scene::getLocalSessions") : e.reverse = !1, r.processCallback(e), a.enable ? a.getSessions(e).then(function (e) { c = e, r.protocol.mergeSessions(c), t() }, function (e) { n = e, t() }) : t() }, r.getLocalSession = function (e) { function t() { e.done(n, o) } var n, r = this.db, o = null; if (i.verifyOptions(e, "sessionId", "scene::getLocalSession"), i.verifyParamType("sessionId", e.sessionId, "string", "scene::getLocalSession"), r.enable) return this.processCallback(e), void r.getSession(e.sessionId).then(function (e) { e && (o = e), t() }, function (e) { n = e, t() }); this.protocol.sessionSet && this.protocol.sessionSet[e.sessionId] && (o = this.protocol.sessionSet[e.sessionId]), t() }, r.getLocalSessionsByMsgType = function (e) { var t = this.db, n = e.exclude, r = [], o = a.validTypes.slice(0); if (s(n)) { if ("string" == typeof n) n = [n]; else if (!Array.isArray(n)) return void i.onParamInvalidType("exclude", ["string", "string array"], "", "exclude::getLocalSessionsByMsgType"); n = n.filter(function (e) { return o.indexOf(e) > -1 }), o = o.filter(function (e) { return -1 === n.indexOf(e) }) } this.processCallback(e), o && 0 !== o.length && t.enable ? t.getSessions().then(function (i) { n && 0 !== n.length ? (i.map(function (e, s) { var a, c, u; e.lastMsg && n.indexOf(e.lastMsg.type) > -1 && (a = s, c = e.id, u = t.getMsgs({ sessionId: c, limit: 1, types: o }).then(function (e) { return e && e[0] ? i[a].lastMsg = e[0] : i[a].lastMsg = null, Promise.resolve() }), r.push(u)) }), Promise.all(r).then(function (t) { var r = i.filter(function (e) { return e.lastMsg }); e.done(null, { exclude: n, sessions: r }) })) : e.done(null, { exclude: n, sessions: i }) }) : e.done(null, { exclude: n, sessions: [] }) }, r.updateLocalSession = function (e) { function t() { r.protocol.onUpdateSession(s), e.session = s, e.done(n, e) } var n, r = this, o = r.db; i.verifyOptions(e, "id", "scene::updateLocalSession"), r.processCallback(e); var s = i.filterObj(e, "id localCustom"); o.enable ? o.updateSession(s).then(function (e) { s = e, t() }, function (e) { n = e, t() }) : t() }, r.deleteLocalSession = function (e) { function t() { e.done(n, e) } var n, r = this, o = r.db; i.verifyOptions(e, "id", "session::deleteLocalSession"), r.processCallback(e), o.enable ? o.deleteSession(e.id).then(function () { r.protocol.deleteLocalSession(e.id), t() }, function (e) { n = e, t() }) : t() }, r.deleteSession = function (e) { i.verifyOptions(e, "scene to", "session::deleteSession"), this.processCallback(e), e.sessions = [{ scene: e.scene, to: e.to }], this.deleteSessions(e) }, r.deleteSessions = function (e) { i.verifyOptions(e, "sessions", "session::deleteSessions"), i.verifyParamType("sessions", e.sessions, "array", "session::deleteSessions"), e.sessions.forEach(function (e, t) { i.verifyOptions(e, "scene to", !0, "sessions[" + t + "].", "session::deleteSessions") }), this.processCallback(e), this.sendCmd("deleteSessions", { sessions: e.sessions.map(function (e) { return e.scene + "|" + e.to }) }, e.callback) } }, function (e, t, n) { var r, i = (r = n(140)) && r.__esModule ? r : { default: r }, o = n(6).fn, s = n(0), a = s.undef, c = n(99), u = n(76); o.addSuperTeamMembers = function (e) { s.verifyOptions(e, "teamId accounts", "superTeam::addSuperTeamMembers"), s.verifyParamType("accounts", e.accounts, "array", "superTeam::addSuperTeamMembers"); var t = s.deduplicate(e.accounts); this.processCallback(e); var n = { teamId: e.teamId, accounts: t }; this.sendCmd("addSuperTeamMembers", n, e.callback) }, o.removeSuperTeamMembers = function (e) { s.verifyOptions(e, "teamId accounts", "team::removeSuperTeamMembers"), s.verifyParamType("accounts", e.accounts, "array", "team::removeSuperTeamMembers"); var t = s.deduplicate(e.accounts); this.processCallback(e); var n = { teamId: e.teamId, accounts: t }; this.sendCmd("removeSuperTeamMembers", n, e.callback) }, o.leaveSuperTeam = function (e) { s.verifyOptions(e, "teamId", "superTeam::leaveSuperTeam"), this.processCallback(e); var t = { teamId: e.teamId }; this.sendCmd("leaveSuperTeam", t, e.callback) }, o.getSuperTeam = function (e) { function t() { r.sendCmd("getSuperTeam", { teamId: e.teamId }, e.callback) } var n, r = this, i = r.db; s.verifyOptions(e, "teamId", "team::getSuperTeam"), r.processCallback(e), e.cbaop = function (e, t) { e || r.logger.log("api::getSuperTeam: cbaop " + n, t) }, n = e.teamId, i.enable && !e.sync ? i.getSuperTeam(n).then(function (i) { i ? (r.logger.log("api::getSuperTeam: db.getSuperTeam " + n, i), e.done(null, i)) : t() }, t) : t() }, o.getSuperTeams = function (e) { function t() { n.sendCmd("getSuperTeams", { timetag: i, NOTSTORE: "timetag" }, e.callback) } var n = this, r = n.db, i = 0; s.verifyOptions(e), n.processCallback(e), r.enable ? r.getSuperTeamsTimetag().then(function (e) { i = e, t() }, t) : t() }, o.updateSuperTeam = function (e) { s.verifyOptions(e, "teamId", "superTeam::updateSuperTeam"), e.action = "update", this.processCallback(e), e.team = new c(e), this.sendCmd("updateSuperTeam", { team: e.team, single: !0 }, e.callback) }, o.updateInfoInSuperTeam = function (e) { s.verifyOptions(e, "teamId", "superTeam::updateInfoInSuperTeam"), this.processCallback(e), this.sendCmd("updateInfoInSuperTeam", { superTeamMember: new u(e), single: !0 }, e.callback) }, o.getSuperTeamMembersByJoinTime = function (e) { var t = this, n = (t.db, e.joinTime), r = e.reverse, i = e.limit, o = e.teamId; r = !!r, a(n) && (n = 0), a(i) && (i = 100), s.verifyOptions(e, "teamId", "superTeam::getSuperTeamMembersByJoinTime"), s.verifyParamType("joinTime", n, "number", "api::superTeam::getSuperTeamMembersByJoinTime"), s.verifyParamType("limit", i, "number", "api::superTeam::getSuperTeamMembersByJoinTime"), t.processCallback(e), t.sendCmd("getSuperTeamMembersByJoinTime", { teamId: o, limit: i, joinTime: n, reverse: r, timetag: 0, NOTSTORE: "timetag" }, e.callback) }, o.getAllSuperTeamMembers = function (e) { function t(t) { t = t || 0, n.sendCmd("getSuperTeamMembers", { teamId: e.teamId, timetag: t, NOTSTORE: "timetag" }, e.callback) } var n = this, r = this.db; s.verifyOptions(e, "teamId", "superTeam::getAllSuperTeamMembers"), n.processCallback(e), function (e) { var t = this.db; if (!t.enable) return Promise.resolve(!1); var n = t.getSuperTeam(e), r = t.getSuperTeamMembersTimetag(e); return Promise.all([n, r]).then(function (e) { var t = (0, i.default)(e, 2), n = t[0], r = t[1], o = n && n.memberUpdateTime, s = { timetag: r = r || 0 }; return o && r >= o && (s.valid = !0), Promise.resolve(s) }, function () { return Promise.resolve({ timetag: 0 }) }) }.bind(this)(e.teamId).then(function (i) { var o = i.valid, s = i.timetag; o ? (n.logger.info("getAllSuperTeamMembers from local db"), r.getSuperTeamMembers(e.teamId).then(function (t) { var n = { teamId: e.teamId, members: t }; e.done(null, n) }, function () { return t() })) : t(s) }) } }, function (e, t, n) { var r = n(6).fn, i = n(0), o = i.undef, s = n(58), a = n(49); r.createTeam = function (e) { i.verifyOptions(e, "type name", "team::createTeam"), o(e.accounts) ? e.accounts = [] : i.verifyParamType("accounts", e.accounts, "array", "team::createTeam"), e.action = "create", this.processPs(e), this.processCallback(e), e.team = new s(e); var t = { team: e.team, accounts: e.accounts.slice(0), ps: e.ps }; this.sendCmd("createTeam", t, e.callback) }, r.updateTeam = function (e) { i.verifyOptions(e, "teamId", "team::updateTeam"), e.action = "update", this.processCallback(e), e.team = new s(e), this.sendCmd("updateTeam", { team: e.team, single: !0 }, e.callback) }, r.addTeamMembers = function (e) { i.verifyOptions(e, "teamId accounts", "team::addTeamMembers"), i.verifyParamType("accounts", e.accounts, "array", "team::addTeamMembers"), this.processPs(e), i.notexist(e.custom) && (e.custom = ""), this.processCallback(e); var t = { teamId: e.teamId, accounts: e.accounts.slice(0), ps: e.ps, attach: e.custom }; this.sendCmd("addTeamMembers", t, e.callback) }, r.removeTeamMembers = function (e) { i.verifyOptions(e, "teamId accounts", "team::removeTeamMembers"), i.verifyParamType("accounts", e.accounts, "array", "team::removeTeamMembers"), this.processCallback(e); var t = { teamId: e.teamId, accounts: e.accounts.slice(0) }; this.sendCmd("removeTeamMembers", t, e.callback) }, r.acceptTeamInvite = function (e) { i.verifyOptions(e, "idServer teamId from", "team::acceptTeamInvite"), this.processCallback(e); var t = { idServer: e.idServer, teamId: e.teamId, from: e.from }; this.sendCmd("acceptTeamInvite", t, e.callback) }, r.rejectTeamInvite = function (e) { i.verifyOptions(e, "idServer teamId from", "team::rejectTeamInvite"), this.processPs(e), this.processCallback(e); var t = { idServer: e.idServer, teamId: e.teamId, from: e.from, ps: e.ps }; this.sendCmd("rejectTeamInvite", t, e.callback) }, r.applyTeam = function (e) { i.verifyOptions(e, "teamId", "team::applyTeam"), this.processPs(e), this.processCallback(e); var t = { teamId: e.teamId, ps: e.ps }; this.sendCmd("applyTeam", t, e.callback) }, r.passTeamApply = function (e) { i.verifyOptions(e, "idServer teamId from", "team::passTeamApply"), this.processCallback(e); var t = { idServer: e.idServer, teamId: e.teamId, from: e.from }; this.sendCmd("passTeamApply", t, e.callback) }, r.rejectTeamApply = function (e) { i.verifyOptions(e, "idServer teamId from", "team::rejectTeamApply"), this.processPs(e), this.processCallback(e); var t = { idServer: e.idServer, teamId: e.teamId, from: e.from, ps: e.ps }; this.sendCmd("rejectTeamApply", t, e.callback) }, r.addTeamManagers = function (e) { i.verifyOptions(e, "teamId accounts", "team::addTeamManagers"), i.verifyParamType("accounts", e.accounts, "array", "team::addTeamManagers"), this.processCallback(e); var t = { teamId: e.teamId, accounts: e.accounts.slice(0) }; this.sendCmd("addTeamManagers", t, e.callback) }, r.removeTeamManagers = function (e) { i.verifyOptions(e, "teamId accounts", "team::removeTeamManagers"), i.verifyParamType("accounts", e.accounts, "array", "team::removeTeamManagers"), this.processCallback(e); var t = { teamId: e.teamId, accounts: e.accounts.slice(0) }; this.sendCmd("removeTeamManagers", t, e.callback) }, r.updateInfoInTeam = function (e) { i.verifyOptions(e, "teamId", "team::updateInfoInTeam"), this.processCallback(e), this.sendCmd("updateInfoInTeam", { teamMember: new a(e), single: !0 }, e.callback) }, r.updateNickInTeam = function (e) { i.verifyOptions(e, "teamId account", "team::updateNickInTeam"), this.processCallback(e), this.sendCmd("updateNickInTeam", { teamMember: new a(e), single: !0 }, e.callback) }, r.updateMuteStateInTeam = function (e) { i.verifyOptions(e, "teamId account mute", "team::updateMuteStateInTeam"), this.processCallback(e), e.mute = e.mute ? 1 : 0, this.sendCmd("updateMuteStateInTeam", e) }, r.getMutedTeamMembers = function (e) { i.verifyOptions(e, "teamId", "team::getMutedTeamMembers"), this.processCallback(e), this.sendCmd("getMutedTeamMembers", e) }, r.leaveTeam = function (e) { i.verifyOptions(e, "teamId", "team::leaveTeam"), this.processCallback(e); var t = { teamId: e.teamId }; this.sendCmd("leaveTeam", t, e.callback) }, r.transferTeam = function (e) { i.verifyOptions(e, "teamId account leave", "team::transferTeam"), i.verifyParamType("leave", e.leave, "boolean", "team::transferTeam"), this.processCallback(e); var t = { teamId: e.teamId, account: e.account, leave: e.leave }; this.sendCmd("transferTeam", t, e.callback) }, r.dismissTeam = function (e) { i.verifyOptions(e, "teamId", "team::dismissTeam"), this.processCallback(e); var t = { teamId: e.teamId }; this.sendCmd("dismissTeam", t, e.callback) }, r.getTeam = function (e) { function t() { r.sendCmd("getTeam", { teamId: e.teamId }, e.callback) } var n, r = this, o = r.db; i.verifyOptions(e, "teamId", "team::getTeam"), r.processCallback(e), e.cbaop = function (e, t) { e || r.logger.log("api::getTeam: cbaop " + n, t) }, n = e.teamId, o.enable && !e.sync ? o.getTeam(n).then(function (i) { i && i.validToCurrentUser ? (r.logger.log("api::getTeam: db.getTeam " + n, i), e.done(null, i)) : t() }, t) : t() }, r.getTeams = function (e) { function t() { n.sendCmd("getTeams", { timetag: o, NOTSTORE: "timetag" }, e.callback) } var n = this, r = n.db, o = 0; i.verifyOptions(e), n.processCallback(e), r.enable ? r.getTeamsTimetag().then(function (e) { o = e, t() }, t) : t() }, r.getTeamMembers = function (e) { i.verifyOptions(e, "teamId", "team::getTeamMembers"), this.processCallback(e), this.sendCmd("getTeamMembers", { teamId: e.teamId, timetag: 0, NOTSTORE: "timetag" }, e.callback) }, r.getTeamMemberByTeamIdAndAccount = function (e) { i.verifyParamType("teamId", e.teamId, "numeric or numeric string", "team::getTeamMemberByTeamIdAndAccount"), i.verifyOptions(e, "account", "team::getTeamMemberByTeamIdAndAccount"), this.processCallback(e), this.sendCmd("getTeamMembers", { teamId: e.teamId, timetag: 0, NOTSTORE: "timetag" }, function (t, n, r) { var i = {}; if (n && n.members && n.members.length) for (var o = 0; o < n.members.length; o++)if (n.members[o].account === e.account) { i[e.account] = n.members[o]; break } e.callback(t, i, r) }) }, r.getTeamMemberInvitorAccid = function (e) { i.verifyParamType("teamId", e.teamId, "numeric or numeric string", "team::getTeamMemberInvitorAccid"), o(e.accounts) || (i.verifyParamType("accounts", e.accounts, "array", "team::getTeamMemberInvitorAccid"), e.accounts.length > 200 && i.onParamError("accounts 参数数组长度不能超过200", "team::getTeamMemberInvitorAccid")); var t = { teamId: e.teamId }; e.accounts.length && (t.accounts = e.accounts.slice(0)), this.processCallback(e), this.sendCmd("getTeamMemberInvitorAccid", t, function (t, n, r) { e.callback(t, r && r.accountsMap || {}) }) }, r.notifyForNewTeamMsg = function (e) { i.verifyOptions(e, "teamIds", "team::notifyForNewTeamMsg"), this.protocol.notifyForNewTeamMsg(e.teamIds).then(function (t) { e.done(t.error || null, t.map, t.miss) }, function (t) { e.done(t) }) }, r.getMyTeamMembers = function (e) { i.verifyOptions(e, "teamIds", "team::getMyTeamMembers"); var t = this.processCallbackPromise(e); return this.sendCmd("getMyTeamMembers", e), t }, r.getLocalTeams = function (e) { function t() { e.teams = o, e.done(n, e) } var n, r = this.db, o = []; i.verifyOptions(e, "teamIds", "team::getLocalTeams"), i.verifyParamType("teamIds", e.teamIds, "array", "team::getLocalTeams"), this.processCallback(e), r.enable ? r.getTeamsByTeamIds(e.teamIds).then(function (e) { o = e.filter(function (e) { return !!e }), t() }, function (e) { n = e, t() }) : t() }, r.getLocalTeamMembers = function (e) { function t() { e.members = o, e.done(n, e) } var n, r = this.db, o = []; i.verifyOptions(e, "teamId accounts", "team::getLocalTeamMembers"), i.verifyParamType("accounts", e.accounts, "array", "team::getLocalTeamMembers"), this.processCallback(e), r.enable ? r.getInvalidTeamMembers(e.teamId, e.accounts).then(function (e) { o = e.filter(function (e) { return !!e }), t() }, function (e) { n = e, t() }) : t() }, r.deleteLocalTeam = function (e) { function t() { e.done(n, e) } var n, r = this.db; i.verifyOptions(e, "teamId", "team::deleteLocalTeam"), this.processCallback(e), r.enable ? r.deleteTeam(e.teamId).then(function () { t() }, function (e) { n = e, t() }) : t() }, r.muteTeamAll = function (e) { switch (i.verifyOptions(e, "teamId type", "team::muteTeamAll"), e.type) { case "none": e.muteType = 0; break; case "normal": e.muteType = 1; break; case "all": e.muteType = 2; break; default: e.muteType = 1 }this.processCallback(e), this.sendCmd("muteTeamAll", e) }, r.sendTeamMsgReceipt = function (e) { i.verifyOptions(e, "teamMsgReceipts", "team::sendTeamMsgReceipt"), this.processCallback(e), this.sendCmd("sendTeamMsgReceipt", e) }, r.getTeamMsgReads = function (e) { i.verifyOptions(e, "teamMsgReceipts", "team::getTeamMsgReads"), this.processCallback(e), this.sendCmd("getTeamMsgReads", e) }, r.getTeamMsgReadAccounts = function (e) { i.verifyOptions(e, "teamMsgReceipt", "team::getTeamMsgReadAccounts"), this.processCallback(e), this.sendCmd("getTeamMsgReadAccounts", e) } }, function (e, t, n) { n(6).fn.getRobots = function (e) { (e = e || {}).type = "getRobots", this.processCallback(e), this.sendCmd("sync", { sync: { robots: 0 } }, e.callback) } }, function (e, t, n) { var r = n(6).fn, i = n(0), o = i.notundef, s = n(141); r.friendRequest = function (e) { i.verifyOptions(e, "type account", "friend::friendRequest"), i.verifyParamValid("type", e.type, s.validTypes(), "friend::friendRequest"), this.processPs(e), this.processCallback(e); var t = { account: e.account, type: s.getByteFromType(e.type), ps: e.ps }; o(e.idServer) && (t.idServer = e.idServer), this.sendCmd("friendRequest", t, e.callback) }, r.addFriend = function (e) { e.type = "addFriend", this.friendRequest(e) }, r.applyFriend = function (e) { e.type = "applyFriend", this.friendRequest(e) }, r.passFriendApply = function (e) { i.verifyOptions(e, "idServer", "friend::passFriendApply"), e.type = "passFriendApply", this.friendRequest(e) }, r.rejectFriendApply = function (e) { i.verifyOptions(e, "idServer", "friend::rejectFriendApply"), e.type = "rejectFriendApply", this.friendRequest(e) }, r.deleteFriend = function (e) { i.verifyOptions(e, "account", "friend::deleteFriend"); var t = !0 === e.delAlias; this.processCallback(e), this.sendCmd("deleteFriend", { account: e.account, delFriendParams: { delAlias: t ? 1 : 0 } }, e.callback) }, r.updateFriend = function (e) { this.processCallback(e); var t = new s(e); this.sendCmd("updateFriend", { friend: t, single: !0 }, e.callback) }, r.getFriends = function (e) { function t() { n.sendCmd("getFriends", { timetag: o, NOTSTORE: "timetag" }, e.callback) } var n = this, r = n.db, o = 0; i.verifyOptions(e), n.processCallback(e), r.enable ? r.getFriendsTimetag().then(function (e) { o = e, t() }, t) : t() } }, function (e, t, n) { var r = n(6).fn, i = n(0), o = i.objs2accounts, s = n(75); r.updateMyInfo = function (e) { i.verifyOptions(e), this.processCallback(e), e.user = new s(e), delete e.user.account, this.sendCmd("updateMyInfo", { user: e.user, single: !0 }, e.callback) }, r.getMyInfo = function (e) { return (e = e || {}).account = this.account, this.getUser(e) }, r.getUser = function (e) { function t() { r.sendCmd("getUsers", { accounts: [n], single: !0 }, e.callback) } var n, r = this, o = r.db; i.verifyOptions(e, "account", "user::getUser"), r.processCallback(e), e.cbaop = function (e, t) { if (!e) return t = t[0] || null, r.logger.log("api::getUser: cbaop " + n, t), t }, n = e.account, e.sync ? t() : o.enable ? o.getUser(n).then(function (i) { i ? (r.logger.log("api::getUser: db.getUser " + n, i), e.done(null, i)) : t() }, t) : t() }, r.getUsers = function (e) { function t() { r.sendCmd("getUsers", { accounts: n, single: !0 }, e.callback) } var n, r = this, s = r.db, a = []; i.verifyOptions(e, "accounts", "user::getUsers"), i.verifyParamType("accounts", e.accounts, "array", "user::getUsers"), r.processCallback(e), e.cbaop = function (e, t) { if (!e) return t = t.concat(a), r.logger.log("api::getUsers: cbaop " + n, t), t }, n = i.deduplicate(e.accounts), i.verifyArrayMax("accounts", e.accounts, 150, "user::getUsers"), e.sync ? t() : s.enable ? s.getUsers(n).then(function (i) { if (i && i.length === n.length) r.logger.log("api::getUsers: db.getUsers", i), e.done(null, i); else { a = i; var s = o(i), c = []; n.forEach(function (e) { -1 === s.indexOf(e) && c.push(e) }), n = c, t() } }, t) : t() } }, function (e, t, n) { var r = n(6).fn, i = n(0); r.markInBlacklist = function (e) { i.verifyOptions(e, "account isAdd", "relation::markInBlacklist"), i.verifyParamType("isAdd", e.isAdd, "boolean", "relation::markInBlacklist"), this.processCallback(e), this.sendCmd("markInBlacklist", { account: e.account, isAdd: e.isAdd }, e.callback) }, r.addToBlacklist = function (e) { return e.isAdd = !0, this.markInBlacklist(e) }, r.removeFromBlacklist = function (e) { return e.isAdd = !1, this.markInBlacklist(e) }, r.markInMutelist = function (e) { i.verifyOptions(e, "account", "relation::markInMutelist"), i.verifyParamType("isAdd", e.isAdd, "boolean", "relation::markInMutelist"), this.processCallback(e), this.sendCmd("markInMutelist", { account: e.account, isAdd: e.isAdd }, e.callback) }, r.addToMutelist = function (e) { return e.isAdd = !0, this.markInMutelist(e) }, r.removeFromMutelist = function (e) { return e.isAdd = !1, this.markInMutelist(e) }, r.getRelations = function (e) { function t() { n.sendCmd("getRelations", { timetag: o, NOTSTORE: "timetag" }, e.callback) } var n = this, r = n.db, o = 0; e = i.verifyOptions(e), n.processCallback(e), r.enable ? r.getRelationsTimetag().then(function (e) { o = e, t() }, t) : t() } }, function (e, t, n) { var r = n(6).fn, i = n(0); r.kick = function (e) { i.verifyOptions(e, "deviceIds", "link::kick"), this.processCallback(e), this.sendCmd("kick", { deviceIds: e.deviceIds.slice(0) }, e.callback) } }, function (e, t, n) { var r = n(6).fn, i = n(0), o = i.isArray, s = n(49); r.mergeObjArray = function (e, t, n) { return e || (e = []), t ? (o(t) || (t = [t]), t.length ? (n = n || {}, i.mergeObjArray(e, t, n)) : e) : e }, r.cutObjArray = function (e, t, n) { return e && t ? (o(t) || (t = [t]), t.length ? (n = n || {}, i.cutObjArray(e, t, n)) : e) : e }, r.mergeLoginPorts = function (e, t) { return this.mergeObjArray(e, t, { keyPath: "deviceId" }) }, r.cutLoginPorts = function (e, t) { return this.cutObjArray(e, t, { keyPath: "deviceId", sortPath: "type" }) }, r.mergeRelations = function (e, t) { return this.mergeObjArray(e, t, { keyPath: "account" }) }, r.cutRelations = function (e, t) { return this.cutObjArray(e, t, { keyPath: "account" }) }, r.findRelation = function (e, t) { return i.findObjInArray(e, { keyPath: "account", value: t }) }, r.mergeFriends = function (e, t) { return this.mergeObjArray(e, t, { keyPath: "account" }) }, r.cutFriends = function (e, t) { return this.cutObjArray(e, t, { keyPath: "account" }) }, r.cutFriendsByAccounts = function (e, t) { o(t) || (t = [t]); var n = t.map(function (e) { return { account: e } }); return this.cutFriends(e, n) }, r.findFriend = function (e, t) { return i.findObjInArray(e, { keyPath: "account", value: t }) }, r.mergeUsers = function (e, t) { return this.mergeObjArray(e, t, { keyPath: "account" }) }, r.findUser = function (e, t) { return i.findObjInArray(e, { keyPath: "account", value: t }) }, r.mergeTeams = function (e, t) { return this.mergeObjArray(e, t, { keyPath: "teamId" }) }, r.cutTeams = function (e, t) { return this.cutObjArray(e, t, { keyPath: "teamId" }) }, r.findTeam = function (e, t) { return i.findObjInArray(e, { keyPath: "teamId", value: t }) }, r.assembleTeamOwner = s.assembleOwner, r.assembleTeamMembers = s.assembleMembers, r.genTeamMemberId = s.genId, r.mergeTeamMembers = function (e, t) { return this.mergeObjArray(e, t) }, r.cutTeamMembers = function (e, t) { return this.cutObjArray(e, t) }, r.cutTeamMembersByAccounts = function (e, t, n) { o(n) || (n = [n]); var r = s.assembleMembers({ teamId: t }, n); return this.cutTeamMembers(e, r) }, r.findTeamMember = function (e, t) { return i.findObjInArray(e, { keyPath: "id", value: t }) }, r.mergeSessions = function (e, t) { return this.mergeObjArray(e, t, { sortPath: "updateTime", desc: !0 }) }, r.cutSessions = function (e, t) { return this.cutObjArray(e, t) }, r.cutSessionsByIds = function (e, t) { o(t) || (t = [t]); var n = t.map(function (e) { return { id: e } }); return this.cutSessions(e, n) }, r.findSession = function (e, t) { return i.findObjInArray(e, { keyPath: "id", value: t }) }, r.mergeMsgs = function (e, t) { return this.mergeObjArray(e, t, { keyPath: "idClient", sortPath: "time" }) }, r.cutMsgs = function (e, t) { return this.cutObjArray(e, t, { keyPath: "idClient" }) }, r.cutMsgsByIdClients = function (e, t) { o(t) || (t = [t]); var n = t.map(function (e) { return { idClient: e } }); return this.cutMsgs(e, n) }, r.findMsg = function (e, t) { return i.findObjInArray(e, { keyPath: "idClient", value: t }) }, r.mergeSysMsgs = function (e, t) { return this.mergeObjArray(e, t, { keyPath: "idServer", desc: !0 }) }, r.cutSysMsgs = function (e, t) { return this.cutObjArray(e, t, { keyPath: "idServer" }) }, r.cutSysMsgsByIdServers = function (e, t) { o(t) || (t = [t]); var n = t.map(function (e) { return { idServer: e } }); return this.cutSysMsgs(e, n) }, r.findSysMsg = function (e, t) { return i.findObjInArray(e, { keyPath: "idServer", value: t }) } }, function (e, t, n) { function r(e) { o.verifyOptions(e, "content", "msg::RobotMessage"), o.undef(e.robotAccid) && (e.robotAccid = e.to); var t = e.content; switch (t.type) { case "welcome": o.undef(e.body) && (this.body = "欢迎消息"); break; case "text": o.verifyOptions(t, "content", "msg::RobotMessage"), o.undef(e.body) && (this.body = t.content); break; case "link": o.verifyOptions(t, "target", "msg::RobotMessage") }t.type && (t.type = s[t.type]), t = { param: t, robotAccid: e.robotAccid }, this.attach = JSON.stringify(t), e.type = "robot", i.call(this, e) } var i = n(33), o = n(0), s = { welcome: "00", text: "01", link: "03" }, a = { "01": "text", "02": "image", "03": "answer", 11: "template" }; r.prototype = Object.create(i.prototype), r.reverse = function (e) { var t = i.reverse(e); if ("robot" === t.type) { var n = JSON.parse(e.attach); if (n.param && (n.param.type = a[n.param.type] || "unknown"), n.robotMsg) { var r = (n = o.merge(n, n.robotMsg)).message; "bot" === n.flag ? n.message = r.map(function (e) { return e.type = a[e.type] || "unknown", e }) : n.flag, delete n.robotMsg } t.content = n } return t }, e.exports = r }, function (e, t, n) { function r(e) { o.verifyOptions(e, "tip", "msg::TipMessage"), e.type = "tip", i.call(this, e), this.body = e.tip } var i = n(33), o = n(0); r.prototype = Object.create(i.prototype), r.reverse = function (e) { var t = i.reverse(e); return t.text = "", t.tip = e.body, e.attach && (t.attach = e.attach), t }, e.exports = r }, function (e, t, n) { function r(e) { o.verifyOptions(e, "content", "msg::CustomMessage"), e.type = "custom", i.call(this, e), this.attach = e.content } var i = n(33), o = n(0); r.prototype = Object.create(i.prototype), r.reverse = function (e) { var t = i.reverse(e); return t.content = e.attach, t }, e.exports = r }, function (e, t, n) { function r() { } var i = n(0).notundef, o = n(33), s = n(44).IM, a = n(58), c = n(75), u = { 0: "addTeamMembers", 1: "removeTeamMembers", 2: "leaveTeam", 3: "updateTeam", 4: "dismissTeam", 5: "passTeamApply", 6: "transferTeam", 7: "addTeamManagers", 8: "removeTeamManagers", 9: "acceptTeamInvite", 10: "updateTeamMute", 101: "netcallMiss", 102: "netcallBill", 401: "addSuperTeamMembers", 402: "removeSuperTeamMembers", 403: "leaveSuperTeam", 404: "updateSuperTeam", 405: "dismissSuperTeam", 406: "transferSuperTeam", 407: "addSuperTeamManagers", 408: "removeSuperTeamManagers", 409: "updateSuperTeamMembersMute" }; r.prototype = Object.create(o.prototype), r.reverse = function (e) { var t = o.reverse(e); if (e.attach = e.attach ? "" + e.attach : "", e.attach) { var n = JSON.parse(e.attach); if (t.attach = { type: u[n.id] || n.id }, i(n.data)) { var r = n.data; i(r.tinfo) && (t.attach.team = a.reverse(s.syncUnserialize(r.tinfo, "team"), !0)), i(r.ids) && (t.attach.accounts = r.ids), i(r.id) && (t.attach.account = r.id), i(r.uinfos) && (t.attach.users = r.uinfos.map(function (e) { return c.reverse(s.syncUnserialize(e, "user")) })), i(r.mute) && (t.attach.mute = 1 == +r.mute), i(r.attach) && (t.attach.custom = r.attach), i(r.channel) && (t.attach.channelId = r.channel), i(r.calltype) && (t.attach.netcallType = r.calltype), i(r.duration) && (t.attach.duration = r.duration), i(r.time) && (t.attach.time = r.time), i(r.from) && (t.attach.from = r.from), i(r.ext) && (t.attach.ext = r.ext), t.attach.accounts && t.attach.accounts.length <= 2 && t.from === t.to && t.attach.accounts.some(function (e) { if (e !== t.to) return t.to = e, !0 }) } } else t.attach = {}; return t }, e.exports = r }, function (e, t, n) { function r(e) { e.type = "geo", o.verifyOptions(e, "geo", "msg::GeoMessage"), o.verifyOptions(e.geo, "lng lat title", !0, "geo.", "msg::GeoMessage"), o.verifyParamType("geo.lng", e.geo.lng, "number", "msg::GeoMessage"), o.verifyParamType("geo.lat", e.geo.lat, "number", "msg::GeoMessage"), o.verifyParamType("geo.title", e.geo.title, "string", "msg::GeoMessage"), i.call(this, e), this.attach = JSON.stringify(e.geo) } var i = n(33), o = n(0); r.prototype = Object.create(i.prototype), r.reverse = function (e) { var t = i.reverse(e); return e.attach = e.attach ? "" + e.attach : "", t.geo = e.attach ? JSON.parse(e.attach) : {}, t }, e.exports = r }, function (e, t, n) { function r() { } var i = n(74), o = n(0); r.prototype = Object.create(i.prototype), r.verifyFile = function (e, t) { o.verifyOptions(e, "dur w h", !0, "file.", t) }, e.exports = r }, function (e, t, n) { function r() { } var i = n(74), o = n(0); r.prototype = Object.create(i.prototype), r.verifyFile = function (e, t) { o.verifyOptions(e, "dur", !0, "file.", t) }, e.exports = r }, function (e, t, n) { function r() { } var i = n(0), o = n(74); r.prototype = Object.create(o.prototype), r.verifyFile = function (e, t) { i.verifyOptions(e, "w h", !0, "file.", t) }, e.exports = r }, function (e, t, n) { function r(e) { o.verifyOptions(e, "text", "msg::TextMessage"), e.type = "text", i.call(this, e) } var i = n(33), o = n(0); r.prototype = Object.create(i.prototype), r.reverse = function (e) { return i.reverse(e) }, e.exports = r }, function (e, t, n) { var r = n(0), i = function (e) { this.account = e.account }, o = i.prototype, s = o.Message = n(33), a = o.TextMessage = n(230), c = o.FileMessage = n(74), u = o.GeoMessage = n(226), l = o.NotificationMessage = n(225), m = o.CustomMessage = n(224), d = o.TipMessage = n(223), p = o.RobotMessage = n(222); o.validScenes = s.validScenes, o.validTypes = s.validTypes, o.reverse = function (e) { var t; switch (s.getType(e)) { case "text": t = a.reverse(e); break; case "image": case "audio": case "video": case "file": t = c.reverse(e); break; case "geo": t = u.reverse(e); break; case "notification": t = l.reverse(e); break; case "custom": t = m.reverse(e); break; case "tip": t = d.reverse(e); break; case "robot": t = p.reverse(e); break; default: t = s.reverse(e) }return s.setExtra(t, this.account), t }, o.reverseMsgs = function (e, t) { var n, i, o = this; return e.map(function (e) { return e = o.reverse(e), t && ((n = t.modifyObj) && (e = r.merge(e, n)), i = t.mapper, r.isFunction(i) && (e = i(e))), e }) }, e.exports = i }, function (e, t, n) { function r(e) { e = e || {}; var t = a.copy(e); return t.clientType && (t.clientType = c[t.clientType] || ""), t.serverCustom && (t.custom = JSON.parse(t.serverCustom), "string" == typeof t.custom[0] && (t.custom = t.custom[0]), delete t.serverCustom), t } var i, o = (i = n(22)) && i.__esModule ? i : { default: i }, s = n(3).fn, a = n(0), c = o.default.clientTypeMap; s.processEventService = function (e) { var t = e.content, n = e.error, i = this.options || {}; switch (n && (n.callFunc = "events::processEventService", this.onCustomError("事件服务解包失败", "EVENT_SERVICE_ERROR", n)), e.cmd) { case "pushEvent": if (a.isFunction(i.onpushevents)) { var o = { msgEvents: [r(t.msgEvent)] }; i.onpushevents(o) } break; case "pushEvents": if (a.isFunction(i.onpushevents)) { var s = t.msgEvents; s = { msgEvents: s.map(function (e) { return r(e) }) }, i.onpushevents(s) } } } }, function (e, t, n) { n(3).fn.processFilter = function (e) { switch (e.cmd) { case "sendFilterMsg": this.onSendMsg(e, !0); break; case "filterMsg": this.onMsg(e, !0); break; case "filterSysMsg": this.onSysMsg(e, !0); break; case "sendFilterCustomSysMsg": this.onSendSysMsg(e, !0) } } }, function (e, t, n) { var r = n(3).fn; r.processChatroom = function (e) { switch (e.cmd) { case "getChatroomAddress": this.onChatroomAddress(e) } }, r.onChatroomAddress = function (e) { e.error || (e.obj.address = e.content.address) } }, function (e, t, n) { var r = n(3).fn; r.syncSessionAck = function (e) { var t = this, n = t.db, r = Promise.resolve();[[e.content.p2p, "p2p"], [e.content.team.m_map, "team"]].forEach(function (e) { var i = e[0], o = e[1]; Object.keys(i).forEach(function (e) { var s = o + "-" + e, a = { id: s, ack: i[e] }; n.enable && (r = r.then(function () { return n.putSession(a) }).then(function () { t.markUnreadBySessionAck({ sessionId: s, ack: i[e] }) })), t.mergeSession(a) }) }), t.logger.warn("session::syncSessionAck: parse offline session ack", t.sessionSet); var i = e.content.timetag; n.enable && (r = r.then(function () { return t.db.updateSessionAck(i) }).catch(function (e) { return t.logger.error("sessionAck::syncSessionAck: ", e), Promise.reject(e) })), r.cmd = "sessionAck", t.syncPromiseArray.push(r) }, r.onMarkSessionAck = function (e) { e.error || this.storeSessionAck(e.obj) }, r.syncMarkSessionAck = function (e) { this.storeSessionAck(e.content) }, r.storeSessionAck = function (e) { if (this.options.syncSessionUnread) { var t = this.db, n = (0 === e.scene ? "p2p" : "team") + "-" + e.to, r = e.timetag; if (r <= ((this.findSession(n) || {}).ack || 0)) this.logger.warn("session::storeSessionAck: ack <= ackInMemory", r); else { var i = { id: n, ack: r }; this.mergeSession(i), t.enable && t.updateSession(i), this.logger.info("session::storeSessionAck:", i), this.markUnreadBySessionAck({ sessionId: n, ack: i.ack }) } } }, r.markUnreadBySessionAck = function (e) { var t = e.sessionId, n = e.ack, r = this, i = r.db; if (i.enable) r.pushMsgTask(function () { return i.getMsgCountAfterAck({ shouldCountNotifyUnread: r.options.shouldCountNotifyUnread, sessionId: t, ack: n }).then(function (e) { var n = { id: t, unread: e }; return r.logger.log("session::markUnreadBySessionAck: db.getMsgCountAfterAck done"), r.syncing && r.cacheSyncedSession(n), r.onUpdateSession(n), i.updateSession(n) }) }); else { var o = r.findSession(t); if (o) { var s = o.unreadMsgs; if (s && s.length) { for (var a = 0, c = [], u = s.length - 1; u >= 0; u--) { var l = s[u]; if (!(l.time > n)) break; a++ , c.push(l) } o.unreadMsgs = c, o.unread = a, r.logger.info("session::markUnreadBySessionAck: unread " + a), r.onUpdateSession(o) } } } } }, function (e, t, n) { var r = n(19), i = n(143); e.exports = n(9).getIterator = function (e) { var t = i(e); if ("function" != typeof t) throw TypeError(e + " is not iterable!"); return r(t.call(e)) } }, function (e, t, n) { n(63), n(51), e.exports = n(236) }, function (e, t, n) { e.exports = { default: n(237), __esModule: !0 } }, function (e, t, n) { var r = n(142), i = n(5)("iterator"), o = n(26); e.exports = n(9).isIterable = function (e) { var t = Object(e); return void 0 !== t[i] || "@@iterator" in t || o.hasOwnProperty(r(t)) } }, function (e, t, n) { n(63), n(51), e.exports = n(239) }, function (e, t, n) { e.exports = { default: n(240), __esModule: !0 } }, function (e, t, n) { var r, i = (r = n(140)) && r.__esModule ? r : { default: r }, o = n(3).fn, s = n(0), a = n(55), c = n(4); o.mergeSession = function (e) { e = s.copyWithNull(e); var t = this.sessionSet, n = e.id, r = t[n]; if (r && r.lastMsg && e && e.lastMsg && e.lastMsg.isLocal) { var i = r.lastMsg.time || 0; if ((e.lastMsg.time || 0) < i) return r } return t[n] = s.merge(r, e), e = t[n], s.undef(e.unread) && (e.unread = 0), e }, o.mergeSessions = function (e) { var t = this; (e = e || []).forEach(function (e) { t.mergeSession(e) }) }, o.deleteLocalSession = function (e) { var t = this; s.isArray(e) || (e = [e]), e.forEach(function (e) { delete t.sessionSet[e] }) }, o.onDeleteSessions = function (e) { e.obj = e.obj.sessions.map(function (e) { return a.parse(e) }) }, o.onUpdateSession = function (e) { var t = this; return new Promise(function (n) { e ? (e = t.mergeSession(e), e = s.simpleClone(e), a.trim(e), a.isComplete(e) && (t.logger.info("session::onUpdateSession:", e.id, s.simpleClone(e)), t.options.onupdatesession(e), n(e))) : n(e) }) }, o.setCurrSession = function (e) { e = "" + e, this.currSessionId = e, this.logger.info("session::setCurrSession:", e) }, o.findSession = function (e) { return this.sessionSet[e] }, o.resetSessionUnread = function (e) { e = "" + e; var t = this.db; if (this.findSession(e)) { if (t.enable && t.resetSessionUnread(e), !this.options.autoMarkRead && this.sessionUnreadMsgs && this.sessionUnreadMsgs[e]) { var n = this.sessionUnreadMsgs[e]; this.markMsgRead(n, !0), this.sessionUnreadMsgs[e] = [] } this.onUpdateSession({ id: e, unread: 0 }) } else this.logger.warn("session::resetSessionUnread: no session " + e) }, o.insertLocalSession = function (e) { var t = this, n = t.db, r = t.sessionSet; return new Promise(function (i, o) { var u = e.scene, l = e.to, m = u + "-" + l, d = t.findSession(m); if (d) o(c.sessionExist({ callFunc: "session::insertLocalSession", session: d })); else { var p; if (s.isNumber(e.updateTime)) p = e.updateTime; else { var f, g = []; for (var h in r) r.hasOwnProperty(h) && (f = r[h], s.isNumber(f.updateTime) && g.push(f.updateTime)); p = Math.max.apply(Math, g) + 1, p = Math.max(p, +new Date) } var y = Promise.resolve(); n.enable && (y = n.getMsgs({ sessionId: m, limit: 1 })), y.then(function (e) { if (s.isArray(e) && 1 === e.length) { var r = e[0]; (d = a.genSessionByMsg(r)).updateTime = p } else d = { id: m, scene: u, to: l, updateTime: p, lastMsg: null }; n.enable ? n.putSession(d).then(i, o) : i(d), t.onUpdateSession(d) }) } }) }, o.updateLocalSession = function (e, t) { var n = this; return new Promise(function (r, i) { var o = n.db; if (n.findSession(e.id)) { var a = Promise.resolve(), u = s.filterObj(e, "id lastMsg localCustom unread"); o.enable && (a = o.updateSession(u)), a.then(function (e) { return n.onUpdateSession(e, t) }).then(r, function (e) { i({ callFunc: "session::updateLocalSession", event: e }) }) } else i(c.sessionNotExist({ sessionId: e.id, callFunc: "session::updateLocalSession" })) }) }, o.checkAndUpdateLocalSessionByMsg = function (e) { var t, n = this.db, r = this, o = this.options.syncSessionUnread && e !== this.currSessionId, s = n.getMsgs({ sessionId: e, limit: 1 }), a = n.getSession(e).then(function (i) { if (i) return t = Object.assign({}, i), i.ack = i.ack || 0, o ? n.getMsgs({ sessionId: e, start: i.ack }) : Promise.resolve(); r.logger.error("can't find session that sessionId = " + e) }); return Promise.all([s, a]).then(function (o) { var s, a, c = (0, i.default)(o, 2), u = c[0], l = c[1], m = { id: e }; if (s = t.lastMsg ? t.lastMsg.idClient : null, u && u[0] ? a = (u = u[0]).idClient : (a = null, u = null), s !== a && (m.lastMsg = u), void 0 !== l) { var d = 0; (l = l || []).forEach(function (e) { e.isUnreadable && "in" === e.flow && ("notification" !== e.type || r.options.shouldCountNotifyUnread(msg)) && d++ }), d !== t.unread && (m.unread = d) } return Object.keys(m).length > 1 ? (r.logger.log("session::checkAndUpdateLocalSessionByMsg::needUpdate newSession:", m), n.updateSession(m).then(function (e) { return r.onUpdateSession(m) })) : Promise.resolve(200) }) } }, function (e, t, n) { var r = n(3).fn, i = n(0), o = n(56); r.splitSysMsgs = function (e, t) { for (var n, r = e.length - 1; r >= 0; r--)n = e[r], o.isCustom(n) && (e.splice(r, 1), t.push(n)) }, r.onOfflineSysMsgs = function (e, t) { var n = this, r = e.content.sysMsgs.map(function (e) { return e = o.reverse(e), t && (e.filter = !0), e }); r = r.reverse(), n.markSysMsgRead(r); var i = []; n.splitSysMsgs(r, i); var s = t ? "offlineFilterSysMsgs" : "offlineSysMsgs", a = t ? "offlineFilterCustomSysMsgs" : "offlineCustomSysMsgs"; if (r.length) { var c = n.putSysMsg(r, "offlineSysMsgs").then(function (e) { (r = e).length && (n.logger.info("sysmsg::onOfflineSysMsgs: ", s, r.length, r), n.syncResult[s] = n.syncResult[s] || [], n.syncResult[s] = n.syncResult[s].concat(r)) }).catch(function (e) { return n.logger.error("sysMsg::onOfflineSysMsgs: ", e), Promise.reject(e) }); c.cmd = "sysMsgs", n.syncPromiseArray.push(c) } i.length && (n.logger.info("sysmsg::onOfflineSysMsgs: ", a, i), n.syncResult[a] = n.syncResult[a] || [], n.syncResult[a] = n.syncResult[a].concat(i)) }, r.onSendSysMsg = function (e, t) { var n = e.obj; this.completeSysMsg(n), e.error ? n.status = "fail" : n.status = "success", n = o.reverse(n), t && (e.obj.filter = !0), e.obj = n }, r.completeSysMsg = function (e) { return e.from = this.account, e }, r.onSysMsg = function (e, t) { var n = o.reverse(e.content.sysMsg); this.markSysMsgRead(n), t && (n.filter = !0), o.isCustom(n) ? (this.logger.info("sysmsg::onSysMsg: on customSysMsg", n), this.options.oncustomsysmsg(n)) : this.syncing ? this.unhandledSysMsgs.push(n) : this.handleSysMsg(n) }, r.handleSysMsg = function (e) { var t = this, n = e.type, r = e.from; t.sysMsgPromise = t.sysMsgPromise.then(function () { return t.putSysMsg(e, "onSysMsg") }).then(function (t) { e = t[0] }).then(function () { if (e) { var i, o = Promise.resolve(); switch (n) { case "addFriend": i = { type: "addFriend", account: r }, o = t.onFriendRequest(i); break; case "passFriendApply": i = { type: "passFriendApply", account: r }, o = t.onFriendRequest(i); break; case "deleteFriend": o = t.onDeleteFriend({ account: r }) }return i && i.friend && (e.friend = i.friend), o } }).then(function () { e && (t.logger.info("sysmsg::handleSysMsg: ", n, e), setTimeout(function () { t.options.onsysmsg(e) }, 0)) }) }, r.putSysMsg = function (e, t) { if (i.isArray(e) || (e = [e]), e[0].filter) return Promise.resolve(e); var n = this, r = n.db, o = r.enable, s = Promise.resolve(), a = []; return (s = (s = s.then(function () { return o ? r.putSysMsg(e) : e }).then(function (t) { var r = []; e.forEach(function (e) { n.checkSysMsgUnique(e) && r.push(e) }), e = r, a = o ? t : e })).then(function () { return n.getSysMsgUnread().then(function (r) { return a.length || ((a = e).backward = !0), n.updateSysMsgUnread(a, r, 1).then(function (e) { "offlineSysMsgs" === t && (n.syncResult.sysMsgUnread = e), "onSysMsg" === t && n.onUpdateSysMsgUnread(e) }) }) })).then(function () { return e }) }, r.checkSysMsgUnique = i.genCheckUniqueFunc("idServer"), r.getSysMsgUnread = function () { var e = this, t = e.db; return new Promise(function (n) { t.enable ? t.getSysMsgUnread().then(function (e) { n(e) }, function () { n(e.sysMsgUnread) }) : n(e.sysMsgUnread) }) }, r.updateSysMsgUnread = function (e, t, n) { if (i.isArray(e) || (e = [e]), !e.length) return Promise.resolve(t); t = t || {}; var r, s = this.db; return e.forEach(function (e) { (n > 0 && !e.read || n < 0 && e.read) && (r = e.type, t[r] = (t[r] || 0) + n) }), t = o.completeUnread(t), this.sysMsgUnread = t, s.enable && !e.backward ? s.updateSysMsgUnread(t) : Promise.resolve(t) }, r.reduceSysMsgUnread = function (e) { var t = this; return t.getSysMsgUnread().then(function (n) { return t.updateSysMsgUnread(e, n, -1) }).then(function (e) { t.onUpdateSysMsgUnread(e) }) }, r.onUpdateSysMsgUnread = function (e) { var t = this; setTimeout(function () { t.logger.info("sysmsg::onUpdateSysMsgUnread:", e), t.options.onupdatesysmsgunread(e) }, 0) }, r.updateSysMsg = function (e) { var t = this, n = t.db; (n.enable ? n.updateSysMsg(e) : Promise.resolve(e)).then(function (e) { t.onUpdateSysMsg(e) }) }, r.onUpdateSysMsg = function (e) { var t = this; setTimeout(function () { i.isArray(e) || (e = [e]), e.forEach(function (e) { t.logger.info("sysmsg::onUpdateSysMsg:", e), t.options.onupdatesysmsg(e) }) }, 0) }, r.processUnsettledSysMsgs = function () { var e = this; e.unhandledSysMsgs.forEach(function (t) { e.handleSysMsg(t) }), e.resetUnsettledSysMsgs() } }, function (e, t, n) { var r = n(3).fn, i = n(56), o = n(55), s = n(0); r.onDeleteMsg = function (e) { var t = this.db; delete e.obj.sysMsg, e.error || (e.promise = this.deleteLocalMsg(e.obj.msg).then(function () { var n = e.obj.msg; t.enable && t.getTimetag("deleteMsg").then(function (e) { e = e || 0, n.time >= e && t.updateDeleteMsgTimetag((new Date).getTime()) }) })) }, r.onMsgDeleted = function (e) { if (!e.error) { var t = this, n = t.db, r = i.reverse(e.content.sysMsg); r = t.processDeleteMsgSysMsg(r), t.markSysMsgRead(r), t.deleteLocalMsg(r.msg).then(function () { n.enable && n.updateDeleteMsgTimetag(r.time + 1), t.handleSysMsg(r) }) } }, r.processDeleteMsgSysMsg = function (e) { return e.msg = {}, ["scene", "from", "to"].forEach(function (t) { e.msg[t] = e[t] }), e.msg.idClient = e.deletedIdClient, e.msg.idServer = e.deletedIdServer, e.msg.time = e.deletedMsgTime, e.msg.fromNick = e.deletedMsgFromNick, e.opeAccount = e.opeAccount || e.from, e.msg.opeAccount = e.opeAccount, this.message.Message.setExtra(e.msg, this.account), e }, r.onDeleteMsgOfflineRoaming = function (e) { if (!e.error) { var t = this, n = 1 == +e.content.type ? "offline" : "roaming", r = i.reverseSysMsgs(e.content.sysMsgs, { mapper: function (e) { return t.processDeleteMsgSysMsg(e) } }); t.logger.info("msg::onDeleteMsgOfflineRoaming: on delete " + n, r), "offline" === n && t.markSysMsgRead(r); var o = e.content.timetag; t.timetags.deleteMsg = o, t.syncResult.deleteMsgTimetag = o; var s = t.putSysMsg(r, "offlineSysMsgs").catch(function (e) { return t.logger.error("msgDelete::onDeleteMsgOfflineRoaming: ", e), Promise.reject(e) }); s.cmd = "deleteMsgSysMsgs " + n, t.syncPromiseArray.push(s), t.syncResult.deleteMsgSysMsgs = t.syncResult.deleteMsgSysMsgs || [], t.syncResult.deleteMsgSysMsgs.push({ type: n, sysMsgs: r }) } }, r.deleteMsgOfflineRoaming = function (e, t) { if (!e) return Promise.resolve(); var n = this; n.logger.info("msg::deleteMsgOfflineRoaming: ", e, t); var r = n.db, i = []; return e.forEach(function (e) { e.sysMsgs.forEach(function (e) { var a = n.deleteLocalMsg(e.msg, { cbUpdateSession: function (e) { e = n.mergeSession(e), e = s.simpleClone(e), o.trim(e); var i = s.findObjIndexInArray(t, { value: e.id }); if (-1 !== i && (t[i] = s.merge({}, t[i], e)), r.enable) return r.updateSession(e) } }); i.push(a) }) }), Promise.all(i).then(function () { if (r.enable) return r.updateDeleteMsgTimetag(n.syncResult.deleteMsgTimetag) }) }, r.deleteLocalMsg = function (e, t) { var n = this, r = n.db, i = (t = t || {}).cbUpdateSession || n.updateLocalSession.bind(n); if (r.enable && e) { var o = !1, s = null, a = null, c = e.sessionId; return r.getMsgs({ sessionId: c, limit: 1 }).then(function (t) { t && t[0] && t[0].idClient === e.idClient && (o = !0) }).then(function () { return r.getMsgByIdClient(e.idClient) }).then(function (t) { return a = t, r.deleteMsg(e.idClient) }).then(function () { if (o) return r.getMsgs({ sessionId: c, limit: 1 }) }).then(function (e) { o && e && e[0] && (s = e[0]) }).then(function () { if (n.options.rollbackDelMsgUnread) return r.getSessions({ sessionId: c }) }).then(function (e) { var t = { id: c }; o && (t.lastMsg = s); var r = e && e.msgReceiptTime || 0; return e && a && r < a.time && n.options.account === a.to && e.unread && (n.logger.log("msgDelete::deleteLocalMsg:db.getSessions: ", e), t.unread = e.unread - 1), i(t) }) } if (n.options.rollbackDelMsgUnread && e && e.sessionId) { var u = n.findSession(e.sessionId), l = u.msgReceiptTime || 0; u && l < e.time && n.options.account === e.to && u.unread && (n.logger.log("msgDelete::deleteLocalMsg:getSessions: ", u), u.unread = u.unread - 1, n.onUpdateSession(u)) } return Promise.resolve() } }, function (e, t, n) { var r = n(3).fn, i = n(0); r.onOfflineMsgReceipts = function (e) { var t, n = this, r = n.db, i = e.content.msgReceipts, o = n.syncResult.msgReceipts = [], s = [], a = "msgReceipts", c = n.syncResult.sessions || {}; i.forEach(function (e) { e.time = +e.time; var i = e.sessionId = "p2p-" + e.from; a += "-" + i, t = Promise.resolve(); var u = c[i]; r.enable ? t = r.getSession(i).then(function (t) { if ((t = t || u) && n.shouldUpdateSessionFromMsgReceipt(t, e)) { var o = n.genSessionFromMsgReceipt(t, e), s = n.syncResult.sessions; return s && s[i] && (s = s[i]).lastMsg && o.lastMsg && s.lastMsg.time > o.lastMsg.time && (o.lastMsg = s.lastMsg), r.putSession(o).then(function (e) { e && n.cacheSyncedSession(e) }) } }).catch(function (e) { return n.logger.error("msgReceipt::onOfflineMsgReceipt: ", e), Promise.reject(e) }) : u && o.push(e), s.push(t) }), (t = Promise.all(s).then(function () { if (r.enable) return r.updateMsgReceiptsTimetag(e.content.timetag) })).cmd = a, n.syncPromiseArray.push(t) }, r.mergeSessionAndMsgReceipts = function (e, t) { var n = this, r = {}; return t = t || [], (e = e || []).forEach(function (e) { r[e.id] = e }), t.forEach(function (t) { var i = r[t.sessionId]; if (n.shouldUpdateSessionFromMsgReceipt(i, t)) { var o = n.genSessionFromMsgReceipt(i, t); e = n.api.mergeSessions(e, o) } }), e }, r.shouldUpdateSessionFromMsgReceipt = function (e, t) { return !e || !e.msgReceiptServerTime || t.time > e.msgReceiptServerTime }, r.genSessionFromMsgReceipt = function (e, t) { var n = t.time, r = { id: t.sessionId, msgReceiptTime: n, msgReceiptServerTime: n }; return e && e.id === t.sessionId && (r = i.merge({}, e, r)), e && e.updateTime || (r.updateTime = n), r }, r.onMsgReceipt = function (e) { var t = this, n = t.db, r = e.content.msgReceipt; r.time = +r.time; var i = r.idClient, o = Promise.resolve(); n.enable && i && (o = n.getMsgByIdClient(i)), o.then(function (e) { var n; if (e) { if (!e.idServer) return void (t.msgReceiptTasks[i] = r); n = e.time } else n = r.time; r.msgReceiptTime = n, t.updateSessionMsgReceiptTime(r) }) }, r.resolveMsgReceiptTask = function (e) { var t = this.msgReceiptTasks[e.idClient]; t && (t.msgReceiptTime = e.time, this.updateSessionMsgReceiptTime(t)) }, r.updateSessionMsgReceiptTime = function (e) { var t = this.db, n = { id: "p2p-" + e.from, msgReceiptTime: e.msgReceiptTime, msgReceiptServerTime: e.time }; t.enable && t.putSession(n), this.onUpdateSession(n) }, r.onSendMsgReceipt = function (e) { if (!e.error) { var t = e.obj.msgReceipt, n = +t.time, r = +e.content.msgReceipt.time; this.sessionSet["p2p-" + t.to].msgReceiptSendTime = Math.min(n, r) } }, r.shouldSendMsgReceipt = function (e) { if (e && "p2p" === e.scene && "success" === e.status) { var t = this.sessionSet[e.sessionId]; if (t) { var n = t.msgReceiptSendTime; return !n || n < e.time } } return !1 }, r.isMsgRemoteRead = function (e) { if (e && "p2p" === e.scene && "out" === e.flow && "success" === e.status) { var t = this.sessionSet[e.sessionId]; if (t && t.msgReceiptTime) return e.time <= t.msgReceiptTime } return !1 } }, function (e, t, n) { var r = n(3).fn, i = n(0), o = i.undef, s = n(22), a = n(49), c = n(76), u = n(55), l = n(97); r.processMsg = function (e) { switch (e.cmd) { case "sendMsg": this.onSendMsg(e); break; case "msg": this.onMsg(e); break; case "sysMsg": this.onSysMsg(e); break; case "broadcastMsg": this.onBroadcastMsg(e); break; case "sendCustomSysMsg": this.onSendSysMsg(e); break; case "getHistoryMsgs": case "searchHistoryMsgs": this.onHistoryMsgs(e); break; case "syncSendMsg": this.onMsg(e); break; case "deleteSessions": this.onDeleteSessions(e); break; case "sendMsgReceipt": this.onSendMsgReceipt(e); break; case "msgReceipt": this.onMsgReceipt(e); break; case "onDeleteMsg": this.onDeleteMsg(e); break; case "onMsgDeleted": this.onMsgDeleted(e); break; case "onDeleteMsgOfflineRoaming": this.onDeleteMsgOfflineRoaming(e); break; case "onMarkSessionAck": this.onMarkSessionAck(e); break; case "syncMarkSessionAck": this.syncMarkSessionAck(e) } }, r.checkIgnore = function (e) { var t = this; e.forEach(function (e) { "notification" === e.type && !e.ignore && t.options.shouldIgnoreNotification(e) && (e.ignore = !0) }) }, r.filterIgnore = function (e) { return e.filter(function (e) { return !e.ignore }) }, r.genSessionByMsgs = function (e) { return this.checkIgnore(e), u.genSessionByMsgs(this.message.Message, e) }, r.onRoamingMsgs = function (e) { var t = this, n = t.message, r = n.Message, i = r.getMaxTimetag, o = n.reverseMsgs(e.content.msgs), s = i(o); o = r.sortMsgs(o); var a = (o = r.deduplication(o))[0], c = a.sessionId, u = t.genSessionByMsgs(o); t.cacheSyncedSession(u); var l = t.putMsg(o, "roamingMsgs").then(function (e) { o = e, (o = t.filterIgnore(o)).length && (t.logger.info("msg::onRoamingMsgs: putRoamingMsgs", c, o.length, o), t.syncResult.roamingMsgs = t.syncResult.roamingMsgs || [], t.syncResult.roamingMsgs.push({ sessionId: c, scene: a.scene, to: a.target, msgs: o, timetag: s }), t.syncing || t.onSyncDone()) }).catch(function (e) { return t.logger.error("msg::onRoamingMsgs: ", e), Promise.reject(e) }); l.cmd = "roamingMsgs-" + c, t.syncPromiseArray.push(l) }, r.onOfflineMsgs = function (e, t) { function n(e) { if (l.length) { var t = o.getMaxTimetag(l), n = l[0].scene, i = l[0].target; r.markMsgRead(l), l = o.sortMsgs(l), l = o.deduplication(l); var s = r.genSessionByMsgs(l); r.cacheSyncedSession(s), (c = r.putMsg(l, "offlineMsgs").then(function (o) { l = o, (l = r.filterIgnore(l)).length && (r.logger.info("msg::onOfflineMsgs： toreLastSession", d, e, l.length, l), r.syncResult[d] = r.syncResult[d] || [], r.syncResult[d].push({ sessionId: e, scene: n, to: i, msgs: l, timetag: t })) }).catch(function (e) { return r.logger.error("msg::onOfflineMsgs: ", e), Promise.reject(e) })).cmd = "offlineMsgs-" + e, r.syncPromiseArray.push(c) } } var r = this, i = r.message, o = i.Message, s = null; t && (s = { filter: !0 }); var a, c, u = i.reverseMsgs(e.content.msgs, { modifyObj: s }), l = [], m = "", d = t ? "offlineFilterMsgs" : "offlineMsgs"; u.forEach(function (e) { (a = e.sessionId) !== m ? (n(m), (l = []).push(e), m = a) : l.push(e) }), n(m) }, r.markUnreadByMsgsPromise = function (e) { var t = this, n = t.db; n.enable && n.getSession(e).then(function (n) { n.ack && t.markUnreadBySessionAck({ sessionId: e, ack: n.ack }) }) }, r.completeMsg = function (e) { return e.from = this.account, e.fromNick = this.myInfo && this.myInfo.nick, e.fromClientType = "Web", e.fromDeviceId = s.deviceId, e.time || (e.time = +new Date), e }, r.onMsgs = function (e) { var t = this; t.message.reverseMsgs(e.content.msgs, { mapper: function (e) { t.handleMsg(e) } }) }, r.onMsg = function (e, t) { var n = this.message.reverse(e.content.msg); t && (n.filter = !0), this.syncing ? (this.logger.log("msg::onMsg:is in syncing ..."), this.unhandledMsgs.push({ type: "onMsg", msg: n })) : this.handleMsg(n) }, r.onBroadcastMsgs = function (e) { var t = e.content.broadcastMsgs; t = t.sort(function (e, t) { return e.broadcastId - t.broadcastId }), this.putBroadcastMsgs(t) }, r.onBroadcastMsg = function (e) { var t = e.content.broadcastMsg; t.time = t.timestamp, this.syncing ? this.unhandledMsgs.push({ type: "onBroadcastMsg", msg: t }) : t && this.putBroadcastMsg(t) }, r.pushMsgTask = function (e) { this.msgPromise = this.msgPromise.then(function () { return e() }) }, r.handleMsg = function (e) { var t = this, n = t.db, r = e.time; t.markMsgRead(e), t.msgPromise = t.msgPromise.then(function () { return t.putMsg(e, "onMsg") }).then(function (i) { if (t.logger.log("msg::handleMsg:putMsg: ", e), !n.enable) return Promise.resolve(); var o = n.updateRoamingMsgTimetag(r), s = Promise.resolve(); return "superTeam" === e.scene && (s = n.updateSuperTeamRoamingMsgTimetag(r)), Promise.all([o, s]) }).then(function () { if (t.logger.log("msg::handleMsg:updateRoamingMsgTimetag: ", r, e), e) return t.checkUserUpdate(e) }).then(function () { if (e) { var n = e.type; switch (t.logger.log("msg::handleMsg:checkUserUpdate: " + e.scene + " " + n + " msg" + ("notification" === n ? " " + e.attach.type : ""), e), n) { case "notification": return t.onTeamNotificationMsg(e) } } }).then(function () { e && !e.ignore && (t.logger.info("msg::handleMsg:onmsg: ", e), setTimeout(function () { t.options.onmsg(i.copy(e)) }, 0)) }).then(void 0, function (e) { e.callFunc = "msg::handleMsg", t.onCustomError("消息处理错误", e) }) }, r.putMsg = function (e, t) { function n(e) { "roamingMsgs" !== t && "offlineMsgs" !== t || r.cacheSyncedSession(e) } if (i.isArray(e) || (e = [e]), e[0].filter) return Promise.resolve(e); var r = this, s = r.db, a = s.enable, c = Promise.resolve(), u = r.message.Message.getLastMsg(e), l = u.flow, m = u.sessionId !== r.currSessionId, d = r.genSessionByMsgs(e); n(d); var p = !1, f = []; return r.checkIgnore(e), r.logger.log("start"), c = (c = (c = c.then(function () { return a || r.options.autoMarkRead || "roamingMsgs" === t || !d || (r.sessionUnreadMsgs = r.sessionUnreadMsgs || {}, r.sessionUnreadMsgs[d.id] = r.sessionUnreadMsgs[d.id] || [], r.sessionUnreadMsgs[d.id] = r.sessionUnreadMsgs[d.id].concat(e.filter(function (e) { return r.options.shouldCountNotifyUnread(e) }))), a && "roamingMsgs" !== t && "offlineMsgs" !== t ? (r.logger.log("msg::putMsg:db.putMsg: ", d), s.putMsg(e)) : e }).then(function (t) { var n = []; return e.forEach(function (e) { r.checkMsgUnique(e) && n.push(e) }), e = n, f = a ? t : e, Promise.resolve(e) })).then(function (e) { return e.length && (n(d = r.genSessionByMsgs(e)), a && d) ? new Promise(function (t, n) { s.getSessions({ sessionId: d.id }).then(function (n) { if (n && n.lastMsg) { var i = n.lastMsg; d.lastMsg && d.lastMsg.time < i.time && (d.lastMsg = i) } r.logger.log("msg::putMsg:db.getSessions: ", d), f.length ? d ? s.putSession(d).then(function (e) { t(e) }) : t(n) : (p = !0, f = e, t(n)) }) }) : Promise.resolve(d) })).then(function (e) { if (d && f.length) { var i = "roamingMsgs" === t, c = r.options.syncSessionUnread, u = d.id, g = r.findSession(u) || {}, h = g.ack || 0; if ("offlineMsgs" === t || i && c || "onMsg" === t && "in" === l && m) { a && e ? (d = e, h = h || d.ack || 0) : (e = g) && (d.unread = e.unread || 0), n(d), d.unread = d.unread || 0; var y = 0; if (f.forEach(function (e) { var t = r.options.shouldCountNotifyUnread(e), n = ("notification" !== e.type || "notification" === e.type && t) && (o(e.isUnreadable) || e.isUnreadable); if (n && c && (n = e.time > h && "out" !== e.flow), n && (y++ , c && !a)) { var i = g.unreadMsgs || []; i.push(e), d.unreadMsgs = i } }), d.unread += y, r.logger.log("msg::putMsg:updateSession: ", d), n(d), a && !p) return s.updateSession({ id: d.id, unread: d.unread }) } } }), "onMsg" === t ? c = c.then(function () { e.length && d && (r.onUpdateSession(d), r.options.syncSessionUnread && !m && r.api.resetSessionUnread(r.currSessionId)) }) : "sendMsg" === t && !m && d && d.lastMsg && d.lastMsg.isLocal && (r.onUpdateSession(d), r.api.resetSessionUnread(r.currSessionId)), c.then(function () { return Promise.resolve(e) }) }, r.putBroadcastMsgs = function (e) { var t = this, n = t.db, r = e.length; if (r > 0) { if (t.doMarkBroadcastMsgsRead(e), n.enable) { var o = e[r - 1].broadcastId; return n.updateBroadcastMsgTimetag(o), n.putBroadcastMsg(e).then(function () { return setTimeout(function () { t.doMarkMsgsRead(), t.options.onbroadcastmsgs(i.copy(e)) }, 0), Promise.resolve(e) }) } setTimeout(function () { t.options.onbroadcastmsgs(i.copy(e)) }, 0) } return e }, r.putBroadcastMsg = function (e) { var t = this, n = t.db; return t.doMarkBroadcastMsgsRead([e]), n.enable ? (e.broadcastId && n.updateBroadcastMsgTimetag(e.broadcastId), n.putBroadcastMsg(e).then(function () { return setTimeout(function () { t.options.onbroadcastmsg(i.copy(e)) }, 0), Promise.resolve(e) })) : (setTimeout(function () { t.options.onbroadcastmsg(i.copy(e)) }, 0), e) }, r.doMarkBroadcastMsgsRead = function (e) { e = e.map(function (e) { return e.broadcastId }), this.sendCmd("batchMarkRead", { sid: 7, cid: 17, ids: e }) }, r.cacheSyncedSession = function (e) { if (e && this.syncResult) { e = i.merge({}, e), this.syncResult.sessions = this.syncResult.sessions || {}; var t = e.id; this.syncResult.sessions[t] = i.merge(this.syncResult.sessions[t], e), o(this.syncResult.sessions[t].unread) && (this.syncResult.sessions[t].unread = 0), this.mergeSession(this.syncResult.sessions[t]) } }, r.checkMsgUnique = i.genCheckUniqueFunc("idClient"), r.storeSendMsg = function (e) { if (!this.syncing) { var t = this.putMsg(e, "sendMsg"); return this.msgPromise = this.msgPromise.then(function () { return t }), t } this.unhandledMsgs.push({ type: "sendMsg", msg: e }) }, r.updateSendMsgError = function (e) { if (!this.syncing) { var t = this.updateMsg(e); return this.msgPromise = this.msgPromise.then(function () { return t }), t } this.unupdatedMsgs.push(e) }, r.onSendMsg = function (e, t) { function n() { r.completeMsg(i); var n = e.error && 7101 === e.error.code; e.error && !n || (i.idServer = e.content.msg.idServer, i.time = +e.content.msg.time), e.error ? i.status = "fail" : i.status = "success", i = r.message.reverse(i), t && (i.filter = !0), e.obj = i, r.syncing ? r.unupdatedMsgs.push(i) : r.msgPromise = Promise.all([r.msgPromise, e.obj.promise]).then(function (e) { return e.length || (i.resend = !0), r.updateMsg(i).then(function () { return r.options.syncSessionUnread && r.currSessionId === i.sessionId && r.api.resetSessionUnread(r.currSessionId), r.resolveMsgReceiptTask(i), i }) }) } var r = this, i = e.obj && e.obj.msg || e.content.msg; if (e.obj) n(); else { var o = r.db; o && o.enable && o.getMsgByIdClient(i.idClient).then(function (e) { e && (i = e, n()) }, function (e) { n() }) } }, r.updateLocalMsg = function (e) { var t = this.updateMsg(e); return this.msgPromise = this.msgPromise.then(function () { return t }), t }, r.updateMsg = function (e) { if (e.filter) return Promise.resolve(e); var t = this, n = t.db, r = "success" === e.status, i = u.genSessionByMsg(e), o = !!e.isLocal; return n.enable ? n.updateMsg(e).then(function (s) { var a = n.updateSession(i), c = Promise.resolve(), u = Promise.resolve(); return r && s && !o && (c = n.updateRoamingMsgTimetag(s.time), "superTeam" === e.scene && (u = n.updateSuperTeamRoamingMsgTimetag(s.time))), t.onUpdateSession(i), Promise.all([a, c, u]) }) : (r && !o && (t.timetags.roamingMsgs = e.time), t.onUpdateSession(i), Promise.resolve(e)) }, r.updateRoamingMsgTimetag = function (e) { var t = this.db; return t.enable ? t.updateRoamingMsgTimetag(e) : (this.timetags.roamingMsgs = e, Promise.resolve(e)) }, r.checkUserUpdate = function (e) { var t = this, n = e.from; return n === t.account ? Promise.resolve() : new Promise(function (r) { function o() { t.api.getUser({ account: n, sync: !0, done: function (e, n) { e || setTimeout(function () { t.logger.log("user::checkUserUpdate: onupdateuser", n.account, n), t.options.onupdateuser(n) }, 0), r() } }) } var s = t.userSet[n]; if (s) { var a = +s.updateTime, c = +e.userUpdateTime; !isNaN(a) && !isNaN(c) && i.isNumber(a) && i.isNumber(c) && a < c ? o() : r() } else o() }) }, r.processUnsettledMsgs = function () { var e = this; e.unhandledMsgs.forEach(function (t) { var n = t.msg; switch (t.type) { case "onMsg": e.handleMsg(n); break; case "sendMsg": e.msgPromise = e.msgPromise.then(function () { return e.putMsg(n) }); break; case "onBroadcastMsg": e.msgPromise = e.msgPromise.then(function () { return e.putBroadcastMsg(n) }) } }), e.unupdatedMsgs.forEach(function (t) { e.msgPromise = e.msgPromise.then(function () { return e.updateMsg(t) }) }), e.resetUnsettledMsgs() }, r.onTeamNotificationMsg = function (e) { this.db; var t = e.attach, n = t.type, r = e.from, i = e.to, o = e.time, s = t.team, a = t.account, c = t.accounts; switch (n) { case "updateTeam": return s.updateTime = o, this.onUpdateTeam(s); case "addTeamMembers": return this.onAddTeamMembers(e, s, c); case "removeTeamMembers": return this.onRemoveTeamMembers(s, i, c); case "acceptTeamInvite": return this.onAddTeamMembers(e, s, [r]); case "passTeamApply": return this.onAddTeamMembers(e, s, [a]); case "addTeamManagers": return this.updateTeamManagers(e, i, c, !0, o); case "removeTeamManagers": return this.updateTeamManagers(e, i, c, !1, o); case "leaveTeam": return this.onRemoveTeamMembers(s, i, [r]); case "dismissTeam": return this.onDismissTeam(i, o); case "transferTeam": return this.transferTeam(e, s, r, a); case "updateTeamMute": return this.onUpdateTeamMembersMute(e, s, [a], t.mute); case "updateSuperTeam": return s.updateTime = o, this.onUpdateSuperTeam(s); case "addSuperTeamMembers": return this.onAddSuperTeamMembers(e, s, c); case "removeSuperTeamMembers": return this.onRemoveSuperTeamMembers(s, i, c); case "leaveSuperTeam": return this.onRemoveSuperTeamMembers(s, i, [r]); case "dismissSuperTeam": return this.onDismissSuperTeam(i, o); case "transferSuperTeam": return this.transferSuperTeam(e, s, r, a); case "addSuperTeamManagers": return this.updateSuperTeamManagers(e, i, c, !0, o); case "removeSuperTeamManagers": return this.updateSuperTeamManagers(e, i, c, !1, o); case "updateSuperTeamMembersMute": return this.onUpdateSuperTeamMembersMute(e, s, c, t.mute) } }, r.onAddSuperTeamMembers = function (e, t, n) { var r = this.db, o = (t.teamId, c.assembleMembers(t, n)); e.attach.members = o; var s = { team: t, accounts: n, members: o }; if (this.logger.info("team::onAddSuperTeamMembers: ", s), this.options.onAddSuperTeamMembers(i.simpleClone(s)), r.enable) { var a = r.putSuperTeamMembers(o), u = Promise.resolve(); return n.indexOf(this.account) > -1 && t && (u = r.putSuperTeam(t)), Promise.all([a, u]) } }, r.onRemoveSuperTeamMembers = function (e, t, n) { var r = this.db, o = { team: e, accounts: n }; if (this.logger.info("team::onRemoveSuperTeamMembers:", o), this.options.onRemoveSuperTeamMembers(i.simpleClone(o)), r.enable) { if (-1 === n.indexOf(this.account)) { var s = r.removeSuperTeamMembersByAccounts(t, n), a = Promise.resolve(); return e && (a = r.putSuperTeam(e)), Promise.all([s, a]) } return r.leaveSuperTeam(t) } }, r.onDismissSuperTeam = function (e, t) { var n = this.db, r = { teamId: e }; if (this.logger.info("team::onDismissSuperTeam:", r), this.options.onDismissSuperTeam(r), n.enable) return n.dismissSuperTeam(e, t) }, r.onAddTeamMembers = function (e, t, n) { var r = this, o = r.db, s = t.teamId, c = a.assembleMembers(t, n); e.attach.members = c; var u = { team: t, accounts: n, members: c }; if (r.logger.info("team::onAddTeamMembers: ", u), r.options.onAddTeamMembers(i.simpleClone(u)), o.enable) { var l, m = o.putTeam(t); return -1 === n.indexOf(r.account) ? l = o.putTeamMembers(c) : (r.logger.warn("team::onAddTeamMembers: user join team", s), m = new Promise(function (e) { r.api.getTeamMembers({ teamId: s, sync: !0, done: function () { e() } }) })), Promise.all([l, m]) } }, r.onRemoveTeamMembers = function (e, t, n) { var r = this.db, o = { team: e, accounts: n }; if (this.logger.info("team::onRemoveTeamMembers:", o), this.options.onRemoveTeamMembers(i.simpleClone(o)), r.enable) { if (-1 === n.indexOf(this.account)) { var s = r.removeTeamMembersByAccounts(t, n), a = Promise.resolve(); return e && (a = r.putTeam(e)), Promise.all([s, a]) } return r.leaveTeam(t) } }, r.updateTeamManagers = function (e, t, n, r, o) { var s = this.db, c = e.attach.members = n.map(function (e) { return { id: a.genId(t, e), type: r ? "manager" : "normal", updateTime: o } }), u = { teamId: "" + t, memberUpdateTime: o }; e.attach.team = u; var l = { team: u, accounts: n, isManager: r, members: c }; if (this.logger.info("team::updateTeamManagers:", l), this.options.onUpdateTeamManagers(i.simpleClone(l)), s.enable) { var m = s.updateTeam(u), d = s.updateTeamManagers(t, n, r, o); return Promise.all([m, d]) } }, r.updateSuperTeamManagers = function (e, t, n, r, o) { var s = this.db, c = e.attach.members = n.map(function (e) { return { id: a.genId(t, e), teamId: t, account: e, type: r ? "manager" : "normal", updateTime: o } }), u = { teamId: "" + t, memberUpdateTime: o }; e.attach.team = u; var l = { team: u, accounts: n, isManager: r, members: c }; if (this.logger.info("team::updateSuperTeamManagers:", l), this.options.onUpdateSuperTeamManagers(i.simpleClone(l)), s.enable) { var m = s.updateSuperTeam(u), d = s.updateSuperTeamMembers(c); return Promise.all([m, d]) } }, r.onDismissTeam = function (e, t) { var n = this.db, r = { teamId: e }; if (this.logger.info("team::onDismissTeam:", r), this.options.onDismissTeam(r), n.enable) return n.dismissTeam(e, t) }, r.transferTeam = function (e, t, n, r) { var o = this.db, s = t.teamId, c = t.memberUpdateTime, u = { id: a.genId(s, n), type: "normal", updateTime: c }, l = { id: a.genId(s, r), type: "owner", updateTime: c }; e.attach.members = [u, l]; var m = { team: t, from: u, to: l }; if (this.logger.info("team::transferTeam:", m), this.options.onTransferTeam(i.simpleClone(m)), o.enable) return o.transferTeam(t, n, r) }, r.transferSuperTeam = function (e, t, n, r) { var o = this.db, s = t.teamId, a = t.memberUpdateTime, c = { teamId: s, type: "normal", account: n, updateTime: a }, u = { teamId: s, type: "owner", account: r, updateTime: a }; e.attach.members = [c, u]; var l = { team: t, from: c, to: u }; if (this.logger.info("team::transferSuperTeam:", l), this.options.onTransferSuperTeam(i.simpleClone(l)), o.enable) return o.transferSuperTeam(t, c, u) }, r.onUpdateTeamMembersMute = function (e, t, n, r) { var o = this.db, s = n.map(function (e) { return { id: a.genId(t.teamId, e), account: e, teamId: t.teamId, mute: r, updateTime: t.memberUpdateTime } }); e.attach.members = s; var c = { team: t, accounts: n, members: s, mute: r }; if (this.logger.info("team::onUpdateTeamMembersMute:", c), this.options.onUpdateTeamMembersMute(i.simpleClone(c)), o.enable) { var u = o.updateTeamMembers(s), l = o.putTeam(t); return Promise.all([u, l]) } }, r.onUpdateSuperTeamMembersMute = function (e, t, n, r) { var o = this.db, s = n.map(function (e) { return { id: c.genId(t.teamId, e), account: e, teamId: t.teamId, mute: r, updateTime: t.memberUpdateTime } }); e.attach.members = s; var a = { team: t, accounts: n, members: s, mute: r }; if (this.logger.info("team::onUpdateSuperTeamMembersMute:", a), this.options.onUpdateSuperTeamMembersMute(i.simpleClone(a)), o.enable) { var u = o.updateSuperTeamMembers(s), l = o.putSuperTeam(t); return Promise.all([u, l]) } }, r.onHistoryMsgs = function (e) { e.error || (e.obj.msgs = this.message.reverseMsgs(e.content.msgs)) }, r.isFilterMsgs = function (e) { return !!e[0].filter }, r.splitMsgs = function (e, t, n, r) { e.forEach(function (e) { if (e.filter) r.push(e); else switch (e.scene) { case "p2p": t.push(e); break; case "team": n.push(e) } }) }, r.markMsgRead = function (e, t) { if (i.isArray(e) || (e = [e]), this.db.enable || this.options.autoMarkRead || t) { var n = [], r = [], o = []; this.splitMsgs(e, n, r, o), this.markP2pMsgsRead(n), this.markTeamMsgsRead(r), this.markFilterMsgsRead(o) } }, r.markP2pMsgsRead = function (e) { if (e.length) { var t = l.idMap.msg.id, n = l.idMap.msg.msg; this.doMarkMsgsRead(t, n, e) } }, r.markTeamMsgsRead = function (e) { if (e.length) { var t = l.idMap.team.id, n = l.idMap.team.teamMsg; this.doMarkMsgsRead(t, n, e) } }, r.markFilterMsgsRead = function (e) { if (e.length) { var t = l.idMap.filter.id, n = l.idMap.filter.filterMsg; this.doMarkMsgsRead(t, n, e) } }, r.markSysMsgRead = function (e, t) { var n, r; i.isArray(e) || (e = [e]), (this.db.enable || this.options.autoMarkRead || t) && (this.isFilterMsgs(e) ? (n = l.idMap.filter.id, r = l.idMap.filter.filterSysMsg) : (n = l.idMap.msg.id, r = l.idMap.msg.sysMsg), this.doMarkMsgsRead(n, r, e)) }, r.doMarkMsgsRead = function (e, t, n) { n && n.length && (!n[0].attach || "netcallBill" !== n[0].attach.type && "netcallMiss" !== n[0].attach.type || (e = 9, t = 11), this.sendCmd("batchMarkRead", { sid: e, cid: t, ids: n.map(function (e) { return e.idServer }) })) } }, function (e, t, n) { var r = n(3).fn, i = n(0), o = n(98); r.processNotify = function (e) { switch (e.cmd) { case "syncOfflineNetcallMsgs": case "syncOfflineMsgs": this.onOfflineMsgs(e); break; case "batchMarkRead": break; case "syncOfflineSysMsgs": this.onOfflineSysMsgs(e); break; case "syncRoamingMsgs": case "syncSuperTeamRoamingMsgs": this.onRoamingMsgs(e); break; case "syncOfflineFilterMsgs": this.onOfflineMsgs(e, !0); break; case "syncOfflineFilterSysMsgs": this.onOfflineSysMsgs(e, !0); break; case "syncMsgReceipts": this.onOfflineMsgReceipts(e); break; case "syncDonnop": this.onDonnop(e, !0); break; case "syncSessionAck": this.syncSessionAck(e); break; case "syncRobots": this.onRobots(e); break; case "syncBroadcastMsgs": this.onBroadcastMsgs(e) } }, r.onDonnop = function (e, t) { if (!e.error) { var n = this, r = n.db, i = o.reverse(e.content.donnop); n.mergeDonnop(i); var s = n.dbDonnop(); if (t) { var a = e.content.timetag; n.timetags.donnop = a, r.enable && (s = s.then(function () { return n.db.updateDonnopTimetag(a) }).catch(function (e) { return n.logger.error("notify::onDonnop: ", e), Promise.reject(e) })), s.cmd = "donnop", n.syncPromiseArray.push(s) } else n.onPushNotificationMultiportConfigUpdate() } }, r.onUpdateDonnop = function (e) { if (!e.error) { var t = e.obj; t && (this.mergeDonnop(i.filterObj(t, ["shouldPushNotificationWhenPCOnline"])), this.dbDonnop(), this.onPushNotificationMultiportConfigUpdate()) } }, r.getPushNotificationMultiportConfig = function () { return i.merge({}, this.pushNotificationMultiportConfig) }, r.mergeDonnop = function (e) { this.pushNotificationMultiportConfig = i.merge({}, this.pushNotificationMultiportConfig, e) }, r.dbDonnop = function () { return this.db.enable ? this.db.setDonnop(this.pushNotificationMultiportConfig) : Promise.resolve() }, r.onPushNotificationMultiportConfigUpdate = function () { var e = this; setTimeout(function () { var t = e.getPushNotificationMultiportConfig(); e.logger.info("link::onPushNotificationMultiportConfigUpdate:", t), e.options.onPushNotificationMultiportConfigUpdate(t) }) } }, function (e, t, n) { var r = n(3).fn, i = n(0), o = i.objs2accounts, s = i.teams2ids, a = n(99), c = n(76); r.processSuperTeam = function (e) { var t, n, r, i = e.error; switch (void 0 === e.obj && (e.obj = {}), e.cmd) { case "sendSuperTeamMsg": this.onSendMsg(e); break; case "superTeamMsg": this.onMsg(e); break; case "syncSuperTeams": this.onSuperTeams(e); break; case "syncCreateSuperTeam": t = a.reverse(e.content.team), r = c.assembleOwner(t), this.logger.info("team::processTeam: sync createTeam", t, r), this.options.onSyncCreateSuperTeam(t, r), this.onCreateSuperTeam(t, r); break; case "getSuperTeamHistoryMsgs": case "searchSuperTeamHistoryMsgs": this.onHistoryMsgs(e); break; case "addSuperTeamMembers": case "removeSuperTeamMembers": case "leaveSuperTeam": case "addSuperTeamManagers": case "removeSuperTeamManagers": case "transferSuperTeam": break; case "updateInfoInSuperTeam": i || ((n = e.obj).account = this.account, n.id = c.genId(n.teamId, n.account), n = c.reverse(n), e.obj = n, this.onUpdateSuperTeamMember(n)); break; case "syncUpdateSuperTeamMember": n = c.reverse(e.content.teamMember), this.onUpdateSuperTeamMember(n); break; case "updateSuperTeam": e.obj = a.reverse(e.obj, !0); break; case "getSuperTeam": e.error || (e.obj = a.reverse(e.content.team)); break; case "getSuperTeams": this.onSuperTeams(e); break; case "syncSuperTeamMembers": this.onSyncSuperTeamMembers(e); break; case "getSuperTeamMembers": e.error || this.onGetAllSuperTeamMembers(e); break; case "getSuperTeamMembersByJoinTime": e.error || this.onSuperTeamMembers(e) } }, r.onSuperTeams = function (e) { function t() { r.timetags.superTeams = n, l.invalid = m, o ? (r.syncResult.superTeams = l, r.syncResult.invalidSuperTeams = m) : (r.logger.info("superTeam::onSuperTeams: not in syncing, get teams", s(l), l), e.obj = l) } e.content = e.content || {}; var n, r = this, i = r.db, o = r.packetFromSync(e), c = e.content.teams || [], u = !0, l = [], m = []; if (e.error) switch (e.error.code) { case 803: e.error = null, u = !1 }var d = new Promise(function (d, p) { var f, g; e.error ? o && p(e.error) : (u && c.forEach(function (e) { (e = a.reverse(e)).validToCurrentUser ? l.push(e) : m.push(e) }), r.logger.info("superTeam::onSuperTeams: parseData", s(l), l, "invalid", s(m), m), c.length ? (u = !0, n = e.content.timetag) : u = !1, i.enable ? (f = d, g = p, e.promise = new Promise(function (e, s) { function a() { o ? (t(), e(), f()) : i.getSuperTeams().then(function (n) { l = n, t(), e(), f() }).then(void 0, function (e) { e.message = "db.getSuperTeams error", e.callFunc = "superTeam::afterMergeData", s(e), g(e) }) } u ? i.mergeSuperTeams(l, m, n).then(function () { a() }).then(void 0, function (e) { var t = { callFunc: "superTeam::onSuperTeams:mergeData", message: "db.mergeSuperTeams error", event: e }; s(t), g(t) }) : (r.logger.warn("superTeam::onSuperTeams:mergeData: no teams need merge"), a()) }).then(void 0, function (e) { throw e.message = "merge teams data error", e.callFunc = "superTeam::mergeData", g(e), e })) : (t(), d())) }).catch(function (e) { return r.logger.error("superTeam::onSuperTeams: ", e), Promise.reject(e) }); o && (d.cmd = "superteams", r.syncPromiseArray.push(d)) }, r.onCreateSuperTeam = function (e, t) { var n = this.db; n.enable && (n.putSuperTeam(e), n.putSuperTeamMembers(t)) }, r.onGetAllSuperTeamMembers = function (e) { var t = this, n = this.db, r = e.raw.ser, i = t.superTeamMembersData[r].teamId; if (n.enable) { var o = e.content && e.content.timetag; e.promise = Promise.all(t.superTeamMembersData[r].pArr).then(function () { return n.getSuperTeamMembers(i).then(function (t) { o && n.updateSuperTeamMemberTimetag(i, o), e.obj = { members: t, invalid: [], teamId: i } }) }).catch(function (e) { return t.logger.error(e) }) } else e.obj = { members: t.superTeamMembersData[r].members, invalid: t.superTeamMembersData[r].invalid, teamId: i }; t.superTeamMembersData[r] = void 0 }, r.onSyncSuperTeamMembers = function (e) { var t, n = this.db, r = [], i = [], s = e.content.members || [], a = e.raw.ser; if (e.obj && (t = e.obj.teamId), t || (t = e.content.teamId), s.forEach(function (e) { (e = c.reverse(e)).valid ? i.push(e) : r.push(e) }), this.logger.info("team::onSyncSuperTeamMembers: parseData", t, o(i), i, "invalid", o(r), r), n.enable) { this.superTeamMembersData[a] = this.superTeamMembersData[a] || { teamId: t, pArr: [] }; var u = Promise.resolve(); e.content && e.content.isAll && (u = n.deleteSuperTeamMembers(t)); var l = u.then(function () { return n.mergeSuperTeamMembers(t, i, r) }).then(function () { return Promise.resolve() }); this.superTeamMembersData[a].pArr.push(l) } else this.superTeamMembersData[a] = this.superTeamMembersData[a] || { teamId: t, members: [], invalid: [] }, i.length && (this.superTeamMembersData[a].members = this.api.mergeTeamMembers(this.superTeamMembersData[a].members, i)), r.length && (this.superTeamMembersData[a].invalid = this.api.mergeTeamMembers(this.superTeamMembersData[a].invalid, r)); e.raw = void 0 }, r.onSuperTeamMembers = function (e) { var t, n = this.db, r = [], i = [], s = e.content.members || []; e.obj && (t = e.obj.teamId), t || (t = e.content.teamId), s.forEach(function (e) { (e = c.reverse(e)).valid ? i.push(e) : r.push(e) }), this.logger.info("team::onSyncSuperTeamMembers: parseData", t, o(i), i, "invalid", o(r), r), n.enable && n.mergeSuperTeamMembers(t, i, r), e.obj = { members: i, invalid: r, teamId: t } }, r.onUpdateSuperTeamMember = function (e) { e.updateTime || (e.updateTime = +new Date), this.logger.warn("superTeam::onUpdateSuperTeamMember: ", e), this.options.onUpdateSuperTeamMember(i.simpleClone(e)); var t = { teamId: e.teamId, memberUpdateTime: e.updateTime }; this.onUpdateSuperTeam(t); var n = this.db; n.enable && n.updateSuperTeamMember(e) }, r.onUpdateSuperTeam = function (e) { this.logger.info("superteam::onUpdateSuperTeam:", e), this.options.onUpdateSuperTeam(i.simpleClone(e)); var t = this.db; t.enable && t.updateSuperTeam(e) } }, function (e, t, n) { var r = n(3).fn, i = n(0), o = i.objs2accounts, s = i.teams2ids, a = n(58), c = n(49); r.processTeam = function (e) { var t = e.error, n = void 0, r = void 0, i = void 0; switch (void 0 === e.obj && (e.obj = {}), e.cmd) { case "createTeam": if (n = e.obj.team, t || (n = e.content.team), n = a.reverse(n), e.obj.team = n, i = c.assembleOwner(n), e.obj.owner = i, !t) { var o = { team: n, owner: i }; this.logger.info("team::processTeam: create team", o), this.onCreateTeam(n, i) } break; case "syncCreateTeam": n = a.reverse(e.content.team), i = c.assembleOwner(n), this.logger.info("team::processTeam: sync createTeam", n, i), this.options.onsynccreateteam(n, i), this.onCreateTeam(n, i); break; case "sendSuperTeamMsg": case "sendTeamMsg": this.onSendMsg(e); break; case "teamMsg": this.onMsg(e); break; case "teamMsgs": this.onMsgs(e); break; case "addTeamMembers": case "removeTeamMembers": case "leaveTeam": case "dismissTeam": case "addTeamManagers": case "removeTeamManagers": case "transferTeam": break; case "updateInfoInTeam": t || ((r = e.obj).account = this.account, r.id = c.genId(r.teamId, r.account), r = c.reverse(r), e.obj = r, this.mergeMyTeamMembers(r), this.onUpdateTeamMember(r)); break; case "updateNickInTeam": e.obj = c.reverse(e.obj); break; case "updateTeam": e.obj = a.reverse(e.obj, !0); break; case "applyTeam": e.error || (e.obj = a.reverse(e.content.team)); break; case "passTeamApply": this.updateTeamSysMsgState(e, "passed"); break; case "rejectTeamApply": this.updateTeamSysMsgState(e, "rejected"); break; case "acceptTeamInvite": this.updateTeamSysMsgState(e, "passed"), e.error || (e.obj = a.reverse(e.content.team)); break; case "rejectTeamInvite": this.updateTeamSysMsgState(e, "rejected"); break; case "getTeam": e.error || (e.obj = a.reverse(e.content.team)); break; case "getTeams": this.onTeams(e); break; case "getTeamMembers": this.onTeamMembers(e); break; case "syncTeams": this.onTeams(e); break; case "syncTeamMembers": this.onTeamMembers(e); break; case "getTeamHistoryMsgs": case "searchTeamHistoryMsgs": this.onHistoryMsgs(e); break; case "syncSendTeamMsg": this.onMsg(e); break; case "notifyTeamMsgReads": this.onTeamMsgReceipt(e); break; case "syncUpdateTeamMember": r = c.reverse(e.content.teamMember), this.onUpdateTeamMember(r), r.account === this.account && this.mergeMyTeamMembers(r); break; case "updateMuteStateInTeam": break; case "getMyTeamMembers": e.error || (e.obj = c.reverseMembers(e.content.teamMembers)); break; case "getMutedTeamMembers": e.error || (e.obj = { teamId: e.obj.teamId, members: c.reverseMembers(e.content.teamMembers) }); break; case "syncMyTeamMembers": this.onSyncMyTeamMembers(e) } }, r.onCreateTeam = function (e, t) { var n = this.db; n.enable && (n.putTeam(e), n.putTeamMembers(t)), this.options.onCreateTeam(e, t) }, r.onTeams = function (e) { function t() { r.timetags.teams = n, l.invalid = m, o ? (r.syncResult.teams = l, r.syncResult.invalidTeams = m, r.syncing || r.onSyncDone()) : (r.logger.info("team::onTeams: not in syncing, get teams", s(l), l), e.obj = l) } e.content = e.content || {}; var n, r = this, i = r.db, o = r.packetFromSync(e), c = e.content.teams || [], u = !0, l = [], m = []; if (e.error) switch (e.error.code) { case 803: e.error = null, u = !1 }var d = new Promise(function (d, p) { var f, g; e.error ? o && p(e.error) : (u && c.forEach(function (e) { (e = a.reverse(e)).validToCurrentUser ? l.push(e) : m.push(e) }), r.logger.info("team::onTeams: parseData", s(l), l, "invalid", s(m), m), c.length ? (u = !0, n = e.content.timetag) : u = !1, i.enable ? (f = d, g = p, e.promise = new Promise(function (e, s) { function a() { o ? (t(), e(), f()) : i.getTeams().then(function (n) { l = n, t(), e(), f() }).then(void 0, function (e) { e.message = "db.getTeams error", e.callFunc = "team::afterMergeData", s(e), g(e) }) } u ? i.mergeTeams(l, m, n).then(function () { a() }).then(void 0, function (e) { var t = { callFunc: "team::onTeams:mergeData", message: "db.mergeTeams error", event: e }; s(t), g(t) }) : (r.logger.warn("team::onTeams:mergeData: no teams need merge"), a()) }).then(void 0, function (e) { throw e.message = "merge teams data error", e.callFunc = "team::mergeData", g(e), e })) : (t(), d())) }).catch(function (e) { return r.logger.error("team::onTeams: ", e), Promise.reject(e) }); o && (d.cmd = "teams", r.syncPromiseArray.push(d)) }, r.onTeamMembers = function (e) { e.content = e.content || {}; var t, n, r = this, i = (r.db, r.packetFromSync(e)), s = e.content.members || [], a = !0, u = [], l = []; if (e.obj && (n = e.obj.teamId), n || (n = e.content.teamId), n = "" + n, e.error) switch (e.error.code) { case 406: e.error = null, a = !1 }var m = new Promise(function (m, d) { e.error ? i && (r.logger.error("team::onTeamMember: team error:", n, e.error), d({ callFunc: "team::onTeamMembers", event: e.error, message: "teamId-" + n + " 获取群成员错误" })) : (a && s.forEach(function (e) { (e = c.reverse(e)).valid ? u.push(e) : l.push(e) }), r.logger.warn("team::onTeamMembers: parseData", n, o(u), u, "invalid", o(l), l), s.length ? (a = !0, t = e.content.timetag) : a = !1, u.invalid = l, i ? (r.syncTeamMembersResult[n] = u, r.syncTeamMembersResult[n + "-invalid"] = l, r.timetags["team-" + n] = t) : (r.logger.info("team::onTeamMembers: not syncing, get members", n, o(u), u), e.obj = { teamId: n, members: u }), m()) }); i && (m.cmd = n, r.syncTeamMembersPromiseArray.push(m)) }, r.onUpdateTeamMember = function (e) { e.updateTime || (e.updateTime = +new Date), this.logger.info("team::onUpdateTeamMember: ", e), this.options.onupdateteammember(i.simpleClone(e)); var t = { teamId: e.teamId, memberUpdateTime: e.updateTime }; this.onUpdateTeam(t); var n = this.db; n.enable && n.updateTeamMember(e) }, r.onUpdateTeam = function (e) { this.logger.info("team::onUpdateTeam:", e), this.options.onUpdateTeam(i.simpleClone(e)); var t = this.db; t.enable && t.updateTeam(e) }, r.onSyncMyTeamMembers = function (e) { var t = this, n = t.db, r = c.reverseMembers(e.content.teamMembers); if (t.logger.info("team::onSyncMyTeamMembers:", r), n.enable) { var i = n.putTeamMembers(r).then(function () { return n.updateMyTeamMembersTimetag(e.content.timetag) }).catch(function (e) { return t.logger.error("team::syncMyTeamMember: ", e), Promise.reject(e) }); i.cmd = "myTeamMembers", t.syncTeamMembersPromiseArray.push(i) } t.mergeMyTeamMembers(r) }, r.mergeMyTeamMembers = function (e) { i.isArray(e) || (e = [e]); var t = this.myTeamMembersMap = this.myTeamMembersMap || {}; e.forEach(function (e) { var n = e.teamId; t[n] = i.merge(t[n], e) }), this.logger.info("team::mergeMyTeamMembers:", t) }, r.notifyForNewTeamMsg = function (e) { i.isArray(e) || (e = [e]); var t = this, n = this.myTeamMembersMap || {}, r = {}, o = []; e.forEach(function (e) { i.exist(n[e]) ? r[e] = n[e].muteNotiType : o.push(e) }); var s = Promise.resolve({ map: r }); return o.length && (s = t.api.getMyTeamMembers({ teamIds: o, promise: !0 }).then(function (n) { t.mergeMyTeamMembers(n), n.forEach(function (e) { r[e.teamId] = e.muteNotiType }); var i = e.filter(function (e) { return !r[e] }); return Promise.resolve({ map: r, miss: i }) }).catch(function (e) { return Object.keys(r).length > 0 ? Promise.resolve({ map: r, miss: o, error: e }) : Promise.reject(e) })), s }, r.updateTeamSysMsgState = function (e, t) { var n, r = e.error; r && (t = "error", r = i.filterObj(r, "code message")), n = { idServer: e.obj.idServer, state: t }, r && (n.error = r), this.updateSysMsg(n) }, r.onTeamMsgReceipt = function (e) { var t = e.content, n = e.error; n && this.logger.error("team::onTeamMsgReceipt:", n), t && t.teamMsgReceipts && this.options.onTeamMsgReceipt(t) } }, function (e, t, n) { var r = n(3).fn, i = n(0); r.onRobots = function (e) { var t = e.content; if (i.isFunction(this.options.onrobots) && Array.isArray(t.robots)) { var n = t.robots.filter(function (e) { return !!e.botid }); n.length > 0 && this.options.onrobots(n || []) } } }, function (e, t, n) { var r = n(3).fn, i = n(0), o = i.objs2accounts, s = n(141), a = n(75); r.processFriend = function (e) { var t = e.obj, n = e.content, r = e.error; switch (e.cmd) { case "friendRequest": this.updateFriendSysMsg(e), r || this.onFriendRequest(t); break; case "syncFriendRequest": this.onFriendRequest(n, !0); break; case "deleteFriend": r || this.onDeleteFriend(t); break; case "syncDeleteFriend": this.onDeleteFriend(n, !0); break; case "updateFriend": r || this.onUpdateFriend(t); break; case "syncUpdateFriend": this.onUpdateFriend(n.friend, !0); break; case "getFriends": case "syncFriends": this.onFriends(e); break; case "syncFriendUsers": this.onFriendUsers(e) } }, r.onFriends = function (e) { function t() { r.timetags.friends = n, m.invalid = d, c ? (r.syncResult.friends = m, r.syncResult.invalidFriends = d) : (r.logger.info("friend::onFriends: get friends bingo", o(m), m), e.obj = m) } var n, r = this, i = r.db, a = e.error, c = r.packetFromSync(e), u = e.content.friends, l = !0, m = [], d = [], p = new Promise(function (p, f) { var g, h; a ? c && f(a) : (l && u.forEach(function (e) { (e = s.reverse(e)).valid ? m.push(e) : d.push(e) }), r.logger.info("friend::onFriends: parse friends", o(m), m, "delete", o(d), d), u.length ? (l = !0, n = e.content.timetag) : l = !1, i.enable ? (g = p, h = f, e.promise = new Promise(function (e, o) { function s() { c ? (t(), e(), g()) : i.getFriends().then(function (n) { m = n, t(), e(), g() }).then(void 0, function (e) { e._msg = "get friends error", o(e), h(e) }) } l ? i.mergeFriends(m, d, n).then(function () { s() }).then(void 0, function (e) { e._msg = "merge friends error", o(e), h(e) }) : (r.logger.info("friend::onFriends: no merge friends"), s()) }).then(void 0, function (e) { throw e._msg = "merge friends data error", h(e), e })) : (t(), p())) }).catch(function (e) { return r.logger.error("friend::onFriends: ", e), Promise.reject(e) }); c && (p.cmd = "friends", r.syncPromiseArray.push(p)) }, r.onFriendRequest = function (e, t) { var n = Promise.resolve(), r = this.db, i = e.type; if ("addFriend" === (i = e.type = s.getTypeFromByte(i) || i) || "passFriendApply" === i) { var o = e.friend = s.assembleFriend(e.account); r.enable && (n = r.putFriend(o)) } return t && this.onSyncFriendAction(e), n }, r.onSyncFriendAction = function (e) { this.logger.info("friend::onSyncFriendActionon:", e), this.options.onsyncfriendaction(e) }, r.onDeleteFriend = function (e, t) { var n = Promise.resolve(), r = this.db; return r.enable && (n = r.deleteFriend(e.account)), t && (e.type = "deleteFriend", this.onSyncFriendAction(e)), n }, r.onUpdateFriend = function (e, t) { var n = this.db, r = s.reverse(e); n.enable && n.updateFriend(r), t && this.onSyncFriendAction({ type: "updateFriend", friend: r }) }, r.onFriendUsers = function (e) { var t = this.db, n = e.content, r = n.users.map(function (e) { return a.reverse(e) }); this.logger.warn("friend::onFriendUsers: parse users", o(r), r); var i = n.timetag, s = Promise.resolve(); t.enable && (s = t.mergeFriendUsers(r, i)), this.timetags.friendUsers = i, s.cmd = "friendUsers", this.syncPromiseArray.push(s), this.syncResult.users = r, this.syncing || this.onSyncDone() }, r.updateFriendSysMsg = function (e) { var t, n, r = e.obj, o = e.error; if (e.obj.idServer) { if (o) t = "error", o = i.filterObj(o, "code message"); else { var a = r.type; switch (a = s.getTypeFromByte(a) || a) { case "passFriendApply": t = "passed"; break; case "rejectFriendApply": t = "rejected" } } n = { idServer: r.idServer, state: t }, o && (n.error = o), this.updateSysMsg(n) } } }, function (e, t, n) { function r() { } var i = n(0); r.parse = function (e) { var t = i.copy(e); return t.isBlacked = "1" === t.isBlacked, t.isMuted = "1" === t.isMuted, t.createTime = +t.createTime, t.updateTime = +t.updateTime, t }, e.exports = r }, function (e, t, n) { var r = n(3).fn, i = n(0), o = i.objs2accounts, s = n(252), a = n(75); r.processUser = function (e) { var t, n = this, r = n.db, i = e.obj, o = e.error, s = e.content; switch (e.cmd) { case "markInBlacklist": o || n.markInBlacklist(i); break; case "syncMarkInBlacklist": n.markInBlacklist(s, !0); break; case "markInMutelist": o || n.markInMutelist(i); break; case "syncMarkInMutelist": n.markInMutelist(s, !0); break; case "getRelations": o || n.onRelations(e); break; case "syncMyInfo": n.onMyInfo(e, !0); break; case "updateMyInfo": o || (i.updateTime = s.timetag, n.onUpdateMyInfo(e, i)); break; case "syncUpdateMyInfo": n.onUpdateMyInfo(e, s.user, !0); break; case "getUsers": o || (t = s.users.map(function (e) { return e = a.reverse(e), n.mergeUser(e), e }), e.obj = t, r.enable && r.putUsers(t)); break; case "updateDonnop": n.onUpdateDonnop(e); break; case "syncUpdateDonnop": n.onDonnop(e, !1) } }, r.onMyInfo = function (e) { function t() { n.timetags.myInfo = c.updateTime, s && (n.syncResult.myInfo = c) } var n = this, r = n.db, i = e.error, o = e.content, s = !0, c = void 0, u = new Promise(function (e, u) { var l, m; i ? s && (i && (i.callFunc = "user::onMyInfo"), e(i), n.syncData()) : (c = a.reverse(o.user), n.logger.info("user::onMyInfo: parseData", c), r.enable ? (l = e, m = u, r.mergeMyInfo(c, s).then(function () { t(), l() }).then(void 0, function (e) { e.message = "db.mergeMyInfo error", e.callFunc = "user::onMyInfo", m(e) })) : (t(), e())) }).catch(function (e) { return n.logger.error("user::onMyInfo: ", e), Promise.reject(e) }); s && (u.cmd = "myInfo", n.syncPromiseArray.push(u)) }, r.onUpdateMyInfo = function (e, t, n) { var r = this.db, o = a.reverse(t), s = i.merge(this.myInfo, o); this.myInfo = s, n ? (this.logger.info("user::onUpdateMyInfo:", s), this.options.onupdatemyinfo(s)) : e.obj = s, r.enable && (o.account = this.account, r.updateUser(o)) }, r.onRelations = function (e) { function t() { n.timetags.relations = l, m.invalid = d, p.invalid = f, a ? (n.syncResult.blacklist = m, n.syncResult.mutelist = p, n.syncResult.invalidBlacklist = d, n.syncResult.invalidMutelist = f) : (n.logger.info("user::onRelations: get relations", m, p), e.obj.blacklist = m, e.obj.mutelist = p) } var n = this, r = n.db, i = e.error, a = n.packetFromSync(e), c = e.content.specialRelations, u = !0, l = void 0, m = [], d = [], p = [], f = [], g = new Promise(function (g, h) { var y, v; i ? a && (g(i), n.syncData()) : (c.forEach(function (e) { var t = { account: (e = s.parse(e)).account, createTime: e.createTime, updateTime: e.updateTime }; e.isBlacked ? m.push(t) : d.push(t), e.isMuted ? p.push(t) : f.push(t) }), n.logger.info("user::onRelations: parse blacklist", o(m), m, "delete", o(d), d), n.logger.info("user::onRelations: parse mutelist", o(p), p, "delete", o(f), f), c.length ? (u = !0, l = e.content.timetag) : u = !1, r.enable ? (y = g, v = h, e.promise = new Promise(function (e, i) { function o() { a ? (t(), e(), y()) : r.getRelations().then(function (n) { m = n[0], p = n[1], t(), e(), y() }).then(void 0, function (e) { e.message = "db.getRelations error", e.callFunc = "user::onRelations", i(e), v(e) }) } u ? r.mergeRelations(m, d, p, f, l).then(function () { o() }).then(void 0, function (e) { e.message = "db.mergeRelations error", e.callFunc = "user::onRelations", i(e), v(e) }) : (n.logger.warn("user::onRelations: no relations need merge"), o()) }).then(void 0, function (e) { throw e.message = "merge relations data error", e.callFunc = "user::onRelations", v(e), e })) : (t(), g())) }).catch(function (e) { return n.logger.error("user::onRelations: ", e), Promise.reject(e) }); a && (g.cmd = "relations", n.syncPromiseArray.push(g)) }, r.markInBlacklist = function (e, t) { var n = this.db; e.record = { account: e.account, updateTime: +new Date }, n.enable && n.markInBlacklist(e), t && (this.logger.info("user::markInBlacklist:", e), this.options.onsyncmarkinblacklist(e)) }, r.markInMutelist = function (e, t) { var n = this.db; e.record = { account: e.account, updateTime: +new Date }, n.enable && n.markInMutelist(e), t && (this.logger.info("user::markInMutelist:", e), this.options.onsyncmarkinmutelist(e)) }, r.mergeUser = function (e) { this.userSet[e.account] = e } }, function (e, t, n) { var r = n(5)("iterator"), i = !1; try { var o = [7][r](); o.return = function () { i = !0 }, Array.from(o, function () { throw 2 }) } catch (e) { } e.exports = function (e, t) { if (!t && !i) return !1; var n = !1; try { var o = [7], s = o[r](); s.next = function () { return { done: n = !0 } }, o[r] = function () { return s }, e(o) } catch (e) { } return n } }, function (e, t, n) { var r = n(8), i = n(27); e.exports = function (e, t, n) { t in e ? r.f(e, t, i(0, n)) : e[t] = n } }, function (e, t, n) { var r = n(26), i = n(5)("iterator"), o = Array.prototype; e.exports = function (e) { return void 0 !== e && (r.Array === e || o[i] === e) } }, function (e, t, n) { var r = n(19); e.exports = function (e, t, n, i) { try { return i ? t(r(n)[0], n[1]) : t(n) } catch (t) { var o = e.return; throw void 0 !== o && r(o.call(e)), t } } }, function (e, t, n) { var r = n(71), i = n(24), o = n(52), s = n(257), a = n(256), c = n(77), u = n(255), l = n(143); i(i.S + i.F * !n(254)(function (e) { Array.from(e) }), "Array", { from: function (e) { var t, n, i, m, d = o(e), p = "function" == typeof this ? this : Array, f = arguments.length, g = f > 1 ? arguments[1] : void 0, h = void 0 !== g, y = 0, v = l(d); if (h && (g = r(g, f > 2 ? arguments[2] : void 0, 2)), null == v || p == Array && a(v)) for (n = new p(t = c(d.length)); t > y; y++)u(n, y, h ? g(d[y], y) : d[y]); else for (m = v.call(d), n = new p; !(i = m.next()).done; y++)u(n, y, h ? s(m, g, [i.value, y], !0) : i.value); return n.length = y, n } }) }, function (e, t, n) { n(51), n(258), e.exports = n(9).Array.from }, function (e, t, n) { e.exports = { default: n(259), __esModule: !0 } }, function (e, t, n) { t.__esModule = !0; var r, i = (r = n(260)) && r.__esModule ? r : { default: r }; t.default = function (e) { if (Array.isArray(e)) { for (var t = 0, n = Array(e.length); t < e.length; t++)n[t] = e[t]; return n } return (0, i.default)(e) } }, function (e, t, n) { var r, i = (r = n(261)) && r.__esModule ? r : { default: r }, o = n(3).fn, s = n(0), a = n(4), c = s.undef, u = s.objs2ids, l = s.objs2accounts, m = s.teams2ids, d = n(55), p = s.getGlobal(); o.beforeSync = function () { var e = this.db; return e.enable ? e.clearSendingMsgs() : Promise.resolve() }, o.syncData = function () { function e(e) { t.syncPromiseArray = [], t.syncResult = {}, t.syncTeamMembersPromiseArray = [], t.syncSuperTeamMembersPromiseArray = [], t.syncTeamMembersResult = {}, t.checkNosReqNum = 0, t.getNosOriginUrlReqNum = 0, s.verifyBooleanWithDefault(r, "syncRelations syncFriends syncFriendUsers syncTeams syncSuperTeams syncRoamingMsgs syncSuperTeamRoamingMsgs syncMsgReceipts syncExtraTeamInfo", !0, "", "sync::syncData"), s.verifyBooleanWithDefault(r, "syncFilter syncTeamMembers syncSuperTeamMembers", !1, "", "sync::syncData"); var n = {}; e = e || {}, p._nimForceSyncIM && (t.logger.warn("sync::syncData: nimForceSyncIM"), delete e.teams, p._nimForceSyncIM = !1), n.myInfo = e.myInfo || 0, n.offlineMsgs = 0, r.syncRelations && (n.relations = e.relations || 0), r.syncFriends && (n.friends = e.friends || 0), r.syncFriendUsers && (n.friendUsers = e.friendUsers || 0), r.syncRobots && (n.robots = e.robots || 0), r.syncTeams && (n.teams = e.teams || 0), r.syncSuperTeams && (n.superTeams = e.superTeams || 0), r.syncRoamingMsgs && (n.roamingMsgs = e.roamingMsgs || 0), r.syncSuperTeamRoamingMsgs && (n.superTeamRoamingMsgs = e.superTeamRoamingMsgs || 0), r.syncMsgReceipts && (n.msgReceipts = e.msgReceipts || 0), r.syncExtraTeamInfo && (n.myTeamMembers = e.myTeamMembers || 0), r.syncSessionUnread && (n.sessionAck = e.sessionAck || 0), r.syncBroadcastMsgs && (n.broadcastMsgs = e.broadcastMsg || 0), n.donnop = e.donnop || 0, n.deleteMsg = e.deleteMsg || 0, n.netcallMsgs = 0, r.syncFilter && (n.filterMsgs = 0); var i = t.onSyncData.bind(t); i.isImSyncDataCb = !0, t.sendCmd("sync", { sync: n, isImSyncDataObj: !0 }, i) } var t = this, n = t.db, r = t.options, i = n.enable; t.syncing = !0, i ? t.beforeSync().then(function () { return t.db.getTimetags() }).then(function (t) { e(t) }, function () { e() }) : e(t.timetags) }, o.onSyncData = function (e, t) { e && this.syncRetryTimes > 3 && (this.syncRetryTimes = 0, e.callFunc = "sync::onSyncData", this.onCustomError("SYNC_DATA_ERROR", e)) }, o.processSync = function (e) { switch (this.syncRetryTimes = this.syncRetryTimes || 0, this.syncRetryTimes++ , e.cmd) { case "syncDone": e.error ? this.syncRetryTimes > 3 || this.syncData() : (this.timetags.sync = e.content.timetag, this.onSyncDone()); break; case "syncTeamMembersDone": this.onSyncTeamMembersDone() } }, o.onSyncDone = function (e) { function t() { if (q) { if (D.logger.info("sync::onSyncDone: after sync", s.promises2cmds(q)), q = [], g = H.blacklist || [], h = H.invalidBlacklist || [], y = H.mutelist || [], v = H.invalidMutelist || [], b = H.friends, T = H.invalidFriends || [], M = H.myInfo, S = H.users, _ = H.superTeams, P = H.invalidSuperTeams, k = H.teams, w = H.invalidTeams || [], C = H.sessions, I = H.msgReceipts, O = H.roamingMsgs, A = H.offlineMsgs, x = H.offlineFilterMsgs, j = H.offlineSysMsgs, U = H.offlineCustomSysMsgs, R = H.offlineFilterSysMsgs, F = H.offlineFilterCustomSysMsgs, H.broadcastMsgs, N = H.sysMsgUnread, C) { var e = []; Object.keys(C).forEach(function (t) { e.push(C[t]) }), C = e.sort(function (e, t) { return t.updateTime - e.updateTime }) } var t = Promise.resolve(); L && (t = function () { var e, t = [], n = []; return O && O.forEach(function (e) { n = [].concat((0, i.default)(n), (0, i.default)(e.msgs)) }), A && A.forEach(function (e) { n = [].concat((0, i.default)(n), (0, i.default)(e.msgs)) }), e = B.putMsg(n), t.push(e), Promise.all(t).then(function () { return n }) }().then(function (e) { var t = {}; e.forEach(function (e) { var n = e.sessionId; t[n] || (t[n] = !0, D.markUnreadByMsgsPromise(n)) }) })), t.then(function () { L && !D.hasSynced && (D.hasSynced = !0, $.syncRelations && (f = B.getRelations().then(function (e) { g = e[0], y = e[1], g.invalid = h, y.invalid = v }, function (e) { return e._msg = "on relations error", e }).catch(function (e) { return D.logger.error("sync::syncRelation: ", e), Promise.reject(e) }), q.push(f)), $.syncFriends && (f = B.getFriends().then(function (e) { (b = e).invalid = T }, function (e) { return e._msg = "on friends error", e }).catch(function (e) { return D.logger.error("sync::syncFriends: ", e), Promise.reject(e) }), q.push(f)), c(M) && (f = B.getUser(D.account).then(function (e) { M = e }, function (e) { return e._msg = "on myInfo error", e }).catch(function (e) { return D.logger.error("sync::syncMyInfo: ", e), Promise.reject(e) }), q.push(f)), $.syncFriendUsers && (f = B.getFriends().then(function (e) { return e.map(function (e) { return e.account }) }).then(function (e) { return B.getUsers(e) }).then(function (e) { S = e }, function (e) { return e._msg = "on users error", e }).catch(function (e) { return D.logger.error("sync::syncFriendUser: ", e), Promise.reject(e) }), q.push(f)), $.syncTeams && (f = B.getTeams().then(function (e) { (k = e).invalid = w }, function (e) { return e._msg = "on teams error", e }).catch(function (e) { return D.logger.error("sync::syncTeams: ", e), Promise.reject(e) }), q.push(f)), $.syncSuperTeams && (f = B.getSuperTeams().then(function (e) { (_ = e).invalid = P }, function (e) { return e._msg = "on superteams error", e }).catch(function (e) { return D.logger.error("sync::syncSuperTeams: ", e), Promise.reject(e) }), q.push(f)), f = B.getTeamMembersByAccount(D.account).then(function (e) { D.mergeMyTeamMembers(e) }).catch(function (e) { return D.logger.error("sync::getTeamMembersByAccount: ", e), Promise.reject(e) }), q.push(f), f = B.getDonnop().then(function (e) { D.mergeDonnop(e) }).catch(function (e) { return D.logger.error("sync::donnop: ", e), Promise.reject(e) }), q.push(f), f = B.getSessions().then(function (e) { C = e }, function (e) { return e._msg = "on sessions error", e }).catch(function (e) { return D.logger.error("sync::getSession: ", e), Promise.reject(e) }), q.push(f), f = B.getSysMsgUnread().then(function (e) { N = e }, function (e) { return e._msg = "on sysMsgUnread error", e }).catch(function (e) { return D.logger.error("sync::getSysMsgUnread: ", e), Promise.reject(e) }), q.push(f)); var e = q.filter(function (e) { return "sessionAck" === e.cmd }); 0 === e.length && e.push(Promise.resolve()); var t = q.filter(function (e) { return "sessionAck" !== e.cmd }); 0 === t.length && t.push(Promise.resolve()), Promise.all(t).then(function () { return Promise.all(e) }).then(n).then(r, function (e) { e.callFunc = "sync::onSyncDone", e.message = "taskAfterSync syncDBDataPromise 出错", D.onCustomError("SYNC_SESSION_ACK_ERROR", e) }) }) } else D.logger.warn("sync::onSyncDone: after sync --no promiseArray") } function n() { D.logger.info("sync::onSyncDone: taskAfterSync"), function () { if (H.deleteMsgSysMsgs) { var e = {}; O && O.forEach(function (t) { e[t.sessionId] = t }); var t = {}; A && A.forEach(function (e) { t[e.sessionId] = e }); var n = D.api; H.deleteMsgSysMsgs.forEach(function (r) { r.sysMsgs.forEach(function (r) { var i = r.msg, o = i.sessionId;[e, t].forEach(function (e) { e[o] && (e[o].msgs = n.cutMsgs(e[o].msgs, i)) }) }) }), B.enable || [O, A].forEach(function (e) { e && e.forEach(function (e) { if (e.msgs.length) { var t = D.genSessionByMsgs(e.msgs); D.cacheSyncedSession(t), C = n.mergeSessions(C, t) } else C = n.cutSessions(C, { id: e.sessionId }) }) }) } }(); var e = []; return e.push(D.deleteMsgOfflineRoaming(H.deleteMsgSysMsgs, C)), Promise.all(e) } function r() { setTimeout(o, 0) } function o() { var e, t, n = [], r = []; g && (D.logger.info("sync::notifyDataAsync: on blacklist", l(g), g), $.onblacklist(g)), y && (D.logger.info("sync::notifyDataAsync: on mutelist", l(y), y), $.onmutelist(y)), b && (D.logger.info("sync::notifyDataAsync: on friends", l(b), b), $.onfriends(b)), M && (D.logger.info("sync::notifyDataAsync: on myInfo", M), D.myInfo = M, $.onmyinfo(s.copy(M))), S && (S.forEach(function (e) { D.mergeUser(e) }), D.logger.info("sync::notifyDataAsync: on users", l(S), S), $.onusers(S)), k && (D.logger.info("sync::notifyDataAsync: on teams", m(k), k), $.onteams(k)), _ && (D.logger.info("sync::notifyDataAsync: onSuperTeams", m(_), _), $.onSuperTeams(_)), I && (!D.hasSynced && C && C.length || D.hasSynced) && (C = D.mergeSessionAndMsgReceipts(C, I)), C && C.length && (C.forEach(function (e) { D.syncResult.sessions && D.syncResult.sessions[e.id] && "number" == typeof D.syncResult.sessions[e.id].unread && (e.unread = D.syncResult.sessions[e.id].unread), D.mergeSession(e), d.trim(e) }), D.logger.info("sync::notifyDataAsync: on sessions", u(C), C), $.onsessions(C)), O && O.forEach(function (e) { n.push(e.timetag), (t = e.msgs).length && (D.logger.info("sync::notifyDataAsync: on roaming msgs", e.sessionId, t.length, t), $.onroamingmsgs(e), "superTeam" === t[0].scene && r.push(e.timetag)) }), A && A.forEach(function (e) { n.push(e.timetag), (t = e.msgs).length && (D.logger.info("sync::notifyDataAsync: on offline msgs", e.sessionId, t.length, t), $.onofflinemsgs(e)) }), x && x.forEach(function (e) { n.push(e.timetag), (t = e.msgs).length && (D.logger.info("sync::notifyDataAsync: on offline filter msgs", e.sessionId, t.length, t), $.onofflinefiltermsgs(t)) }); var i = [], o = []; H.deleteMsgSysMsgs && H.deleteMsgSysMsgs.forEach(function (e) { "roaming" === e.type ? i = i.concat(e.sysMsgs) : o = o.concat(e.sysMsgs) }), i.length && (E = (E = E || []).concat(i)), o.length && (j = (j = j || []).concat(o)), E && (D.logger.info("sync::notifyDataAsync: on roaming sys msgs", E.length, E), $.onroamingsysmsgs(E)), j && (D.logger.info("sync::notifyDataAsync: on offline sys msgs", j.length, j), $.onofflinesysmsgs(j)), R && (D.logger.info("sync::notifyDataAsync: on offline filter sys msgs", R.length, R), $.onofflinefiltersysmsgs(R)), U && (D.logger.info("sync::notifyDataAsync: on offline custom sys msgs", U.length, U), $.onofflinecustomsysmsgs(U)), F && (D.logger.info("sync::notifyDataAsync: on offline filter custom sys msgs", F.length, F), $.onofflinefiltercustomsysmsgs(F)), N && (N = s.merge({}, D.sysMsgUnread, N), D.sysMsgUnread = s.merge({}, N), D.logger.info("sync::notifyDataAsync: on sysMsgUnread", N), $.onsysmsgunread(N)); var a = D.getPushNotificationMultiportConfig(); if (D.logger.info("sync::notifyDataAsync: on pushNotificationMultiportConfig", a), $.onPushNotificationMultiportConfig(a), n.length ? (e = Math.max.apply(Math, n), D.updateRoamingMsgTimetag(e).then(p, p)) : p(), r.lenth && B.enable) { var c = Math.max.apply(Math, r); D.db.updateSuperTeamRoamingMsgTimetag(c) } D.syncPromiseArray = [], D.syncResult = {} } function p() { if (D.processUnsettledMsgs(), D.processUnsettledSysMsgs(), D.syncing && $.onsyncdone(), D.syncing = !1, $.syncTeamMembers && k && k.length) throw new a("sync team members api deprecated!") } var f, g, h, y, v, b, T, M, S, k, _, w, P, C, I, O, A, x, E, j, U, R, F, N, D = this, B = D.db, L = B.enable, $ = D.options, q = D.syncPromiseArray, H = D.syncResult; if (q && q.length) { var z = q.filter(function (e) { return "sessionAck" === e.cmd }); 0 === z.length && z.push(Promise.resolve()); var V = q.filter(function (e) { return "sessionAck" !== e.cmd }); 0 === V.length && V.push(Promise.resolve()), Promise.all(V).then(function () { return Promise.all(z) }, function (e) { e.callFunc = "sync::onSyncDone", e.message = "afterSync syncNormalPromise 出错", D.onCustomError("SYNC_NORMAL_ERROR", e) }).then(t, function (e) { e.callFunc = "sync::onSyncDone", e.message = "afterSync syncSessionAckPromise 出错", D.onCustomError("SYNC_SESSION_ACK_ERROR", e) }).catch(function (e) { D.syncData() }) } else t() }, o.syncTeamMembers = function (e) { var t, n, r = this; t = r.timetags, n = {}, t = t || {}, e.forEach(function (e) { n[e.teamId] = 0 }, r), r.sendCmd("syncTeamMembers", { sync: n }, r.onSyncTeamMembers.bind(r)) }, o.onSyncTeamMembers = function (e, t) { e.callFunc = "sync::onSyncTeamMembers", e.message = "同步群成员错误", this.onCustomError("SYNC_TEAM_MEMBERS_ERROR", e) }, o.onSyncTeamMembersDone = function () { function e() { o.logger.log("sync::onSyncTeamMembersDone: afterSync", s.promises2cmds(m)), m = [], a.enable && !o.hasSyncedTeamMembers ? (o.hasSyncedTeamMembers = !0, function () { if (!c.syncTeams || !c.syncTeamMembers) return r(); a.getTeams().then(function (e) { e.forEach(function (e) { var t = e.teamId; i = new Promise(function (e, n) { o.api.getTeamMembers({ teamId: t, done: function (r, i) { r && n({ callFunc: "sync::getTeamMembers: teamId-" + t, message: "sync team members error" }), u[t] = i.members || [], e() } }) }), m.push(i) }), m.length ? Promise.all(m).then(t, function (e) { e.callFunc = "sync::onSyncTeamMembersDone", e.message = "pullFullData promiseArray notifyData 错误", o.onCustomError("SYNC_TEAM_MEMBERS_ERROR", e) }) : t() }, function (e) { e.callFunc = "sync::onSyncTeamMembersDone", e.message = "pullFullData getTeams 错误", o.onCustomError("SYNC_TEAM_MEMBERS_ERROR", e) }) }()) : t() } function t() { setTimeout(n, 0) } function n() { var e, t; Object.keys(u).forEach(function (n) { -1 === n.indexOf("invalid") && (e = u[n], t = u[n + "-invalid"] || [], e.invalid = t, function (e, t) { o.logger.info("sync::onSyncTeamMembersDone: onTeamMembers", e, l(t), t), c.onteammembers({ teamId: e, members: t }) }(n, e)) }), r() } function r() { o.logger.info("sync::onSyncTeamMembersDone: bingo"), c.onsyncteammembersdone(), o.syncTeamMembersResult = null, o.syncTeamMembersPromiseArray = null } var i, o = this, a = o.db, c = o.options, u = o.syncTeamMembersResult, m = o.syncTeamMembersPromiseArray; m.length ? Promise.all(m).then(e, function (e) { e.callFunc = "sync::onSyncTeamMembersDone", e.message = "同步群成员 syncTeamMembersPromiseArray 错误", o.onCustomError("SYNC_TEAM_MEMBERS_ERROR", e) }).catch(function (t) { o.logger.log("sync::onSyncTeamMembersDone: syncTeamMembersPromiseArray promise ", t), e() }) : e() } }, function (e, t, n) { var r = n(3).fn, i = n(57); r.assembleLogin = function () { var e = this.assembleIMLogin(); return this.addPushInfo instanceof Function ? this.addPushInfo(e) : Promise.resolve({ login: e }) }, r.afterLogin = function () { var e = this; this.initPush instanceof Function && this.initPush(); var t = this.db; if (t.enable) { var n = this.account; this.options.appendAppKeyForDBName && (n += "-" + this.options.appKey), this.db.init(n).then(function () { e.notifyLogin(), e.syncData() }, function (n) { e.logger.warn("link::afterLogin: no db", n), t.reset(!1), e.notifyLogin(), e.syncData() }) } else this.logger.info("link::afterLogin: no db"), this.notifyLogin(), this.syncData() }, r.processAuth = function (e) { switch (e.cmd) { case "login": e.error || (e.content = e.content || {}, this.loginAndroidPush && this.loginAndroidPush(e.content.aosPushInfo || {}), e.obj = e.content.loginRes, this.connectionId = e.content.loginRes.connectionId, this.onLoginPortsChange(e, 2)); break; case "kicked": return void this.onKicked(e); case "multiPortLogin": this.onLoginPortsChange(e, e.content.state); break; case "kick": e.error || (e.obj.deviceIds = e.content.deviceIds) } }, r.onLoginPortsChange = function (e, t) { var n = this, r = e.content.loginPorts; if (r && r.length) { var o = !0; switch (t) { case 2: o = !0; break; case 3: o = !1 }r.forEach(function (e) { e.type = i.reverseType(e.type), e.time = +e.time, e.online = o }), (r = r.filter(function (e) { return e.connectionId !== n.connectionId })).length && (n.logger.info("link::onLoginPortsChange:", r), n.options.onloginportschange(r)) } }, r.kickedReasons = ["", "samePlatformKick", "serverKick", "otherPlatformKick", "silentlyKick"], r.kickedMessages = ["", "不允许同一个帐号在多个地方同时登录", "被服务器踢了", "被其它端踢了", "悄悄被踢"] }, function (e, t, n) { var r = n(3).fn, i = n(1), o = n(0), s = n(17); r.refreshSocketUrl = function () { function e(e) { n.socketUrls = [], (e = i.isWeixinApp ? e.data : JSON.parse(e)).common.link.forEach(function (e) { n.socketUrls.push(i.formatSocketUrl({ url: e, secure: n.options.secure })) }), e.common["link.default"].forEach(function (e) { e = i.formatSocketUrl({ url: e, secure: n.options.secure }), -1 === n.socketUrls.indexOf(e) && n.socketUrls.push(e) }); try { i.uploadUrl = e.nosup[0] } catch (e) { } i.chunkUploadUrl = i.chunkUploadUrl || e["nos-chunk"] || "", n.logger.info("link::refreshSocketUrl: ajax load, got socket urls ", n.socketUrls), n.connectToUrl(n.getNextSocketUrl()) } function t(e) { n.logger.error("link::refreshSocketUrl: ajax lbs error", e), n.api.reportLogs({ event: "nimlb", code: 3001 }); var t = i.getDefaultLinkUrl(n.options.secure); t ? (n.logger.info("link::refreshSocketUrl: use default link url", t), n.connectToUrl(t)) : n.onDisconnect(!1, "link::refreshSocketUrl") } var n = this, r = n.options, a = i.info, c = r.lbsUrl; c = c + o.genUrlSep(c) + "k=" + r.appKey + "&id=" + r.account + "&sv=" + a.sdkVersion + "&pv=" + a.protocolVersion, n.logger.info("link::refreshSocketUrl: ajax " + c), i.isWeixinApp ? (c = c.replace(/:\d+/, ""), wx.request({ url: c, success: e, fail: t })) : s(c, { proxyUrl: o.url2origin(c) + "/lbs/res/cors/nej_proxy_frame.html", timeout: i.xhrTimeout, onload: e, onerror: t }) } }, function (e, t, n) { var r = n(16).fn, i = n(0), o = i.notundef; r.putSession = function (e) { return void 0 === (e = i.merge({}, e)).updateTime && e.lastMsg && e.lastMsg.time && (e.updateTime = e.lastMsg.time), delete e.unread, this.modifyOrPut({ table: "session", obj: e, key: "id", modifyObjWhenPut: { unread: 0 } }) }, r.getSessions = function (e) { var t, n = !(e = e || {}).reverse, r = e.limit || 100, i = e.lastSessionId, s = e.sessionId, a = !1; if (o(i)) t = function (e) { return !!a || (e.id === i && (a = !0), !1) }; else if (o(s)) return this.get("session", s); return this.getAll("session", { index: "updateTime", desc: n, limit: r, filter: t }) }, r.getSession = function (e) { return this.get("session", e) }, r.updateSession = function (e) { var t = this, n = e.id, r = i.filterObj(e, "ack unread lastMsg localCustom msgReceiptTime msgReceiptServerTime"); return Object.keys(e).forEach(function (t) { 0 === t.indexOf("last") && (r[t] = e[t]) }), this.getOne("session", null, n, { modifyObj: r }).then(function (e) { return e ? t.logger.log("db::updateSession: " + n, r) : t.logger.warn("db::updateSession: no record " + n), e }) }, r.resetSessionUnread = function (e) { return this.updateSession({ id: e, unread: 0 }) }, r.deleteSession = function (e) { return this.remove("session", e) } }, function (e, t, n) { var r = n(16).fn, i = n(0); i.notundef, r.putBroadcastMsg = function (e) { var t = this; return new Promise(function (n) { function r() { 0 == --s && n(o) } i.isArray(e) || (e = [e]); var o = [], s = e.length; e.forEach(function (e) { e = i.copy(e), t.put("broadcastMsg", e).then(function (e) { o.push(e[0]), r() }, r) }) }) }, r.getBroadcastMsgs = function (e) { return e = e || {}, this.getAll("broadcastMsg", e) } }, function (e, t, n) { var r = n(16).fn, i = n(0), o = i.notundef; r.putSysMsg = function (e) { var t = this; return new Promise(function (n) { function r() { 0 == --s && n(o) } if (i.isArray(e) || (e = [e]), !e[0].filter) { var o = [], s = e.length; e.forEach(function (e) { e = i.copy(e), t.put("sysMsg", e).then(function (e) { o.push(e[0]), r() }, r) }) } }) }, r.getSysMsgs = function (e) { var t = !(e = e || {}).reverse, n = e.limit || 100, r = null, i = null; e.category && (r = "category", i = e.category), e.type && (r = "type", i = e.type); var s, a = e.lastIdServer, c = !1, u = e.read; return (o(a) || o(u)) && (s = function (e) { function t() { return !o(u) || e.read === u } return o(a) ? (a = "" + a, c ? t() : (e.idServer === a && (c = !0), !1)) : t() }), e = { filter: s, desc: t, limit: n }, r ? this.getOnly("sysMsg", r, i, e) : this.getAll("sysMsg", e) }, r.getSysMsgByIdServer = function (e) { return this.getOne("sysMsg", "idServer", e) }, r.updateSysMsg = function (e) { var t = this; if (!e.filter) { var n = "" + e.idServer, r = i.filterObj(e, "read state error localCustom"); return this.getOne("sysMsg", "idServer", n, { modifyObj: r }).then(function (e) { return e ? t.logger.log("db::updateSysMsg: " + n, r) : t.logger.warn("db::updateSession: " + n), e }) } }, r.markSysMsgRead = function (e) { var t = this; return new Promise(function (n, r) { i.isArray(e) || (e = [e]); var o, s, a = [], c = []; e.forEach(function (e) { o = t.getSysMsgByIdServer(e.idServer).then(function (e) { e && !e.read && (s = t.updateSysMsg({ idServer: e.idServer, read: !0 }), c.push(s)) }, r), a.push(o) }), Promise.all(a).then(function () { Promise.all(c).then(function (e) { n(e) }, r) }, r) }) }, r.deleteSysMsg = function (e) { var t, n = this, r = []; return i.isArray(e) || (e = [e]), e.forEach(function (e) { e = "" + e, t = n.getOne("sysMsg", "idServer", e, { remove: !0 }), r.push(t) }), 1 === r.length ? r[0] : Promise.all(r) }, r.deleteAllSysMsgs = function () { var e = this.clearTable("sysMsg"), t = this.clearTable("sysMsgUnread"); return Promise.all([e, t]) }, r.getSysMsgUnread = function () { return this.getAll("sysMsgUnread").then(function (e) { var t = {}; return e.forEach(function (e) { t[e.type] = e.num }), t }) }, r.updateSysMsgUnread = function (e) { var t = this; e = i.copy(e); var n = []; return Object.keys(e).forEach(function (t) { n.push({ type: t, num: e[t] }) }), this.put("sysMsgUnread", n).then(function () { return t.logger.log("db::updateSysMsgUnread: ", e), e }) } }, function (e, t, n) { var r = n(16).fn, i = n(0), o = n(1); r.putMsg = function (e) { return i.isArray(e) || (e = [e]), !e.length || e[0].filter ? Promise.resolve() : (e = e.filter(function (e) { return !e.ignore }), this.put("msg1", e)) }, r.updateMsg = function (e) { var t = this; if (!e.filter) { var n = e.idClient, r = i.filterObj(e, "resend status idServer time localCustom"); return t.getOne("msg1", null, n, { modifyObj: r }).then(function (e) { return e ? t.logger.log("db::updateMsg: " + n, r) : t.logger.warn("db::updateMsg: no record " + n), e }) } }, r.getMsgs = function (e) { return o.isBrowser ? this.getMsgsIndexedDB(e) : o.isRN ? this.getMsgsRN(e) : Promise.resolve() }, r.getMsgsRN = function (e) { var t = {}; return "number" == typeof e.start && (t.lowerBound = ["time", e.start]), "number" == typeof e.end && e.end !== 1 / 0 && (t.upperBound = ["time", e.end]), t.desc = !1, t.sortIndex = "time", "boolean" == typeof e.desc && (t.desc = e.desc), "number" == typeof e.limit && (t.limit = e.limit), t.searchIndex = [], e.sessionId && t.searchIndex.push(["sessionId", e.sessionId]), "string" == typeof e.type && t.searchIndex.push(["type", e.type]), this.getAll("msg1", t) }, r.getMsgsIndexedDB = function (e) { this.checkDB(); var t = "time", n = !1, r = !1, o = (e = e || {}).sessionId || [], s = e.sessionIds || []; i.isString(o) ? o = [o] : Array.isArray(o) || (o = []), i.isString(s) ? s = [s] : Array.isArray(s) || (s = []); var a = o.concat(s); 1 === a.length ? (n = !0, t = "sessionTime", o = a[0]) : a.length > 1 && (n = !0, r = !0, s = a); var c = e.start || 0, u = e.end || 1 / 0, l = c, m = u; n && !r && (l = [o, c], m = [o, u]); var d = !1 !== e.desc, p = e.limit || 100, f = !1, g = !1, h = e.type || [], y = e.types || []; i.isString(h) ? h = [h] : Array.isArray(h) || (h = []), i.isString(y) ? y = [y] : Array.isArray(y) || (y = []); var v = h.concat(y); 1 === v.length ? (f = !0, h = v[0]) : v.length > 1 && (f = !0, g = !0, y = v); var b = e.keyword || "", T = e.filterFunc, M = void 0; return (r || f || b || i.isFunction(T)) && (M = function (e) { if (r && -1 === s.indexOf(e.sessionId)) return !1; if (f) if (g) { if (-1 === y.indexOf(e.type)) return !1 } else if (h !== e.type) return !1; return (!b || -1 !== (e.text || e.tip || "").indexOf(b)) && (!T || T(e)) }), this.server.query("msg1", t).bound(l, m, !0, !0).desc(d).limit(p).filter(M).execute() }, r.getMsgCountAfterAck = function (e) { return o.isBrowser ? this.getMsgCountAfterAckIndexedDB(e) : o.isRN ? this.getMsgCountAfterAckRN(e) : Promise.resolve() }, r.getMsgCountAfterAckRN = function (e) { var t = e = e || {}, n = t.sessionId, r = t.ack; return this.checkDB(), this.getAll("msg1", { searchIndex: ["sessionId", n], lowerBound: ["time", r] }).then(function (t) { var n = t.filter(function (t) { return "out" !== t.flow && ("notification" !== t.type || !!e.shouldCountNotifyUnread(t)) }); return Promise.resolve(n.length) }) }, r.getMsgCountAfterAckIndexedDB = function (e) { var t = (e = e || {}).sessionId; return this.checkDB(), this.server.query("msg1", "sessionTime").bound([t, e.ack], [t, 1 / 0], !0, !0).execute().then(function (t) { var n = t.filter(function (t) { return "out" !== t.flow && ("notification" !== t.type || !!e.shouldCountNotifyUnread(t)) }); return Promise.resolve(n.length) }) }, r.amendMsg = function (e) { return e ? (i.notexist(e.text) && (e.text = ""), e) : null }, r.getMsgByIdClient = function (e) { var t = this; return t.getOne("msg1", null, e).then(function (e) { return t.amendMsg(e) }) }, r.getMsgsByIdClients = function (e) { var t, n = this, r = []; return e.forEach(function (e) { t = n.getMsgByIdClient(e), r.push(t) }), Promise.all(r) }, r.clearSendingMsgs = function () { var e = this; return e.getOnly("msg1", "status", "sending", { modifyObj: { status: "fail" } }).then(function (t) { e.logger.log("db::clearSendingMsgs: msgs send failed", t) }) }, r.deleteMsg = function (e) { var t, n = this, r = []; return i.isArray(e) || (e = [e]), e.forEach(function (e) { t = n.getOne("msg1", null, e, { remove: !0 }).then(function (e) { return n.logger.log("db::deleteMsg:", e), e }), r.push(t) }), 1 === r.length ? r[0] : Promise.all(r) }, r.deleteMsgsBySessionId = function (e) { var t = this, n = null, r = e.start, i = e.end; return void 0 !== r && void 0 !== i ? n = function (e) { return e > r && e < i } : void 0 !== r ? n = function (e) { return e > r } : void 0 !== i && (n = function (e) { return e < i }), n ? t.getOnly("msg1", "sessionId", e.sessionId).then(function (e) { t.logger.log("db::deleteMsgsBySessionId: session results", e); var r = []; return (e = e || []).map(function (e) { n(e.time) && r.push(e.idClient) }), t.deleteMsg(r) }) : t.getOnly("msg1", "sessionId", e.sessionId, { remove: !0 }) }, r.deleteMsgsByTime = function (e) { return this.remove("msg1", null, "time", e.start, e.end, !0, !0) }, r.deleteAllMsgs = function () { var e = this.clearTable("msg1"), t = this.clearTable("session"); return Promise.all([e, t]) } }, function (e, t, n) { var r = n(16).fn, i = n(0); r.mergeMyInfo = function (e, t) { var n = this; return n.put("user", e).then(function () { return t ? n.updateMyInfoTimetag(e.updateTime) : e }) }, r.mergeFriendUsers = function (e, t) { var n = this; return n.putUsers(e).then(function () { n.updateFriendUserTimetag(t) }) }, r.putUsers = function (e) { return this.put("user", e) }, r.putUser = function (e) { return this.put("user", e) }, r.updateUser = function (e) { var t = this, n = (e = i.copy(e)).account; return this.getOne("user", null, n, { modifyObj: e }).then(function (r) { return r ? t.logger.log("db::updateUser: " + n, e) : t.logger.warn("db::updateUser: no record " + n), r }) }, r.putUsersIfIsFriend = function (e) { var t, n = this, r = [], i = []; return e.forEach(function (e) { t = n.getFriend(e.account).then(function (r) { return r && (t = n.putUser(e), i.push(t)), r }), r.push(t) }), Promise.all(r).then(function () { return Promise.all(i).then(function (e) { return e }) }) }, r.deleteUser = function (e) { return this.remove("user", e) }, r.getUser = function (e) { return this.getOne("user", null, e) }, r.getUsers = function (e) { return this.getAll("user", { filter: function (t) { return -1 !== e.indexOf(t.account) } }) }, r.getAllUsers = function () { return this.getAll("user") } }, function (e, t, n) { function r(e) { return e.valid && e.validToCurrentUser } function i(e) { return e && e.valid } function o(e) { return e && a.fillUndef(e, { mute: !1, custom: "" }), e } var s = n(16).fn, a = n(0), c = n(4), u = n(99), l = n(76); s.mergeSuperTeams = function (e, t, n) { var r = this, i = r.put("superTeam", e), o = r.leaveTeams(t, n); return Promise.all([i, o]).then(function () { return r.logger.log("db::mergeSuperTeams:"), r.updateSuperTeamTimetag(n), [e, t, n] }) }, s.putSuperTeam = function (e) { if (e) return a.isArray(e) || (e = [e]), e.forEach(function (e) { e.validToCurrentUser = !0 }), this.put("superTeam", e) }, s.updateSuperTeam = function (e) { var t = this, n = (e = a.copy(e)).teamId; return t.getOne("superTeam", null, n, { modifyObj: e }).then(function (r) { return r ? (t.logger.log("db::updateSuperTeam: " + n, e), r) : (t.logger.warn("db::updateSuperTeam: no record " + n), t.putSuperTeam(e)) }) }, s.leaveSuperTeam = function (e) { var t = this; return t.updateSuperTeam({ teamId: e, validToCurrentUser: !1 }).then(function () { return t.removeAllSuperTeamMembers(e) }) }, s.dismissSuperTeam = function (e, t) { var n = this, r = { teamId: e, valid: !1, validToCurrentUser: !1, updateTime: t }; return n.updateSuperTeam(r).then(function () { return n.removeAllSuperTeamMembers(e) }) }, s.leaveSuperTeams = function (e, t) { var n, r = this, i = []; return e.forEach(function (e) { n = r.leaveSuperTeam(e.teamId, t), i.push(n) }), Promise.all(i) }, s.getSuperTeamsByTeamIds = function (e) { var t, n = this, r = []; return e.forEach(function (e) { t = n.getSuperTeam(e), r.push(t) }), Promise.all(r) }, s.getSuperTeam = function (e) { e = "" + e; var t = this; return t.getOne("superTeam", null, e).then(function (e) { return e ? (t.updateSuperTeamProperties([e]), e) : null }) }, s.getSuperTeams = function () { var e = this; return e.getAll("superTeam", { filter: r }).then(function (t) { return e.updateSuperTeamProperties(t), t }) }, s.updateSuperTeamProperties = function (e) { e.forEach(function (e) { e && u.fillProperties(e) }) }, s.mergeSuperTeamMembers = function (e, t, n, r) { var i = this, o = i.putSuperTeamMembers(t), s = i.updateSuperTeamMembers(n); return Promise.all([o, s]).then(function () { return i.logger.log("db::mergeSuperTeamMembers: " + e), null != r ? i.updateSuperTeamMemberTimetag(e, r) : Promise.resolve() }) }, s.putSuperTeamMembers = function (e) { return this.put("superTeamMember", e) }, s.getSuperTeamMembersByAccount = function (e) { return this.getOnly("superTeamMember", "account", e, { filter: i, mapper: o }).then() }, s.getSuperTeamMembers = function (e, t) { var n = this; e = "" + e; var r = { filter: function (e) { return e.valid }, mapper: o }; if (t) { if ("number" != typeof t.joinTime) return void n.logger.error("db::getSuperTeamMembers::params.joinTime should be number, not ", t.joinTime); t.limit && (r.limit = t.limit), t.reverse ? r.filter = function (e) { return e.valid && e.joinTime <= t.joinTime } : r.filter = function (e) { return e.valid && e.joinTime >= t.joinTime } } return n.getOnly("superTeamMember", "teamId", e, r).then(function (e) { return n.updateSuperTeamMemberProperties(e).then(function () { return e }) }) }, s.updateSuperTeamMemberProperties = function (e) { var t, n = this, r = []; return e.forEach(function (e) { l.fillProperties(e) && (t = n.updateSuperTeamMember(e), r.push(t)) }), Promise.all(r) }, s.getInvalidSuperTeamMembers = function (e, t) { var n = this; e = "" + e; var r, i = []; return t.forEach(function (t) { r = n.getOne("superTeamMember", "id", l.genId(e, t)).then(function (e) { return o(e) }), i.push(r) }), Promise.all(i) }, s.updateSuperTeamMember = function (e) { var t = this, n = e.teamId, r = e.account, i = l.genId(n, r), s = a.filterObj(e, "nickInTeam muteTeam mute custom updateTime type valid"); return this.getOne("superTeamMember", "id", i, { modifyObj: s, mapper: o }).then(function (e) { return e ? t.logger.log("db::updateSuperTeamMember: " + n + " " + r, s) : t.logger.warn("db::updateSuperTeam: no record " + n + " " + r), e }) }, s.updateSuperTeamMembers = function (e) { var t = this; if (!e.length) return Promise.resolve(); var n, r = []; return e.forEach(function (e) { n = t.updateSuperTeamMember(e), r.push(n) }), Promise.all(r) }, s.removeSuperTeamMembersByAccounts = function (e, t) { var n = t.map(function (t) { return { teamId: e, account: t, valid: !1 } }); return this.updateSuperTeamMembers(n) }, s.removeAllSuperTeamMembers = function (e) { var t = this; return t.getOnly("superTeamMember", "teamId", e, { modifyObj: { valid: !1 } }).then(function () { return t.logger.warn("db::removeAllSuperTeamMembers: " + e), t.deleteSuperTeamMemberTimetag(e) }) }, s.deleteSuperTeamMembers = function (e) { var t = this; return t.getOnly("superTeamMember", "teamId", e, { remove: !0 }).then(function () { t.logger.warn("db::deleteTeamMembers: " + e), t.deleteSuperTeamMemberTimetag(e) }) }, s.deleteSuperTeam = function (e) { var t, n = this, i = []; return a.isArray(e) || (e = [e]), e.forEach(function (e) { e = "" + e, t = n.get("superTeam", e).then(function (t) { if (t && r(t)) throw c.stillInTeamError({ callFunc: "team::deleteTeam", team: t }); var i = n.remove("superTeam", e), o = n.deleteSuperTeamMembers(e); return Promise.all([i, o]) }), i.push(t) }), 1 === i.length ? i[0] : Promise.all(i) }, s.transferSuperTeam = function (e, t, n) { var r = this; return r.updateSuperTeamMembers([t, n]).then(function () { return r.putSuperTeam(e).then(function () { return r.logger.log("db::transferSuperTeam: " + e.teamId + " " + t.account + " -> " + n.account), [e, t, n] }) }) } }, function (e, t, n) { function r(e) { return e.valid && e.validToCurrentUser } function i(e) { return e && e.valid } function o(e) { return e && a.fillUndef(e, { mute: !1, custom: "" }), e } var s = n(16).fn, a = n(0), c = n(4), u = n(58), l = n(49); s.mergeTeams = function (e, t, n) { var r = this, i = r.put("team", e), o = r.leaveTeams(t, n); return Promise.all([i, o]).then(function () { return r.logger.log("db::mergeTeams:"), r.updateTeamTimetag(n), [e, t, n] }) }, s.putTeam = function (e) { if (e) return a.isArray(e) || (e = [e]), e.forEach(function (e) { e.validToCurrentUser = !0 }), this.put("team", e) }, s.updateTeam = function (e) { var t = this, n = (e = a.copy(e)).teamId; return t.getOne("team", null, n, { modifyObj: e }).then(function (r) { if (r) t.logger.log("db::updateTeam: " + n, e); else if (t.logger.warn("db::updateTeam: no record " + n), e.validToCurrentUser) return t.putTeam(e); return r }) }, s.transferTeam = function (e, t, n) { var r = this, i = e.teamId, o = e.memberUpdateTime, s = { teamId: i, account: t, type: "normal", updateTime: o }, a = { teamId: i, account: n, type: "owner", updateTime: o }; return r.updateTeamMembers([s, a]).then(function () { return r.putTeam(e).then(function () { return r.logger.log("db::transferTeam: " + e.teamId + " " + t + " -> " + n), [e, t, n] }) }) }, s.leaveTeam = function (e) { var t = this; return t.updateTeam({ teamId: e, validToCurrentUser: !1 }).then(function () { return t.removeAllTeamMembers(e) }) }, s.dismissTeam = function (e, t) { var n = this, r = { teamId: e, valid: !1, validToCurrentUser: !1, updateTime: t }; return n.updateTeam(r).then(function () { return n.removeAllTeamMembers(e) }) }, s.leaveTeams = function (e, t) { var n, r = this, i = []; return e.forEach(function (e) { n = r.leaveTeam(e.teamId, t), i.push(n) }), Promise.all(i) }, s.getTeamsByTeamIds = function (e) { var t, n = this, r = []; return e.forEach(function (e) { t = n.getTeam(e), r.push(t) }), Promise.all(r) }, s.getTeam = function (e) { e = "" + e; var t = this; return t.getOne("team", null, e).then(function (e) { return e ? (t.updateTeamProperties([e]), e) : null }) }, s.getTeams = function () { var e = this; return e.getAll("team", { filter: r }).then(function (t) { return e.updateTeamProperties(t), t }) }, s.updateTeamProperties = function (e) { e.forEach(function (e) { e && u.fillProperties(e) }) }, s.mergeTeamMembers = function (e, t, n, r) { var i = this, o = i.putTeamMembers(t), s = i.updateTeamMembers(n); return Promise.all([o, s]).then(function () { return i.logger.log("db::mergeTeamMembers: " + e), i.updateTeamMemberTimetag(e, r) }) }, s.putTeamMembers = function (e) { return this.put("teamMember", e) }, s.getTeamMembersByAccount = function (e) { return this.getOnly("teamMember", "account", e, { filter: i, mapper: o }).then() }, s.getTeamMembers = function (e) { var t = this; return e = "" + e, t.getOnly("teamMember", "teamId", e, { filter: function (e) { return e.valid }, mapper: o }).then(function (e) { return t.updateTeamMemberProperties(e).then(function () { return e }) }) }, s.updateTeamMemberProperties = function (e) { var t, n = this, r = []; return e.forEach(function (e) { l.fillProperties(e) && (t = n.updateTeamMember(e), r.push(t)) }), Promise.all(r) }, s.getInvalidTeamMembers = function (e, t) { var n = this; e = "" + e; var r, i = []; return t.forEach(function (t) { r = n.getOne("teamMember", null, l.genId(e, t)).then(function (e) { return o(e) }), i.push(r) }), Promise.all(i) }, s.updateTeamMember = function (e) { var t = this, n = e.teamId, r = e.account, i = l.genId(n, r), s = a.filterObj(e, "nickInTeam muteTeam mute custom updateTime type valid"); return this.getOne("teamMember", null, i, { modifyObj: s, mapper: o }).then(function (e) { return e ? t.logger.log("db::updateTeamMember: " + n + " " + r, s) : t.logger.warn("db::updateTeam: no record " + n + " " + r), e }) }, s.updateTeamMembers = function (e) { var t = this; if (!e.length) return Promise.resolve(); var n, r = []; return e.forEach(function (e) { n = t.updateTeamMember(e), r.push(n) }), Promise.all(r) }, s.updateTeamManagers = function (e, t, n, r) { var i = t.map(function (t) { return { teamId: e, account: t, type: n ? "manager" : "normal", updateTime: r } }); return this.updateTeamMembers(i) }, s.removeTeamMembersByAccounts = function (e, t) { var n = t.map(function (t) { return { teamId: e, account: t, valid: !1 } }); return this.updateTeamMembers(n) }, s.removeAllTeamMembers = function (e) { var t = this; return t.getOnly("teamMember", "teamId", e, { modifyObj: { valid: !1 } }).then(function () { return t.logger.warn("db::removeAllTeamMembers: " + e), t.deleteTeamMemberTimetag(e) }) }, s.deleteTeamMembers = function (e) { var t = this; return t.getOnly("teamMember", "teamId", e, { remove: !0 }).then(function () { t.logger.warn("db::deleteTeamMembers: " + e), t.deleteTeamMemberTimetag(e) }) }, s.deleteTeam = function (e) { var t, n = this, i = []; return a.isArray(e) || (e = [e]), e.forEach(function (e) { e = "" + e, t = n.get("team", e).then(function (t) { if (t && r(t)) throw c.stillInTeamError({ callFunc: "team::deleteTeam", team: t }); var i = n.remove("team", e), o = n.deleteTeamMembers(e); return Promise.all([i, o]) }), i.push(t) }), 1 === i.length ? i[0] : Promise.all(i) } }, function (e, t, n) { var r = n(16).fn, i = n(0); r.mergeFriends = function (e, t, n) { var r = this; return r.updateAndDelete("friend", e, t).then(function () { return r.logger.log("db::mergeFriends: updateAndDelete done", e), n && r.updateFriendTimetag(n), [e, t, n] }) }, r.putFriend = function (e) { return this.put("friend", e) }, r.updateFriend = function (e) { var t = this, n = (e = i.copy(e)).account; return this.getOne("friend", null, n, { modifyObj: e }).then(function (r) { return r ? t.logger.log("db::updateFriend: " + n, e) : t.logger.warn("db::updateFriend: no record " + n), r }) }, r.deleteFriend = function (e) { var t = this.remove("friend", e), n = this.deleteUser(e); return Promise.all([t, n]) }, r.getFriends = function () { return this.getAll("friend", { filter: function (e) { return e.valid } }) }, r.getFriend = function (e) { return this.getOne("friend", null, e) } }, function (e, t, n) { var r = n(16).fn, i = n(0); r.mergeRelations = function (e, t, n, r, i) { var o = this, s = o.updateAndDelete("blacklist", e, t), a = o.updateAndDelete("mutelist", n, r); return Promise.all([s, a]).then(function () { return o.logger.log("db::mergeRelations: timetag " + i), o.updateRelationTimetag(i), [e, t, n, r, i] }) }, r.getRelations = function () { var e = this.getAll("blacklist"), t = this.getAll("mutelist"); return Promise.all([e, t]) }, r.markInBlacklist = function (e) { if ((e = i.copy(e)).isAdd) { var t = e.record; return this.put("blacklist", t) } var n = e.account; return this.remove("blacklist", n) }, r.markInMutelist = function (e) { if ((e = i.copy(e)).isAdd) { var t = e.record; return this.put("mutelist", t) } var n = e.account; return this.remove("mutelist", n) } }, function (e, t, n) { var r = n(16).fn; r.getTimetags = function (e) { var t = {}; return this.getAll("timetag", { filter: e, mapper: function (e) { return -1 !== e.name.indexOf("team-") ? t[e.name] = 0 : t[e.name] = e.value, e } }).then(function () { return t }) }, r.getTeamMemberTimetags = function () { return this.getTimetags(function (e) { return -1 !== e.name.indexOf("team-") }) }, r.getTimetag = function (e) { return this.getOne("timetag", null, e).then(function (e) { return (e = e || { value: 0 }).value }) }, r.getTeamMemberTimetag = function (e) { return 0 }, r.updateTimetag = function (e, t) { var n = { name: e, value: t }; return this.put("timetag", n) }, r.updateMyInfoTimetag = function (e) { return this.updateTimetag("myInfo", e) }, r.updateRelationTimetag = function (e) { return this.updateTimetag("relations", e) }, r.getRelationsTimetag = function () { return this.getTimetag("relations") }, r.updateFriendTimetag = function (e) { return this.updateTimetag("friends", e) }, r.getFriendsTimetag = function () { return this.getTimetag("friends") }, r.updateFriendUserTimetag = function (e) { return this.updateTimetag("friendUsers", e) }, r.updateTeamTimetag = function (e) { return this.updateTimetag("teams", e) }, r.getTeamsTimetag = function () { return this.getTimetag("teams") }, r.updateSuperTeamTimetag = function (e) { return this.updateTimetag("superTeams", e) }, r.getSuperTeamsTimetag = function () { return this.getTimetag("superTeams") }, r.updateTeamMemberTimetag = function (e, t) { return this.updateTimetag("team-" + e, t) }, r.getTeamMembersTimetag = function (e) { return this.getTimetag("team-" + e) }, r.updateSuperTeamMemberTimetag = function (e, t) { return this.updateTimetag("superTeam-" + e, t) }, r.getSuperTeamMembersTimetag = function (e) { return this.getTimetag("superTeam-" + e) }, r.updateMyTeamMembersTimetag = function (e) { return this.updateTimetag("myTeamMembers", e) }, r.getBroadcastMsgTimetag = function (e) { return this.getTimetag("broadcastMsg") }, r.updateBroadcastMsgTimetag = function (e) { return this.updateTimetag("broadcastMsg", parseInt(e)) }, r.updateRoamingMsgTimetag = function (e) { return this.updateTimetag("roamingMsgs", e) }, r.updateSuperTeamRoamingMsgTimetag = function (e) { return this.updateTimetag("superTeamRoamingMsgs", e) }, r.updateMsgReceiptsTimetag = function (e) { return this.updateTimetag("msgReceipts", e) }, r.updateDonnopTimetag = function (e) { return this.updateTimetag("donnop", e) }, r.updateDeleteMsgTimetag = function (e) { return this.updateTimetag("deleteMsg", e) }, r.updateSessionAck = function (e) { return this.updateTimetag("sessionAck", e) }, r.deleteTimetag = function (e) { return this.remove("timetag", e) }, r.deleteTeamMemberTimetag = function (e) { return this.deleteTimetag("team-" + e) }, r.deleteSuperTeamMemberTimetag = function (e) { return this.deleteTimetag("superTeam-" + e) } }, function (e, t, n) { var r = n(16).fn; r.setKey = function (e, t) { return this.put("kv", { key: e, value: t }) }, r.getKey = function (e) { return this.get("kv", e).then(function (e) { return e && e.value }) }, r.setDonnop = function (e) { return this.setKey("donnop", e) }, r.getDonnop = function () { return this.getKey("donnop") } }, function (e, t, n) { function r(e) { this.concurrency = 0, this.pendingTasks = [], this.queue = Promise.resolve(), this.logger = e.logger, this.enable = !1, this.server = null, this.name = null } var i = r.prototype; i.reset = function (e) { this.enable = !1 }, i.clear = i.destroy = i.close = i.remove = i.init = function (e) { return Promise.resolve() }, e.exports = r }, function (e, t, n) { n(125); var r = n(6); n(96)(r), e.exports = r }]) },,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(27)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(35)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(43)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(51)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(59)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(67)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(75)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(83)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(91)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(99)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(107)).default) }).call(this, n(1).createPage) },,,,,, function(e, t, n) { Object.defineProperty(t, "__esModule", { value: !0 }), t.genUpToken = void 0; var r, i = n(113), o = (r = i) && r.__esModule ? r : { default: r }, s = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"; new Array(-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1), t.genUpToken = function (e, t, n) { var r = function (e) { var t, n, r, i, o, a; for (r = e.length, n = 0, t = ""; n < r;) { if (i = 255 & e.charCodeAt(n++), n == r) { t += s.charAt(i >> 2), t += s.charAt((3 & i) << 4), t += "=="; break } if (o = e.charCodeAt(n++), n == r) { t += s.charAt(i >> 2), t += s.charAt((3 & i) << 4 | (240 & o) >> 4), t += s.charAt((15 & o) << 2), t += "="; break } a = e.charCodeAt(n++), t += s.charAt(i >> 2), t += s.charAt((3 & i) << 4 | (240 & o) >> 4), t += s.charAt((15 & o) << 2 | (192 & a) >> 6), t += s.charAt(63 & a) } return t }(function (e) { var t, n, r, i; for (t = "", r = e.length, n = 0; n < r; n++)(i = e.charCodeAt(n)) >= 1 && i <= 127 ? t += e.charAt(n) : i > 2047 ? (t += String.fromCharCode(224 | i >> 12 & 15), t += String.fromCharCode(128 | i >> 6 & 63), t += String.fromCharCode(128 | i >> 0 & 63)) : (t += String.fromCharCode(192 | i >> 6 & 31), t += String.fromCharCode(128 | i >> 0 & 63)); return t }(JSON.stringify(n))); return e + ":" + function (e) { return (e = e.replace(/\+/g, "-")).replace(/\//g, "_") }(o.default.HmacSHA1(r, t).toString(o.default.enc.Base64)) + ":" + r } }, function(e, t, n) { var r; e.exports = (r = n(114), n(115), n(116), n(117), n(118), n(119), n(120), n(121), n(122), n(123), n(124), n(125), n(126), n(127), n(128), n(129), n(130), n(131), n(132), n(133), n(134), n(135), n(136), n(137), n(138), n(139), n(140), n(141), n(142), n(143), n(144), n(145), n(146), r) }, function(e, t, n) { var r; e.exports = r = r || function (e, t) { var n = Object.create || function () { function e() { } return function (t) { var n; return e.prototype = t, n = new e, e.prototype = null, n } }(), r = {}, i = r.lib = {}, o = i.Base = { extend: function (e) { var t = n(this); return e && t.mixIn(e), t.hasOwnProperty("init") && this.init !== t.init || (t.init = function () { t.$super.init.apply(this, arguments) }), t.init.prototype = t, t.$super = this, t }, create: function () { var e = this.extend(); return e.init.apply(e, arguments), e }, init: function () { }, mixIn: function (e) { for (var t in e) e.hasOwnProperty(t) && (this[t] = e[t]); e.hasOwnProperty("toString") && (this.toString = e.toString) }, clone: function () { return this.init.prototype.extend(this) } }, s = i.WordArray = o.extend({ init: function (e, t) { e = this.words = e || [], this.sigBytes = null != t ? t : 4 * e.length }, toString: function (e) { return (e || c).stringify(this) }, concat: function (e) { var t = this.words, n = e.words, r = this.sigBytes, i = e.sigBytes; if (this.clamp(), r % 4) for (var o = 0; o < i; o++) { var s = n[o >>> 2] >>> 24 - o % 4 * 8 & 255; t[r + o >>> 2] |= s << 24 - (r + o) % 4 * 8 } else for (var o = 0; o < i; o += 4)t[r + o >>> 2] = n[o >>> 2]; return this.sigBytes += i, this }, clamp: function () { var t = this.words, n = this.sigBytes; t[n >>> 2] &= 4294967295 << 32 - n % 4 * 8, t.length = e.ceil(n / 4) }, clone: function () { var e = o.clone.call(this); return e.words = this.words.slice(0), e }, random: function (t) { for (var n, r = [], i = 0; i < t; i += 4) { var o = function (t) { var t = t, n = 987654321, r = 4294967295; return function () { var i = ((n = 36969 * (65535 & n) + (n >> 16) & r) << 16) + (t = 18e3 * (65535 & t) + (t >> 16) & r) & r; return i /= 4294967296, (i += .5) * (e.random() > .5 ? 1 : -1) } }(4294967296 * (n || e.random())); n = 987654071 * o(), r.push(4294967296 * o() | 0) } return new s.init(r, t) } }), a = r.enc = {}, c = a.Hex = { stringify: function (e) { for (var t = e.words, n = e.sigBytes, r = [], i = 0; i < n; i++) { var o = t[i >>> 2] >>> 24 - i % 4 * 8 & 255; r.push((o >>> 4).toString(16)), r.push((15 & o).toString(16)) } return r.join("") }, parse: function (e) { for (var t = e.length, n = [], r = 0; r < t; r += 2)n[r >>> 3] |= parseInt(e.substr(r, 2), 16) << 24 - r % 8 * 4; return new s.init(n, t / 2) } }, u = a.Latin1 = { stringify: function (e) { for (var t = e.words, n = e.sigBytes, r = [], i = 0; i < n; i++) { var o = t[i >>> 2] >>> 24 - i % 4 * 8 & 255; r.push(String.fromCharCode(o)) } return r.join("") }, parse: function (e) { for (var t = e.length, n = [], r = 0; r < t; r++)n[r >>> 2] |= (255 & e.charCodeAt(r)) << 24 - r % 4 * 8; return new s.init(n, t) } }, l = a.Utf8 = { stringify: function (e) { try { return decodeURIComponent(escape(u.stringify(e))) } catch (e) { throw new Error("Malformed UTF-8 data") } }, parse: function (e) { return u.parse(unescape(encodeURIComponent(e))) } }, m = i.BufferedBlockAlgorithm = o.extend({ reset: function () { this._data = new s.init, this._nDataBytes = 0 }, _append: function (e) { "string" == typeof e && (e = l.parse(e)), this._data.concat(e), this._nDataBytes += e.sigBytes }, _process: function (t) { var n = this._data, r = n.words, i = n.sigBytes, o = this.blockSize, a = 4 * o, c = i / a, u = (c = t ? e.ceil(c) : e.max((0 | c) - this._minBufferSize, 0)) * o, l = e.min(4 * u, i); if (u) { for (var m = 0; m < u; m += o)this._doProcessBlock(r, m); var d = r.splice(0, u); n.sigBytes -= l } return new s.init(d, l) }, clone: function () { var e = o.clone.call(this); return e._data = this._data.clone(), e }, _minBufferSize: 0 }), d = (i.Hasher = m.extend({ cfg: o.extend(), init: function (e) { this.cfg = this.cfg.extend(e), this.reset() }, reset: function () { m.reset.call(this), this._doReset() }, update: function (e) { return this._append(e), this._process(), this }, finalize: function (e) { return e && this._append(e), this._doFinalize() }, blockSize: 16, _createHelper: function (e) { return function (t, n) { return new e.init(n).finalize(t) } }, _createHmacHelper: function (e) { return function (t, n) { return new d.HMAC.init(e, n).finalize(t) } } }), r.algo = {}); return r }(Math) }, function(e, t, n) { var r, i, o, s, a, c; e.exports = (r = n(114), o = (i = r).lib, s = o.Base, a = o.WordArray, (c = i.x64 = {}).Word = s.extend({ init: function (e, t) { this.high = e, this.low = t } }), c.WordArray = s.extend({ init: function (e, t) { e = this.words = e || [], this.sigBytes = null != t ? t : 8 * e.length }, toX32: function () { for (var e = this.words, t = e.length, n = [], r = 0; r < t; r++) { var i = e[r]; n.push(i.high), n.push(i.low) } return a.create(n, this.sigBytes) }, clone: function () { for (var e = s.clone.call(this), t = e.words = this.words.slice(0), n = t.length, r = 0; r < n; r++)t[r] = t[r].clone(); return e } }), r) }, function(e, t, n) { var r; e.exports = (r = n(114), function () { if ("function" == typeof ArrayBuffer) { var e = r.lib.WordArray, t = e.init; (e.init = function (e) { if (e instanceof ArrayBuffer && (e = new Uint8Array(e)), (e instanceof Int8Array || "undefined" != typeof Uint8ClampedArray && e instanceof Uint8ClampedArray || e instanceof Int16Array || e instanceof Uint16Array || e instanceof Int32Array || e instanceof Uint32Array || e instanceof Float32Array || e instanceof Float64Array) && (e = new Uint8Array(e.buffer, e.byteOffset, e.byteLength)), e instanceof Uint8Array) { for (var n = e.byteLength, r = [], i = 0; i < n; i++)r[i >>> 2] |= e[i] << 24 - i % 4 * 8; t.call(this, r, n) } else t.apply(this, arguments) }).prototype = e } }(), r.lib.WordArray) }, function(e, t, n) { var r; e.exports = (r = n(114), function () { function e(e) { return e << 8 & 4278255360 | e >>> 8 & 16711935 } var t = r, n = t.lib.WordArray, i = t.enc; i.Utf16 = i.Utf16BE = { stringify: function (e) { for (var t = e.words, n = e.sigBytes, r = [], i = 0; i < n; i += 2) { var o = t[i >>> 2] >>> 16 - i % 4 * 8 & 65535; r.push(String.fromCharCode(o)) } return r.join("") }, parse: function (e) { for (var t = e.length, r = [], i = 0; i < t; i++)r[i >>> 1] |= e.charCodeAt(i) << 16 - i % 2 * 16; return n.create(r, 2 * t) } }, i.Utf16LE = { stringify: function (t) { for (var n = t.words, r = t.sigBytes, i = [], o = 0; o < r; o += 2) { var s = e(n[o >>> 2] >>> 16 - o % 4 * 8 & 65535); i.push(String.fromCharCode(s)) } return i.join("") }, parse: function (t) { for (var r = t.length, i = [], o = 0; o < r; o++)i[o >>> 1] |= e(t.charCodeAt(o) << 16 - o % 2 * 16); return n.create(i, 2 * r) } } }(), r.enc.Utf16) }, function(e, t, n) { var r, i, o; e.exports = (r = n(114), o = (i = r).lib.WordArray, i.enc.Base64 = { stringify: function (e) { var t = e.words, n = e.sigBytes, r = this._map; e.clamp(); for (var i = [], o = 0; o < n; o += 3)for (var s = (t[o >>> 2] >>> 24 - o % 4 * 8 & 255) << 16 | (t[o + 1 >>> 2] >>> 24 - (o + 1) % 4 * 8 & 255) << 8 | t[o + 2 >>> 2] >>> 24 - (o + 2) % 4 * 8 & 255, a = 0; a < 4 && o + .75 * a < n; a++)i.push(r.charAt(s >>> 6 * (3 - a) & 63)); var c = r.charAt(64); if (c) for (; i.length % 4;)i.push(c); return i.join("") }, parse: function (e) { var t = e.length, n = this._map, r = this._reverseMap; if (!r) { r = this._reverseMap = []; for (var i = 0; i < n.length; i++)r[n.charCodeAt(i)] = i } var s = n.charAt(64); if (s) { var a = e.indexOf(s); -1 !== a && (t = a) } return function (e, t, n) { for (var r = [], i = 0, s = 0; s < t; s++)if (s % 4) { var a = n[e.charCodeAt(s - 1)] << s % 4 * 2, c = n[e.charCodeAt(s)] >>> 6 - s % 4 * 2; r[i >>> 2] |= (a | c) << 24 - i % 4 * 8, i++ } return o.create(r, i) }(e, t, r) }, _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=" }, r.enc.Base64) }, function(e, t, n) { var r; e.exports = (r = n(114), function (e) { function t(e, t, n, r, i, o, s) { var a = e + (t & n | ~t & r) + i + s; return (a << o | a >>> 32 - o) + t } function n(e, t, n, r, i, o, s) { var a = e + (t & r | n & ~r) + i + s; return (a << o | a >>> 32 - o) + t } function i(e, t, n, r, i, o, s) { var a = e + (t ^ n ^ r) + i + s; return (a << o | a >>> 32 - o) + t } function o(e, t, n, r, i, o, s) { var a = e + (n ^ (t | ~r)) + i + s; return (a << o | a >>> 32 - o) + t } var s = r, a = s.lib, c = a.WordArray, u = a.Hasher, l = s.algo, m = []; !function () { for (var t = 0; t < 64; t++)m[t] = 4294967296 * e.abs(e.sin(t + 1)) | 0 }(); var d = l.MD5 = u.extend({ _doReset: function () { this._hash = new c.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (e, r) { for (var s = 0; s < 16; s++) { var a = r + s, c = e[a]; e[a] = 16711935 & (c << 8 | c >>> 24) | 4278255360 & (c << 24 | c >>> 8) } var u = this._hash.words, l = e[r + 0], d = e[r + 1], p = e[r + 2], f = e[r + 3], g = e[r + 4], h = e[r + 5], y = e[r + 6], v = e[r + 7], b = e[r + 8], T = e[r + 9], M = e[r + 10], S = e[r + 11], k = e[r + 12], _ = e[r + 13], w = e[r + 14], P = e[r + 15], C = u[0], I = u[1], O = u[2], A = u[3]; C = t(C, I, O, A, l, 7, m[0]), A = t(A, C, I, O, d, 12, m[1]), O = t(O, A, C, I, p, 17, m[2]), I = t(I, O, A, C, f, 22, m[3]), C = t(C, I, O, A, g, 7, m[4]), A = t(A, C, I, O, h, 12, m[5]), O = t(O, A, C, I, y, 17, m[6]), I = t(I, O, A, C, v, 22, m[7]), C = t(C, I, O, A, b, 7, m[8]), A = t(A, C, I, O, T, 12, m[9]), O = t(O, A, C, I, M, 17, m[10]), I = t(I, O, A, C, S, 22, m[11]), C = t(C, I, O, A, k, 7, m[12]), A = t(A, C, I, O, _, 12, m[13]), O = t(O, A, C, I, w, 17, m[14]), C = n(C, I = t(I, O, A, C, P, 22, m[15]), O, A, d, 5, m[16]), A = n(A, C, I, O, y, 9, m[17]), O = n(O, A, C, I, S, 14, m[18]), I = n(I, O, A, C, l, 20, m[19]), C = n(C, I, O, A, h, 5, m[20]), A = n(A, C, I, O, M, 9, m[21]), O = n(O, A, C, I, P, 14, m[22]), I = n(I, O, A, C, g, 20, m[23]), C = n(C, I, O, A, T, 5, m[24]), A = n(A, C, I, O, w, 9, m[25]), O = n(O, A, C, I, f, 14, m[26]), I = n(I, O, A, C, b, 20, m[27]), C = n(C, I, O, A, _, 5, m[28]), A = n(A, C, I, O, p, 9, m[29]), O = n(O, A, C, I, v, 14, m[30]), C = i(C, I = n(I, O, A, C, k, 20, m[31]), O, A, h, 4, m[32]), A = i(A, C, I, O, b, 11, m[33]), O = i(O, A, C, I, S, 16, m[34]), I = i(I, O, A, C, w, 23, m[35]), C = i(C, I, O, A, d, 4, m[36]), A = i(A, C, I, O, g, 11, m[37]), O = i(O, A, C, I, v, 16, m[38]), I = i(I, O, A, C, M, 23, m[39]), C = i(C, I, O, A, _, 4, m[40]), A = i(A, C, I, O, l, 11, m[41]), O = i(O, A, C, I, f, 16, m[42]), I = i(I, O, A, C, y, 23, m[43]), C = i(C, I, O, A, T, 4, m[44]), A = i(A, C, I, O, k, 11, m[45]), O = i(O, A, C, I, P, 16, m[46]), C = o(C, I = i(I, O, A, C, p, 23, m[47]), O, A, l, 6, m[48]), A = o(A, C, I, O, v, 10, m[49]), O = o(O, A, C, I, w, 15, m[50]), I = o(I, O, A, C, h, 21, m[51]), C = o(C, I, O, A, k, 6, m[52]), A = o(A, C, I, O, f, 10, m[53]), O = o(O, A, C, I, M, 15, m[54]), I = o(I, O, A, C, d, 21, m[55]), C = o(C, I, O, A, b, 6, m[56]), A = o(A, C, I, O, P, 10, m[57]), O = o(O, A, C, I, y, 15, m[58]), I = o(I, O, A, C, _, 21, m[59]), C = o(C, I, O, A, g, 6, m[60]), A = o(A, C, I, O, S, 10, m[61]), O = o(O, A, C, I, p, 15, m[62]), I = o(I, O, A, C, T, 21, m[63]), u[0] = u[0] + C | 0, u[1] = u[1] + I | 0, u[2] = u[2] + O | 0, u[3] = u[3] + A | 0 }, _doFinalize: function () { var t = this._data, n = t.words, r = 8 * this._nDataBytes, i = 8 * t.sigBytes; n[i >>> 5] |= 128 << 24 - i % 32; var o = e.floor(r / 4294967296), s = r; n[15 + (i + 64 >>> 9 << 4)] = 16711935 & (o << 8 | o >>> 24) | 4278255360 & (o << 24 | o >>> 8), n[14 + (i + 64 >>> 9 << 4)] = 16711935 & (s << 8 | s >>> 24) | 4278255360 & (s << 24 | s >>> 8), t.sigBytes = 4 * (n.length + 1), this._process(); for (var a = this._hash, c = a.words, u = 0; u < 4; u++) { var l = c[u]; c[u] = 16711935 & (l << 8 | l >>> 24) | 4278255360 & (l << 24 | l >>> 8) } return a }, clone: function () { var e = u.clone.call(this); return e._hash = this._hash.clone(), e } }); s.MD5 = u._createHelper(d), s.HmacMD5 = u._createHmacHelper(d) }(Math), r.MD5) }, function(e, t, n) { var r, i, o, s, a, c, u, l; e.exports = (r = n(114), o = (i = r).lib, s = o.WordArray, a = o.Hasher, c = i.algo, u = [], l = c.SHA1 = a.extend({ _doReset: function () { this._hash = new s.init([1732584193, 4023233417, 2562383102, 271733878, 3285377520]) }, _doProcessBlock: function (e, t) { for (var n = this._hash.words, r = n[0], i = n[1], o = n[2], s = n[3], a = n[4], c = 0; c < 80; c++) { if (c < 16) u[c] = 0 | e[t + c]; else { var l = u[c - 3] ^ u[c - 8] ^ u[c - 14] ^ u[c - 16]; u[c] = l << 1 | l >>> 31 } var m = (r << 5 | r >>> 27) + a + u[c]; m += c < 20 ? 1518500249 + (i & o | ~i & s) : c < 40 ? 1859775393 + (i ^ o ^ s) : c < 60 ? (i & o | i & s | o & s) - 1894007588 : (i ^ o ^ s) - 899497514, a = s, s = o, o = i << 30 | i >>> 2, i = r, r = m } n[0] = n[0] + r | 0, n[1] = n[1] + i | 0, n[2] = n[2] + o | 0, n[3] = n[3] + s | 0, n[4] = n[4] + a | 0 }, _doFinalize: function () { var e = this._data, t = e.words, n = 8 * this._nDataBytes, r = 8 * e.sigBytes; return t[r >>> 5] |= 128 << 24 - r % 32, t[14 + (r + 64 >>> 9 << 4)] = Math.floor(n / 4294967296), t[15 + (r + 64 >>> 9 << 4)] = n, e.sigBytes = 4 * t.length, this._process(), this._hash }, clone: function () { var e = a.clone.call(this); return e._hash = this._hash.clone(), e } }), i.SHA1 = a._createHelper(l), i.HmacSHA1 = a._createHmacHelper(l), r.SHA1) }, function(e, t, n) { var r; e.exports = (r = n(114), function (e) { var t = r, n = t.lib, i = n.WordArray, o = n.Hasher, s = t.algo, a = [], c = []; !function () { function t(e) { return 4294967296 * (e - (0 | e)) | 0 } for (var n = 2, r = 0; r < 64;)(function (t) { for (var n = e.sqrt(t), r = 2; r <= n; r++)if (!(t % r)) return !1; return !0 })(n) && (r < 8 && (a[r] = t(e.pow(n, .5))), c[r] = t(e.pow(n, 1 / 3)), r++), n++ }(); var u = [], l = s.SHA256 = o.extend({ _doReset: function () { this._hash = new i.init(a.slice(0)) }, _doProcessBlock: function (e, t) { for (var n = this._hash.words, r = n[0], i = n[1], o = n[2], s = n[3], a = n[4], l = n[5], m = n[6], d = n[7], p = 0; p < 64; p++) { if (p < 16) u[p] = 0 | e[t + p]; else { var f = u[p - 15], g = (f << 25 | f >>> 7) ^ (f << 14 | f >>> 18) ^ f >>> 3, h = u[p - 2], y = (h << 15 | h >>> 17) ^ (h << 13 | h >>> 19) ^ h >>> 10; u[p] = g + u[p - 7] + y + u[p - 16] } var v = r & i ^ r & o ^ i & o, b = (r << 30 | r >>> 2) ^ (r << 19 | r >>> 13) ^ (r << 10 | r >>> 22), T = d + ((a << 26 | a >>> 6) ^ (a << 21 | a >>> 11) ^ (a << 7 | a >>> 25)) + (a & l ^ ~a & m) + c[p] + u[p]; d = m, m = l, l = a, a = s + T | 0, s = o, o = i, i = r, r = T + (b + v) | 0 } n[0] = n[0] + r | 0, n[1] = n[1] + i | 0, n[2] = n[2] + o | 0, n[3] = n[3] + s | 0, n[4] = n[4] + a | 0, n[5] = n[5] + l | 0, n[6] = n[6] + m | 0, n[7] = n[7] + d | 0 }, _doFinalize: function () { var t = this._data, n = t.words, r = 8 * this._nDataBytes, i = 8 * t.sigBytes; return n[i >>> 5] |= 128 << 24 - i % 32, n[14 + (i + 64 >>> 9 << 4)] = e.floor(r / 4294967296), n[15 + (i + 64 >>> 9 << 4)] = r, t.sigBytes = 4 * n.length, this._process(), this._hash }, clone: function () { var e = o.clone.call(this); return e._hash = this._hash.clone(), e } }); t.SHA256 = o._createHelper(l), t.HmacSHA256 = o._createHmacHelper(l) }(Math), r.SHA256) }, function(e, t, n) { var r, i, o, s, a, c; e.exports = (r = n(114), n(121), o = (i = r).lib.WordArray, s = i.algo, a = s.SHA256, c = s.SHA224 = a.extend({ _doReset: function () { this._hash = new o.init([3238371032, 914150663, 812702999, 4144912697, 4290775857, 1750603025, 1694076839, 3204075428]) }, _doFinalize: function () { var e = a._doFinalize.call(this); return e.sigBytes -= 4, e } }), i.SHA224 = a._createHelper(c), i.HmacSHA224 = a._createHmacHelper(c), r.SHA224) }, function(e, t, n) { var r; e.exports = (r = n(114), n(115), function () { function e() { return o.create.apply(o, arguments) } var t = r, n = t.lib.Hasher, i = t.x64, o = i.Word, s = i.WordArray, a = t.algo, c = [e(1116352408, 3609767458), e(1899447441, 602891725), e(3049323471, 3964484399), e(3921009573, 2173295548), e(961987163, 4081628472), e(1508970993, 3053834265), e(2453635748, 2937671579), e(2870763221, 3664609560), e(3624381080, 2734883394), e(310598401, 1164996542), e(607225278, 1323610764), e(1426881987, 3590304994), e(1925078388, 4068182383), e(2162078206, 991336113), e(2614888103, 633803317), e(3248222580, 3479774868), e(3835390401, 2666613458), e(4022224774, 944711139), e(264347078, 2341262773), e(604807628, 2007800933), e(770255983, 1495990901), e(1249150122, 1856431235), e(1555081692, 3175218132), e(1996064986, 2198950837), e(2554220882, 3999719339), e(2821834349, 766784016), e(2952996808, 2566594879), e(3210313671, 3203337956), e(3336571891, 1034457026), e(3584528711, 2466948901), e(113926993, 3758326383), e(338241895, 168717936), e(666307205, 1188179964), e(773529912, 1546045734), e(1294757372, 1522805485), e(1396182291, 2643833823), e(1695183700, 2343527390), e(1986661051, 1014477480), e(2177026350, 1206759142), e(2456956037, 344077627), e(2730485921, 1290863460), e(2820302411, 3158454273), e(3259730800, 3505952657), e(3345764771, 106217008), e(3516065817, 3606008344), e(3600352804, 1432725776), e(4094571909, 1467031594), e(275423344, 851169720), e(430227734, 3100823752), e(506948616, 1363258195), e(659060556, 3750685593), e(883997877, 3785050280), e(958139571, 3318307427), e(1322822218, 3812723403), e(1537002063, 2003034995), e(1747873779, 3602036899), e(1955562222, 1575990012), e(2024104815, 1125592928), e(2227730452, 2716904306), e(2361852424, 442776044), e(2428436474, 593698344), e(2756734187, 3733110249), e(3204031479, 2999351573), e(3329325298, 3815920427), e(3391569614, 3928383900), e(3515267271, 566280711), e(3940187606, 3454069534), e(4118630271, 4000239992), e(116418474, 1914138554), e(174292421, 2731055270), e(289380356, 3203993006), e(460393269, 320620315), e(685471733, 587496836), e(852142971, 1086792851), e(1017036298, 365543100), e(1126000580, 2618297676), e(1288033470, 3409855158), e(1501505948, 4234509866), e(1607167915, 987167468), e(1816402316, 1246189591)], u = []; !function () { for (var t = 0; t < 80; t++)u[t] = e() }(); var l = a.SHA512 = n.extend({ _doReset: function () { this._hash = new s.init([new o.init(1779033703, 4089235720), new o.init(3144134277, 2227873595), new o.init(1013904242, 4271175723), new o.init(2773480762, 1595750129), new o.init(1359893119, 2917565137), new o.init(2600822924, 725511199), new o.init(528734635, 4215389547), new o.init(1541459225, 327033209)]) }, _doProcessBlock: function (e, t) { for (var n = this._hash.words, r = n[0], i = n[1], o = n[2], s = n[3], a = n[4], l = n[5], m = n[6], d = n[7], p = r.high, f = r.low, g = i.high, h = i.low, y = o.high, v = o.low, b = s.high, T = s.low, M = a.high, S = a.low, k = l.high, _ = l.low, w = m.high, P = m.low, C = d.high, I = d.low, O = p, A = f, x = g, E = h, j = y, U = v, R = b, F = T, N = M, D = S, B = k, L = _, $ = w, q = P, H = C, z = I, V = 0; V < 80; V++) { var W = u[V]; if (V < 16) var J = W.high = 0 | e[t + 2 * V], X = W.low = 0 | e[t + 2 * V + 1]; else { var G = u[V - 15], K = G.high, Q = G.low, Y = (K >>> 1 | Q << 31) ^ (K >>> 8 | Q << 24) ^ K >>> 7, Z = (Q >>> 1 | K << 31) ^ (Q >>> 8 | K << 24) ^ (Q >>> 7 | K << 25), ee = u[V - 2], te = ee.high, ne = ee.low, re = (te >>> 19 | ne << 13) ^ (te << 3 | ne >>> 29) ^ te >>> 6, ie = (ne >>> 19 | te << 13) ^ (ne << 3 | te >>> 29) ^ (ne >>> 6 | te << 26), oe = u[V - 7], se = oe.high, ae = oe.low, ce = u[V - 16], ue = ce.high, le = ce.low; J = (J = (J = Y + se + ((X = Z + ae) >>> 0 < Z >>> 0 ? 1 : 0)) + re + ((X += ie) >>> 0 < ie >>> 0 ? 1 : 0)) + ue + ((X += le) >>> 0 < le >>> 0 ? 1 : 0), W.high = J, W.low = X } var me, de = N & B ^ ~N & $, pe = D & L ^ ~D & q, fe = O & x ^ O & j ^ x & j, ge = A & E ^ A & U ^ E & U, he = (O >>> 28 | A << 4) ^ (O << 30 | A >>> 2) ^ (O << 25 | A >>> 7), ye = (A >>> 28 | O << 4) ^ (A << 30 | O >>> 2) ^ (A << 25 | O >>> 7), ve = (N >>> 14 | D << 18) ^ (N >>> 18 | D << 14) ^ (N << 23 | D >>> 9), be = (D >>> 14 | N << 18) ^ (D >>> 18 | N << 14) ^ (D << 23 | N >>> 9), Te = c[V], Me = Te.high, Se = Te.low, ke = H + ve + ((me = z + be) >>> 0 < z >>> 0 ? 1 : 0), _e = ye + ge; H = $, z = q, $ = B, q = L, B = N, L = D, N = R + (ke = (ke = (ke = ke + de + ((me += pe) >>> 0 < pe >>> 0 ? 1 : 0)) + Me + ((me += Se) >>> 0 < Se >>> 0 ? 1 : 0)) + J + ((me += X) >>> 0 < X >>> 0 ? 1 : 0)) + ((D = F + me | 0) >>> 0 < F >>> 0 ? 1 : 0) | 0, R = j, F = U, j = x, U = E, x = O, E = A, O = ke + (he + fe + (_e >>> 0 < ye >>> 0 ? 1 : 0)) + ((A = me + _e | 0) >>> 0 < me >>> 0 ? 1 : 0) | 0 } f = r.low = f + A, r.high = p + O + (f >>> 0 < A >>> 0 ? 1 : 0), h = i.low = h + E, i.high = g + x + (h >>> 0 < E >>> 0 ? 1 : 0), v = o.low = v + U, o.high = y + j + (v >>> 0 < U >>> 0 ? 1 : 0), T = s.low = T + F, s.high = b + R + (T >>> 0 < F >>> 0 ? 1 : 0), S = a.low = S + D, a.high = M + N + (S >>> 0 < D >>> 0 ? 1 : 0), _ = l.low = _ + L, l.high = k + B + (_ >>> 0 < L >>> 0 ? 1 : 0), P = m.low = P + q, m.high = w + $ + (P >>> 0 < q >>> 0 ? 1 : 0), I = d.low = I + z, d.high = C + H + (I >>> 0 < z >>> 0 ? 1 : 0) }, _doFinalize: function () { var e = this._data, t = e.words, n = 8 * this._nDataBytes, r = 8 * e.sigBytes; return t[r >>> 5] |= 128 << 24 - r % 32, t[30 + (r + 128 >>> 10 << 5)] = Math.floor(n / 4294967296), t[31 + (r + 128 >>> 10 << 5)] = n, e.sigBytes = 4 * t.length, this._process(), this._hash.toX32() }, clone: function () { var e = n.clone.call(this); return e._hash = this._hash.clone(), e }, blockSize: 32 }); t.SHA512 = n._createHelper(l), t.HmacSHA512 = n._createHmacHelper(l) }(), r.SHA512) }, function(e, t, n) { var r, i, o, s, a, c, u, l; e.exports = (r = n(114), n(115), n(123), o = (i = r).x64, s = o.Word, a = o.WordArray, c = i.algo, u = c.SHA512, l = c.SHA384 = u.extend({ _doReset: function () { this._hash = new a.init([new s.init(3418070365, 3238371032), new s.init(1654270250, 914150663), new s.init(2438529370, 812702999), new s.init(355462360, 4144912697), new s.init(1731405415, 4290775857), new s.init(2394180231, 1750603025), new s.init(3675008525, 1694076839), new s.init(1203062813, 3204075428)]) }, _doFinalize: function () { var e = u._doFinalize.call(this); return e.sigBytes -= 16, e } }), i.SHA384 = u._createHelper(l), i.HmacSHA384 = u._createHmacHelper(l), r.SHA384) }, function(e, t, n) { var r; e.exports = (r = n(114), n(115), function (e) { var t = r, n = t.lib, i = n.WordArray, o = n.Hasher, s = t.x64.Word, a = t.algo, c = [], u = [], l = []; !function () { for (var e = 1, t = 0, n = 0; n < 24; n++) { c[e + 5 * t] = (n + 1) * (n + 2) / 2 % 64; var r = (2 * e + 3 * t) % 5; e = t % 5, t = r } for (e = 0; e < 5; e++)for (t = 0; t < 5; t++)u[e + 5 * t] = t + (2 * e + 3 * t) % 5 * 5; for (var i = 1, o = 0; o < 24; o++) { for (var a = 0, m = 0, d = 0; d < 7; d++) { if (1 & i) { var p = (1 << d) - 1; p < 32 ? m ^= 1 << p : a ^= 1 << p - 32 } 128 & i ? i = i << 1 ^ 113 : i <<= 1 } l[o] = s.create(a, m) } }(); var m = []; !function () { for (var e = 0; e < 25; e++)m[e] = s.create() }(); var d = a.SHA3 = o.extend({ cfg: o.cfg.extend({ outputLength: 512 }), _doReset: function () { for (var e = this._state = [], t = 0; t < 25; t++)e[t] = new s.init; this.blockSize = (1600 - 2 * this.cfg.outputLength) / 32 }, _doProcessBlock: function (e, t) { for (var n = this._state, r = this.blockSize / 2, i = 0; i < r; i++) { var o = e[t + 2 * i], s = e[t + 2 * i + 1]; o = 16711935 & (o << 8 | o >>> 24) | 4278255360 & (o << 24 | o >>> 8), s = 16711935 & (s << 8 | s >>> 24) | 4278255360 & (s << 24 | s >>> 8), (I = n[i]).high ^= s, I.low ^= o } for (var a = 0; a < 24; a++) { for (var d = 0; d < 5; d++) { for (var p = 0, f = 0, g = 0; g < 5; g++)p ^= (I = n[d + 5 * g]).high, f ^= I.low; var h = m[d]; h.high = p, h.low = f } for (d = 0; d < 5; d++) { var y = m[(d + 4) % 5], v = m[(d + 1) % 5], b = v.high, T = v.low; for (p = y.high ^ (b << 1 | T >>> 31), f = y.low ^ (T << 1 | b >>> 31), g = 0; g < 5; g++)(I = n[d + 5 * g]).high ^= p, I.low ^= f } for (var M = 1; M < 25; M++) { var S = (I = n[M]).high, k = I.low, _ = c[M]; _ < 32 ? (p = S << _ | k >>> 32 - _, f = k << _ | S >>> 32 - _) : (p = k << _ - 32 | S >>> 64 - _, f = S << _ - 32 | k >>> 64 - _); var w = m[u[M]]; w.high = p, w.low = f } var P = m[0], C = n[0]; for (P.high = C.high, P.low = C.low, d = 0; d < 5; d++)for (g = 0; g < 5; g++) { var I = n[M = d + 5 * g], O = m[M], A = m[(d + 1) % 5 + 5 * g], x = m[(d + 2) % 5 + 5 * g]; I.high = O.high ^ ~A.high & x.high, I.low = O.low ^ ~A.low & x.low } I = n[0]; var E = l[a]; I.high ^= E.high, I.low ^= E.low } }, _doFinalize: function () { var t = this._data, n = t.words, r = (this._nDataBytes, 8 * t.sigBytes), o = 32 * this.blockSize; n[r >>> 5] |= 1 << 24 - r % 32, n[(e.ceil((r + 1) / o) * o >>> 5) - 1] |= 128, t.sigBytes = 4 * n.length, this._process(); for (var s = this._state, a = this.cfg.outputLength / 8, c = a / 8, u = [], l = 0; l < c; l++) { var m = s[l], d = m.high, p = m.low; d = 16711935 & (d << 8 | d >>> 24) | 4278255360 & (d << 24 | d >>> 8), p = 16711935 & (p << 8 | p >>> 24) | 4278255360 & (p << 24 | p >>> 8), u.push(p), u.push(d) } return new i.init(u, a) }, clone: function () { for (var e = o.clone.call(this), t = e._state = this._state.slice(0), n = 0; n < 25; n++)t[n] = t[n].clone(); return e } }); t.SHA3 = o._createHelper(d), t.HmacSHA3 = o._createHmacHelper(d) }(Math), r.SHA3) }, function(e, t, n) { var r; e.exports = (r = n(114), function (e) { function t(e, t, n) { return e ^ t ^ n } function n(e, t, n) { return e & t | ~e & n } function i(e, t, n) { return (e | ~t) ^ n } function o(e, t, n) { return e & n | t & ~n } function s(e, t, n) { return e ^ (t | ~n) } function a(e, t) { return e << t | e >>> 32 - t } var c = r, u = c.lib, l = u.WordArray, m = u.Hasher, d = c.algo, p = l.create([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8, 3, 10, 14, 4, 9, 15, 8, 1, 2, 7, 0, 6, 13, 11, 5, 12, 1, 9, 11, 10, 0, 8, 12, 4, 13, 3, 7, 15, 14, 5, 6, 2, 4, 0, 5, 9, 7, 12, 2, 10, 14, 1, 3, 8, 11, 6, 15, 13]), f = l.create([5, 14, 7, 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12, 6, 11, 3, 7, 0, 13, 5, 10, 14, 15, 8, 12, 4, 9, 1, 2, 15, 5, 1, 3, 7, 14, 6, 9, 11, 8, 12, 2, 10, 0, 4, 13, 8, 6, 4, 1, 3, 11, 15, 0, 5, 12, 2, 13, 9, 7, 10, 14, 12, 15, 10, 4, 1, 5, 8, 7, 6, 2, 13, 14, 0, 3, 9, 11]), g = l.create([11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8, 7, 6, 8, 13, 11, 9, 7, 15, 7, 12, 15, 9, 11, 7, 13, 12, 11, 13, 6, 7, 14, 9, 13, 15, 14, 8, 13, 6, 5, 12, 7, 5, 11, 12, 14, 15, 14, 15, 9, 8, 9, 14, 5, 6, 8, 6, 5, 12, 9, 15, 5, 11, 6, 8, 13, 12, 5, 12, 13, 14, 11, 8, 5, 6]), h = l.create([8, 9, 9, 11, 13, 15, 15, 5, 7, 7, 8, 11, 14, 14, 12, 6, 9, 13, 15, 7, 12, 8, 9, 11, 7, 7, 12, 7, 6, 15, 13, 11, 9, 7, 15, 11, 8, 6, 6, 14, 12, 13, 5, 14, 13, 13, 7, 5, 15, 5, 8, 11, 14, 14, 6, 14, 6, 9, 12, 9, 12, 5, 15, 8, 8, 5, 12, 9, 12, 5, 14, 6, 8, 13, 6, 5, 15, 13, 11, 11]), y = l.create([0, 1518500249, 1859775393, 2400959708, 2840853838]), v = l.create([1352829926, 1548603684, 1836072691, 2053994217, 0]), b = d.RIPEMD160 = m.extend({ _doReset: function () { this._hash = l.create([1732584193, 4023233417, 2562383102, 271733878, 3285377520]) }, _doProcessBlock: function (e, r) { for (var c = 0; c < 16; c++) { var u = r + c, l = e[u]; e[u] = 16711935 & (l << 8 | l >>> 24) | 4278255360 & (l << 24 | l >>> 8) } var m, d, b, T, M, S, k, _, w, P, C, I = this._hash.words, O = y.words, A = v.words, x = p.words, E = f.words, j = g.words, U = h.words; for (S = m = I[0], k = d = I[1], _ = b = I[2], w = T = I[3], P = M = I[4], c = 0; c < 80; c += 1)C = m + e[r + x[c]] | 0, C += c < 16 ? t(d, b, T) + O[0] : c < 32 ? n(d, b, T) + O[1] : c < 48 ? i(d, b, T) + O[2] : c < 64 ? o(d, b, T) + O[3] : s(d, b, T) + O[4], C = (C = a(C |= 0, j[c])) + M | 0, m = M, M = T, T = a(b, 10), b = d, d = C, C = S + e[r + E[c]] | 0, C += c < 16 ? s(k, _, w) + A[0] : c < 32 ? o(k, _, w) + A[1] : c < 48 ? i(k, _, w) + A[2] : c < 64 ? n(k, _, w) + A[3] : t(k, _, w) + A[4], C = (C = a(C |= 0, U[c])) + P | 0, S = P, P = w, w = a(_, 10), _ = k, k = C; C = I[1] + b + w | 0, I[1] = I[2] + T + P | 0, I[2] = I[3] + M + S | 0, I[3] = I[4] + m + k | 0, I[4] = I[0] + d + _ | 0, I[0] = C }, _doFinalize: function () { var e = this._data, t = e.words, n = 8 * this._nDataBytes, r = 8 * e.sigBytes; t[r >>> 5] |= 128 << 24 - r % 32, t[14 + (r + 64 >>> 9 << 4)] = 16711935 & (n << 8 | n >>> 24) | 4278255360 & (n << 24 | n >>> 8), e.sigBytes = 4 * (t.length + 1), this._process(); for (var i = this._hash, o = i.words, s = 0; s < 5; s++) { var a = o[s]; o[s] = 16711935 & (a << 8 | a >>> 24) | 4278255360 & (a << 24 | a >>> 8) } return i }, clone: function () { var e = m.clone.call(this); return e._hash = this._hash.clone(), e } }); c.RIPEMD160 = m._createHelper(b), c.HmacRIPEMD160 = m._createHmacHelper(b) }(Math), r.RIPEMD160) }, function(e, t, n) { var r, i, o, s, a, c, u; e.exports = (r = n(114), o = (i = r).lib, s = o.Base, a = i.enc, c = a.Utf8, u = i.algo, void (u.HMAC = s.extend({ init: function (e, t) { e = this._hasher = new e.init, "string" == typeof t && (t = c.parse(t)); var n = e.blockSize, r = 4 * n; t.sigBytes > r && (t = e.finalize(t)), t.clamp(); for (var i = this._oKey = t.clone(), o = this._iKey = t.clone(), s = i.words, a = o.words, u = 0; u < n; u++)s[u] ^= 1549556828, a[u] ^= 909522486; i.sigBytes = o.sigBytes = r, this.reset() }, reset: function () { var e = this._hasher; e.reset(), e.update(this._iKey) }, update: function (e) { return this._hasher.update(e), this }, finalize: function (e) { var t = this._hasher, n = t.finalize(e); return t.reset(), t.finalize(this._oKey.clone().concat(n)) } }))) }, function(e, t, n) { var r, i, o, s, a, c, u, l, m; e.exports = (r = n(114), n(120), n(127), o = (i = r).lib, s = o.Base, a = o.WordArray, c = i.algo, u = c.SHA1, l = c.HMAC, m = c.PBKDF2 = s.extend({ cfg: s.extend({ keySize: 4, hasher: u, iterations: 1 }), init: function (e) { this.cfg = this.cfg.extend(e) }, compute: function (e, t) { for (var n = this.cfg, r = l.create(n.hasher, e), i = a.create(), o = a.create([1]), s = i.words, c = o.words, u = n.keySize, m = n.iterations; s.length < u;) { var d = r.update(t).finalize(o); r.reset(); for (var p = d.words, f = p.length, g = d, h = 1; h < m; h++) { g = r.finalize(g), r.reset(); for (var y = g.words, v = 0; v < f; v++)p[v] ^= y[v] } i.concat(d), c[0]++ } return i.sigBytes = 4 * u, i } }), i.PBKDF2 = function (e, t, n) { return m.create(n).compute(e, t) }, r.PBKDF2) }, function(e, t, n) { var r, i, o, s, a, c, u, l; e.exports = (r = n(114), n(120), n(127), o = (i = r).lib, s = o.Base, a = o.WordArray, c = i.algo, u = c.MD5, l = c.EvpKDF = s.extend({ cfg: s.extend({ keySize: 4, hasher: u, iterations: 1 }), init: function (e) { this.cfg = this.cfg.extend(e) }, compute: function (e, t) { for (var n = this.cfg, r = n.hasher.create(), i = a.create(), o = i.words, s = n.keySize, c = n.iterations; o.length < s;) { u && r.update(u); var u = r.update(e).finalize(t); r.reset(); for (var l = 1; l < c; l++)u = r.finalize(u), r.reset(); i.concat(u) } return i.sigBytes = 4 * s, i } }), i.EvpKDF = function (e, t, n) { return l.create(n).compute(e, t) }, r.EvpKDF) }, function(e, t, n) { var r; e.exports = (r = n(114), n(129), void (r.lib.Cipher || function (e) { var t = r, n = t.lib, i = n.Base, o = n.WordArray, s = n.BufferedBlockAlgorithm, a = t.enc, c = (a.Utf8, a.Base64), u = t.algo, l = u.EvpKDF, m = n.Cipher = s.extend({ cfg: i.extend(), createEncryptor: function (e, t) { return this.create(this._ENC_XFORM_MODE, e, t) }, createDecryptor: function (e, t) { return this.create(this._DEC_XFORM_MODE, e, t) }, init: function (e, t, n) { this.cfg = this.cfg.extend(n), this._xformMode = e, this._key = t, this.reset() }, reset: function () { s.reset.call(this), this._doReset() }, process: function (e) { return this._append(e), this._process() }, finalize: function (e) { return e && this._append(e), this._doFinalize() }, keySize: 4, ivSize: 4, _ENC_XFORM_MODE: 1, _DEC_XFORM_MODE: 2, _createHelper: function () { function e(e) { return "string" == typeof e ? k : T } return function (t) { return { encrypt: function (n, r, i) { return e(r).encrypt(t, n, r, i) }, decrypt: function (n, r, i) { return e(r).decrypt(t, n, r, i) } } } }() }), d = (n.StreamCipher = m.extend({ _doFinalize: function () { return this._process(!0) }, blockSize: 1 }), t.mode = {}), p = n.BlockCipherMode = i.extend({ createEncryptor: function (e, t) { return this.Encryptor.create(e, t) }, createDecryptor: function (e, t) { return this.Decryptor.create(e, t) }, init: function (e, t) { this._cipher = e, this._iv = t } }), f = d.CBC = function () { function t(t, n, r) { var i = this._iv; if (i) { var o = i; this._iv = e } else var o = this._prevBlock; for (var s = 0; s < r; s++)t[n + s] ^= o[s] } var n = p.extend(); return n.Encryptor = n.extend({ processBlock: function (e, n) { var r = this._cipher, i = r.blockSize; t.call(this, e, n, i), r.encryptBlock(e, n), this._prevBlock = e.slice(n, n + i) } }), n.Decryptor = n.extend({ processBlock: function (e, n) { var r = this._cipher, i = r.blockSize, o = e.slice(n, n + i); r.decryptBlock(e, n), t.call(this, e, n, i), this._prevBlock = o } }), n }(), g = t.pad = {}, h = g.Pkcs7 = { pad: function (e, t) { for (var n = 4 * t, r = n - e.sigBytes % n, i = r << 24 | r << 16 | r << 8 | r, s = [], a = 0; a < r; a += 4)s.push(i); var c = o.create(s, r); e.concat(c) }, unpad: function (e) { var t = 255 & e.words[e.sigBytes - 1 >>> 2]; e.sigBytes -= t } }, y = (n.BlockCipher = m.extend({ cfg: m.cfg.extend({ mode: f, padding: h }), reset: function () { m.reset.call(this); var e = this.cfg, t = e.iv, n = e.mode; if (this._xformMode == this._ENC_XFORM_MODE) var r = n.createEncryptor; else { var r = n.createDecryptor; this._minBufferSize = 1 } this._mode && this._mode.__creator == r ? this._mode.init(this, t && t.words) : (this._mode = r.call(n, this, t && t.words), this._mode.__creator = r) }, _doProcessBlock: function (e, t) { this._mode.processBlock(e, t) }, _doFinalize: function () { var e = this.cfg.padding; if (this._xformMode == this._ENC_XFORM_MODE) { e.pad(this._data, this.blockSize); var t = this._process(!0) } else { var t = this._process(!0); e.unpad(t) } return t }, blockSize: 4 }), n.CipherParams = i.extend({ init: function (e) { this.mixIn(e) }, toString: function (e) { return (e || this.formatter).stringify(this) } })), v = t.format = {}, b = v.OpenSSL = { stringify: function (e) { var t = e.ciphertext, n = e.salt; if (n) var r = o.create([1398893684, 1701076831]).concat(n).concat(t); else var r = t; return r.toString(c) }, parse: function (e) { var t = c.parse(e), n = t.words; if (1398893684 == n[0] && 1701076831 == n[1]) { var r = o.create(n.slice(2, 4)); n.splice(0, 4), t.sigBytes -= 16 } return y.create({ ciphertext: t, salt: r }) } }, T = n.SerializableCipher = i.extend({ cfg: i.extend({ format: b }), encrypt: function (e, t, n, r) { r = this.cfg.extend(r); var i = e.createEncryptor(n, r), o = i.finalize(t), s = i.cfg; return y.create({ ciphertext: o, key: n, iv: s.iv, algorithm: e, mode: s.mode, padding: s.padding, blockSize: e.blockSize, formatter: r.format }) }, decrypt: function (e, t, n, r) { return r = this.cfg.extend(r), t = this._parse(t, r.format), e.createDecryptor(n, r).finalize(t.ciphertext) }, _parse: function (e, t) { return "string" == typeof e ? t.parse(e, this) : e } }), M = t.kdf = {}, S = M.OpenSSL = { execute: function (e, t, n, r) { r || (r = o.random(8)); var i = l.create({ keySize: t + n }).compute(e, r), s = o.create(i.words.slice(t), 4 * n); return i.sigBytes = 4 * t, y.create({ key: i, iv: s, salt: r }) } }, k = n.PasswordBasedCipher = T.extend({ cfg: T.cfg.extend({ kdf: S }), encrypt: function (e, t, n, r) { var i = (r = this.cfg.extend(r)).kdf.execute(n, e.keySize, e.ivSize); r.iv = i.iv; var o = T.encrypt.call(this, e, t, i.key, r); return o.mixIn(i), o }, decrypt: function (e, t, n, r) { r = this.cfg.extend(r), t = this._parse(t, r.format); var i = r.kdf.execute(n, e.keySize, e.ivSize, t.salt); return r.iv = i.iv, T.decrypt.call(this, e, t, i.key, r) } }) }())) }, function(e, t, n) { var r; e.exports = (r = n(114), n(130), r.mode.CFB = function () { function e(e, t, n, r) { var i = this._iv; if (i) { var o = i.slice(0); this._iv = void 0 } else o = this._prevBlock; r.encryptBlock(o, 0); for (var s = 0; s < n; s++)e[t + s] ^= o[s] } var t = r.lib.BlockCipherMode.extend(); return t.Encryptor = t.extend({ processBlock: function (t, n) { var r = this._cipher, i = r.blockSize; e.call(this, t, n, i, r), this._prevBlock = t.slice(n, n + i) } }), t.Decryptor = t.extend({ processBlock: function (t, n) { var r = this._cipher, i = r.blockSize, o = t.slice(n, n + i); e.call(this, t, n, i, r), this._prevBlock = o } }), t }(), r.mode.CFB) }, function(e, t, n) { var r, i, o; e.exports = (r = n(114), n(130), r.mode.CTR = (i = r.lib.BlockCipherMode.extend(), o = i.Encryptor = i.extend({ processBlock: function (e, t) { var n = this._cipher, r = n.blockSize, i = this._iv, o = this._counter; i && (o = this._counter = i.slice(0), this._iv = void 0); var s = o.slice(0); n.encryptBlock(s, 0), o[r - 1] = o[r - 1] + 1 | 0; for (var a = 0; a < r; a++)e[t + a] ^= s[a] } }), i.Decryptor = o, i), r.mode.CTR) }, function(e, t, n) { var r; e.exports = (r = n(114), n(130), r.mode.CTRGladman = function () { function e(e) { if (255 == (e >> 24 & 255)) { var t = e >> 16 & 255, n = e >> 8 & 255, r = 255 & e; 255 === t ? (t = 0, 255 === n ? (n = 0, 255 === r ? r = 0 : ++r) : ++n) : ++t, e = 0, e += t << 16, e += n << 8, e += r } else e += 1 << 24; return e } var t = r.lib.BlockCipherMode.extend(), n = t.Encryptor = t.extend({ processBlock: function (t, n) { var r = this._cipher, i = r.blockSize, o = this._iv, s = this._counter; o && (s = this._counter = o.slice(0), this._iv = void 0), function (t) { 0 === (t[0] = e(t[0])) && (t[1] = e(t[1])) }(s); var a = s.slice(0); r.encryptBlock(a, 0); for (var c = 0; c < i; c++)t[n + c] ^= a[c] } }); return t.Decryptor = n, t }(), r.mode.CTRGladman) }, function(e, t, n) { var r, i, o; e.exports = (r = n(114), n(130), r.mode.OFB = (i = r.lib.BlockCipherMode.extend(), o = i.Encryptor = i.extend({ processBlock: function (e, t) { var n = this._cipher, r = n.blockSize, i = this._iv, o = this._keystream; i && (o = this._keystream = i.slice(0), this._iv = void 0), n.encryptBlock(o, 0); for (var s = 0; s < r; s++)e[t + s] ^= o[s] } }), i.Decryptor = o, i), r.mode.OFB) }, function(e, t, n) { var r, i; e.exports = (r = n(114), n(130), r.mode.ECB = ((i = r.lib.BlockCipherMode.extend()).Encryptor = i.extend({ processBlock: function (e, t) { this._cipher.encryptBlock(e, t) } }), i.Decryptor = i.extend({ processBlock: function (e, t) { this._cipher.decryptBlock(e, t) } }), i), r.mode.ECB) }, function(e, t, n) { var r; e.exports = (r = n(114), n(130), r.pad.AnsiX923 = { pad: function (e, t) { var n = e.sigBytes, r = 4 * t, i = r - n % r, o = n + i - 1; e.clamp(), e.words[o >>> 2] |= i << 24 - o % 4 * 8, e.sigBytes += i }, unpad: function (e) { var t = 255 & e.words[e.sigBytes - 1 >>> 2]; e.sigBytes -= t } }, r.pad.Ansix923) }, function(e, t, n) { var r; e.exports = (r = n(114), n(130), r.pad.Iso10126 = { pad: function (e, t) { var n = 4 * t, i = n - e.sigBytes % n; e.concat(r.lib.WordArray.random(i - 1)).concat(r.lib.WordArray.create([i << 24], 1)) }, unpad: function (e) { var t = 255 & e.words[e.sigBytes - 1 >>> 2]; e.sigBytes -= t } }, r.pad.Iso10126) }, function(e, t, n) { var r; e.exports = (r = n(114), n(130), r.pad.Iso97971 = { pad: function (e, t) { e.concat(r.lib.WordArray.create([2147483648], 1)), r.pad.ZeroPadding.pad(e, t) }, unpad: function (e) { r.pad.ZeroPadding.unpad(e), e.sigBytes-- } }, r.pad.Iso97971) }, function(e, t, n) { var r; e.exports = (r = n(114), n(130), r.pad.ZeroPadding = { pad: function (e, t) { var n = 4 * t; e.clamp(), e.sigBytes += n - (e.sigBytes % n || n) }, unpad: function (e) { for (var t = e.words, n = e.sigBytes - 1; !(t[n >>> 2] >>> 24 - n % 4 * 8 & 255);)n--; e.sigBytes = n + 1 } }, r.pad.ZeroPadding) }, function(e, t, n) { var r; e.exports = (r = n(114), n(130), r.pad.NoPadding = { pad: function () { }, unpad: function () { } }, r.pad.NoPadding) }, function(e, t, n) { var r, i, o, s; e.exports = (r = n(114), n(130), o = (i = r).lib.CipherParams, s = i.enc.Hex, i.format.Hex = { stringify: function (e) { return e.ciphertext.toString(s) }, parse: function (e) { var t = s.parse(e); return o.create({ ciphertext: t }) } }, r.format.Hex) }, function(e, t, n) { var r; e.exports = (r = n(114), n(118), n(119), n(129), n(130), function () { var e = r, t = e.lib.BlockCipher, n = e.algo, i = [], o = [], s = [], a = [], c = [], u = [], l = [], m = [], d = [], p = []; !function () { for (var e = [], t = 0; t < 256; t++)e[t] = t < 128 ? t << 1 : t << 1 ^ 283; var n = 0, r = 0; for (t = 0; t < 256; t++) { var f = r ^ r << 1 ^ r << 2 ^ r << 3 ^ r << 4; f = f >>> 8 ^ 255 & f ^ 99, i[n] = f, o[f] = n; var g = e[n], h = e[g], y = e[h], v = 257 * e[f] ^ 16843008 * f; s[n] = v << 24 | v >>> 8, a[n] = v << 16 | v >>> 16, c[n] = v << 8 | v >>> 24, u[n] = v, v = 16843009 * y ^ 65537 * h ^ 257 * g ^ 16843008 * n, l[f] = v << 24 | v >>> 8, m[f] = v << 16 | v >>> 16, d[f] = v << 8 | v >>> 24, p[f] = v, n ? (n = g ^ e[e[e[y ^ g]]], r ^= e[e[r]]) : n = r = 1 } }(); var f = [0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54], g = n.AES = t.extend({ _doReset: function () { if (!this._nRounds || this._keyPriorReset !== this._key) { for (var e = this._keyPriorReset = this._key, t = e.words, n = e.sigBytes / 4, r = 4 * ((this._nRounds = n + 6) + 1), o = this._keySchedule = [], s = 0; s < r; s++)if (s < n) o[s] = t[s]; else { var a = o[s - 1]; s % n ? n > 6 && s % n == 4 && (a = i[a >>> 24] << 24 | i[a >>> 16 & 255] << 16 | i[a >>> 8 & 255] << 8 | i[255 & a]) : (a = i[(a = a << 8 | a >>> 24) >>> 24] << 24 | i[a >>> 16 & 255] << 16 | i[a >>> 8 & 255] << 8 | i[255 & a], a ^= f[s / n | 0] << 24), o[s] = o[s - n] ^ a } for (var c = this._invKeySchedule = [], u = 0; u < r; u++)s = r - u, a = u % 4 ? o[s] : o[s - 4], c[u] = u < 4 || s <= 4 ? a : l[i[a >>> 24]] ^ m[i[a >>> 16 & 255]] ^ d[i[a >>> 8 & 255]] ^ p[i[255 & a]] } }, encryptBlock: function (e, t) { this._doCryptBlock(e, t, this._keySchedule, s, a, c, u, i) }, decryptBlock: function (e, t) { var n = e[t + 1]; e[t + 1] = e[t + 3], e[t + 3] = n, this._doCryptBlock(e, t, this._invKeySchedule, l, m, d, p, o), n = e[t + 1], e[t + 1] = e[t + 3], e[t + 3] = n }, _doCryptBlock: function (e, t, n, r, i, o, s, a) { for (var c = this._nRounds, u = e[t] ^ n[0], l = e[t + 1] ^ n[1], m = e[t + 2] ^ n[2], d = e[t + 3] ^ n[3], p = 4, f = 1; f < c; f++) { var g = r[u >>> 24] ^ i[l >>> 16 & 255] ^ o[m >>> 8 & 255] ^ s[255 & d] ^ n[p++], h = r[l >>> 24] ^ i[m >>> 16 & 255] ^ o[d >>> 8 & 255] ^ s[255 & u] ^ n[p++], y = r[m >>> 24] ^ i[d >>> 16 & 255] ^ o[u >>> 8 & 255] ^ s[255 & l] ^ n[p++], v = r[d >>> 24] ^ i[u >>> 16 & 255] ^ o[l >>> 8 & 255] ^ s[255 & m] ^ n[p++]; u = g, l = h, m = y, d = v } g = (a[u >>> 24] << 24 | a[l >>> 16 & 255] << 16 | a[m >>> 8 & 255] << 8 | a[255 & d]) ^ n[p++], h = (a[l >>> 24] << 24 | a[m >>> 16 & 255] << 16 | a[d >>> 8 & 255] << 8 | a[255 & u]) ^ n[p++], y = (a[m >>> 24] << 24 | a[d >>> 16 & 255] << 16 | a[u >>> 8 & 255] << 8 | a[255 & l]) ^ n[p++], v = (a[d >>> 24] << 24 | a[u >>> 16 & 255] << 16 | a[l >>> 8 & 255] << 8 | a[255 & m]) ^ n[p++], e[t] = g, e[t + 1] = h, e[t + 2] = y, e[t + 3] = v }, keySize: 8 }); e.AES = t._createHelper(g) }(), r.AES) }, function(e, t, n) { var r; e.exports = (r = n(114), n(118), n(119), n(129), n(130), function () { function e(e, t) { var n = (this._lBlock >>> e ^ this._rBlock) & t; this._rBlock ^= n, this._lBlock ^= n << e } function t(e, t) { var n = (this._rBlock >>> e ^ this._lBlock) & t; this._lBlock ^= n, this._rBlock ^= n << e } var n = r, i = n.lib, o = i.WordArray, s = i.BlockCipher, a = n.algo, c = [57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20, 12, 4], u = [14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16, 7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44, 49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32], l = [1, 2, 4, 6, 8, 10, 12, 14, 15, 17, 19, 21, 23, 25, 27, 28], m = [{ 0: 8421888, 268435456: 32768, 536870912: 8421378, 805306368: 2, 1073741824: 512, 1342177280: 8421890, 1610612736: 8389122, 1879048192: 8388608, 2147483648: 514, 2415919104: 8389120, 2684354560: 33280, 2952790016: 8421376, 3221225472: 32770, 3489660928: 8388610, 3758096384: 0, 4026531840: 33282, 134217728: 0, 402653184: 8421890, 671088640: 33282, 939524096: 32768, 1207959552: 8421888, 1476395008: 512, 1744830464: 8421378, 2013265920: 2, 2281701376: 8389120, 2550136832: 33280, 2818572288: 8421376, 3087007744: 8389122, 3355443200: 8388610, 3623878656: 32770, 3892314112: 514, 4160749568: 8388608, 1: 32768, 268435457: 2, 536870913: 8421888, 805306369: 8388608, 1073741825: 8421378, 1342177281: 33280, 1610612737: 512, 1879048193: 8389122, 2147483649: 8421890, 2415919105: 8421376, 2684354561: 8388610, 2952790017: 33282, 3221225473: 514, 3489660929: 8389120, 3758096385: 32770, 4026531841: 0, 134217729: 8421890, 402653185: 8421376, 671088641: 8388608, 939524097: 512, 1207959553: 32768, 1476395009: 8388610, 1744830465: 2, 2013265921: 33282, 2281701377: 32770, 2550136833: 8389122, 2818572289: 514, 3087007745: 8421888, 3355443201: 8389120, 3623878657: 0, 3892314113: 33280, 4160749569: 8421378 }, { 0: 1074282512, 16777216: 16384, 33554432: 524288, 50331648: 1074266128, 67108864: 1073741840, 83886080: 1074282496, 100663296: 1073758208, 117440512: 16, 134217728: 540672, 150994944: 1073758224, 167772160: 1073741824, 184549376: 540688, 201326592: 524304, 218103808: 0, 234881024: 16400, 251658240: 1074266112, 8388608: 1073758208, 25165824: 540688, 41943040: 16, 58720256: 1073758224, 75497472: 1074282512, 92274688: 1073741824, 109051904: 524288, 125829120: 1074266128, 142606336: 524304, 159383552: 0, 176160768: 16384, 192937984: 1074266112, 209715200: 1073741840, 226492416: 540672, 243269632: 1074282496, 260046848: 16400, 268435456: 0, 285212672: 1074266128, 301989888: 1073758224, 318767104: 1074282496, 335544320: 1074266112, 352321536: 16, 369098752: 540688, 385875968: 16384, 402653184: 16400, 419430400: 524288, 436207616: 524304, 452984832: 1073741840, 469762048: 540672, 486539264: 1073758208, 503316480: 1073741824, 520093696: 1074282512, 276824064: 540688, 293601280: 524288, 310378496: 1074266112, 327155712: 16384, 343932928: 1073758208, 360710144: 1074282512, 377487360: 16, 394264576: 1073741824, 411041792: 1074282496, 427819008: 1073741840, 444596224: 1073758224, 461373440: 524304, 478150656: 0, 494927872: 16400, 511705088: 1074266128, 528482304: 540672 }, { 0: 260, 1048576: 0, 2097152: 67109120, 3145728: 65796, 4194304: 65540, 5242880: 67108868, 6291456: 67174660, 7340032: 67174400, 8388608: 67108864, 9437184: 67174656, 10485760: 65792, 11534336: 67174404, 12582912: 67109124, 13631488: 65536, 14680064: 4, 15728640: 256, 524288: 67174656, 1572864: 67174404, 2621440: 0, 3670016: 67109120, 4718592: 67108868, 5767168: 65536, 6815744: 65540, 7864320: 260, 8912896: 4, 9961472: 256, 11010048: 67174400, 12058624: 65796, 13107200: 65792, 14155776: 67109124, 15204352: 67174660, 16252928: 67108864, 16777216: 67174656, 17825792: 65540, 18874368: 65536, 19922944: 67109120, 20971520: 256, 22020096: 67174660, 23068672: 67108868, 24117248: 0, 25165824: 67109124, 26214400: 67108864, 27262976: 4, 28311552: 65792, 29360128: 67174400, 30408704: 260, 31457280: 65796, 32505856: 67174404, 17301504: 67108864, 18350080: 260, 19398656: 67174656, 20447232: 0, 21495808: 65540, 22544384: 67109120, 23592960: 256, 24641536: 67174404, 25690112: 65536, 26738688: 67174660, 27787264: 65796, 28835840: 67108868, 29884416: 67109124, 30932992: 67174400, 31981568: 4, 33030144: 65792 }, { 0: 2151682048, 65536: 2147487808, 131072: 4198464, 196608: 2151677952, 262144: 0, 327680: 4198400, 393216: 2147483712, 458752: 4194368, 524288: 2147483648, 589824: 4194304, 655360: 64, 720896: 2147487744, 786432: 2151678016, 851968: 4160, 917504: 4096, 983040: 2151682112, 32768: 2147487808, 98304: 64, 163840: 2151678016, 229376: 2147487744, 294912: 4198400, 360448: 2151682112, 425984: 0, 491520: 2151677952, 557056: 4096, 622592: 2151682048, 688128: 4194304, 753664: 4160, 819200: 2147483648, 884736: 4194368, 950272: 4198464, 1015808: 2147483712, 1048576: 4194368, 1114112: 4198400, 1179648: 2147483712, 1245184: 0, 1310720: 4160, 1376256: 2151678016, 1441792: 2151682048, 1507328: 2147487808, 1572864: 2151682112, 1638400: 2147483648, 1703936: 2151677952, 1769472: 4198464, 1835008: 2147487744, 1900544: 4194304, 1966080: 64, 2031616: 4096, 1081344: 2151677952, 1146880: 2151682112, 1212416: 0, 1277952: 4198400, 1343488: 4194368, 1409024: 2147483648, 1474560: 2147487808, 1540096: 64, 1605632: 2147483712, 1671168: 4096, 1736704: 2147487744, 1802240: 2151678016, 1867776: 4160, 1933312: 2151682048, 1998848: 4194304, 2064384: 4198464 }, { 0: 128, 4096: 17039360, 8192: 262144, 12288: 536870912, 16384: 537133184, 20480: 16777344, 24576: 553648256, 28672: 262272, 32768: 16777216, 36864: 537133056, 40960: 536871040, 45056: 553910400, 49152: 553910272, 53248: 0, 57344: 17039488, 61440: 553648128, 2048: 17039488, 6144: 553648256, 10240: 128, 14336: 17039360, 18432: 262144, 22528: 537133184, 26624: 553910272, 30720: 536870912, 34816: 537133056, 38912: 0, 43008: 553910400, 47104: 16777344, 51200: 536871040, 55296: 553648128, 59392: 16777216, 63488: 262272, 65536: 262144, 69632: 128, 73728: 536870912, 77824: 553648256, 81920: 16777344, 86016: 553910272, 90112: 537133184, 94208: 16777216, 98304: 553910400, 102400: 553648128, 106496: 17039360, 110592: 537133056, 114688: 262272, 118784: 536871040, 122880: 0, 126976: 17039488, 67584: 553648256, 71680: 16777216, 75776: 17039360, 79872: 537133184, 83968: 536870912, 88064: 17039488, 92160: 128, 96256: 553910272, 100352: 262272, 104448: 553910400, 108544: 0, 112640: 553648128, 116736: 16777344, 120832: 262144, 124928: 537133056, 129024: 536871040 }, { 0: 268435464, 256: 8192, 512: 270532608, 768: 270540808, 1024: 268443648, 1280: 2097152, 1536: 2097160, 1792: 268435456, 2048: 0, 2304: 268443656, 2560: 2105344, 2816: 8, 3072: 270532616, 3328: 2105352, 3584: 8200, 3840: 270540800, 128: 270532608, 384: 270540808, 640: 8, 896: 2097152, 1152: 2105352, 1408: 268435464, 1664: 268443648, 1920: 8200, 2176: 2097160, 2432: 8192, 2688: 268443656, 2944: 270532616, 3200: 0, 3456: 270540800, 3712: 2105344, 3968: 268435456, 4096: 268443648, 4352: 270532616, 4608: 270540808, 4864: 8200, 5120: 2097152, 5376: 268435456, 5632: 268435464, 5888: 2105344, 6144: 2105352, 6400: 0, 6656: 8, 6912: 270532608, 7168: 8192, 7424: 268443656, 7680: 270540800, 7936: 2097160, 4224: 8, 4480: 2105344, 4736: 2097152, 4992: 268435464, 5248: 268443648, 5504: 8200, 5760: 270540808, 6016: 270532608, 6272: 270540800, 6528: 270532616, 6784: 8192, 7040: 2105352, 7296: 2097160, 7552: 0, 7808: 268435456, 8064: 268443656 }, { 0: 1048576, 16: 33555457, 32: 1024, 48: 1049601, 64: 34604033, 80: 0, 96: 1, 112: 34603009, 128: 33555456, 144: 1048577, 160: 33554433, 176: 34604032, 192: 34603008, 208: 1025, 224: 1049600, 240: 33554432, 8: 34603009, 24: 0, 40: 33555457, 56: 34604032, 72: 1048576, 88: 33554433, 104: 33554432, 120: 1025, 136: 1049601, 152: 33555456, 168: 34603008, 184: 1048577, 200: 1024, 216: 34604033, 232: 1, 248: 1049600, 256: 33554432, 272: 1048576, 288: 33555457, 304: 34603009, 320: 1048577, 336: 33555456, 352: 34604032, 368: 1049601, 384: 1025, 400: 34604033, 416: 1049600, 432: 1, 448: 0, 464: 34603008, 480: 33554433, 496: 1024, 264: 1049600, 280: 33555457, 296: 34603009, 312: 1, 328: 33554432, 344: 1048576, 360: 1025, 376: 34604032, 392: 33554433, 408: 34603008, 424: 0, 440: 34604033, 456: 1049601, 472: 1024, 488: 33555456, 504: 1048577 }, { 0: 134219808, 1: 131072, 2: 134217728, 3: 32, 4: 131104, 5: 134350880, 6: 134350848, 7: 2048, 8: 134348800, 9: 134219776, 10: 133120, 11: 134348832, 12: 2080, 13: 0, 14: 134217760, 15: 133152, 2147483648: 2048, 2147483649: 134350880, 2147483650: 134219808, 2147483651: 134217728, 2147483652: 134348800, 2147483653: 133120, 2147483654: 133152, 2147483655: 32, 2147483656: 134217760, 2147483657: 2080, 2147483658: 131104, 2147483659: 134350848, 2147483660: 0, 2147483661: 134348832, 2147483662: 134219776, 2147483663: 131072, 16: 133152, 17: 134350848, 18: 32, 19: 2048, 20: 134219776, 21: 134217760, 22: 134348832, 23: 131072, 24: 0, 25: 131104, 26: 134348800, 27: 134219808, 28: 134350880, 29: 133120, 30: 2080, 31: 134217728, 2147483664: 131072, 2147483665: 2048, 2147483666: 134348832, 2147483667: 133152, 2147483668: 32, 2147483669: 134348800, 2147483670: 134217728, 2147483671: 134219808, 2147483672: 134350880, 2147483673: 134217760, 2147483674: 134219776, 2147483675: 0, 2147483676: 133120, 2147483677: 2080, 2147483678: 131104, 2147483679: 134350848 }], d = [4160749569, 528482304, 33030144, 2064384, 129024, 8064, 504, 2147483679], p = a.DES = s.extend({ _doReset: function () { for (var e = this._key.words, t = [], n = 0; n < 56; n++) { var r = c[n] - 1; t[n] = e[r >>> 5] >>> 31 - r % 32 & 1 } for (var i = this._subKeys = [], o = 0; o < 16; o++) { var s = i[o] = [], a = l[o]; for (n = 0; n < 24; n++)s[n / 6 | 0] |= t[(u[n] - 1 + a) % 28] << 31 - n % 6, s[4 + (n / 6 | 0)] |= t[28 + (u[n + 24] - 1 + a) % 28] << 31 - n % 6; for (s[0] = s[0] << 1 | s[0] >>> 31, n = 1; n < 7; n++)s[n] = s[n] >>> 4 * (n - 1) + 3; s[7] = s[7] << 5 | s[7] >>> 27 } var m = this._invSubKeys = []; for (n = 0; n < 16; n++)m[n] = i[15 - n] }, encryptBlock: function (e, t) { this._doCryptBlock(e, t, this._subKeys) }, decryptBlock: function (e, t) { this._doCryptBlock(e, t, this._invSubKeys) }, _doCryptBlock: function (n, r, i) { this._lBlock = n[r], this._rBlock = n[r + 1], e.call(this, 4, 252645135), e.call(this, 16, 65535), t.call(this, 2, 858993459), t.call(this, 8, 16711935), e.call(this, 1, 1431655765); for (var o = 0; o < 16; o++) { for (var s = i[o], a = this._lBlock, c = this._rBlock, u = 0, l = 0; l < 8; l++)u |= m[l][((c ^ s[l]) & d[l]) >>> 0]; this._lBlock = c, this._rBlock = a ^ u } var p = this._lBlock; this._lBlock = this._rBlock, this._rBlock = p, e.call(this, 1, 1431655765), t.call(this, 8, 16711935), t.call(this, 2, 858993459), e.call(this, 16, 65535), e.call(this, 4, 252645135), n[r] = this._lBlock, n[r + 1] = this._rBlock }, keySize: 2, ivSize: 2, blockSize: 2 }); n.DES = s._createHelper(p); var f = a.TripleDES = s.extend({ _doReset: function () { var e = this._key.words; this._des1 = p.createEncryptor(o.create(e.slice(0, 2))), this._des2 = p.createEncryptor(o.create(e.slice(2, 4))), this._des3 = p.createEncryptor(o.create(e.slice(4, 6))) }, encryptBlock: function (e, t) { this._des1.encryptBlock(e, t), this._des2.decryptBlock(e, t), this._des3.encryptBlock(e, t) }, decryptBlock: function (e, t) { this._des3.decryptBlock(e, t), this._des2.encryptBlock(e, t), this._des1.decryptBlock(e, t) }, keySize: 6, ivSize: 2, blockSize: 2 }); n.TripleDES = s._createHelper(f) }(), r.TripleDES) }, function(e, t, n) { var r; e.exports = (r = n(114), n(118), n(119), n(129), n(130), function () { function e() { for (var e = this._S, t = this._i, n = this._j, r = 0, i = 0; i < 4; i++) { n = (n + e[t = (t + 1) % 256]) % 256; var o = e[t]; e[t] = e[n], e[n] = o, r |= e[(e[t] + e[n]) % 256] << 24 - 8 * i } return this._i = t, this._j = n, r } var t = r, n = t.lib.StreamCipher, i = t.algo, o = i.RC4 = n.extend({ _doReset: function () { for (var e = this._key, t = e.words, n = e.sigBytes, r = this._S = [], i = 0; i < 256; i++)r[i] = i; i = 0; for (var o = 0; i < 256; i++) { var s = i % n, a = t[s >>> 2] >>> 24 - s % 4 * 8 & 255; o = (o + r[i] + a) % 256; var c = r[i]; r[i] = r[o], r[o] = c } this._i = this._j = 0 }, _doProcessBlock: function (t, n) { t[n] ^= e.call(this) }, keySize: 8, ivSize: 0 }); t.RC4 = n._createHelper(o); var s = i.RC4Drop = o.extend({ cfg: o.cfg.extend({ drop: 192 }), _doReset: function () { o._doReset.call(this); for (var t = this.cfg.drop; t > 0; t--)e.call(this) } }); t.RC4Drop = n._createHelper(s) }(), r.RC4) }, function(e, t, n) { var r; e.exports = (r = n(114), n(118), n(119), n(129), n(130), function () { function e() { for (var e = this._X, t = this._C, n = 0; n < 8; n++)s[n] = t[n]; for (t[0] = t[0] + 1295307597 + this._b | 0, t[1] = t[1] + 3545052371 + (t[0] >>> 0 < s[0] >>> 0 ? 1 : 0) | 0, t[2] = t[2] + 886263092 + (t[1] >>> 0 < s[1] >>> 0 ? 1 : 0) | 0, t[3] = t[3] + 1295307597 + (t[2] >>> 0 < s[2] >>> 0 ? 1 : 0) | 0, t[4] = t[4] + 3545052371 + (t[3] >>> 0 < s[3] >>> 0 ? 1 : 0) | 0, t[5] = t[5] + 886263092 + (t[4] >>> 0 < s[4] >>> 0 ? 1 : 0) | 0, t[6] = t[6] + 1295307597 + (t[5] >>> 0 < s[5] >>> 0 ? 1 : 0) | 0, t[7] = t[7] + 3545052371 + (t[6] >>> 0 < s[6] >>> 0 ? 1 : 0) | 0, this._b = t[7] >>> 0 < s[7] >>> 0 ? 1 : 0, n = 0; n < 8; n++) { var r = e[n] + t[n], i = 65535 & r, o = r >>> 16, c = ((i * i >>> 17) + i * o >>> 15) + o * o, u = ((4294901760 & r) * r | 0) + ((65535 & r) * r | 0); a[n] = c ^ u } e[0] = a[0] + (a[7] << 16 | a[7] >>> 16) + (a[6] << 16 | a[6] >>> 16) | 0, e[1] = a[1] + (a[0] << 8 | a[0] >>> 24) + a[7] | 0, e[2] = a[2] + (a[1] << 16 | a[1] >>> 16) + (a[0] << 16 | a[0] >>> 16) | 0, e[3] = a[3] + (a[2] << 8 | a[2] >>> 24) + a[1] | 0, e[4] = a[4] + (a[3] << 16 | a[3] >>> 16) + (a[2] << 16 | a[2] >>> 16) | 0, e[5] = a[5] + (a[4] << 8 | a[4] >>> 24) + a[3] | 0, e[6] = a[6] + (a[5] << 16 | a[5] >>> 16) + (a[4] << 16 | a[4] >>> 16) | 0, e[7] = a[7] + (a[6] << 8 | a[6] >>> 24) + a[5] | 0 } var t = r, n = t.lib.StreamCipher, i = t.algo, o = [], s = [], a = [], c = i.Rabbit = n.extend({ _doReset: function () { for (var t = this._key.words, n = this.cfg.iv, r = 0; r < 4; r++)t[r] = 16711935 & (t[r] << 8 | t[r] >>> 24) | 4278255360 & (t[r] << 24 | t[r] >>> 8); var i = this._X = [t[0], t[3] << 16 | t[2] >>> 16, t[1], t[0] << 16 | t[3] >>> 16, t[2], t[1] << 16 | t[0] >>> 16, t[3], t[2] << 16 | t[1] >>> 16], o = this._C = [t[2] << 16 | t[2] >>> 16, 4294901760 & t[0] | 65535 & t[1], t[3] << 16 | t[3] >>> 16, 4294901760 & t[1] | 65535 & t[2], t[0] << 16 | t[0] >>> 16, 4294901760 & t[2] | 65535 & t[3], t[1] << 16 | t[1] >>> 16, 4294901760 & t[3] | 65535 & t[0]]; for (this._b = 0, r = 0; r < 4; r++)e.call(this); for (r = 0; r < 8; r++)o[r] ^= i[r + 4 & 7]; if (n) { var s = n.words, a = s[0], c = s[1], u = 16711935 & (a << 8 | a >>> 24) | 4278255360 & (a << 24 | a >>> 8), l = 16711935 & (c << 8 | c >>> 24) | 4278255360 & (c << 24 | c >>> 8), m = u >>> 16 | 4294901760 & l, d = l << 16 | 65535 & u; for (o[0] ^= u, o[1] ^= m, o[2] ^= l, o[3] ^= d, o[4] ^= u, o[5] ^= m, o[6] ^= l, o[7] ^= d, r = 0; r < 4; r++)e.call(this) } }, _doProcessBlock: function (t, n) { var r = this._X; e.call(this), o[0] = r[0] ^ r[5] >>> 16 ^ r[3] << 16, o[1] = r[2] ^ r[7] >>> 16 ^ r[5] << 16, o[2] = r[4] ^ r[1] >>> 16 ^ r[7] << 16, o[3] = r[6] ^ r[3] >>> 16 ^ r[1] << 16; for (var i = 0; i < 4; i++)o[i] = 16711935 & (o[i] << 8 | o[i] >>> 24) | 4278255360 & (o[i] << 24 | o[i] >>> 8), t[n + i] ^= o[i] }, blockSize: 4, ivSize: 2 }); t.Rabbit = n._createHelper(c) }(), r.Rabbit) }, function(e, t, n) { var r; e.exports = (r = n(114), n(118), n(119), n(129), n(130), function () { function e() { for (var e = this._X, t = this._C, n = 0; n < 8; n++)s[n] = t[n]; for (t[0] = t[0] + 1295307597 + this._b | 0, t[1] = t[1] + 3545052371 + (t[0] >>> 0 < s[0] >>> 0 ? 1 : 0) | 0, t[2] = t[2] + 886263092 + (t[1] >>> 0 < s[1] >>> 0 ? 1 : 0) | 0, t[3] = t[3] + 1295307597 + (t[2] >>> 0 < s[2] >>> 0 ? 1 : 0) | 0, t[4] = t[4] + 3545052371 + (t[3] >>> 0 < s[3] >>> 0 ? 1 : 0) | 0, t[5] = t[5] + 886263092 + (t[4] >>> 0 < s[4] >>> 0 ? 1 : 0) | 0, t[6] = t[6] + 1295307597 + (t[5] >>> 0 < s[5] >>> 0 ? 1 : 0) | 0, t[7] = t[7] + 3545052371 + (t[6] >>> 0 < s[6] >>> 0 ? 1 : 0) | 0, this._b = t[7] >>> 0 < s[7] >>> 0 ? 1 : 0, n = 0; n < 8; n++) { var r = e[n] + t[n], i = 65535 & r, o = r >>> 16, c = ((i * i >>> 17) + i * o >>> 15) + o * o, u = ((4294901760 & r) * r | 0) + ((65535 & r) * r | 0); a[n] = c ^ u } e[0] = a[0] + (a[7] << 16 | a[7] >>> 16) + (a[6] << 16 | a[6] >>> 16) | 0, e[1] = a[1] + (a[0] << 8 | a[0] >>> 24) + a[7] | 0, e[2] = a[2] + (a[1] << 16 | a[1] >>> 16) + (a[0] << 16 | a[0] >>> 16) | 0, e[3] = a[3] + (a[2] << 8 | a[2] >>> 24) + a[1] | 0, e[4] = a[4] + (a[3] << 16 | a[3] >>> 16) + (a[2] << 16 | a[2] >>> 16) | 0, e[5] = a[5] + (a[4] << 8 | a[4] >>> 24) + a[3] | 0, e[6] = a[6] + (a[5] << 16 | a[5] >>> 16) + (a[4] << 16 | a[4] >>> 16) | 0, e[7] = a[7] + (a[6] << 8 | a[6] >>> 24) + a[5] | 0 } var t = r, n = t.lib.StreamCipher, i = t.algo, o = [], s = [], a = [], c = i.RabbitLegacy = n.extend({ _doReset: function () { var t = this._key.words, n = this.cfg.iv, r = this._X = [t[0], t[3] << 16 | t[2] >>> 16, t[1], t[0] << 16 | t[3] >>> 16, t[2], t[1] << 16 | t[0] >>> 16, t[3], t[2] << 16 | t[1] >>> 16], i = this._C = [t[2] << 16 | t[2] >>> 16, 4294901760 & t[0] | 65535 & t[1], t[3] << 16 | t[3] >>> 16, 4294901760 & t[1] | 65535 & t[2], t[0] << 16 | t[0] >>> 16, 4294901760 & t[2] | 65535 & t[3], t[1] << 16 | t[1] >>> 16, 4294901760 & t[3] | 65535 & t[0]]; this._b = 0; for (var o = 0; o < 4; o++)e.call(this); for (o = 0; o < 8; o++)i[o] ^= r[o + 4 & 7]; if (n) { var s = n.words, a = s[0], c = s[1], u = 16711935 & (a << 8 | a >>> 24) | 4278255360 & (a << 24 | a >>> 8), l = 16711935 & (c << 8 | c >>> 24) | 4278255360 & (c << 24 | c >>> 8), m = u >>> 16 | 4294901760 & l, d = l << 16 | 65535 & u; for (i[0] ^= u, i[1] ^= m, i[2] ^= l, i[3] ^= d, i[4] ^= u, i[5] ^= m, i[6] ^= l, i[7] ^= d, o = 0; o < 4; o++)e.call(this) } }, _doProcessBlock: function (t, n) { var r = this._X; e.call(this), o[0] = r[0] ^ r[5] >>> 16 ^ r[3] << 16, o[1] = r[2] ^ r[7] >>> 16 ^ r[5] << 16, o[2] = r[4] ^ r[1] >>> 16 ^ r[7] << 16, o[3] = r[6] ^ r[3] >>> 16 ^ r[1] << 16; for (var i = 0; i < 4; i++)o[i] = 16711935 & (o[i] << 8 | o[i] >>> 24) | 4278255360 & (o[i] << 24 | o[i] >>> 8), t[n + i] ^= o[i] }, blockSize: 4, ivSize: 2 }); t.RabbitLegacy = n._createHelper(c) }(), r.RabbitLegacy) }, function(e, t, n) { !function () { function t(e) { e.region ? r.qiniuRegion = e.region : console.error("qiniu uploader need your bucket region"), e.uptoken ? r.qiniuUploadToken = e.uptoken : e.uptokenURL ? r.qiniuUploadTokenURL = e.uptokenURL : e.uptokenFunc && (r.qiniuUploadTokenFunction = e.uptokenFunc), e.domain && (r.qiniuImageURLPrefix = e.domain), r.qiniuShouldUseQiniuFileName = e.shouldUseQiniuFileName } function n(e, t, n, i, o, s, a, c) { if (null == r.qiniuUploadToken && r.qiniuUploadToken.length > 0) console.error("qiniu UploadToken is null, please check the init config or networking"); else { var u = function (e) { var t = null; switch (e) { case "ECN": t = "https://up.qiniup.com"; break; case "NCN": t = "https://up-z1.qiniup.com"; break; case "SCN": t = "https://up-z2.qiniup.com"; break; case "NA": t = "https://up-na0.qiniup.com"; break; case "ASG": t = "https://up-as0.qiniup.com"; break; default: console.error("please make the region is with one of [ECN, SCN, NCN, NA, ASG]") }return t }(r.qiniuRegion), l = e.split("//")[1]; i && i.key && (l = i.key); var m = { token: r.qiniuUploadToken }; r.qiniuShouldUseQiniuFileName || (m.key = l), a && a(); var d = wx.uploadFile({ url: u, filePath: e, name: "file", formData: m, success: function (e) { var i = e.data; try { var o = JSON.parse(i), s = r.qiniuImageURLPrefix + "/" + o.key; o.fileUrl = s, o.imageURL = s, console.log(o), t && t(o) } catch (e) { console.log("parse JSON failed, origin String is: " + i), n && n(e) } }, fail: function (e) { console.error(e), n && n(e) }, complete: function (e) { c && c(e) } }); d.onProgressUpdate(function (e) { o && o(e) }), s && s(function () { d.abort() }) } } var r = { qiniuRegion: "", qiniuImageURLPrefix: "", qiniuUploadToken: "", qiniuUploadTokenURL: "", qiniuUploadTokenFunction: null, qiniuShouldUseQiniuFileName: !1 }; e.exports = { init: function (e) { r = { qiniuRegion: "", qiniuImageURLPrefix: "", qiniuUploadToken: "", qiniuUploadTokenURL: "", qiniuUploadTokenFunction: null, qiniuShouldUseQiniuFileName: !1 }, t(e) }, upload: function (e, i, o, s, a, c, u, l) { if (null != e) if (s && t(s), r.qiniuUploadToken) n(e, i, o, s, a, c, u, l); else if (r.qiniuUploadTokenURL) !function (e) { wx.request({ url: r.qiniuUploadTokenURL, success: function (t) { var n = t.data.uptoken; n && n.length > 0 ? (r.qiniuUploadToken = n, e && e()) : console.error("qiniuUploader cannot get your token, please check the uptokenURL or server") }, fail: function (e) { console.error("qiniu UploadToken is null, please check the init config or networking: " + e) } }) }(function () { n(e, i, o, s, a, c, u, l) }); else { if (!r.qiniuUploadTokenFunction) return void console.error("qiniu uploader need one of [uptoken, uptokenURL, uptokenFunc]"); if (r.qiniuUploadToken = r.qiniuUploadTokenFunction(), null == r.qiniuUploadToken && r.qiniuUploadToken.length > 0) return void console.error("qiniu UploadTokenFunction result is null, please check the return value"); n(e, i, o, s, a, c, u, l) } else console.error("qiniu uploader need filePath to upload") } } }() },,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(151)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(159)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(167)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(175)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(183)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(191)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(199)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(207)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(215)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(223)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(231)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(239)).default) }).call(this, n(1).createPage) },,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(245)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(253)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(261)).default) }).call(this, n(1).createPage) },,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(267)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(275)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(283)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(291)).default) }).call(this, n(1).createPage) },,,,,,,, function(e, t, n) { (function (e) { function t(e) { return e && e.__esModule ? e : { default: e } } n(4), t(n(2)), e(t(n(299)).default) }).call(this, n(1).createPage) }]]);